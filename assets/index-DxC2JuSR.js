(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var T0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function st(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var b4={exports:{}},Np={},w4={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qf=Symbol.for("react.element"),w6=Symbol.for("react.portal"),S6=Symbol.for("react.fragment"),_6=Symbol.for("react.strict_mode"),k6=Symbol.for("react.profiler"),N6=Symbol.for("react.provider"),j6=Symbol.for("react.context"),E6=Symbol.for("react.forward_ref"),T6=Symbol.for("react.suspense"),A6=Symbol.for("react.memo"),O6=Symbol.for("react.lazy"),Kw=Symbol.iterator;function C6(e){return e===null||typeof e!="object"?null:(e=Kw&&e[Kw]||e["@@iterator"],typeof e=="function"?e:null)}var S4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_4=Object.assign,k4={};function oc(e,t,r){this.props=e,this.context=t,this.refs=k4,this.updater=r||S4}oc.prototype.isReactComponent={};oc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};oc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function N4(){}N4.prototype=oc.prototype;function ty(e,t,r){this.props=e,this.context=t,this.refs=k4,this.updater=r||S4}var ry=ty.prototype=new N4;ry.constructor=ty;_4(ry,oc.prototype);ry.isPureReactComponent=!0;var qw=Array.isArray,j4=Object.prototype.hasOwnProperty,ny={current:null},E4={key:!0,ref:!0,__self:!0,__source:!0};function T4(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)j4.call(t,n)&&!E4.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:qf,type:e,key:i,ref:s,props:a,_owner:ny.current}}function P6(e,t){return{$$typeof:qf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ay(e){return typeof e=="object"&&e!==null&&e.$$typeof===qf}function M6(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Yw=/\/+/g;function nm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?M6(""+e.key):t.toString(36)}function wd(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case qf:case w6:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+nm(s,0):n,qw(a)?(r="",e!=null&&(r=e.replace(Yw,"$&/")+"/"),wd(a,t,r,"",function(u){return u})):a!=null&&(ay(a)&&(a=P6(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Yw,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",qw(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+nm(i,o);s+=wd(i,t,r,c,a)}else if(c=C6(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+nm(i,o++),s+=wd(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function A0(e,t,r){if(e==null)return e;var n=[],a=0;return wd(e,n,"","",function(i){return t.call(r,i,a++)}),n}function F6(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ln={current:null},Sd={transition:null},D6={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Sd,ReactCurrentOwner:ny};function A4(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:A0,forEach:function(e,t,r){A0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return A0(e,function(){t++}),t},toArray:function(e){return A0(e,function(t){return t})||[]},only:function(e){if(!ay(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=oc;Xe.Fragment=S6;Xe.Profiler=k6;Xe.PureComponent=ty;Xe.StrictMode=_6;Xe.Suspense=T6;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D6;Xe.act=A4;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=_4({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=ny.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)j4.call(t,c)&&!E4.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:qf,type:e.type,key:a,ref:i,props:n,_owner:s}};Xe.createContext=function(e){return e={$$typeof:j6,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:N6,_context:e},e.Consumer=e};Xe.createElement=T4;Xe.createFactory=function(e){var t=T4.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:E6,render:e}};Xe.isValidElement=ay;Xe.lazy=function(e){return{$$typeof:O6,_payload:{_status:-1,_result:e},_init:F6}};Xe.memo=function(e,t){return{$$typeof:A6,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=Sd.transition;Sd.transition={};try{e()}finally{Sd.transition=t}};Xe.unstable_act=A4;Xe.useCallback=function(e,t){return ln.current.useCallback(e,t)};Xe.useContext=function(e){return ln.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return ln.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return ln.current.useEffect(e,t)};Xe.useId=function(){return ln.current.useId()};Xe.useImperativeHandle=function(e,t,r){return ln.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return ln.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return ln.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return ln.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return ln.current.useReducer(e,t,r)};Xe.useRef=function(e){return ln.current.useRef(e)};Xe.useState=function(e){return ln.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return ln.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return ln.current.useTransition()};Xe.version="18.3.1";w4.exports=Xe;var H=w4.exports;const q=st(H);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I6=H,R6=Symbol.for("react.element"),$6=Symbol.for("react.fragment"),L6=Object.prototype.hasOwnProperty,B6=I6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,U6={key:!0,ref:!0,__self:!0,__source:!0};function O4(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)L6.call(t,n)&&!U6.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:R6,type:e,key:i,ref:s,props:a,_owner:B6.current}}Np.Fragment=$6;Np.jsx=O4;Np.jsxs=O4;b4.exports=Np;var l=b4.exports,Fd={},C4={exports:{}},Ln={},P4={exports:{}},M4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,D){var Z=K.length;K.push(D);e:for(;0<Z;){var ee=Z-1>>>1,O=K[ee];if(0<a(O,D))K[ee]=D,K[Z]=O,Z=ee;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var D=K[0],Z=K.pop();if(Z!==D){K[0]=Z;e:for(var ee=0,O=K.length,L=O>>>1;ee<L;){var R=2*(ee+1)-1,X=K[R],J=R+1,le=K[J];if(0>a(X,Z))J<O&&0>a(le,X)?(K[ee]=le,K[J]=Z,ee=J):(K[ee]=X,K[R]=Z,ee=R);else if(J<O&&0>a(le,Z))K[ee]=le,K[J]=Z,ee=J;else break e}}return D}function a(K,D){var Z=K.sortIndex-D.sortIndex;return Z!==0?Z:K.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var c=[],u=[],f=1,d=null,h=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(K){for(var D=r(u);D!==null;){if(D.callback===null)n(u);else if(D.startTime<=K)n(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=r(u)}}function _(K){if(g=!1,x(K),!m)if(r(c)!==null)m=!0,W(w);else{var D=r(u);D!==null&&Y(_,D.startTime-K)}}function w(K,D){m=!1,g&&(g=!1,v(N),N=-1),p=!0;var Z=h;try{for(x(D),d=r(c);d!==null&&(!(d.expirationTime>D)||K&&!A());){var ee=d.callback;if(typeof ee=="function"){d.callback=null,h=d.priorityLevel;var O=ee(d.expirationTime<=D);D=e.unstable_now(),typeof O=="function"?d.callback=O:d===r(c)&&n(c),x(D)}else n(c);d=r(c)}if(d!==null)var L=!0;else{var R=r(u);R!==null&&Y(_,R.startTime-D),L=!1}return L}finally{d=null,h=Z,p=!1}}var S=!1,k=null,N=-1,j=5,E=-1;function A(){return!(e.unstable_now()-E<j)}function T(){if(k!==null){var K=e.unstable_now();E=K;var D=!0;try{D=k(!0,K)}finally{D?F():(S=!1,k=null)}}else S=!1}var F;if(typeof b=="function")F=function(){b(T)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,M=G.port2;G.port1.onmessage=T,F=function(){M.postMessage(null)}}else F=function(){y(T,0)};function W(K){k=K,S||(S=!0,F())}function Y(K,D){N=y(function(){K(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,W(w))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var Z=h;h=D;try{return K()}finally{h=Z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,D){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Z=h;h=K;try{return D()}finally{h=Z}},e.unstable_scheduleCallback=function(K,D,Z){var ee=e.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ee+Z:ee):Z=ee,K){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Z+O,K={id:f++,callback:D,priorityLevel:K,startTime:Z,expirationTime:O,sortIndex:-1},Z>ee?(K.sortIndex=Z,t(u,K),r(c)===null&&K===r(u)&&(g?(v(N),N=-1):g=!0,Y(_,Z-ee))):(K.sortIndex=O,t(c,K),m||p||(m=!0,W(w))),K},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(K){var D=h;return function(){var Z=h;h=D;try{return K.apply(this,arguments)}finally{h=Z}}}})(M4);P4.exports=M4;var z6=P4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W6=H,In=z6;function xe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var F4=new Set,Du={};function wo(e,t){jl(e,t),jl(e+"Capture",t)}function jl(e,t){for(Du[e]=t,e=0;e<t.length;e++)F4.add(t[e])}var bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sg=Object.prototype.hasOwnProperty,H6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Qw={},Zw={};function V6(e){return Sg.call(Zw,e)?!0:Sg.call(Qw,e)?!1:H6.test(e)?Zw[e]=!0:(Qw[e]=!0,!1)}function G6(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function X6(e,t,r,n){if(t===null||typeof t>"u"||G6(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function cn(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var Cr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Cr[e]=new cn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Cr[t]=new cn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Cr[e]=new cn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Cr[e]=new cn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Cr[e]=new cn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Cr[e]=new cn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Cr[e]=new cn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Cr[e]=new cn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Cr[e]=new cn(e,5,!1,e.toLowerCase(),null,!1,!1)});var iy=/[\-:]([a-z])/g;function sy(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(iy,sy);Cr[t]=new cn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(iy,sy);Cr[t]=new cn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(iy,sy);Cr[t]=new cn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Cr[e]=new cn(e,1,!1,e.toLowerCase(),null,!1,!1)});Cr.xlinkHref=new cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Cr[e]=new cn(e,1,!1,e.toLowerCase(),null,!0,!0)});function oy(e,t,r,n){var a=Cr.hasOwnProperty(t)?Cr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(X6(t,r,a,n)&&(r=null),n||a===null?V6(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ti=W6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O0=Symbol.for("react.element"),qo=Symbol.for("react.portal"),Yo=Symbol.for("react.fragment"),ly=Symbol.for("react.strict_mode"),_g=Symbol.for("react.profiler"),D4=Symbol.for("react.provider"),I4=Symbol.for("react.context"),cy=Symbol.for("react.forward_ref"),kg=Symbol.for("react.suspense"),Ng=Symbol.for("react.suspense_list"),uy=Symbol.for("react.memo"),$i=Symbol.for("react.lazy"),R4=Symbol.for("react.offscreen"),Jw=Symbol.iterator;function Fc(e){return e===null||typeof e!="object"?null:(e=Jw&&e[Jw]||e["@@iterator"],typeof e=="function"?e:null)}var Dt=Object.assign,am;function nu(e){if(am===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);am=t&&t[1]||""}return`
`+am+e}var im=!1;function sm(e,t){if(!e||im)return"";im=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=o);break}}}finally{im=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?nu(e):""}function K6(e){switch(e.tag){case 5:return nu(e.type);case 16:return nu("Lazy");case 13:return nu("Suspense");case 19:return nu("SuspenseList");case 0:case 2:case 15:return e=sm(e.type,!1),e;case 11:return e=sm(e.type.render,!1),e;case 1:return e=sm(e.type,!0),e;default:return""}}function jg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yo:return"Fragment";case qo:return"Portal";case _g:return"Profiler";case ly:return"StrictMode";case kg:return"Suspense";case Ng:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case I4:return(e.displayName||"Context")+".Consumer";case D4:return(e._context.displayName||"Context")+".Provider";case cy:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case uy:return t=e.displayName||null,t!==null?t:jg(e.type)||"Memo";case $i:t=e._payload,e=e._init;try{return jg(e(t))}catch{}}return null}function q6(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jg(t);case 8:return t===ly?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function as(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function $4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Y6(e){var t=$4(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function C0(e){e._valueTracker||(e._valueTracker=Y6(e))}function L4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=$4(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Dd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Eg(e,t){var r=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function e2(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=as(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function B4(e,t){t=t.checked,t!=null&&oy(e,"checked",t,!1)}function Tg(e,t){B4(e,t);var r=as(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ag(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ag(e,t.type,as(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function t2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ag(e,t,r){(t!=="number"||Dd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var au=Array.isArray;function hl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+as(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Og(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(xe(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function r2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(xe(92));if(au(r)){if(1<r.length)throw Error(xe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:as(r)}}function U4(e,t){var r=as(t.value),n=as(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function n2(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function z4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?z4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var P0,W4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(P0=P0||document.createElement("div"),P0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=P0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Iu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var fu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Q6=["Webkit","ms","Moz","O"];Object.keys(fu).forEach(function(e){Q6.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fu[t]=fu[e]})});function H4(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||fu.hasOwnProperty(e)&&fu[e]?(""+t).trim():t+"px"}function V4(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=H4(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Z6=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pg(e,t){if(t){if(Z6[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(xe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(xe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(xe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(xe(62))}}function Mg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fg=null;function fy(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Dg=null,pl=null,xl=null;function a2(e){if(e=Zf(e)){if(typeof Dg!="function")throw Error(xe(280));var t=e.stateNode;t&&(t=Op(t),Dg(e.stateNode,e.type,t))}}function G4(e){pl?xl?xl.push(e):xl=[e]:pl=e}function X4(){if(pl){var e=pl,t=xl;if(xl=pl=null,a2(e),t)for(e=0;e<t.length;e++)a2(t[e])}}function K4(e,t){return e(t)}function q4(){}var om=!1;function Y4(e,t,r){if(om)return e(t,r);om=!0;try{return K4(e,t,r)}finally{om=!1,(pl!==null||xl!==null)&&(q4(),X4())}}function Ru(e,t){var r=e.stateNode;if(r===null)return null;var n=Op(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(xe(231,t,typeof r));return r}var Ig=!1;if(bi)try{var Dc={};Object.defineProperty(Dc,"passive",{get:function(){Ig=!0}}),window.addEventListener("test",Dc,Dc),window.removeEventListener("test",Dc,Dc)}catch{Ig=!1}function J6(e,t,r,n,a,i,s,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var du=!1,Id=null,Rd=!1,Rg=null,eM={onError:function(e){du=!0,Id=e}};function tM(e,t,r,n,a,i,s,o,c){du=!1,Id=null,J6.apply(eM,arguments)}function rM(e,t,r,n,a,i,s,o,c){if(tM.apply(this,arguments),du){if(du){var u=Id;du=!1,Id=null}else throw Error(xe(198));Rd||(Rd=!0,Rg=u)}}function So(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Q4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function i2(e){if(So(e)!==e)throw Error(xe(188))}function nM(e){var t=e.alternate;if(!t){if(t=So(e),t===null)throw Error(xe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return i2(a),e;if(i===n)return i2(a),t;i=i.sibling}throw Error(xe(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(xe(189))}}if(r.alternate!==n)throw Error(xe(190))}if(r.tag!==3)throw Error(xe(188));return r.stateNode.current===r?e:t}function Z4(e){return e=nM(e),e!==null?J4(e):null}function J4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=J4(e);if(t!==null)return t;e=e.sibling}return null}var eE=In.unstable_scheduleCallback,s2=In.unstable_cancelCallback,aM=In.unstable_shouldYield,iM=In.unstable_requestPaint,Ht=In.unstable_now,sM=In.unstable_getCurrentPriorityLevel,dy=In.unstable_ImmediatePriority,tE=In.unstable_UserBlockingPriority,$d=In.unstable_NormalPriority,oM=In.unstable_LowPriority,rE=In.unstable_IdlePriority,jp=null,Va=null;function lM(e){if(Va&&typeof Va.onCommitFiberRoot=="function")try{Va.onCommitFiberRoot(jp,e,void 0,(e.current.flags&128)===128)}catch{}}var Ta=Math.clz32?Math.clz32:fM,cM=Math.log,uM=Math.LN2;function fM(e){return e>>>=0,e===0?32:31-(cM(e)/uM|0)|0}var M0=64,F0=4194304;function iu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ld(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=iu(o):(i&=s,i!==0&&(n=iu(i)))}else s=r&~a,s!==0?n=iu(s):i!==0&&(n=iu(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ta(t),a=1<<r,n|=e[r],t&=~a;return n}function dM(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hM(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Ta(i),o=1<<s,c=a[s];c===-1?(!(o&r)||o&n)&&(a[s]=dM(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function $g(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nE(){var e=M0;return M0<<=1,!(M0&4194240)&&(M0=64),e}function lm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Yf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ta(t),e[t]=r}function pM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ta(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function hy(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ta(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var it=0;function aE(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var iE,py,sE,oE,lE,Lg=!1,D0=[],qi=null,Yi=null,Qi=null,$u=new Map,Lu=new Map,Ui=[],xM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function o2(e,t){switch(e){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":$u.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lu.delete(t.pointerId)}}function Ic(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Zf(t),t!==null&&py(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function mM(e,t,r,n,a){switch(t){case"focusin":return qi=Ic(qi,e,t,r,n,a),!0;case"dragenter":return Yi=Ic(Yi,e,t,r,n,a),!0;case"mouseover":return Qi=Ic(Qi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return $u.set(i,Ic($u.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Lu.set(i,Ic(Lu.get(i)||null,e,t,r,n,a)),!0}return!1}function cE(e){var t=Us(e.target);if(t!==null){var r=So(t);if(r!==null){if(t=r.tag,t===13){if(t=Q4(r),t!==null){e.blockedOn=t,lE(e.priority,function(){sE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _d(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Bg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Fg=n,r.target.dispatchEvent(n),Fg=null}else return t=Zf(r),t!==null&&py(t),e.blockedOn=r,!1;t.shift()}return!0}function l2(e,t,r){_d(e)&&r.delete(t)}function gM(){Lg=!1,qi!==null&&_d(qi)&&(qi=null),Yi!==null&&_d(Yi)&&(Yi=null),Qi!==null&&_d(Qi)&&(Qi=null),$u.forEach(l2),Lu.forEach(l2)}function Rc(e,t){e.blockedOn===t&&(e.blockedOn=null,Lg||(Lg=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,gM)))}function Bu(e){function t(a){return Rc(a,e)}if(0<D0.length){Rc(D0[0],e);for(var r=1;r<D0.length;r++){var n=D0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(qi!==null&&Rc(qi,e),Yi!==null&&Rc(Yi,e),Qi!==null&&Rc(Qi,e),$u.forEach(t),Lu.forEach(t),r=0;r<Ui.length;r++)n=Ui[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ui.length&&(r=Ui[0],r.blockedOn===null);)cE(r),r.blockedOn===null&&Ui.shift()}var ml=Ti.ReactCurrentBatchConfig,Bd=!0;function vM(e,t,r,n){var a=it,i=ml.transition;ml.transition=null;try{it=1,xy(e,t,r,n)}finally{it=a,ml.transition=i}}function yM(e,t,r,n){var a=it,i=ml.transition;ml.transition=null;try{it=4,xy(e,t,r,n)}finally{it=a,ml.transition=i}}function xy(e,t,r,n){if(Bd){var a=Bg(e,t,r,n);if(a===null)vm(e,t,n,Ud,r),o2(e,n);else if(mM(a,e,t,r,n))n.stopPropagation();else if(o2(e,n),t&4&&-1<xM.indexOf(e)){for(;a!==null;){var i=Zf(a);if(i!==null&&iE(i),i=Bg(e,t,r,n),i===null&&vm(e,t,n,Ud,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else vm(e,t,n,null,r)}}var Ud=null;function Bg(e,t,r,n){if(Ud=null,e=fy(n),e=Us(e),e!==null)if(t=So(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Q4(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ud=e,null}function uE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sM()){case dy:return 1;case tE:return 4;case $d:case oM:return 16;case rE:return 536870912;default:return 16}default:return 16}}var Hi=null,my=null,kd=null;function fE(){if(kd)return kd;var e,t=my,r=t.length,n,a="value"in Hi?Hi.value:Hi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return kd=a.slice(e,1<n?1-n:void 0)}function Nd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function I0(){return!0}function c2(){return!1}function Bn(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?I0:c2,this.isPropagationStopped=c2,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=I0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=I0)},persist:function(){},isPersistent:I0}),t}var lc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gy=Bn(lc),Qf=Dt({},lc,{view:0,detail:0}),bM=Bn(Qf),cm,um,$c,Ep=Dt({},Qf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$c&&($c&&e.type==="mousemove"?(cm=e.screenX-$c.screenX,um=e.screenY-$c.screenY):um=cm=0,$c=e),cm)},movementY:function(e){return"movementY"in e?e.movementY:um}}),u2=Bn(Ep),wM=Dt({},Ep,{dataTransfer:0}),SM=Bn(wM),_M=Dt({},Qf,{relatedTarget:0}),fm=Bn(_M),kM=Dt({},lc,{animationName:0,elapsedTime:0,pseudoElement:0}),NM=Bn(kM),jM=Dt({},lc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),EM=Bn(jM),TM=Dt({},lc,{data:0}),f2=Bn(TM),AM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},OM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PM(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=CM[e])?!!t[e]:!1}function vy(){return PM}var MM=Dt({},Qf,{key:function(e){if(e.key){var t=AM[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?OM[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vy,charCode:function(e){return e.type==="keypress"?Nd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),FM=Bn(MM),DM=Dt({},Ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),d2=Bn(DM),IM=Dt({},Qf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vy}),RM=Bn(IM),$M=Dt({},lc,{propertyName:0,elapsedTime:0,pseudoElement:0}),LM=Bn($M),BM=Dt({},Ep,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),UM=Bn(BM),zM=[9,13,27,32],yy=bi&&"CompositionEvent"in window,hu=null;bi&&"documentMode"in document&&(hu=document.documentMode);var WM=bi&&"TextEvent"in window&&!hu,dE=bi&&(!yy||hu&&8<hu&&11>=hu),h2=" ",p2=!1;function hE(e,t){switch(e){case"keyup":return zM.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qo=!1;function HM(e,t){switch(e){case"compositionend":return pE(t);case"keypress":return t.which!==32?null:(p2=!0,h2);case"textInput":return e=t.data,e===h2&&p2?null:e;default:return null}}function VM(e,t){if(Qo)return e==="compositionend"||!yy&&hE(e,t)?(e=fE(),kd=my=Hi=null,Qo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dE&&t.locale!=="ko"?null:t.data;default:return null}}var GM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!GM[e.type]:t==="textarea"}function xE(e,t,r,n){G4(n),t=zd(t,"onChange"),0<t.length&&(r=new gy("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var pu=null,Uu=null;function XM(e){jE(e,0)}function Tp(e){var t=el(e);if(L4(t))return e}function KM(e,t){if(e==="change")return t}var mE=!1;if(bi){var dm;if(bi){var hm="oninput"in document;if(!hm){var m2=document.createElement("div");m2.setAttribute("oninput","return;"),hm=typeof m2.oninput=="function"}dm=hm}else dm=!1;mE=dm&&(!document.documentMode||9<document.documentMode)}function g2(){pu&&(pu.detachEvent("onpropertychange",gE),Uu=pu=null)}function gE(e){if(e.propertyName==="value"&&Tp(Uu)){var t=[];xE(t,Uu,e,fy(e)),Y4(XM,t)}}function qM(e,t,r){e==="focusin"?(g2(),pu=t,Uu=r,pu.attachEvent("onpropertychange",gE)):e==="focusout"&&g2()}function YM(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Tp(Uu)}function QM(e,t){if(e==="click")return Tp(t)}function ZM(e,t){if(e==="input"||e==="change")return Tp(t)}function JM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ma=typeof Object.is=="function"?Object.is:JM;function zu(e,t){if(Ma(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Sg.call(t,a)||!Ma(e[a],t[a]))return!1}return!0}function v2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function y2(e,t){var r=v2(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v2(r)}}function vE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yE(){for(var e=window,t=Dd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Dd(e.document)}return t}function by(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function eF(e){var t=yE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&vE(r.ownerDocument.documentElement,r)){if(n!==null&&by(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=y2(r,i);var s=y2(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tF=bi&&"documentMode"in document&&11>=document.documentMode,Zo=null,Ug=null,xu=null,zg=!1;function b2(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zg||Zo==null||Zo!==Dd(n)||(n=Zo,"selectionStart"in n&&by(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xu&&zu(xu,n)||(xu=n,n=zd(Ug,"onSelect"),0<n.length&&(t=new gy("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Zo)))}function R0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Jo={animationend:R0("Animation","AnimationEnd"),animationiteration:R0("Animation","AnimationIteration"),animationstart:R0("Animation","AnimationStart"),transitionend:R0("Transition","TransitionEnd")},pm={},bE={};bi&&(bE=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function Ap(e){if(pm[e])return pm[e];if(!Jo[e])return e;var t=Jo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in bE)return pm[e]=t[r];return e}var wE=Ap("animationend"),SE=Ap("animationiteration"),_E=Ap("animationstart"),kE=Ap("transitionend"),NE=new Map,w2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(e,t){NE.set(e,t),wo(t,[e])}for(var xm=0;xm<w2.length;xm++){var mm=w2[xm],rF=mm.toLowerCase(),nF=mm[0].toUpperCase()+mm.slice(1);us(rF,"on"+nF)}us(wE,"onAnimationEnd");us(SE,"onAnimationIteration");us(_E,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(kE,"onTransitionEnd");jl("onMouseEnter",["mouseout","mouseover"]);jl("onMouseLeave",["mouseout","mouseover"]);jl("onPointerEnter",["pointerout","pointerover"]);jl("onPointerLeave",["pointerout","pointerover"]);wo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wo("onBeforeInput",["compositionend","keypress","textInput","paste"]);wo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aF=new Set("cancel close invalid load scroll toggle".split(" ").concat(su));function S2(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,rM(n,t,void 0,e),e.currentTarget=null}function jE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;S2(a,o,u),i=c}else for(s=0;s<n.length;s++){if(o=n[s],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;S2(a,o,u),i=c}}}if(Rd)throw e=Rg,Rd=!1,Rg=null,e}function gt(e,t){var r=t[Xg];r===void 0&&(r=t[Xg]=new Set);var n=e+"__bubble";r.has(n)||(EE(t,e,2,!1),r.add(n))}function gm(e,t,r){var n=0;t&&(n|=4),EE(r,e,n,t)}var $0="_reactListening"+Math.random().toString(36).slice(2);function Wu(e){if(!e[$0]){e[$0]=!0,F4.forEach(function(r){r!=="selectionchange"&&(aF.has(r)||gm(r,!1,e),gm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$0]||(t[$0]=!0,gm("selectionchange",!1,t))}}function EE(e,t,r,n){switch(uE(t)){case 1:var a=vM;break;case 4:a=yM;break;default:a=xy}r=a.bind(null,t,r,e),a=void 0,!Ig||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function vm(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Us(o),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}o=o.parentNode}}n=n.return}Y4(function(){var u=i,f=fy(r),d=[];e:{var h=NE.get(e);if(h!==void 0){var p=gy,m=e;switch(e){case"keypress":if(Nd(r)===0)break e;case"keydown":case"keyup":p=FM;break;case"focusin":m="focus",p=fm;break;case"focusout":m="blur",p=fm;break;case"beforeblur":case"afterblur":p=fm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=u2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=SM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=RM;break;case wE:case SE:case _E:p=NM;break;case kE:p=LM;break;case"scroll":p=bM;break;case"wheel":p=UM;break;case"copy":case"cut":case"paste":p=EM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=d2}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?h!==null?h+"Capture":null:h;g=[];for(var b=u,x;b!==null;){x=b;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,v!==null&&(_=Ru(b,v),_!=null&&g.push(Hu(b,_,x)))),y)break;b=b.return}0<g.length&&(h=new p(h,m,null,r,f),d.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Fg&&(m=r.relatedTarget||r.fromElement)&&(Us(m)||m[wi]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?Us(m):null,m!==null&&(y=So(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=u2,_="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=d2,_="onPointerLeave",v="onPointerEnter",b="pointer"),y=p==null?h:el(p),x=m==null?h:el(m),h=new g(_,b+"leave",p,r,f),h.target=y,h.relatedTarget=x,_=null,Us(f)===u&&(g=new g(v,b+"enter",m,r,f),g.target=x,g.relatedTarget=y,_=g),y=_,p&&m)t:{for(g=p,v=m,b=0,x=g;x;x=Io(x))b++;for(x=0,_=v;_;_=Io(_))x++;for(;0<b-x;)g=Io(g),b--;for(;0<x-b;)v=Io(v),x--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=Io(g),v=Io(v)}g=null}else g=null;p!==null&&_2(d,h,p,g,!1),m!==null&&y!==null&&_2(d,y,m,g,!0)}}e:{if(h=u?el(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var w=KM;else if(x2(h))if(mE)w=ZM;else{w=YM;var S=qM}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=QM);if(w&&(w=w(e,u))){xE(d,w,r,f);break e}S&&S(e,h,u),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&Ag(h,"number",h.value)}switch(S=u?el(u):window,e){case"focusin":(x2(S)||S.contentEditable==="true")&&(Zo=S,Ug=u,xu=null);break;case"focusout":xu=Ug=Zo=null;break;case"mousedown":zg=!0;break;case"contextmenu":case"mouseup":case"dragend":zg=!1,b2(d,r,f);break;case"selectionchange":if(tF)break;case"keydown":case"keyup":b2(d,r,f)}var k;if(yy)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Qo?hE(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(dE&&r.locale!=="ko"&&(Qo||N!=="onCompositionStart"?N==="onCompositionEnd"&&Qo&&(k=fE()):(Hi=f,my="value"in Hi?Hi.value:Hi.textContent,Qo=!0)),S=zd(u,N),0<S.length&&(N=new f2(N,e,null,r,f),d.push({event:N,listeners:S}),k?N.data=k:(k=pE(r),k!==null&&(N.data=k)))),(k=WM?HM(e,r):VM(e,r))&&(u=zd(u,"onBeforeInput"),0<u.length&&(f=new f2("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=k))}jE(d,t)})}function Hu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function zd(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ru(e,r),i!=null&&n.unshift(Hu(e,i,a)),i=Ru(e,t),i!=null&&n.push(Hu(e,i,a))),e=e.return}return n}function Io(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _2(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=Ru(r,i),c!=null&&s.unshift(Hu(r,c,o))):a||(c=Ru(r,i),c!=null&&s.push(Hu(r,c,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var iF=/\r\n?/g,sF=/\u0000|\uFFFD/g;function k2(e){return(typeof e=="string"?e:""+e).replace(iF,`
`).replace(sF,"")}function L0(e,t,r){if(t=k2(t),k2(e)!==t&&r)throw Error(xe(425))}function Wd(){}var Wg=null,Hg=null;function Vg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gg=typeof setTimeout=="function"?setTimeout:void 0,oF=typeof clearTimeout=="function"?clearTimeout:void 0,N2=typeof Promise=="function"?Promise:void 0,lF=typeof queueMicrotask=="function"?queueMicrotask:typeof N2<"u"?function(e){return N2.resolve(null).then(e).catch(cF)}:Gg;function cF(e){setTimeout(function(){throw e})}function ym(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Bu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Bu(t)}function Zi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function j2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var cc=Math.random().toString(36).slice(2),za="__reactFiber$"+cc,Vu="__reactProps$"+cc,wi="__reactContainer$"+cc,Xg="__reactEvents$"+cc,uF="__reactListeners$"+cc,fF="__reactHandles$"+cc;function Us(e){var t=e[za];if(t)return t;for(var r=e.parentNode;r;){if(t=r[wi]||r[za]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=j2(e);e!==null;){if(r=e[za])return r;e=j2(e)}return t}e=r,r=e.parentNode}return null}function Zf(e){return e=e[za]||e[wi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function el(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(xe(33))}function Op(e){return e[Vu]||null}var Kg=[],tl=-1;function fs(e){return{current:e}}function wt(e){0>tl||(e.current=Kg[tl],Kg[tl]=null,tl--)}function ht(e,t){tl++,Kg[tl]=e.current,e.current=t}var is={},qr=fs(is),pn=fs(!1),no=is;function El(e,t){var r=e.type.contextTypes;if(!r)return is;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function xn(e){return e=e.childContextTypes,e!=null}function Hd(){wt(pn),wt(qr)}function E2(e,t,r){if(qr.current!==is)throw Error(xe(168));ht(qr,t),ht(pn,r)}function TE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(xe(108,q6(e)||"Unknown",a));return Dt({},r,n)}function Vd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||is,no=qr.current,ht(qr,e),ht(pn,pn.current),!0}function T2(e,t,r){var n=e.stateNode;if(!n)throw Error(xe(169));r?(e=TE(e,t,no),n.__reactInternalMemoizedMergedChildContext=e,wt(pn),wt(qr),ht(qr,e)):wt(pn),ht(pn,r)}var oi=null,Cp=!1,bm=!1;function AE(e){oi===null?oi=[e]:oi.push(e)}function dF(e){Cp=!0,AE(e)}function ds(){if(!bm&&oi!==null){bm=!0;var e=0,t=it;try{var r=oi;for(it=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}oi=null,Cp=!1}catch(a){throw oi!==null&&(oi=oi.slice(e+1)),eE(dy,ds),a}finally{it=t,bm=!1}}return null}var rl=[],nl=0,Gd=null,Xd=0,Yn=[],Qn=0,ao=null,li=1,ci="";function Fs(e,t){rl[nl++]=Xd,rl[nl++]=Gd,Gd=e,Xd=t}function OE(e,t,r){Yn[Qn++]=li,Yn[Qn++]=ci,Yn[Qn++]=ao,ao=e;var n=li;e=ci;var a=32-Ta(n)-1;n&=~(1<<a),r+=1;var i=32-Ta(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,li=1<<32-Ta(t)+a|r<<a|n,ci=i+e}else li=1<<i|r<<a|n,ci=e}function wy(e){e.return!==null&&(Fs(e,1),OE(e,1,0))}function Sy(e){for(;e===Gd;)Gd=rl[--nl],rl[nl]=null,Xd=rl[--nl],rl[nl]=null;for(;e===ao;)ao=Yn[--Qn],Yn[Qn]=null,ci=Yn[--Qn],Yn[Qn]=null,li=Yn[--Qn],Yn[Qn]=null}var Pn=null,On=null,kt=!1,ka=null;function CE(e,t){var r=Jn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function A2(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pn=e,On=Zi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pn=e,On=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ao!==null?{id:li,overflow:ci}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Jn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pn=e,On=null,!0):!1;default:return!1}}function qg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yg(e){if(kt){var t=On;if(t){var r=t;if(!A2(e,t)){if(qg(e))throw Error(xe(418));t=Zi(r.nextSibling);var n=Pn;t&&A2(e,t)?CE(n,r):(e.flags=e.flags&-4097|2,kt=!1,Pn=e)}}else{if(qg(e))throw Error(xe(418));e.flags=e.flags&-4097|2,kt=!1,Pn=e}}}function O2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pn=e}function B0(e){if(e!==Pn)return!1;if(!kt)return O2(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vg(e.type,e.memoizedProps)),t&&(t=On)){if(qg(e))throw PE(),Error(xe(418));for(;t;)CE(e,t),t=Zi(t.nextSibling)}if(O2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(xe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){On=Zi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}On=null}}else On=Pn?Zi(e.stateNode.nextSibling):null;return!0}function PE(){for(var e=On;e;)e=Zi(e.nextSibling)}function Tl(){On=Pn=null,kt=!1}function _y(e){ka===null?ka=[e]:ka.push(e)}var hF=Ti.ReactCurrentBatchConfig;function Lc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(xe(309));var n=r.stateNode}if(!n)throw Error(xe(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(xe(284));if(!r._owner)throw Error(xe(290,e))}return e}function U0(e,t){throw e=Object.prototype.toString.call(t),Error(xe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function C2(e){var t=e._init;return t(e._payload)}function ME(e){function t(v,b){if(e){var x=v.deletions;x===null?(v.deletions=[b],v.flags|=16):x.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function a(v,b){return v=rs(v,b),v.index=0,v.sibling=null,v}function i(v,b,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<b?(v.flags|=2,b):x):(v.flags|=2,b)):(v.flags|=1048576,b)}function s(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,b,x,_){return b===null||b.tag!==6?(b=Em(x,v.mode,_),b.return=v,b):(b=a(b,x),b.return=v,b)}function c(v,b,x,_){var w=x.type;return w===Yo?f(v,b,x.props.children,_,x.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===$i&&C2(w)===b.type)?(_=a(b,x.props),_.ref=Lc(v,b,x),_.return=v,_):(_=Pd(x.type,x.key,x.props,null,v.mode,_),_.ref=Lc(v,b,x),_.return=v,_)}function u(v,b,x,_){return b===null||b.tag!==4||b.stateNode.containerInfo!==x.containerInfo||b.stateNode.implementation!==x.implementation?(b=Tm(x,v.mode,_),b.return=v,b):(b=a(b,x.children||[]),b.return=v,b)}function f(v,b,x,_,w){return b===null||b.tag!==7?(b=Ys(x,v.mode,_,w),b.return=v,b):(b=a(b,x),b.return=v,b)}function d(v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Em(""+b,v.mode,x),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case O0:return x=Pd(b.type,b.key,b.props,null,v.mode,x),x.ref=Lc(v,null,b),x.return=v,x;case qo:return b=Tm(b,v.mode,x),b.return=v,b;case $i:var _=b._init;return d(v,_(b._payload),x)}if(au(b)||Fc(b))return b=Ys(b,v.mode,x,null),b.return=v,b;U0(v,b)}return null}function h(v,b,x,_){var w=b!==null?b.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:o(v,b,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case O0:return x.key===w?c(v,b,x,_):null;case qo:return x.key===w?u(v,b,x,_):null;case $i:return w=x._init,h(v,b,w(x._payload),_)}if(au(x)||Fc(x))return w!==null?null:f(v,b,x,_,null);U0(v,x)}return null}function p(v,b,x,_,w){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(x)||null,o(b,v,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case O0:return v=v.get(_.key===null?x:_.key)||null,c(b,v,_,w);case qo:return v=v.get(_.key===null?x:_.key)||null,u(b,v,_,w);case $i:var S=_._init;return p(v,b,x,S(_._payload),w)}if(au(_)||Fc(_))return v=v.get(x)||null,f(b,v,_,w,null);U0(b,_)}return null}function m(v,b,x,_){for(var w=null,S=null,k=b,N=b=0,j=null;k!==null&&N<x.length;N++){k.index>N?(j=k,k=null):j=k.sibling;var E=h(v,k,x[N],_);if(E===null){k===null&&(k=j);break}e&&k&&E.alternate===null&&t(v,k),b=i(E,b,N),S===null?w=E:S.sibling=E,S=E,k=j}if(N===x.length)return r(v,k),kt&&Fs(v,N),w;if(k===null){for(;N<x.length;N++)k=d(v,x[N],_),k!==null&&(b=i(k,b,N),S===null?w=k:S.sibling=k,S=k);return kt&&Fs(v,N),w}for(k=n(v,k);N<x.length;N++)j=p(k,v,N,x[N],_),j!==null&&(e&&j.alternate!==null&&k.delete(j.key===null?N:j.key),b=i(j,b,N),S===null?w=j:S.sibling=j,S=j);return e&&k.forEach(function(A){return t(v,A)}),kt&&Fs(v,N),w}function g(v,b,x,_){var w=Fc(x);if(typeof w!="function")throw Error(xe(150));if(x=w.call(x),x==null)throw Error(xe(151));for(var S=w=null,k=b,N=b=0,j=null,E=x.next();k!==null&&!E.done;N++,E=x.next()){k.index>N?(j=k,k=null):j=k.sibling;var A=h(v,k,E.value,_);if(A===null){k===null&&(k=j);break}e&&k&&A.alternate===null&&t(v,k),b=i(A,b,N),S===null?w=A:S.sibling=A,S=A,k=j}if(E.done)return r(v,k),kt&&Fs(v,N),w;if(k===null){for(;!E.done;N++,E=x.next())E=d(v,E.value,_),E!==null&&(b=i(E,b,N),S===null?w=E:S.sibling=E,S=E);return kt&&Fs(v,N),w}for(k=n(v,k);!E.done;N++,E=x.next())E=p(k,v,N,E.value,_),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?N:E.key),b=i(E,b,N),S===null?w=E:S.sibling=E,S=E);return e&&k.forEach(function(T){return t(v,T)}),kt&&Fs(v,N),w}function y(v,b,x,_){if(typeof x=="object"&&x!==null&&x.type===Yo&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case O0:e:{for(var w=x.key,S=b;S!==null;){if(S.key===w){if(w=x.type,w===Yo){if(S.tag===7){r(v,S.sibling),b=a(S,x.props.children),b.return=v,v=b;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===$i&&C2(w)===S.type){r(v,S.sibling),b=a(S,x.props),b.ref=Lc(v,S,x),b.return=v,v=b;break e}r(v,S);break}else t(v,S);S=S.sibling}x.type===Yo?(b=Ys(x.props.children,v.mode,_,x.key),b.return=v,v=b):(_=Pd(x.type,x.key,x.props,null,v.mode,_),_.ref=Lc(v,b,x),_.return=v,v=_)}return s(v);case qo:e:{for(S=x.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===x.containerInfo&&b.stateNode.implementation===x.implementation){r(v,b.sibling),b=a(b,x.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=Tm(x,v.mode,_),b.return=v,v=b}return s(v);case $i:return S=x._init,y(v,b,S(x._payload),_)}if(au(x))return m(v,b,x,_);if(Fc(x))return g(v,b,x,_);U0(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,b!==null&&b.tag===6?(r(v,b.sibling),b=a(b,x),b.return=v,v=b):(r(v,b),b=Em(x,v.mode,_),b.return=v,v=b),s(v)):r(v,b)}return y}var Al=ME(!0),FE=ME(!1),Kd=fs(null),qd=null,al=null,ky=null;function Ny(){ky=al=qd=null}function jy(e){var t=Kd.current;wt(Kd),e._currentValue=t}function Qg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function gl(e,t){qd=e,ky=al=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(dn=!0),e.firstContext=null)}function ia(e){var t=e._currentValue;if(ky!==e)if(e={context:e,memoizedValue:t,next:null},al===null){if(qd===null)throw Error(xe(308));al=e,qd.dependencies={lanes:0,firstContext:e}}else al=al.next=e;return t}var zs=null;function Ey(e){zs===null?zs=[e]:zs.push(e)}function DE(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Ey(t)):(r.next=a.next,a.next=r),t.interleaved=r,Si(e,n)}function Si(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Li=!1;function Ty(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function pi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ji(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,qe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Si(e,r)}return a=n.interleaved,a===null?(t.next=t,Ey(n)):(t.next=a.next,a.next=t),n.interleaved=t,Si(e,r)}function jd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hy(e,r)}}function P2(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Yd(e,t,r,n){var a=e.updateQueue;Li=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,s===null?i=u:s.next=u,s=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==s&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(i!==null){var d=a.baseState;s=0,f=u=c=null,o=i;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(h=t,p=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){d=m.call(p,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(p,d,h):m,h==null)break e;d=Dt({},d,h);break e;case 2:Li=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=p,c=d):f=f.next=p,s|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);so|=s,e.lanes=s,e.memoizedState=d}}function M2(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(xe(191,a));a.call(n)}}}var Jf={},Ga=fs(Jf),Gu=fs(Jf),Xu=fs(Jf);function Ws(e){if(e===Jf)throw Error(xe(174));return e}function Ay(e,t){switch(ht(Xu,t),ht(Gu,e),ht(Ga,Jf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Cg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Cg(t,e)}wt(Ga),ht(Ga,t)}function Ol(){wt(Ga),wt(Gu),wt(Xu)}function RE(e){Ws(Xu.current);var t=Ws(Ga.current),r=Cg(t,e.type);t!==r&&(ht(Gu,e),ht(Ga,r))}function Oy(e){Gu.current===e&&(wt(Ga),wt(Gu))}var Ct=fs(0);function Qd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wm=[];function Cy(){for(var e=0;e<wm.length;e++)wm[e]._workInProgressVersionPrimary=null;wm.length=0}var Ed=Ti.ReactCurrentDispatcher,Sm=Ti.ReactCurrentBatchConfig,io=0,Ft=null,ar=null,mr=null,Zd=!1,mu=!1,Ku=0,pF=0;function Rr(){throw Error(xe(321))}function Py(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ma(e[r],t[r]))return!1;return!0}function My(e,t,r,n,a,i){if(io=i,Ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ed.current=e===null||e.memoizedState===null?vF:yF,e=r(n,a),mu){i=0;do{if(mu=!1,Ku=0,25<=i)throw Error(xe(301));i+=1,mr=ar=null,t.updateQueue=null,Ed.current=bF,e=r(n,a)}while(mu)}if(Ed.current=Jd,t=ar!==null&&ar.next!==null,io=0,mr=ar=Ft=null,Zd=!1,t)throw Error(xe(300));return e}function Fy(){var e=Ku!==0;return Ku=0,e}function Ua(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Ft.memoizedState=mr=e:mr=mr.next=e,mr}function sa(){if(ar===null){var e=Ft.alternate;e=e!==null?e.memoizedState:null}else e=ar.next;var t=mr===null?Ft.memoizedState:mr.next;if(t!==null)mr=t,ar=e;else{if(e===null)throw Error(xe(310));ar=e,e={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},mr===null?Ft.memoizedState=mr=e:mr=mr.next=e}return mr}function qu(e,t){return typeof t=="function"?t(e):t}function _m(e){var t=sa(),r=t.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=e;var n=ar,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,c=null,u=i;do{var f=u.lane;if((io&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,s=n):c=c.next=d,Ft.lanes|=f,so|=f}u=u.next}while(u!==null&&u!==i);c===null?s=n:c.next=o,Ma(n,t.memoizedState)||(dn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Ft.lanes|=i,so|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function km(e){var t=sa(),r=t.queue;if(r===null)throw Error(xe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Ma(i,t.memoizedState)||(dn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function $E(){}function LE(e,t){var r=Ft,n=sa(),a=t(),i=!Ma(n.memoizedState,a);if(i&&(n.memoizedState=a,dn=!0),n=n.queue,Dy(zE.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mr!==null&&mr.memoizedState.tag&1){if(r.flags|=2048,Yu(9,UE.bind(null,r,n,a,t),void 0,null),Sr===null)throw Error(xe(349));io&30||BE(r,t,a)}return a}function BE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function UE(e,t,r,n){t.value=r,t.getSnapshot=n,WE(t)&&HE(e)}function zE(e,t,r){return r(function(){WE(t)&&HE(e)})}function WE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ma(e,r)}catch{return!0}}function HE(e){var t=Si(e,1);t!==null&&Aa(t,e,1,-1)}function F2(e){var t=Ua();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qu,lastRenderedState:e},t.queue=e,e=e.dispatch=gF.bind(null,Ft,e),[t.memoizedState,e]}function Yu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ft.updateQueue,t===null?(t={lastEffect:null,stores:null},Ft.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function VE(){return sa().memoizedState}function Td(e,t,r,n){var a=Ua();Ft.flags|=e,a.memoizedState=Yu(1|t,r,void 0,n===void 0?null:n)}function Pp(e,t,r,n){var a=sa();n=n===void 0?null:n;var i=void 0;if(ar!==null){var s=ar.memoizedState;if(i=s.destroy,n!==null&&Py(n,s.deps)){a.memoizedState=Yu(t,r,i,n);return}}Ft.flags|=e,a.memoizedState=Yu(1|t,r,i,n)}function D2(e,t){return Td(8390656,8,e,t)}function Dy(e,t){return Pp(2048,8,e,t)}function GE(e,t){return Pp(4,2,e,t)}function XE(e,t){return Pp(4,4,e,t)}function KE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function qE(e,t,r){return r=r!=null?r.concat([e]):null,Pp(4,4,KE.bind(null,t,e),r)}function Iy(){}function YE(e,t){var r=sa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Py(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function QE(e,t){var r=sa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Py(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function ZE(e,t,r){return io&21?(Ma(r,t)||(r=nE(),Ft.lanes|=r,so|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,dn=!0),e.memoizedState=r)}function xF(e,t){var r=it;it=r!==0&&4>r?r:4,e(!0);var n=Sm.transition;Sm.transition={};try{e(!1),t()}finally{it=r,Sm.transition=n}}function JE(){return sa().memoizedState}function mF(e,t,r){var n=ts(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},eT(e))tT(t,r);else if(r=DE(e,t,r,n),r!==null){var a=an();Aa(r,e,n,a),rT(r,t,n)}}function gF(e,t,r){var n=ts(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(eT(e))tT(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Ma(o,s)){var c=t.interleaved;c===null?(a.next=a,Ey(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=DE(e,t,a,n),r!==null&&(a=an(),Aa(r,e,n,a),rT(r,t,n))}}function eT(e){var t=e.alternate;return e===Ft||t!==null&&t===Ft}function tT(e,t){mu=Zd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function rT(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,hy(e,r)}}var Jd={readContext:ia,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},vF={readContext:ia,useCallback:function(e,t){return Ua().memoizedState=[e,t===void 0?null:t],e},useContext:ia,useEffect:D2,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Td(4194308,4,KE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Td(4194308,4,e,t)},useInsertionEffect:function(e,t){return Td(4,2,e,t)},useMemo:function(e,t){var r=Ua();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ua();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=mF.bind(null,Ft,e),[n.memoizedState,e]},useRef:function(e){var t=Ua();return e={current:e},t.memoizedState=e},useState:F2,useDebugValue:Iy,useDeferredValue:function(e){return Ua().memoizedState=e},useTransition:function(){var e=F2(!1),t=e[0];return e=xF.bind(null,e[1]),Ua().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ft,a=Ua();if(kt){if(r===void 0)throw Error(xe(407));r=r()}else{if(r=t(),Sr===null)throw Error(xe(349));io&30||BE(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,D2(zE.bind(null,n,i,e),[e]),n.flags|=2048,Yu(9,UE.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ua(),t=Sr.identifierPrefix;if(kt){var r=ci,n=li;r=(n&~(1<<32-Ta(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ku++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=pF++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},yF={readContext:ia,useCallback:YE,useContext:ia,useEffect:Dy,useImperativeHandle:qE,useInsertionEffect:GE,useLayoutEffect:XE,useMemo:QE,useReducer:_m,useRef:VE,useState:function(){return _m(qu)},useDebugValue:Iy,useDeferredValue:function(e){var t=sa();return ZE(t,ar.memoizedState,e)},useTransition:function(){var e=_m(qu)[0],t=sa().memoizedState;return[e,t]},useMutableSource:$E,useSyncExternalStore:LE,useId:JE,unstable_isNewReconciler:!1},bF={readContext:ia,useCallback:YE,useContext:ia,useEffect:Dy,useImperativeHandle:qE,useInsertionEffect:GE,useLayoutEffect:XE,useMemo:QE,useReducer:km,useRef:VE,useState:function(){return km(qu)},useDebugValue:Iy,useDeferredValue:function(e){var t=sa();return ar===null?t.memoizedState=e:ZE(t,ar.memoizedState,e)},useTransition:function(){var e=km(qu)[0],t=sa().memoizedState;return[e,t]},useMutableSource:$E,useSyncExternalStore:LE,useId:JE,unstable_isNewReconciler:!1};function ba(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Zg(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Dt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Mp={isMounted:function(e){return(e=e._reactInternals)?So(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=an(),a=ts(e),i=pi(n,a);i.payload=t,r!=null&&(i.callback=r),t=Ji(e,i,a),t!==null&&(Aa(t,e,a,n),jd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=an(),a=ts(e),i=pi(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Ji(e,i,a),t!==null&&(Aa(t,e,a,n),jd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=an(),n=ts(e),a=pi(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ji(e,a,n),t!==null&&(Aa(t,e,n,r),jd(t,e,n))}};function I2(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!zu(r,n)||!zu(a,i):!0}function nT(e,t,r){var n=!1,a=is,i=t.contextType;return typeof i=="object"&&i!==null?i=ia(i):(a=xn(t)?no:qr.current,n=t.contextTypes,i=(n=n!=null)?El(e,a):is),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Mp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function R2(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Mp.enqueueReplaceState(t,t.state,null)}function Jg(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ty(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ia(i):(i=xn(t)?no:qr.current,a.context=El(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Zg(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Mp.enqueueReplaceState(a,a.state,null),Yd(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Cl(e,t){try{var r="",n=t;do r+=K6(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Nm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ev(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var wF=typeof WeakMap=="function"?WeakMap:Map;function aT(e,t,r){r=pi(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){th||(th=!0,uv=n),ev(e,t)},r}function iT(e,t,r){r=pi(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){ev(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ev(e,t),typeof n!="function"&&(es===null?es=new Set([this]):es.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function $2(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new wF;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=DF.bind(null,e,t,r),t.then(e,e))}function L2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function B2(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=pi(-1,1),t.tag=2,Ji(r,t,1))),r.lanes|=1),e)}var SF=Ti.ReactCurrentOwner,dn=!1;function Zr(e,t,r,n){t.child=e===null?FE(t,null,r,n):Al(t,e.child,r,n)}function U2(e,t,r,n,a){r=r.render;var i=t.ref;return gl(t,a),n=My(e,t,r,n,i,a),r=Fy(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_i(e,t,a)):(kt&&r&&wy(t),t.flags|=1,Zr(e,t,n,a),t.child)}function z2(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Hy(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,sT(e,t,i,n,a)):(e=Pd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:zu,r(s,n)&&e.ref===t.ref)return _i(e,t,a)}return t.flags|=1,e=rs(i,n),e.ref=t.ref,e.return=t,t.child=e}function sT(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(zu(i,n)&&e.ref===t.ref)if(dn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(dn=!0);else return t.lanes=e.lanes,_i(e,t,a)}return tv(e,t,r,n,a)}function oT(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(sl,Sn),Sn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(sl,Sn),Sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ht(sl,Sn),Sn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ht(sl,Sn),Sn|=n;return Zr(e,t,a,r),t.child}function lT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function tv(e,t,r,n,a){var i=xn(r)?no:qr.current;return i=El(t,i),gl(t,a),r=My(e,t,r,n,i,a),n=Fy(),e!==null&&!dn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_i(e,t,a)):(kt&&n&&wy(t),t.flags|=1,Zr(e,t,r,a),t.child)}function W2(e,t,r,n,a){if(xn(r)){var i=!0;Vd(t)}else i=!1;if(gl(t,a),t.stateNode===null)Ad(e,t),nT(t,r,n),Jg(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=ia(u):(u=xn(r)?no:qr.current,u=El(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||c!==u)&&R2(t,s,n,u),Li=!1;var h=t.memoizedState;s.state=h,Yd(t,n,s,a),c=t.memoizedState,o!==n||h!==c||pn.current||Li?(typeof f=="function"&&(Zg(t,r,f,n),c=t.memoizedState),(o=Li||I2(t,r,o,n,h,c,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,IE(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ba(t.type,o),s.props=u,d=t.pendingProps,h=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=ia(c):(c=xn(r)?no:qr.current,c=El(t,c));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||h!==c)&&R2(t,s,n,c),Li=!1,h=t.memoizedState,s.state=h,Yd(t,n,s,a);var m=t.memoizedState;o!==d||h!==m||pn.current||Li?(typeof p=="function"&&(Zg(t,r,p,n),m=t.memoizedState),(u=Li||I2(t,r,u,n,h,m,c)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,m,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,m,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),s.props=n,s.state=m,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return rv(e,t,r,n,i,a)}function rv(e,t,r,n,a,i){lT(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&T2(t,r,!1),_i(e,t,i);n=t.stateNode,SF.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Al(t,e.child,null,i),t.child=Al(t,null,o,i)):Zr(e,t,o,i),t.memoizedState=n.state,a&&T2(t,r,!0),t.child}function cT(e){var t=e.stateNode;t.pendingContext?E2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&E2(e,t.context,!1),Ay(e,t.containerInfo)}function H2(e,t,r,n,a){return Tl(),_y(a),t.flags|=256,Zr(e,t,r,n),t.child}var nv={dehydrated:null,treeContext:null,retryLane:0};function av(e){return{baseLanes:e,cachePool:null,transitions:null}}function uT(e,t,r){var n=t.pendingProps,a=Ct.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ht(Ct,a&1),e===null)return Yg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ip(s,n,0,null),e=Ys(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=av(r),t.memoizedState=nv,e):Ry(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return _F(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=rs(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=rs(o,i):(i=Ys(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?av(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=nv,n}return i=e.child,e=i.sibling,n=rs(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ry(e,t){return t=Ip({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function z0(e,t,r,n){return n!==null&&_y(n),Al(t,e.child,null,r),e=Ry(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _F(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Nm(Error(xe(422))),z0(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ip({mode:"visible",children:n.children},a,0,null),i=Ys(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Al(t,e.child,null,s),t.child.memoizedState=av(s),t.memoizedState=nv,i);if(!(t.mode&1))return z0(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(xe(419)),n=Nm(i,n,void 0),z0(e,t,s,n)}if(o=(s&e.childLanes)!==0,dn||o){if(n=Sr,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Si(e,a),Aa(n,e,a,-1))}return Wy(),n=Nm(Error(xe(421))),z0(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=IF.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,On=Zi(a.nextSibling),Pn=t,kt=!0,ka=null,e!==null&&(Yn[Qn++]=li,Yn[Qn++]=ci,Yn[Qn++]=ao,li=e.id,ci=e.overflow,ao=t),t=Ry(t,n.children),t.flags|=4096,t)}function V2(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Qg(e.return,t,r)}function jm(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function fT(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Zr(e,t,n.children,r),n=Ct.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&V2(e,r,t);else if(e.tag===19)V2(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ht(Ct,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Qd(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),jm(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Qd(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}jm(t,!0,r,null,i);break;case"together":jm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ad(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _i(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),so|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(xe(153));if(t.child!==null){for(e=t.child,r=rs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=rs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function kF(e,t,r){switch(t.tag){case 3:cT(t),Tl();break;case 5:RE(t);break;case 1:xn(t.type)&&Vd(t);break;case 4:Ay(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ht(Kd,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ht(Ct,Ct.current&1),t.flags|=128,null):r&t.child.childLanes?uT(e,t,r):(ht(Ct,Ct.current&1),e=_i(e,t,r),e!==null?e.sibling:null);ht(Ct,Ct.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return fT(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ht(Ct,Ct.current),n)break;return null;case 22:case 23:return t.lanes=0,oT(e,t,r)}return _i(e,t,r)}var dT,iv,hT,pT;dT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};iv=function(){};hT=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ws(Ga.current);var i=null;switch(r){case"input":a=Eg(e,a),n=Eg(e,n),i=[];break;case"select":a=Dt({},a,{value:void 0}),n=Dt({},n,{value:void 0}),i=[];break;case"textarea":a=Og(e,a),n=Og(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Wd)}Pg(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Du.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Du.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&gt("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};pT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Bc(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function $r(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function NF(e,t,r){var n=t.pendingProps;switch(Sy(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $r(t),null;case 1:return xn(t.type)&&Hd(),$r(t),null;case 3:return n=t.stateNode,Ol(),wt(pn),wt(qr),Cy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(B0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ka!==null&&(hv(ka),ka=null))),iv(e,t),$r(t),null;case 5:Oy(t);var a=Ws(Xu.current);if(r=t.type,e!==null&&t.stateNode!=null)hT(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(xe(166));return $r(t),null}if(e=Ws(Ga.current),B0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[za]=t,n[Vu]=i,e=(t.mode&1)!==0,r){case"dialog":gt("cancel",n),gt("close",n);break;case"iframe":case"object":case"embed":gt("load",n);break;case"video":case"audio":for(a=0;a<su.length;a++)gt(su[a],n);break;case"source":gt("error",n);break;case"img":case"image":case"link":gt("error",n),gt("load",n);break;case"details":gt("toggle",n);break;case"input":e2(n,i),gt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},gt("invalid",n);break;case"textarea":r2(n,i),gt("invalid",n)}Pg(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&L0(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&L0(n.textContent,o,e),a=["children",""+o]):Du.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&gt("scroll",n)}switch(r){case"input":C0(n),t2(n,i,!0);break;case"textarea":C0(n),n2(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Wd)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=z4(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[za]=t,e[Vu]=n,dT(e,t,!1,!1),t.stateNode=e;e:{switch(s=Mg(r,n),r){case"dialog":gt("cancel",e),gt("close",e),a=n;break;case"iframe":case"object":case"embed":gt("load",e),a=n;break;case"video":case"audio":for(a=0;a<su.length;a++)gt(su[a],e);a=n;break;case"source":gt("error",e),a=n;break;case"img":case"image":case"link":gt("error",e),gt("load",e),a=n;break;case"details":gt("toggle",e),a=n;break;case"input":e2(e,n),a=Eg(e,n),gt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Dt({},n,{value:void 0}),gt("invalid",e);break;case"textarea":r2(e,n),a=Og(e,n),gt("invalid",e);break;default:a=n}Pg(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?V4(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&W4(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Iu(e,c):typeof c=="number"&&Iu(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Du.hasOwnProperty(i)?c!=null&&i==="onScroll"&&gt("scroll",e):c!=null&&oy(e,i,c,s))}switch(r){case"input":C0(e),t2(e,n,!1);break;case"textarea":C0(e),n2(e);break;case"option":n.value!=null&&e.setAttribute("value",""+as(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?hl(e,!!n.multiple,i,!1):n.defaultValue!=null&&hl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Wd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return $r(t),null;case 6:if(e&&t.stateNode!=null)pT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(xe(166));if(r=Ws(Xu.current),Ws(Ga.current),B0(t)){if(n=t.stateNode,r=t.memoizedProps,n[za]=t,(i=n.nodeValue!==r)&&(e=Pn,e!==null))switch(e.tag){case 3:L0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&L0(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[za]=t,t.stateNode=n}return $r(t),null;case 13:if(wt(Ct),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&On!==null&&t.mode&1&&!(t.flags&128))PE(),Tl(),t.flags|=98560,i=!1;else if(i=B0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(xe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(xe(317));i[za]=t}else Tl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;$r(t),i=!1}else ka!==null&&(hv(ka),ka=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ct.current&1?lr===0&&(lr=3):Wy())),t.updateQueue!==null&&(t.flags|=4),$r(t),null);case 4:return Ol(),iv(e,t),e===null&&Wu(t.stateNode.containerInfo),$r(t),null;case 10:return jy(t.type._context),$r(t),null;case 17:return xn(t.type)&&Hd(),$r(t),null;case 19:if(wt(Ct),i=t.memoizedState,i===null)return $r(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Bc(i,!1);else{if(lr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Qd(e),s!==null){for(t.flags|=128,Bc(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ht(Ct,Ct.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ht()>Pl&&(t.flags|=128,n=!0,Bc(i,!1),t.lanes=4194304)}else{if(!n)if(e=Qd(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Bc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!kt)return $r(t),null}else 2*Ht()-i.renderingStartTime>Pl&&r!==1073741824&&(t.flags|=128,n=!0,Bc(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ht(),t.sibling=null,r=Ct.current,ht(Ct,n?r&1|2:r&1),t):($r(t),null);case 22:case 23:return zy(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sn&1073741824&&($r(t),t.subtreeFlags&6&&(t.flags|=8192)):$r(t),null;case 24:return null;case 25:return null}throw Error(xe(156,t.tag))}function jF(e,t){switch(Sy(t),t.tag){case 1:return xn(t.type)&&Hd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ol(),wt(pn),wt(qr),Cy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Oy(t),null;case 13:if(wt(Ct),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(xe(340));Tl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wt(Ct),null;case 4:return Ol(),null;case 10:return jy(t.type._context),null;case 22:case 23:return zy(),null;case 24:return null;default:return null}}var W0=!1,Wr=!1,EF=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function il(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Rt(e,t,n)}else r.current=null}function sv(e,t,r){try{r()}catch(n){Rt(e,t,n)}}var G2=!1;function TF(e,t){if(Wg=Bd,e=yE(),by(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||a!==0&&d.nodeType!==3||(o=s+a),d!==i||n!==0&&d.nodeType!==3||(c=s+n),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++u===a&&(o=s),h===i&&++f===n&&(c=s),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hg={focusedElem:e,selectionRange:r},Bd=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ba(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(xe(163))}}catch(_){Rt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return m=G2,G2=!1,m}function gu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&sv(t,r,i)}a=a.next}while(a!==n)}}function Fp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ov(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function xT(e){var t=e.alternate;t!==null&&(e.alternate=null,xT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[za],delete t[Vu],delete t[Xg],delete t[uF],delete t[fF])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function mT(e){return e.tag===5||e.tag===3||e.tag===4}function X2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function lv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Wd));else if(n!==4&&(e=e.child,e!==null))for(lv(e,t,r),e=e.sibling;e!==null;)lv(e,t,r),e=e.sibling}function cv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(cv(e,t,r),e=e.sibling;e!==null;)cv(e,t,r),e=e.sibling}var Er=null,wa=!1;function Ii(e,t,r){for(r=r.child;r!==null;)gT(e,t,r),r=r.sibling}function gT(e,t,r){if(Va&&typeof Va.onCommitFiberUnmount=="function")try{Va.onCommitFiberUnmount(jp,r)}catch{}switch(r.tag){case 5:Wr||il(r,t);case 6:var n=Er,a=wa;Er=null,Ii(e,t,r),Er=n,wa=a,Er!==null&&(wa?(e=Er,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Er.removeChild(r.stateNode));break;case 18:Er!==null&&(wa?(e=Er,r=r.stateNode,e.nodeType===8?ym(e.parentNode,r):e.nodeType===1&&ym(e,r),Bu(e)):ym(Er,r.stateNode));break;case 4:n=Er,a=wa,Er=r.stateNode.containerInfo,wa=!0,Ii(e,t,r),Er=n,wa=a;break;case 0:case 11:case 14:case 15:if(!Wr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&sv(r,t,s),a=a.next}while(a!==n)}Ii(e,t,r);break;case 1:if(!Wr&&(il(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Rt(r,t,o)}Ii(e,t,r);break;case 21:Ii(e,t,r);break;case 22:r.mode&1?(Wr=(n=Wr)||r.memoizedState!==null,Ii(e,t,r),Wr=n):Ii(e,t,r);break;default:Ii(e,t,r)}}function K2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new EF),t.forEach(function(n){var a=RF.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ga(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Er=o.stateNode,wa=!1;break e;case 3:Er=o.stateNode.containerInfo,wa=!0;break e;case 4:Er=o.stateNode.containerInfo,wa=!0;break e}o=o.return}if(Er===null)throw Error(xe(160));gT(i,s,a),Er=null,wa=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Rt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vT(t,e),t=t.sibling}function vT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ga(t,e),Ra(e),n&4){try{gu(3,e,e.return),Fp(3,e)}catch(g){Rt(e,e.return,g)}try{gu(5,e,e.return)}catch(g){Rt(e,e.return,g)}}break;case 1:ga(t,e),Ra(e),n&512&&r!==null&&il(r,r.return);break;case 5:if(ga(t,e),Ra(e),n&512&&r!==null&&il(r,r.return),e.flags&32){var a=e.stateNode;try{Iu(a,"")}catch(g){Rt(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&B4(a,i),Mg(o,s);var u=Mg(o,i);for(s=0;s<c.length;s+=2){var f=c[s],d=c[s+1];f==="style"?V4(a,d):f==="dangerouslySetInnerHTML"?W4(a,d):f==="children"?Iu(a,d):oy(a,f,d,u)}switch(o){case"input":Tg(a,i);break;case"textarea":U4(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?hl(a,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?hl(a,!!i.multiple,i.defaultValue,!0):hl(a,!!i.multiple,i.multiple?[]:"",!1))}a[Vu]=i}catch(g){Rt(e,e.return,g)}}break;case 6:if(ga(t,e),Ra(e),n&4){if(e.stateNode===null)throw Error(xe(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Rt(e,e.return,g)}}break;case 3:if(ga(t,e),Ra(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Bu(t.containerInfo)}catch(g){Rt(e,e.return,g)}break;case 4:ga(t,e),Ra(e);break;case 13:ga(t,e),Ra(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(By=Ht())),n&4&&K2(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Wr=(u=Wr)||f,ga(t,e),Wr=u):ga(t,e),Ra(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(d=Ne=f;Ne!==null;){switch(h=Ne,p=h.child,h.tag){case 0:case 11:case 14:case 15:gu(4,h,h.return);break;case 1:il(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Rt(n,r,g)}}break;case 5:il(h,h.return);break;case 22:if(h.memoizedState!==null){Y2(d);continue}}p!==null?(p.return=h,Ne=p):Y2(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=H4("display",s))}catch(g){Rt(e,e.return,g)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Rt(e,e.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ga(t,e),Ra(e),n&4&&K2(e);break;case 21:break;default:ga(t,e),Ra(e)}}function Ra(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(mT(r)){var n=r;break e}r=r.return}throw Error(xe(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Iu(a,""),n.flags&=-33);var i=X2(e);cv(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=X2(e);lv(e,o,s);break;default:throw Error(xe(161))}}catch(c){Rt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function AF(e,t,r){Ne=e,yT(e)}function yT(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var a=Ne,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||W0;if(!s){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Wr;o=W0;var u=Wr;if(W0=s,(Wr=c)&&!u)for(Ne=a;Ne!==null;)s=Ne,c=s.child,s.tag===22&&s.memoizedState!==null?Q2(a):c!==null?(c.return=s,Ne=c):Q2(a);for(;i!==null;)Ne=i,yT(i),i=i.sibling;Ne=a,W0=o,Wr=u}q2(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ne=i):q2(e)}}function q2(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Wr||Fp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Wr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ba(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&M2(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}M2(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Bu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(xe(163))}Wr||t.flags&512&&ov(t)}catch(h){Rt(t,t.return,h)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Y2(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function Q2(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Fp(4,t)}catch(c){Rt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Rt(t,a,c)}}var i=t.return;try{ov(t)}catch(c){Rt(t,i,c)}break;case 5:var s=t.return;try{ov(t)}catch(c){Rt(t,s,c)}}}catch(c){Rt(t,t.return,c)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var OF=Math.ceil,eh=Ti.ReactCurrentDispatcher,$y=Ti.ReactCurrentOwner,ta=Ti.ReactCurrentBatchConfig,qe=0,Sr=null,Jt=null,Or=0,Sn=0,sl=fs(0),lr=0,Qu=null,so=0,Dp=0,Ly=0,vu=null,fn=null,By=0,Pl=1/0,ii=null,th=!1,uv=null,es=null,H0=!1,Vi=null,rh=0,yu=0,fv=null,Od=-1,Cd=0;function an(){return qe&6?Ht():Od!==-1?Od:Od=Ht()}function ts(e){return e.mode&1?qe&2&&Or!==0?Or&-Or:hF.transition!==null?(Cd===0&&(Cd=nE()),Cd):(e=it,e!==0||(e=window.event,e=e===void 0?16:uE(e.type)),e):1}function Aa(e,t,r,n){if(50<yu)throw yu=0,fv=null,Error(xe(185));Yf(e,r,n),(!(qe&2)||e!==Sr)&&(e===Sr&&(!(qe&2)&&(Dp|=r),lr===4&&zi(e,Or)),mn(e,n),r===1&&qe===0&&!(t.mode&1)&&(Pl=Ht()+500,Cp&&ds()))}function mn(e,t){var r=e.callbackNode;hM(e,t);var n=Ld(e,e===Sr?Or:0);if(n===0)r!==null&&s2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&s2(r),t===1)e.tag===0?dF(Z2.bind(null,e)):AE(Z2.bind(null,e)),lF(function(){!(qe&6)&&ds()}),r=null;else{switch(aE(n)){case 1:r=dy;break;case 4:r=tE;break;case 16:r=$d;break;case 536870912:r=rE;break;default:r=$d}r=ET(r,bT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function bT(e,t){if(Od=-1,Cd=0,qe&6)throw Error(xe(327));var r=e.callbackNode;if(vl()&&e.callbackNode!==r)return null;var n=Ld(e,e===Sr?Or:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=nh(e,n);else{t=n;var a=qe;qe|=2;var i=ST();(Sr!==e||Or!==t)&&(ii=null,Pl=Ht()+500,qs(e,t));do try{MF();break}catch(o){wT(e,o)}while(!0);Ny(),eh.current=i,qe=a,Jt!==null?t=0:(Sr=null,Or=0,t=lr)}if(t!==0){if(t===2&&(a=$g(e),a!==0&&(n=a,t=dv(e,a))),t===1)throw r=Qu,qs(e,0),zi(e,n),mn(e,Ht()),r;if(t===6)zi(e,n);else{if(a=e.current.alternate,!(n&30)&&!CF(a)&&(t=nh(e,n),t===2&&(i=$g(e),i!==0&&(n=i,t=dv(e,i))),t===1))throw r=Qu,qs(e,0),zi(e,n),mn(e,Ht()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(xe(345));case 2:Ds(e,fn,ii);break;case 3:if(zi(e,n),(n&130023424)===n&&(t=By+500-Ht(),10<t)){if(Ld(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){an(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Gg(Ds.bind(null,e,fn,ii),t);break}Ds(e,fn,ii);break;case 4:if(zi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Ta(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*OF(n/1960))-n,10<n){e.timeoutHandle=Gg(Ds.bind(null,e,fn,ii),n);break}Ds(e,fn,ii);break;case 5:Ds(e,fn,ii);break;default:throw Error(xe(329))}}}return mn(e,Ht()),e.callbackNode===r?bT.bind(null,e):null}function dv(e,t){var r=vu;return e.current.memoizedState.isDehydrated&&(qs(e,t).flags|=256),e=nh(e,t),e!==2&&(t=fn,fn=r,t!==null&&hv(t)),e}function hv(e){fn===null?fn=e:fn.push.apply(fn,e)}function CF(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ma(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zi(e,t){for(t&=~Ly,t&=~Dp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ta(t),n=1<<r;e[r]=-1,t&=~n}}function Z2(e){if(qe&6)throw Error(xe(327));vl();var t=Ld(e,0);if(!(t&1))return mn(e,Ht()),null;var r=nh(e,t);if(e.tag!==0&&r===2){var n=$g(e);n!==0&&(t=n,r=dv(e,n))}if(r===1)throw r=Qu,qs(e,0),zi(e,t),mn(e,Ht()),r;if(r===6)throw Error(xe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ds(e,fn,ii),mn(e,Ht()),null}function Uy(e,t){var r=qe;qe|=1;try{return e(t)}finally{qe=r,qe===0&&(Pl=Ht()+500,Cp&&ds())}}function oo(e){Vi!==null&&Vi.tag===0&&!(qe&6)&&vl();var t=qe;qe|=1;var r=ta.transition,n=it;try{if(ta.transition=null,it=1,e)return e()}finally{it=n,ta.transition=r,qe=t,!(qe&6)&&ds()}}function zy(){Sn=sl.current,wt(sl)}function qs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,oF(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(Sy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hd();break;case 3:Ol(),wt(pn),wt(qr),Cy();break;case 5:Oy(n);break;case 4:Ol();break;case 13:wt(Ct);break;case 19:wt(Ct);break;case 10:jy(n.type._context);break;case 22:case 23:zy()}r=r.return}if(Sr=e,Jt=e=rs(e.current,null),Or=Sn=t,lr=0,Qu=null,Ly=Dp=so=0,fn=vu=null,zs!==null){for(t=0;t<zs.length;t++)if(r=zs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}zs=null}return e}function wT(e,t){do{var r=Jt;try{if(Ny(),Ed.current=Jd,Zd){for(var n=Ft.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Zd=!1}if(io=0,mr=ar=Ft=null,mu=!1,Ku=0,$y.current=null,r===null||r.return===null){lr=1,Qu=t,Jt=null;break}e:{var i=e,s=r.return,o=r,c=t;if(t=Or,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=L2(s);if(p!==null){p.flags&=-257,B2(p,s,o,i,t),p.mode&1&&$2(i,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){$2(i,u,t),Wy();break e}c=Error(xe(426))}}else if(kt&&o.mode&1){var y=L2(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),B2(y,s,o,i,t),_y(Cl(c,o));break e}}i=c=Cl(c,o),lr!==4&&(lr=2),vu===null?vu=[i]:vu.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=aT(i,c,t);P2(i,v);break e;case 1:o=c;var b=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(es===null||!es.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=iT(i,o,t);P2(i,_);break e}}i=i.return}while(i!==null)}kT(r)}catch(w){t=w,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function ST(){var e=eh.current;return eh.current=Jd,e===null?Jd:e}function Wy(){(lr===0||lr===3||lr===2)&&(lr=4),Sr===null||!(so&268435455)&&!(Dp&268435455)||zi(Sr,Or)}function nh(e,t){var r=qe;qe|=2;var n=ST();(Sr!==e||Or!==t)&&(ii=null,qs(e,t));do try{PF();break}catch(a){wT(e,a)}while(!0);if(Ny(),qe=r,eh.current=n,Jt!==null)throw Error(xe(261));return Sr=null,Or=0,lr}function PF(){for(;Jt!==null;)_T(Jt)}function MF(){for(;Jt!==null&&!aM();)_T(Jt)}function _T(e){var t=jT(e.alternate,e,Sn);e.memoizedProps=e.pendingProps,t===null?kT(e):Jt=t,$y.current=null}function kT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=jF(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lr=6,Jt=null;return}}else if(r=NF(r,t,Sn),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);lr===0&&(lr=5)}function Ds(e,t,r){var n=it,a=ta.transition;try{ta.transition=null,it=1,FF(e,t,r,n)}finally{ta.transition=a,it=n}return null}function FF(e,t,r,n){do vl();while(Vi!==null);if(qe&6)throw Error(xe(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(xe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(pM(e,i),e===Sr&&(Jt=Sr=null,Or=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||H0||(H0=!0,ET($d,function(){return vl(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ta.transition,ta.transition=null;var s=it;it=1;var o=qe;qe|=4,$y.current=null,TF(e,r),vT(r,e),eF(Hg),Bd=!!Wg,Hg=Wg=null,e.current=r,AF(r),iM(),qe=o,it=s,ta.transition=i}else e.current=r;if(H0&&(H0=!1,Vi=e,rh=a),i=e.pendingLanes,i===0&&(es=null),lM(r.stateNode),mn(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(th)throw th=!1,e=uv,uv=null,e;return rh&1&&e.tag!==0&&vl(),i=e.pendingLanes,i&1?e===fv?yu++:(yu=0,fv=e):yu=0,ds(),null}function vl(){if(Vi!==null){var e=aE(rh),t=ta.transition,r=it;try{if(ta.transition=null,it=16>e?16:e,Vi===null)var n=!1;else{if(e=Vi,Vi=null,rh=0,qe&6)throw Error(xe(331));var a=qe;for(qe|=4,Ne=e.current;Ne!==null;){var i=Ne,s=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Ne=u;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:gu(8,f,i)}var d=f.child;if(d!==null)d.return=f,Ne=d;else for(;Ne!==null;){f=Ne;var h=f.sibling,p=f.return;if(xT(f),f===u){Ne=null;break}if(h!==null){h.return=p,Ne=h;break}Ne=p}}}var m=i.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Ne=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ne=s;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:gu(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,Ne=v;break e}Ne=i.return}}var b=e.current;for(Ne=b;Ne!==null;){s=Ne;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,Ne=x;else e:for(s=b;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Fp(9,o)}}catch(w){Rt(o,o.return,w)}if(o===s){Ne=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Ne=_;break e}Ne=o.return}}if(qe=a,ds(),Va&&typeof Va.onPostCommitFiberRoot=="function")try{Va.onPostCommitFiberRoot(jp,e)}catch{}n=!0}return n}finally{it=r,ta.transition=t}}return!1}function J2(e,t,r){t=Cl(r,t),t=aT(e,t,1),e=Ji(e,t,1),t=an(),e!==null&&(Yf(e,1,t),mn(e,t))}function Rt(e,t,r){if(e.tag===3)J2(e,e,r);else for(;t!==null;){if(t.tag===3){J2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(es===null||!es.has(n))){e=Cl(r,e),e=iT(t,e,1),t=Ji(t,e,1),e=an(),t!==null&&(Yf(t,1,e),mn(t,e));break}}t=t.return}}function DF(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=an(),e.pingedLanes|=e.suspendedLanes&r,Sr===e&&(Or&r)===r&&(lr===4||lr===3&&(Or&130023424)===Or&&500>Ht()-By?qs(e,0):Ly|=r),mn(e,t)}function NT(e,t){t===0&&(e.mode&1?(t=F0,F0<<=1,!(F0&130023424)&&(F0=4194304)):t=1);var r=an();e=Si(e,t),e!==null&&(Yf(e,t,r),mn(e,r))}function IF(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),NT(e,r)}function RF(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(xe(314))}n!==null&&n.delete(t),NT(e,r)}var jT;jT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||pn.current)dn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return dn=!1,kF(e,t,r);dn=!!(e.flags&131072)}else dn=!1,kt&&t.flags&1048576&&OE(t,Xd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ad(e,t),e=t.pendingProps;var a=El(t,qr.current);gl(t,r),a=My(null,t,n,e,a,r);var i=Fy();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xn(n)?(i=!0,Vd(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ty(t),a.updater=Mp,t.stateNode=a,a._reactInternals=t,Jg(t,n,e,r),t=rv(null,t,n,!0,i,r)):(t.tag=0,kt&&i&&wy(t),Zr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ad(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=LF(n),e=ba(n,e),a){case 0:t=tv(null,t,n,e,r);break e;case 1:t=W2(null,t,n,e,r);break e;case 11:t=U2(null,t,n,e,r);break e;case 14:t=z2(null,t,n,ba(n.type,e),r);break e}throw Error(xe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ba(n,a),tv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ba(n,a),W2(e,t,n,a,r);case 3:e:{if(cT(t),e===null)throw Error(xe(387));n=t.pendingProps,i=t.memoizedState,a=i.element,IE(e,t),Yd(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Cl(Error(xe(423)),t),t=H2(e,t,n,r,a);break e}else if(n!==a){a=Cl(Error(xe(424)),t),t=H2(e,t,n,r,a);break e}else for(On=Zi(t.stateNode.containerInfo.firstChild),Pn=t,kt=!0,ka=null,r=FE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Tl(),n===a){t=_i(e,t,r);break e}Zr(e,t,n,r)}t=t.child}return t;case 5:return RE(t),e===null&&Yg(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,Vg(n,a)?s=null:i!==null&&Vg(n,i)&&(t.flags|=32),lT(e,t),Zr(e,t,s,r),t.child;case 6:return e===null&&Yg(t),null;case 13:return uT(e,t,r);case 4:return Ay(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Al(t,null,n,r):Zr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ba(n,a),U2(e,t,n,a,r);case 7:return Zr(e,t,t.pendingProps,r),t.child;case 8:return Zr(e,t,t.pendingProps.children,r),t.child;case 12:return Zr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,ht(Kd,n._currentValue),n._currentValue=s,i!==null)if(Ma(i.value,s)){if(i.children===a.children&&!pn.current){t=_i(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=pi(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Qg(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(xe(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Qg(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Zr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,gl(t,r),a=ia(a),n=n(a),t.flags|=1,Zr(e,t,n,r),t.child;case 14:return n=t.type,a=ba(n,t.pendingProps),a=ba(n.type,a),z2(e,t,n,a,r);case 15:return sT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ba(n,a),Ad(e,t),t.tag=1,xn(n)?(e=!0,Vd(t)):e=!1,gl(t,r),nT(t,n,a),Jg(t,n,a,r),rv(null,t,n,!0,e,r);case 19:return fT(e,t,r);case 22:return oT(e,t,r)}throw Error(xe(156,t.tag))};function ET(e,t){return eE(e,t)}function $F(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(e,t,r,n){return new $F(e,t,r,n)}function Hy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function LF(e){if(typeof e=="function")return Hy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===cy)return 11;if(e===uy)return 14}return 2}function rs(e,t){var r=e.alternate;return r===null?(r=Jn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Pd(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")Hy(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Yo:return Ys(r.children,a,i,t);case ly:s=8,a|=8;break;case _g:return e=Jn(12,r,t,a|2),e.elementType=_g,e.lanes=i,e;case kg:return e=Jn(13,r,t,a),e.elementType=kg,e.lanes=i,e;case Ng:return e=Jn(19,r,t,a),e.elementType=Ng,e.lanes=i,e;case R4:return Ip(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D4:s=10;break e;case I4:s=9;break e;case cy:s=11;break e;case uy:s=14;break e;case $i:s=16,n=null;break e}throw Error(xe(130,e==null?e:typeof e,""))}return t=Jn(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Ys(e,t,r,n){return e=Jn(7,e,n,t),e.lanes=r,e}function Ip(e,t,r,n){return e=Jn(22,e,n,t),e.elementType=R4,e.lanes=r,e.stateNode={isHidden:!1},e}function Em(e,t,r){return e=Jn(6,e,null,t),e.lanes=r,e}function Tm(e,t,r){return t=Jn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function BF(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lm(0),this.expirationTimes=lm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lm(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Vy(e,t,r,n,a,i,s,o,c){return e=new BF(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Jn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ty(i),e}function UF(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function TT(e){if(!e)return is;e=e._reactInternals;e:{if(So(e)!==e||e.tag!==1)throw Error(xe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(xe(171))}if(e.tag===1){var r=e.type;if(xn(r))return TE(e,r,t)}return t}function AT(e,t,r,n,a,i,s,o,c){return e=Vy(r,n,!0,e,a,i,s,o,c),e.context=TT(null),r=e.current,n=an(),a=ts(r),i=pi(n,a),i.callback=t??null,Ji(r,i,a),e.current.lanes=a,Yf(e,a,n),mn(e,n),e}function Rp(e,t,r,n){var a=t.current,i=an(),s=ts(a);return r=TT(r),t.context===null?t.context=r:t.pendingContext=r,t=pi(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ji(a,t,s),e!==null&&(Aa(e,a,s,i),jd(e,a,s)),s}function ah(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function eS(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Gy(e,t){eS(e,t),(e=e.alternate)&&eS(e,t)}function zF(){return null}var OT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xy(e){this._internalRoot=e}$p.prototype.render=Xy.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(xe(409));Rp(e,t,null,null)};$p.prototype.unmount=Xy.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;oo(function(){Rp(null,e,null,null)}),t[wi]=null}};function $p(e){this._internalRoot=e}$p.prototype.unstable_scheduleHydration=function(e){if(e){var t=oE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ui.length&&t!==0&&t<Ui[r].priority;r++);Ui.splice(r,0,e),r===0&&cE(e)}};function Ky(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Lp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function tS(){}function WF(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=ah(s);i.call(u)}}var s=AT(t,n,e,0,null,!1,!1,"",tS);return e._reactRootContainer=s,e[wi]=s.current,Wu(e.nodeType===8?e.parentNode:e),oo(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=ah(c);o.call(u)}}var c=Vy(e,0,!1,null,null,!1,!1,"",tS);return e._reactRootContainer=c,e[wi]=c.current,Wu(e.nodeType===8?e.parentNode:e),oo(function(){Rp(t,c,r,n)}),c}function Bp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var c=ah(s);o.call(c)}}Rp(t,s,e,a)}else s=WF(r,t,e,a,n);return ah(s)}iE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=iu(t.pendingLanes);r!==0&&(hy(t,r|1),mn(t,Ht()),!(qe&6)&&(Pl=Ht()+500,ds()))}break;case 13:oo(function(){var n=Si(e,1);if(n!==null){var a=an();Aa(n,e,1,a)}}),Gy(e,1)}};py=function(e){if(e.tag===13){var t=Si(e,134217728);if(t!==null){var r=an();Aa(t,e,134217728,r)}Gy(e,134217728)}};sE=function(e){if(e.tag===13){var t=ts(e),r=Si(e,t);if(r!==null){var n=an();Aa(r,e,t,n)}Gy(e,t)}};oE=function(){return it};lE=function(e,t){var r=it;try{return it=e,t()}finally{it=r}};Dg=function(e,t,r){switch(t){case"input":if(Tg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Op(n);if(!a)throw Error(xe(90));L4(n),Tg(n,a)}}}break;case"textarea":U4(e,r);break;case"select":t=r.value,t!=null&&hl(e,!!r.multiple,t,!1)}};K4=Uy;q4=oo;var HF={usingClientEntryPoint:!1,Events:[Zf,el,Op,G4,X4,Uy]},Uc={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},VF={bundleType:Uc.bundleType,version:Uc.version,rendererPackageName:Uc.rendererPackageName,rendererConfig:Uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ti.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Z4(e),e===null?null:e.stateNode},findFiberByHostInstance:Uc.findFiberByHostInstance||zF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var V0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!V0.isDisabled&&V0.supportsFiber)try{jp=V0.inject(VF),Va=V0}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HF;Ln.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ky(t))throw Error(xe(200));return UF(e,t,null,r)};Ln.createRoot=function(e,t){if(!Ky(e))throw Error(xe(299));var r=!1,n="",a=OT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Vy(e,1,!1,null,null,r,!1,n,a),e[wi]=t.current,Wu(e.nodeType===8?e.parentNode:e),new Xy(t)};Ln.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(xe(188)):(e=Object.keys(e).join(","),Error(xe(268,e)));return e=Z4(t),e=e===null?null:e.stateNode,e};Ln.flushSync=function(e){return oo(e)};Ln.hydrate=function(e,t,r){if(!Lp(t))throw Error(xe(200));return Bp(null,e,t,!0,r)};Ln.hydrateRoot=function(e,t,r){if(!Ky(e))throw Error(xe(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=OT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=AT(t,null,e,1,r??null,a,!1,i,s),e[wi]=t.current,Wu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new $p(t)};Ln.render=function(e,t,r){if(!Lp(t))throw Error(xe(200));return Bp(null,e,t,!1,r)};Ln.unmountComponentAtNode=function(e){if(!Lp(e))throw Error(xe(40));return e._reactRootContainer?(oo(function(){Bp(null,null,e,!1,function(){e._reactRootContainer=null,e[wi]=null})}),!0):!1};Ln.unstable_batchedUpdates=Uy;Ln.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Lp(r))throw Error(xe(200));if(e==null||e._reactInternals===void 0)throw Error(xe(38));return Bp(e,t,r,!1,n)};Ln.version="18.3.1-next-f1338f8080-20240426";function CT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CT)}catch(e){console.error(e)}}CT(),C4.exports=Ln;var GF=C4.exports,rS=GF;Fd.createRoot=rS.createRoot,Fd.hydrateRoot=rS.hydrateRoot;/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),KF=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),nS=e=>{const t=KF(e);return t.charAt(0).toUpperCase()+t.slice(1)},PT=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),qF=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var YF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=H.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...o},c)=>H.createElement("svg",{ref:c,...YF,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:PT("lucide",a),...!i&&!qF(o)&&{"aria-hidden":"true"},...o},[...s.map(([u,f])=>H.createElement(u,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=(e,t)=>{const r=H.forwardRef(({className:n,...a},i)=>H.createElement(QF,{ref:i,iconNode:t,className:PT(`lucide-${XF(nS(e))}`,`lucide-${e}`,n),...a}));return r.displayName=nS(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],uc=Ee("activity",ZF);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Up=Ee("arrow-down",JF);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],MT=Ee("arrow-left",e8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Fa=Ee("arrow-right-left",t8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],zp=Ee("arrow-right",r8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],hs=Ee("briefcase",n8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],ih=Ee("building",a8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ps=Ee("calculator",i8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],o8=Ee("chart-column",s8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],fc=Ee("chart-no-axes-column",l8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],dc=Ee("chart-pie",c8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Cn=Ee("check",u8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Xr=Ee("chevron-down",f8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Pr=Ee("chevron-right",d8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],FT=Ee("circle-alert",h8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fa=Ee("circle-check-big",p8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],DT=Ee("circle-question-mark",x8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Wp=Ee("coffee",m8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],Hp=Ee("columns-2",g8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Vp=Ee("copy",v8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y8=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],b8=Ee("database",y8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ra=Ee("download",w8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Gp=Ee("ellipsis",S8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]],k8=Ee("file-image",_8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],qy=Ee("file-spreadsheet",N8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],hc=Ee("file-text",j8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pv=Ee("funnel",E8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],IT=Ee("gauge",T8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],xs=Ee("git-commit-horizontal",A8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],e0=Ee("globe",O8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],RT=Ee("grid-3x3",C8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]],$T=Ee("hexagon",P8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Xp=Ee("house",M8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],D8=Ee("image",F8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],t0=Ee("info",I8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Mr=Ee("layers",R8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],LT=Ee("layout-grid",$8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],BT=Ee("lightbulb",L8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],UT=Ee("list",B8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],zT=Ee("map-pin",U8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Yy=Ee("maximize-2",z8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Kp=Ee("maximize",W8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],WT=Ee("menu",H8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],HT=Ee("minimize-2",V8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],VT=Ee("monitor",G8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],sh=Ee("network",X8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],qp=Ee("palette",K8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Rn=Ee("panels-top-left",q8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],GT=Ee("pen",Y8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Za=Ee("plus",Q8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]],J8=Ee("presentation",Z8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],XT=Ee("rotate-ccw",eD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]],KT=Ee("scaling",tD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],qT=Ee("search",rD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],r0=Ee("settings",nD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Yp=Ee("settings-2",aD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ms=Ee("shield-check",iD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Qp=Ee("table",sD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],YT=Ee("text-align-start",oD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],gs=Ee("trash-2",lD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],QT=Ee("trending-up",cD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ur=Ee("triangle-alert",uD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ZT=Ee("upload",fD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],JT=Ee("user",dD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Fr=Ee("users",hD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],on=Ee("x",pD),xD=["Technology","Finance","Professional Services","Legal","Real Estate","Retail/FMCG","Media & Creative","Healthcare","Education","Manufacturing","Logistics","Public Sector","Other (Custom)"],mD=["Global HQ","Regional HQ","Corporate Office","Client-facing Office","R&D / Innovation Hub","Trading Floor","Back Office","Flex / Hybrid Workplace","Other (Custom)"],Nt={primary:"#F97316",program:["#64748B","#F97316","#8B5CF6","#0EA5E9","#94A3B8","#F43F5E"],departments:["#3B82F6","#8B5CF6","#EC4899","#F43F5E","#F97316","#EAB308","#84CC16","#10B981","#06B6D4","#6366F1"]},gD={deskOpen:4.5,deskAlt:3,deskEnclosed:12,meetingAvg:18,phoneBooth:1.5},vD={deskOpen:48,deskAlt:32,deskEnclosed:130,meetingAvg:195,phoneBooth:16},_o=e=>e==="sqm"?gD:vD,Ho={small:25,medium:60,large:150,board:300,townhall:1e3},yD=[{id:"sup-1",name:"Tea Point / Pantry",category:"pantry",logic:"ratio",value:50,areaPerUnit:15},{id:"sup-2",name:"Open Collaboration",category:"collab",logic:"pct_nia",value:15},{id:"sup-3",name:"Storage",category:"storage",logic:"pct_nia",value:2},{id:"sup-4",name:"IT / Server Room",category:"server",logic:"fixed_area",value:10},{id:"sup-5",name:"Wellness / Mothers",category:"wellness",logic:"fixed_count",value:1,areaPerUnit:10},{id:"sup-6",name:"Print / Utilities",category:"utilities",logic:"ratio",value:75,areaPerUnit:4}],n0=e=>[{id:"pg-work",name:"Workstations",color:Nt.program[0],items:["work_open","work_alt","work_enclosed"]},{id:"pg-collab",name:"Collaboration",color:Nt.program[1],items:["sup-2"]},{id:"pg-meet",name:"Meeting Rooms",color:Nt.program[2],items:["meet","phone"]},{id:"pg-supp",name:"Support",color:Nt.program[3],items:["sup-1","sup-3","sup-4","sup-5","sup-6"]},{id:"pg-circ",name:"Circulation",color:Nt.program[4],items:["circ"]}],bD={projectName:"New Strategic Hub",location:"Singapore",industry:"Technology",projectType:"Regional HQ",areaInput:2500,areaDefinition:"NIA",targetEfficiency:80,calculatedNia:2500,unit:"sqm",headcount:300,floors:[{id:"f1",name:"Floor 1",headcount:300}],departments:[{id:"d1",name:"Sales",headcount:80,futureHeadcount:90,occupancy:80,color:Nt.departments[0],collaborators:[{deptId:"d2",strength:80}]},{id:"d2",name:"Marketing",headcount:40,futureHeadcount:45,occupancy:70,color:Nt.departments[1],collaborators:[{deptId:"d1",strength:80},{deptId:"d4",strength:50}]},{id:"d3",name:"Engineering",headcount:120,futureHeadcount:140,occupancy:60,color:Nt.departments[2],collaborators:[{deptId:"d4",strength:80}]},{id:"d4",name:"Product",headcount:30,futureHeadcount:35,occupancy:90,color:Nt.departments[3],collaborators:[{deptId:"d3",strength:80},{deptId:"d2",strength:50}]},{id:"d5",name:"G&A",headcount:30,futureHeadcount:30,occupancy:95,color:Nt.departments[4],collaborators:[]}],programStructure:n0()},aS={id:"default",name:"Base Case",workpoints:{fixed:240,alternative:60},circulationPct:25,growthBuffer:5,enclosedOfficeCount:10,meetingRatios:{...Ho},phoneBoothRatio:15,supportSpaces:[...yD]},wD=(e,t)=>{let r={};switch(e){case"Legal":r={enclosedOfficeCount:50};break;case"Technology":r={enclosedOfficeCount:5};break}return r},eA=({project:e,onChange:t,onClose:r})=>{var c;const[n,a]=H.useState("program"),i=(u,f)=>{var h;const d=((h=e.programStructure)==null?void 0:h.map(p=>p.id===u?{...p,color:f}:p))||[];t({...e,programStructure:d})},s=(u,f)=>{const d=e.departments.map(h=>h.id===u?{...h,color:f}:h);t({...e,departments:d})},o=()=>{var u;if(n==="program"){const f=((u=e.programStructure)==null?void 0:u.map((d,h)=>({...d,color:Nt.program[h%Nt.program.length]})))||[];t({...e,programStructure:f})}else{const f=e.departments.map((d,h)=>({...d,color:Nt.departments[h%Nt.departments.length]}));t({...e,departments:f})}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[85vh]",children:[l.jsxs("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-white sticky top-0 z-10",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-base font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(qp,{className:"w-4 h-4 text-orange-500"}),"Visualization Settings"]}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Customize diagram color mapping for exports."})]}),l.jsx("button",{onClick:r,className:"p-2 text-slate-400 hover:text-slate-700 hover:bg-slate-100 rounded-full transition",children:l.jsx(on,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex border-b border-slate-100 px-5 pt-2 bg-slate-50/50",children:[l.jsxs("button",{onClick:()=>a("program"),className:`pb-3 px-4 text-xs font-bold border-b-2 transition-colors flex items-center gap-2 ${n==="program"?"border-orange-500 text-orange-600":"border-transparent text-slate-400 hover:text-slate-600"}`,children:[l.jsx(Mr,{className:"w-3 h-3"})," Program Structure"]}),l.jsxs("button",{onClick:()=>a("depts"),className:`pb-3 px-4 text-xs font-bold border-b-2 transition-colors flex items-center gap-2 ${n==="depts"?"border-orange-500 text-orange-600":"border-transparent text-slate-400 hover:text-slate-600"}`,children:[l.jsx(Fr,{className:"w-3 h-3"})," Departments"]})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-white",children:[l.jsx("div",{className:"flex justify-end mb-4",children:l.jsxs("button",{onClick:o,className:"text-[10px] font-bold text-slate-400 hover:text-orange-600 flex items-center gap-1 transition-colors",children:[l.jsx(XT,{className:"w-3 h-3"})," Reset to M Moser Standard"]})}),l.jsx("div",{className:"space-y-2",children:n==="program"?(c=e.programStructure)==null?void 0:c.map(u=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg hover:border-orange-200 transition-colors",children:[l.jsx("span",{className:"font-bold text-xs text-slate-700",children:u.name}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-[10px] font-mono text-slate-400 uppercase",children:u.color}),l.jsx("div",{className:"relative overflow-hidden w-8 h-8 rounded-full border border-slate-200 shadow-sm",children:l.jsx("input",{type:"color",value:u.color,onChange:f=>i(u.id,f.target.value),className:"absolute -top-2 -left-2 w-16 h-16 cursor-pointer"})})]})]},u.id)):e.departments.map(u=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg hover:border-orange-200 transition-colors",children:[l.jsx("span",{className:"font-bold text-xs text-slate-700",children:u.name}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-[10px] font-mono text-slate-400 uppercase",children:u.color}),l.jsx("div",{className:"relative overflow-hidden w-8 h-8 rounded-full border border-slate-200 shadow-sm",children:l.jsx("input",{type:"color",value:u.color,onChange:f=>s(u.id,f.target.value),className:"absolute -top-2 -left-2 w-16 h-16 cursor-pointer"})})]})]},u.id))})]}),l.jsx("div",{className:"p-5 border-t border-slate-100 bg-slate-50 flex justify-end",children:l.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-2 bg-orange-600 hover:bg-orange-700 text-white font-bold rounded-lg shadow-sm transition-all text-xs",children:[l.jsx(Cn,{className:"w-3 h-3"})," Apply Settings"]})})]})})},SD=["Technology","Finance","Professional Services","Legal","Real Estate","Retail/FMCG","Media & Creative","Healthcare","Education","Manufacturing","Logistics","Public Sector","Other (Custom)"],_D=["Global HQ","Regional HQ","Corporate Office","Client-facing Office","R&D / Innovation Hub","Trading Floor","Back Office","Flex / Hybrid Workplace","Other (Custom)"],vr={primary:"#F97316",program:["#64748B","#F97316","#8B5CF6","#0EA5E9","#94A3B8","#F43F5E"],departments:["#3B82F6","#8B5CF6","#EC4899","#F43F5E","#F97316","#EAB308","#84CC16","#10B981","#06B6D4","#6366F1"]},kD={deskOpen:4.5,deskAlt:3,deskEnclosed:12,meetingAvg:18,phoneBooth:1.5},ND={deskOpen:48,deskAlt:32,deskEnclosed:130,meetingAvg:195,phoneBooth:16},a0=e=>e==="sqm"?kD:ND,Vo={small:25,medium:60,large:150,board:300,townhall:1e3},jD=[{id:"sup-1",name:"Tea Point / Pantry",category:"pantry",logic:"ratio",value:50,areaPerUnit:15},{id:"sup-2",name:"Open Collaboration",category:"collab",logic:"pct_nia",value:15},{id:"sup-3",name:"Storage",category:"storage",logic:"pct_nia",value:2},{id:"sup-4",name:"IT / Server Room",category:"server",logic:"fixed_area",value:10},{id:"sup-5",name:"Wellness / Mothers",category:"wellness",logic:"fixed_count",value:1,areaPerUnit:10},{id:"sup-6",name:"Print / Utilities",category:"utilities",logic:"ratio",value:75,areaPerUnit:4}],i0=e=>[{id:"pg-work",name:"Workstations",color:vr.program[0],items:["work_open","work_alt","work_enclosed"]},{id:"pg-collab",name:"Collaboration",color:vr.program[1],items:["sup-2"]},{id:"pg-meet",name:"Meeting Rooms",color:vr.program[2],items:["meet","phone"]},{id:"pg-supp",name:"Support",color:vr.program[3],items:["sup-1","sup-3","sup-4","sup-5","sup-6"]},{id:"pg-circ",name:"Circulation",color:vr.program[4],items:["circ"]}],ED={projectName:"New Strategic Hub",location:"Singapore",industry:"Technology",projectType:"Regional HQ",areaInput:2500,areaDefinition:"NIA",targetEfficiency:80,calculatedNia:2500,unit:"sqm",headcount:300,floors:[{id:"f1",name:"Floor 1",headcount:300}],departments:[{id:"d1",name:"Sales",headcount:80,futureHeadcount:90,occupancy:80,color:vr.departments[0],collaborators:[{deptId:"d2",strength:80}]},{id:"d2",name:"Marketing",headcount:40,futureHeadcount:45,occupancy:70,color:vr.departments[1],collaborators:[{deptId:"d1",strength:80},{deptId:"d4",strength:50}]},{id:"d3",name:"Engineering",headcount:120,futureHeadcount:140,occupancy:60,color:vr.departments[2],collaborators:[{deptId:"d4",strength:80}]},{id:"d4",name:"Product",headcount:30,futureHeadcount:35,occupancy:90,color:vr.departments[3],collaborators:[{deptId:"d3",strength:80},{deptId:"d2",strength:50}]},{id:"d5",name:"G&A",headcount:30,futureHeadcount:30,occupancy:95,color:vr.departments[4],collaborators:[]}],programStructure:i0()},iS={id:"default",name:"Base Case",workpoints:{fixed:240,alternative:60},circulationPct:25,growthBuffer:5,enclosedOfficeCount:10,meetingRatios:{...Vo},phoneBoothRatio:15,supportSpaces:[...jD]},TD=(e,t)=>{let r={};switch(e){case"Legal":r={enclosedOfficeCount:50};break;case"Technology":r={enclosedOfficeCount:5};break}return r},G0=({number:e,title:t,icon:r})=>l.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-slate-100",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold font-mono",children:e}),l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(r,{className:"w-4 h-4 text-orange-500"}),t]})]}),AD=({data:e,onChange:t})=>{const[r,n]=H.useState(!1),[a,i]=H.useState(!1);H.useEffect(()=>{let h=e.areaInput;e.areaDefinition==="Gross"&&(h=e.areaInput*(e.targetEfficiency/100)),h!==e.calculatedNia&&t({...e,calculatedNia:h})},[e.areaInput,e.areaDefinition,e.targetEfficiency,e.calculatedNia]);const s=(h,p)=>{let m={...e,[h]:p};if(h==="projectType"){const g=i0();m={...m,programStructure:g}}t(m)},o=h=>{t({...e,unit:h})},c=h=>{const p=[...e.floors];if(h>p.length)for(let m=p.length;m<h;m++)p.push({id:`f${m+1}`,name:`Floor ${m+1}`,headcount:0});else h<p.length&&(p.length=h);t({...e,floors:p})},u=(h,p)=>{const m=[...e.floors];m[h].headcount=p,t({...e,floors:m})},f=e.floors.reduce((h,p)=>h+p.headcount,0),d=f!==e.headcount;return l.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto",children:[l.jsxs("div",{className:"mb-10",children:[l.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(ih,{className:"w-6 h-6 text-orange-500"}),"Project Information"]}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Defining the strategic context and constraints for the portfolio analysis."})]}),l.jsxs("div",{className:"space-y-12",children:[l.jsxs("section",{children:[l.jsx(G0,{number:"1",title:"Strategic Context",icon:hs}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"col-span-1 md:col-span-2",children:[l.jsxs("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2",children:["Project Name ",l.jsx("span",{className:"text-rose-500",children:"*"})]}),l.jsxs("div",{className:"flex items-center bg-slate-50 px-4 py-3 rounded-lg border border-slate-200 focus-within:border-orange-400 transition-all",children:[l.jsx(hc,{className:"w-5 h-5 text-slate-400 mr-3"}),l.jsx("input",{type:"text",className:"bg-transparent w-full text-lg font-bold text-slate-800 focus:outline-none placeholder-slate-300",value:e.projectName||"",onChange:h=>s("projectName",h.target.value),placeholder:"e.g. Project Zenith - Global HQ"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Industry Sector"}),l.jsxs("div",{className:"relative group",children:[l.jsx(e0,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.industry,onChange:h=>s("industry",h.target.value),children:SD.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Location"}),l.jsxs("div",{className:"relative group",children:[l.jsx(zT,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"text",className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.location,onChange:h=>s("location",h.target.value),placeholder:"City, Country"})]})]})]})]}),l.jsxs("section",{children:[l.jsx(G0,{number:"2",title:"Scale & Typology",icon:KT}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Project Typology"}),l.jsxs("div",{className:"relative group",children:[l.jsx(ih,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.projectType,onChange:h=>s("projectType",h.target.value),children:_D.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Total Base Headcount"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"number",min:"1",className:"w-full bg-slate-50 border border-slate-200 text-sm font-bold text-slate-800 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.headcount,onChange:h=>s("headcount",parseInt(h.target.value)||0)})]})]})]})]}),l.jsxs("section",{children:[l.jsx(G0,{number:"3",title:"Physical Constraints",icon:Mr}),l.jsxs("div",{className:"flex flex-wrap items-end gap-6 bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6",children:[l.jsxs("div",{className:"flex-grow min-w-[240px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Input Area"}),l.jsxs("div",{className:"flex items-center gap-6 mb-3",children:[l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="NIA",onChange:()=>t({...e,areaDefinition:"NIA",targetEfficiency:100})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"NIA (Net Internal)"})]}),l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="Gross",onChange:()=>t({...e,areaDefinition:"Gross",targetEfficiency:80})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"Gross Area"})]})]}),l.jsxs("div",{className:"relative group max-w-xs",children:[l.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 text-lg font-bold text-slate-800 pl-4 pr-12 py-2 rounded-lg focus:outline-none focus:border-orange-400 shadow-sm",value:e.areaInput,onChange:h=>s("areaInput",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-4 top-3 text-xs font-bold text-slate-400 uppercase",children:e.unit})]})]}),e.areaDefinition==="Gross"&&l.jsxs("div",{className:"w-40 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Efficiency"}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:"number",min:"50",max:"100",className:"w-full bg-white border border-slate-300 text-lg font-medium text-slate-700 px-3 py-2 rounded-lg focus:outline-none focus:border-orange-400 text-right pr-8 shadow-sm",value:e.targetEfficiency,onChange:h=>s("targetEfficiency",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-3 top-3 text-sm text-slate-400 font-bold",children:"%"})]})]}),l.jsx("div",{className:"flex items-center pb-4 text-slate-300",children:l.jsx(Fa,{className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-grow min-w-[200px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Effective NIA (Usable)"}),l.jsxs("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("span",{className:"text-xl font-bold text-slate-800 w-full font-mono",children:Math.round(e.calculatedNia).toLocaleString()}),l.jsx("span",{className:"text-xs text-slate-400 font-bold ml-2 uppercase",children:e.unit})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Number of Floors"}),l.jsx("input",{type:"number",min:"1",max:"50",className:"w-24 bg-white border border-slate-200 text-sm font-medium text-slate-700 px-3 py-1.5 rounded-lg focus:outline-none focus:border-orange-400 text-right",value:e.floors.length,onChange:h=>c(parseInt(h.target.value)||1)})]}),l.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-bold text-slate-600 uppercase hover:text-orange-600 transition-colors group",children:[r?l.jsx(Xr,{className:"w-4 h-4 text-orange-500"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400 group-hover:text-orange-500"}),"Floor-by-Floor Allocation ",r?"":"(Optional)"]}),r&&l.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200 animate-in fade-in slide-in-from-top-2",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:e.floors.map((h,p)=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm focus-within:border-orange-400 transition-colors",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wide",children:h.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Fr,{className:"w-3 h-3 text-slate-300"}),l.jsx("input",{type:"number",className:"w-full text-sm font-bold text-slate-700 focus:outline-none",value:h.headcount,onChange:m=>u(p,parseInt(m.target.value)||0)})]})]},h.id))}),d&&l.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs font-medium text-amber-700 bg-amber-50 p-3 rounded-lg border border-amber-100",children:[l.jsx(ur,{className:"w-4 h-4 text-amber-500"}),l.jsxs("span",{children:["Warning: Floor headcount sum (",f,") does not match Total Headcount (",e.headcount,"). Stacking calculations generally prioritize floor data."]})]})]})]})]}),l.jsxs("section",{children:[l.jsx(G0,{number:"4",title:"System Preferences",icon:Yp}),l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-100",children:[l.jsx("div",{className:"flex items-center gap-6",children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Unit System"}),l.jsxs("div",{className:"flex bg-white p-1 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("button",{onClick:()=>o("sqm"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqm"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQM"}),l.jsx("button",{onClick:()=>o("sqft"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqft"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQFT"})]})]})}),l.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2.5 text-sm font-bold text-slate-700 bg-white border border-slate-300 rounded-lg hover:border-orange-400 hover:text-orange-600 transition-all shadow-sm",children:[l.jsx(qp,{className:"w-4 h-4"})," Customize Visualization"]})]})]})]}),a&&l.jsx(eA,{project:e,onChange:t,onClose:()=>i(!1)})]})},sS=({title:e,icon:t,isOpen:r,toggle:n})=>l.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-3 bg-white border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(t,{className:"w-4 h-4 text-indigo-600"}),l.jsx("span",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:e})]}),r?l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400"})]}),Go=({label:e,value:t,unit:r,min:n,max:a,onChange:i,disabled:s,step:o=1,note:c})=>l.jsxs("div",{className:`mb-3 ${s?"opacity-60 grayscale":""}`,children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:e}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",min:n,max:a,step:o,value:t,disabled:s,onChange:u=>i(parseFloat(u.target.value)||0),className:"w-full p-2 text-sm border border-slate-200 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none bg-white font-medium"}),r&&l.jsx("div",{className:"px-3 py-2 bg-slate-100 border border-l-0 border-slate-200 rounded-r-md text-xs font-bold text-slate-500 whitespace-nowrap",children:r})]}),c&&l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:c})]}),OD=({pct:e,baseHc:t,onChange:r,disabled:n})=>{const[a,i]=H.useState("%"),s=Math.round(t*(e/100)),o=c=>{if(t>0){const u=c/t*100;r(parseFloat(u.toFixed(1)))}};return l.jsxs("div",{className:`mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100 ${n?"opacity-60 grayscale":""}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide",children:"Growth Buffer"}),l.jsxs("div",{className:"flex bg-white rounded border border-indigo-200 p-0.5",children:[l.jsx("button",{onClick:()=>i("%"),className:`text-[10px] px-2 py-0.5 rounded ${a==="%"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"%"}),l.jsx("button",{onClick:()=>i("Abs"),className:`text-[10px] px-2 py-0.5 rounded ${a==="Abs"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"HC"})]})]}),a==="%"?l.jsx(Go,{label:"",value:e,unit:"% add-on",min:0,max:100,step:1,onChange:r,disabled:n}):l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",className:"w-full p-2 text-sm border border-indigo-200 rounded-l-md focus:outline-none focus:ring-1 focus:ring-indigo-500",value:s,onChange:c=>o(parseInt(c.target.value)||0),disabled:n}),l.jsx("div",{className:"px-3 py-2 bg-white border border-l-0 border-indigo-200 rounded-r-md text-xs font-bold text-indigo-500 whitespace-nowrap",children:"People"})]}),l.jsxs("div",{className:"text-[10px] text-indigo-400 mt-1 flex justify-between",children:[l.jsx("span",{children:"Reserve capacity"}),l.jsx("span",{children:a==="%"?`+${s} people`:`+${e}% add-on`})]})]})},CD=({ratios:e,onChange:t,disabled:r})=>{const n=(s,o)=>{t({...e,[s]:o})},a=(s,o)=>{if(s===0)return{label:"None",color:"bg-slate-100 text-slate-400"};const c=(s-o)/o;return c>.1?{label:"Conservative",color:"bg-orange-100 text-orange-700"}:c<-.1?{label:"Generous",color:"bg-emerald-100 text-emerald-700"}:{label:"Typical",color:"bg-blue-100 text-blue-700"}},i=({type:s,label:o,val:c,bench:u})=>{const f=a(c,u);return l.jsxs("tr",{className:"border-b border-slate-50 last:border-0 hover:bg-slate-50 group",children:[l.jsxs("td",{className:"py-2 pl-2 text-xs font-medium text-slate-700 flex items-center gap-1",children:[o,l.jsxs("div",{className:"group relative",children:[l.jsx(DT,{className:"w-3 h-3 text-slate-300 cursor-help"}),l.jsxs("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 w-32 bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 pointer-events-none z-50 whitespace-normal",children:["Benchmark: 1 per ",u," ppl"]})]})]}),l.jsx("td",{className:"py-2 px-1",children:l.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border border-slate-200 rounded focus:ring-1 focus:ring-indigo-500 font-medium",value:c,onChange:d=>n(s,parseInt(d.target.value)||0),disabled:r})}),l.jsx("td",{className:"py-2 pr-2 text-right",children:l.jsx("span",{className:`text-[9px] uppercase font-bold px-1.5 py-0.5 rounded ${f.color}`,children:f.label})})]})};return l.jsxs("div",{className:"mb-4 bg-white border border-slate-200 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"bg-slate-50 px-3 py-2 border-b border-slate-200 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Meeting Strategy"}),l.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"People per Room"})]}),l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 text-[10px] text-slate-400 uppercase font-semibold text-left",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pl-2 py-1 font-normal w-1/3",children:"Room Type"}),l.jsx("th",{className:"py-1 text-right font-normal pr-2",children:"Input"}),l.jsx("th",{className:"pr-2 py-1 text-right font-normal",children:"Status"})]})}),l.jsxs("tbody",{children:[l.jsx(i,{type:"small",label:"Small (4p)",val:e.small,bench:Vo.small}),l.jsx(i,{type:"medium",label:"Medium (8p)",val:e.medium,bench:Vo.medium}),l.jsx(i,{type:"large",label:"Large (14p)",val:e.large,bench:Vo.large}),l.jsx(i,{type:"board",label:"Board (20p)",val:e.board,bench:Vo.board}),l.jsx(i,{type:"townhall",label:"Townhall",val:e.townhall,bench:Vo.townhall})]})]})]})},PD=({spaces:e,onChange:t})=>{const r=()=>{t([...e,{id:`sup-${Date.now()}`,name:"New Amenity",category:"other",logic:"pct_nia",value:1}])},n=(i,s,o)=>{t(e.map(c=>c.id===i?{...c,[s]:o}:c))},a=i=>{t(e.filter(s=>s.id!==i))};return l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-600 uppercase flex items-center gap-1",children:[l.jsx(Wp,{className:"w-3 h-3"})," Support & Amenity"]}),l.jsxs("button",{onClick:r,className:"text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[l.jsx(Za,{className:"w-3 h-3"})," Add"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(i=>l.jsxs("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 text-xs hover:border-indigo-200 transition-colors",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 gap-2",children:[l.jsx("input",{className:"bg-transparent font-bold text-slate-700 w-full focus:outline-none border-b border-transparent focus:border-indigo-200 text-xs",value:i.name,onChange:s=>n(i.id,"name",s.target.value),placeholder:"Space Name"}),l.jsx("button",{onClick:()=>a(i.id),className:"text-slate-400 hover:text-rose-500",children:l.jsx(gs,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("select",{className:"w-full p-1 border rounded bg-white text-[10px]",value:i.logic,onChange:s=>n(i.id,"logic",s.target.value),children:[l.jsx("option",{value:"ratio",children:"Ratio (1:X)"}),l.jsx("option",{value:"pct_nia",children:"% of NIA"}),l.jsx("option",{value:"fixed_area",children:"Fixed Area"}),l.jsx("option",{value:"fixed_count",children:"Fixed Count"}),l.jsx("option",{value:"area_per_person",children:"Area / Person"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right",value:i.value,onChange:s=>n(i.id,"value",parseFloat(s.target.value))}),l.jsx("span",{className:"text-[9px] text-slate-400 w-8 text-right",children:i.logic==="pct_nia"?"%":i.logic==="ratio"?"ppl":"val"})]})]}),(i.logic==="ratio"||i.logic==="fixed_count")&&l.jsxs("div",{className:"mt-2 flex items-center justify-between pt-1 border-t border-slate-200",children:[l.jsx("span",{className:"text-[9px] text-slate-400",children:"Size per room:"}),l.jsx("div",{className:"flex items-center gap-1 w-20",children:l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right text-[10px]",value:i.areaPerUnit||0,onChange:s=>n(i.id,"areaPerUnit",parseFloat(s.target.value))})})]})]},i.id))})]})},MD=({strategy:e,onChange:t,title:r="Active Strategy",isReadOnly:n=!1,baseHeadcount:a=100})=>{var g,y;const[i,s]=H.useState({planning:!0,workplace:!0}),o=Math.ceil(a*(1+e.growthBuffer/100)),c=((g=e.workpoints)==null?void 0:g.fixed)||0,u=((y=e.workpoints)==null?void 0:y.alternative)||0,f=c+u,d=f-o,h=(v,b)=>{n||t({...e,[v]:b})},p=(v,b)=>{n||t({...e,workpoints:{...e.workpoints,[v]:Math.max(0,b)}})},m=v=>s(b=>({...b,[v]:!b[v]}));return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Yp,{className:"w-4 h-4 text-indigo-600"}),"Strategy Inputs"]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate font-medium",children:r})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx(sS,{title:"Planning Factors",icon:LT,isOpen:i.planning,toggle:()=>m("planning")}),i.planning&&l.jsxs("div",{className:"p-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(OD,{pct:e.growthBuffer,baseHc:a,onChange:v=>h("growthBuffer",v),disabled:n}),l.jsx(Go,{label:"Circulation",value:e.circulationPct,unit:"% add-on",min:10,max:60,onChange:v=>h("circulationPct",v),disabled:n})]}),l.jsx(sS,{title:"Workplace Strategy",icon:hs,isOpen:i.workplace,toggle:()=>m("workplace")}),i.workplace&&l.jsxs("div",{className:"p-4 space-y-6 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(Go,{label:"Enclosed Offices",value:e.enclosedOfficeCount,unit:"people",min:0,onChange:v=>h("enclosedOfficeCount",v),disabled:n,note:"Included within Fixed Workstations count"}),l.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:"Workpoints Target"})}),l.jsx(Go,{label:"Fixed Workstations",value:c,unit:"seats",min:0,onChange:v=>p("fixed",v),disabled:n,note:"Total assigned desks (includes Enclosed Offices)"}),l.jsx(Go,{label:"Alternative Workpoints",value:u,unit:"points",min:0,onChange:v=>p("alternative",v),disabled:n,note:"Agile, flex, or touchdown points"}),l.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-3 text-xs space-y-2 shadow-sm mb-3 mt-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 border-b border-indigo-200 pb-1.5 mb-1",children:[l.jsx(ps,{className:"w-3 h-3 text-indigo-500"}),l.jsx("span",{className:"font-bold text-indigo-800",children:"Supply vs Demand"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Headcount:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:o})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Workpoints:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:f})]}),l.jsxs("div",{className:`flex justify-between font-bold pt-1 border-t border-indigo-100 ${d<0?"text-amber-600":d>0?"text-blue-600":"text-emerald-600"}`,children:[l.jsxs("span",{className:"flex items-center gap-1",children:[d<0?l.jsx(ur,{className:"w-3 h-3"}):l.jsx(fa,{className:"w-3 h-3"})," Status:"]}),l.jsx("span",{children:d===0?"Matched":d>0?`Over by ${d}`:`Under by ${Math.abs(d)}`})]})]})]}),l.jsx(CD,{ratios:e.meetingRatios,onChange:v=>h("meetingRatios",v),disabled:n}),l.jsx(Go,{label:"Phone Booth Ratio",value:e.phoneBoothRatio,unit:"ppl : 1 booth",min:1,max:100,onChange:v=>h("phoneBoothRatio",v),disabled:n}),l.jsx("div",{className:"border-t border-slate-100 pt-4",children:l.jsx(PD,{spaces:e.supportSpaces||[],onChange:v=>h("supportSpaces",v)})})]})]})]})};function tA(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=tA(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ze(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=tA(e))&&(n&&(n+=" "),n+=t);return n}var FD=Array.isArray,yn=FD,DD=typeof T0=="object"&&T0&&T0.Object===Object&&T0,rA=DD,ID=rA,RD=typeof self=="object"&&self&&self.Object===Object&&self,$D=ID||RD||Function("return this")(),Ja=$D,LD=Ja,BD=LD.Symbol,s0=BD,oS=s0,nA=Object.prototype,UD=nA.hasOwnProperty,zD=nA.toString,zc=oS?oS.toStringTag:void 0;function WD(e){var t=UD.call(e,zc),r=e[zc];try{e[zc]=void 0;var n=!0}catch{}var a=zD.call(e);return n&&(t?e[zc]=r:delete e[zc]),a}var HD=WD,VD=Object.prototype,GD=VD.toString;function XD(e){return GD.call(e)}var KD=XD,lS=s0,qD=HD,YD=KD,QD="[object Null]",ZD="[object Undefined]",cS=lS?lS.toStringTag:void 0;function JD(e){return e==null?e===void 0?ZD:QD:cS&&cS in Object(e)?qD(e):YD(e)}var Ai=JD;function eI(e){return e!=null&&typeof e=="object"}var Oi=eI,tI=Ai,rI=Oi,nI="[object Symbol]";function aI(e){return typeof e=="symbol"||rI(e)&&tI(e)==nI}var pc=aI,iI=yn,sI=pc,oI=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lI=/^\w*$/;function cI(e,t){if(iI(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||sI(e)?!0:lI.test(e)||!oI.test(e)||t!=null&&e in Object(t)}var Qy=cI;function uI(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var vs=uI;const xc=st(vs);var fI=Ai,dI=vs,hI="[object AsyncFunction]",pI="[object Function]",xI="[object GeneratorFunction]",mI="[object Proxy]";function gI(e){if(!dI(e))return!1;var t=fI(e);return t==pI||t==xI||t==hI||t==mI}var Zy=gI;const Ie=st(Zy);var vI=Ja,yI=vI["__core-js_shared__"],bI=yI,Am=bI,uS=function(){var e=/[^.]+$/.exec(Am&&Am.keys&&Am.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function wI(e){return!!uS&&uS in e}var SI=wI,_I=Function.prototype,kI=_I.toString;function NI(e){if(e!=null){try{return kI.call(e)}catch{}try{return e+""}catch{}}return""}var aA=NI,jI=Zy,EI=SI,TI=vs,AI=aA,OI=/[\\^$.*+?()[\]{}|]/g,CI=/^\[object .+?Constructor\]$/,PI=Function.prototype,MI=Object.prototype,FI=PI.toString,DI=MI.hasOwnProperty,II=RegExp("^"+FI.call(DI).replace(OI,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function RI(e){if(!TI(e)||EI(e))return!1;var t=jI(e)?II:CI;return t.test(AI(e))}var $I=RI;function LI(e,t){return e==null?void 0:e[t]}var BI=LI,UI=$I,zI=BI;function WI(e,t){var r=zI(e,t);return UI(r)?r:void 0}var ko=WI,HI=ko,VI=HI(Object,"create"),Zp=VI,fS=Zp;function GI(){this.__data__=fS?fS(null):{},this.size=0}var XI=GI;function KI(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var qI=KI,YI=Zp,QI="__lodash_hash_undefined__",ZI=Object.prototype,JI=ZI.hasOwnProperty;function eR(e){var t=this.__data__;if(YI){var r=t[e];return r===QI?void 0:r}return JI.call(t,e)?t[e]:void 0}var tR=eR,rR=Zp,nR=Object.prototype,aR=nR.hasOwnProperty;function iR(e){var t=this.__data__;return rR?t[e]!==void 0:aR.call(t,e)}var sR=iR,oR=Zp,lR="__lodash_hash_undefined__";function cR(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=oR&&t===void 0?lR:t,this}var uR=cR,fR=XI,dR=qI,hR=tR,pR=sR,xR=uR;function mc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}mc.prototype.clear=fR;mc.prototype.delete=dR;mc.prototype.get=hR;mc.prototype.has=pR;mc.prototype.set=xR;var mR=mc;function gR(){this.__data__=[],this.size=0}var vR=gR;function yR(e,t){return e===t||e!==e&&t!==t}var Jy=yR,bR=Jy;function wR(e,t){for(var r=e.length;r--;)if(bR(e[r][0],t))return r;return-1}var Jp=wR,SR=Jp,_R=Array.prototype,kR=_R.splice;function NR(e){var t=this.__data__,r=SR(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():kR.call(t,r,1),--this.size,!0}var jR=NR,ER=Jp;function TR(e){var t=this.__data__,r=ER(t,e);return r<0?void 0:t[r][1]}var AR=TR,OR=Jp;function CR(e){return OR(this.__data__,e)>-1}var PR=CR,MR=Jp;function FR(e,t){var r=this.__data__,n=MR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var DR=FR,IR=vR,RR=jR,$R=AR,LR=PR,BR=DR;function gc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}gc.prototype.clear=IR;gc.prototype.delete=RR;gc.prototype.get=$R;gc.prototype.has=LR;gc.prototype.set=BR;var ex=gc,UR=ko,zR=Ja,WR=UR(zR,"Map"),eb=WR,dS=mR,HR=ex,VR=eb;function GR(){this.size=0,this.__data__={hash:new dS,map:new(VR||HR),string:new dS}}var XR=GR;function KR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var qR=KR,YR=qR;function QR(e,t){var r=e.__data__;return YR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var tx=QR,ZR=tx;function JR(e){var t=ZR(this,e).delete(e);return this.size-=t?1:0,t}var e$=JR,t$=tx;function r$(e){return t$(this,e).get(e)}var n$=r$,a$=tx;function i$(e){return a$(this,e).has(e)}var s$=i$,o$=tx;function l$(e,t){var r=o$(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var c$=l$,u$=XR,f$=e$,d$=n$,h$=s$,p$=c$;function vc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}vc.prototype.clear=u$;vc.prototype.delete=f$;vc.prototype.get=d$;vc.prototype.has=h$;vc.prototype.set=p$;var tb=vc,iA=tb,x$="Expected a function";function rb(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(x$);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(rb.Cache||iA),r}rb.Cache=iA;var sA=rb;const m$=st(sA);var g$=sA,v$=500;function y$(e){var t=g$(e,function(n){return r.size===v$&&r.clear(),n}),r=t.cache;return t}var b$=y$,w$=b$,S$=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_$=/\\(\\)?/g,k$=w$(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(S$,function(r,n,a,i){t.push(a?i.replace(_$,"$1"):n||r)}),t}),N$=k$;function j$(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var nb=j$,hS=s0,E$=nb,T$=yn,A$=pc,pS=hS?hS.prototype:void 0,xS=pS?pS.toString:void 0;function oA(e){if(typeof e=="string")return e;if(T$(e))return E$(e,oA)+"";if(A$(e))return xS?xS.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var O$=oA,C$=O$;function P$(e){return e==null?"":C$(e)}var lA=P$,M$=yn,F$=Qy,D$=N$,I$=lA;function R$(e,t){return M$(e)?e:F$(e,t)?[e]:D$(I$(e))}var cA=R$,$$=pc;function L$(e){if(typeof e=="string"||$$(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var rx=L$,B$=cA,U$=rx;function z$(e,t){t=B$(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[U$(t[r++])];return r&&r==n?e:void 0}var ab=z$,W$=ab;function H$(e,t,r){var n=e==null?void 0:W$(e,t);return n===void 0?r:n}var uA=H$;const Mn=st(uA);function V$(e){return e==null}var G$=V$;const $e=st(G$);var X$=Ai,K$=yn,q$=Oi,Y$="[object String]";function Q$(e){return typeof e=="string"||!K$(e)&&q$(e)&&X$(e)==Y$}var Z$=Q$;const lo=st(Z$);var fA={exports:{}},ot={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib=Symbol.for("react.element"),sb=Symbol.for("react.portal"),nx=Symbol.for("react.fragment"),ax=Symbol.for("react.strict_mode"),ix=Symbol.for("react.profiler"),sx=Symbol.for("react.provider"),ox=Symbol.for("react.context"),J$=Symbol.for("react.server_context"),lx=Symbol.for("react.forward_ref"),cx=Symbol.for("react.suspense"),ux=Symbol.for("react.suspense_list"),fx=Symbol.for("react.memo"),dx=Symbol.for("react.lazy"),eL=Symbol.for("react.offscreen"),dA;dA=Symbol.for("react.module.reference");function da(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ib:switch(e=e.type,e){case nx:case ix:case ax:case cx:case ux:return e;default:switch(e=e&&e.$$typeof,e){case J$:case ox:case lx:case dx:case fx:case sx:return e;default:return t}}case sb:return t}}}ot.ContextConsumer=ox;ot.ContextProvider=sx;ot.Element=ib;ot.ForwardRef=lx;ot.Fragment=nx;ot.Lazy=dx;ot.Memo=fx;ot.Portal=sb;ot.Profiler=ix;ot.StrictMode=ax;ot.Suspense=cx;ot.SuspenseList=ux;ot.isAsyncMode=function(){return!1};ot.isConcurrentMode=function(){return!1};ot.isContextConsumer=function(e){return da(e)===ox};ot.isContextProvider=function(e){return da(e)===sx};ot.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ib};ot.isForwardRef=function(e){return da(e)===lx};ot.isFragment=function(e){return da(e)===nx};ot.isLazy=function(e){return da(e)===dx};ot.isMemo=function(e){return da(e)===fx};ot.isPortal=function(e){return da(e)===sb};ot.isProfiler=function(e){return da(e)===ix};ot.isStrictMode=function(e){return da(e)===ax};ot.isSuspense=function(e){return da(e)===cx};ot.isSuspenseList=function(e){return da(e)===ux};ot.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===nx||e===ix||e===ax||e===cx||e===ux||e===eL||typeof e=="object"&&e!==null&&(e.$$typeof===dx||e.$$typeof===fx||e.$$typeof===sx||e.$$typeof===ox||e.$$typeof===lx||e.$$typeof===dA||e.getModuleId!==void 0)};ot.typeOf=da;fA.exports=ot;var tL=fA.exports,rL=Ai,nL=Oi,aL="[object Number]";function iL(e){return typeof e=="number"||nL(e)&&rL(e)==aL}var hA=iL;const sL=st(hA);var oL=hA;function lL(e){return oL(e)&&e!=+e}var cL=lL;const o0=st(cL);var tn=function(t){return t===0?0:t>0?1:-1},Hs=function(t){return lo(t)&&t.indexOf("%")===t.length-1},ge=function(t){return sL(t)&&!o0(t)},uL=function(t){return $e(t)},cr=function(t){return ge(t)||lo(t)},fL=0,yc=function(t){var r=++fL;return"".concat(t||"").concat(r)},rn=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ge(t)&&!lo(t))return n;var i;if(Hs(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return o0(i)&&(i=n),a&&i>r&&(i=r),i},Wi=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},dL=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},kn=function(t,r){return ge(t)&&ge(r)?function(n){return t+n*(r-t)}:function(){return r}};function oh(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Mn(n,t))===r})}var hL=function(t,r){return ge(t)&&ge(r)?t-r:lo(t)&&lo(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function yl(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function xv(e){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}var pL=["viewBox","children"],xL=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],mS=["points","pathLength"],Om={svg:pL,polygon:mS,polyline:mS},ob=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],lh=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(H.isValidElement(t)&&(n=t.props),!xc(n))return null;var a={};return Object.keys(n).forEach(function(i){ob.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},mL=function(t,r,n){return function(a){return t(r,n,a),null}},co=function(t,r,n){if(!xc(t)||xv(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];ob.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=mL(s,r,n))}),a},gL=["children"],vL=["children"];function gS(e,t){if(e==null)return{};var r=yL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mv(e){"@babel/helpers - typeof";return mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mv(e)}var vS={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},xi=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},yS=null,Cm=null,lb=function e(t){if(t===yS&&Array.isArray(Cm))return Cm;var r=[];return H.Children.forEach(t,function(n){$e(n)||(tL.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Cm=r,yS=t,r};function Fn(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return xi(a)}):n=[xi(t)],lb(e).forEach(function(a){var i=Mn(a,"type.displayName")||Mn(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function _n(e,t){var r=Fn(e,t);return r&&r[0]}var bS=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!ge(n)||n<=0||!ge(a)||a<=0)},bL=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],wL=function(t){return t&&t.type&&lo(t.type)&&bL.indexOf(t.type)>=0},SL=function(t){return t&&mv(t)==="object"&&"clipDot"in t},_L=function(t,r,n,a){var i,s=(i=Om==null?void 0:Om[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Ie(t)&&(a&&s.includes(r)||xL.includes(r))||n&&ob.includes(r)},Ce=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(H.isValidElement(t)&&(a=t.props),!xc(a))return null;var i={};return Object.keys(a).forEach(function(s){var o;_L((o=a)===null||o===void 0?void 0:o[s],s,r,n)&&(i[s]=a[s])}),i},gv=function e(t,r){if(t===r)return!0;var n=H.Children.count(t);if(n!==H.Children.count(r))return!1;if(n===0)return!0;if(n===1)return wS(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!wS(i,s))return!1}return!0},wS=function(t,r){if($e(t)&&$e(r))return!0;if(!$e(t)&&!$e(r)){var n=t.props||{},a=n.children,i=gS(n,gL),s=r.props||{},o=s.children,c=gS(s,vL);return a&&o?yl(i,c)&&gv(a,o):!a&&!o?yl(i,c):!1}return!1},SS=function(t,r){var n=[],a={};return lb(t).forEach(function(i,s){if(wL(i))n.push(i);else if(i){var o=xi(i.type),c=r[o]||{},u=c.handler,f=c.once;if(u&&(!f||!a[o])){var d=u(i,o,s);n.push(d),a[o]=!0}}}),n},kL=function(t){var r=t&&t.type;return r&&vS[r]?vS[r]:null},NL=function(t,r){return lb(r).indexOf(t)},jL=["children","width","height","viewBox","className","style","title","desc"];function vv(){return vv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vv.apply(this,arguments)}function EL(e,t){if(e==null)return{};var r=TL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yv(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,o=e.title,c=e.desc,u=EL(e,jL),f=a||{width:r,height:n,x:0,y:0},d=ze("recharts-surface",i);return q.createElement("svg",vv({},Ce(u,!0,"svg"),{className:d,width:r,height:n,style:s,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height)}),q.createElement("title",null,o),q.createElement("desc",null,c),t)}var AL=["children","className"];function bv(){return bv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bv.apply(this,arguments)}function OL(e,t){if(e==null)return{};var r=CL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function CL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Je=q.forwardRef(function(e,t){var r=e.children,n=e.className,a=OL(e,AL),i=ze("recharts-layer",n);return q.createElement("g",bv({className:i},Ce(a,!0),{ref:t}),r)}),Oa=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function PL(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var ML=PL,FL=ML;function DL(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:FL(e,t,r)}var IL=DL,RL="\\ud800-\\udfff",$L="\\u0300-\\u036f",LL="\\ufe20-\\ufe2f",BL="\\u20d0-\\u20ff",UL=$L+LL+BL,zL="\\ufe0e\\ufe0f",WL="\\u200d",HL=RegExp("["+WL+RL+UL+zL+"]");function VL(e){return HL.test(e)}var pA=VL;function GL(e){return e.split("")}var XL=GL,xA="\\ud800-\\udfff",KL="\\u0300-\\u036f",qL="\\ufe20-\\ufe2f",YL="\\u20d0-\\u20ff",QL=KL+qL+YL,ZL="\\ufe0e\\ufe0f",JL="["+xA+"]",wv="["+QL+"]",Sv="\\ud83c[\\udffb-\\udfff]",eB="(?:"+wv+"|"+Sv+")",mA="[^"+xA+"]",gA="(?:\\ud83c[\\udde6-\\uddff]){2}",vA="[\\ud800-\\udbff][\\udc00-\\udfff]",tB="\\u200d",yA=eB+"?",bA="["+ZL+"]?",rB="(?:"+tB+"(?:"+[mA,gA,vA].join("|")+")"+bA+yA+")*",nB=bA+yA+rB,aB="(?:"+[mA+wv+"?",wv,gA,vA,JL].join("|")+")",iB=RegExp(Sv+"(?="+Sv+")|"+aB+nB,"g");function sB(e){return e.match(iB)||[]}var oB=sB,lB=XL,cB=pA,uB=oB;function fB(e){return cB(e)?uB(e):lB(e)}var dB=fB,hB=IL,pB=pA,xB=dB,mB=lA;function gB(e){return function(t){t=mB(t);var r=pB(t)?xB(t):void 0,n=r?r[0]:t.charAt(0),a=r?hB(r,1).join(""):t.slice(1);return n[e]()+a}}var vB=gB,yB=vB,bB=yB("toUpperCase"),wB=bB;const hx=st(wB);function dt(e){return function(){return e}}const wA=Math.cos,ch=Math.sin,Da=Math.sqrt,uh=Math.PI,px=2*uh,_v=Math.PI,kv=2*_v,Is=1e-6,SB=kv-Is;function SA(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function _B(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return SA;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class kB{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?SA:_B(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,f=s-t,d=o-r,h=f*f+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Is)if(!(Math.abs(d*c-u*f)>Is)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,m=a-o,g=c*c+u*u,y=p*p+m*m,v=Math.sqrt(g),b=Math.sqrt(h),x=i*Math.tan((_v-Math.acos((g+h-y)/(2*v*b)))/2),_=x/b,w=x/v;Math.abs(_-1)>Is&&this._append`L${t+_*f},${r+_*d}`,this._append`A${i},${i},0,0,${+(d*p>f*m)},${this._x1=t+w*c},${this._y1=r+w*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,f=r+c,d=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Is||Math.abs(this._y1-f)>Is)&&this._append`L${u},${f}`,n&&(h<0&&(h=h%kv+kv),h>SB?this._append`A${n},${n},0,1,${d},${t-o},${r-c}A${n},${n},0,1,${d},${this._x1=u},${this._y1=f}`:h>Is&&this._append`A${n},${n},0,${+(h>=_v)},${d},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function cb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new kB(t)}function ub(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _A(e){this._context=e}_A.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xx(e){return new _A(e)}function kA(e){return e[0]}function NA(e){return e[1]}function jA(e,t){var r=dt(!0),n=null,a=xx,i=null,s=cb(o);e=typeof e=="function"?e:e===void 0?kA:dt(e),t=typeof t=="function"?t:t===void 0?NA:dt(t);function o(c){var u,f=(c=ub(c)).length,d,h=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=f;++u)!(u<f&&r(d=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,u,c),+t(d,u,c));if(p)return i=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:dt(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:dt(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:dt(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function X0(e,t,r){var n=null,a=dt(!0),i=null,s=xx,o=null,c=cb(u);e=typeof e=="function"?e:e===void 0?kA:dt(+e),t=typeof t=="function"?t:dt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?NA:dt(+r);function u(d){var h,p,m,g=(d=ub(d)).length,y,v=!1,b,x=new Array(g),_=new Array(g);for(i==null&&(o=s(b=c())),h=0;h<=g;++h){if(!(h<g&&a(y=d[h],h,d))===v)if(v=!v)p=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),m=h-1;m>=p;--m)o.point(x[m],_[m]);o.lineEnd(),o.areaEnd()}v&&(x[h]=+e(y,h,d),_[h]=+t(y,h,d),o.point(n?+n(y,h,d):x[h],r?+r(y,h,d):_[h]))}if(b)return o=null,b+""||null}function f(){return jA().defined(a).curve(s).context(i)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:dt(+d),n=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:dt(+d),u):e},u.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:dt(+d),u):n},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:dt(+d),r=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:dt(+d),u):t},u.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:dt(+d),u):r},u.lineX0=u.lineY0=function(){return f().x(e).y(t)},u.lineY1=function(){return f().x(e).y(r)},u.lineX1=function(){return f().x(n).y(t)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:dt(!!d),u):a},u.curve=function(d){return arguments.length?(s=d,i!=null&&(o=s(i)),u):s},u.context=function(d){return arguments.length?(d==null?i=o=null:o=s(i=d),u):i},u}class EA{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function NB(e){return new EA(e,!0)}function jB(e){return new EA(e,!1)}const fb={draw(e,t){const r=Da(t/uh);e.moveTo(r,0),e.arc(0,0,r,0,px)}},EB={draw(e,t){const r=Da(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},TA=Da(1/3),TB=TA*2,AB={draw(e,t){const r=Da(t/TB),n=r*TA;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},OB={draw(e,t){const r=Da(t),n=-r/2;e.rect(n,n,r,r)}},CB=.8908130915292852,AA=ch(uh/10)/ch(7*uh/10),PB=ch(px/10)*AA,MB=-wA(px/10)*AA,FB={draw(e,t){const r=Da(t*CB),n=PB*r,a=MB*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=px*i/5,o=wA(s),c=ch(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},Pm=Da(3),DB={draw(e,t){const r=-Da(t/(Pm*3));e.moveTo(0,r*2),e.lineTo(-Pm*r,-r),e.lineTo(Pm*r,-r),e.closePath()}},Un=-.5,zn=Da(3)/2,Nv=1/Da(12),IB=(Nv/2+1)*3,RB={draw(e,t){const r=Da(t/IB),n=r/2,a=r*Nv,i=n,s=r*Nv+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(Un*n-zn*a,zn*n+Un*a),e.lineTo(Un*i-zn*s,zn*i+Un*s),e.lineTo(Un*o-zn*c,zn*o+Un*c),e.lineTo(Un*n+zn*a,Un*a-zn*n),e.lineTo(Un*i+zn*s,Un*s-zn*i),e.lineTo(Un*o+zn*c,Un*c-zn*o),e.closePath()}};function $B(e,t){let r=null,n=cb(a);e=typeof e=="function"?e:dt(e||fb),t=typeof t=="function"?t:dt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:dt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:dt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function fh(){}function dh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function OA(e){this._context=e}OA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:dh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function LB(e){return new OA(e)}function CA(e){this._context=e}CA.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BB(e){return new CA(e)}function PA(e){this._context=e}PA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:dh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function UB(e){return new PA(e)}function MA(e){this._context=e}MA.prototype={areaStart:fh,areaEnd:fh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function zB(e){return new MA(e)}function _S(e){return e<0?-1:1}function kS(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(_S(i)+_S(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function NS(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Mm(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function hh(e){this._context=e}hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Mm(this,this._t0,NS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Mm(this,NS(this,r=kS(this,e,t)),r);break;default:Mm(this,this._t0,r=kS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function FA(e){this._context=new DA(e)}(FA.prototype=Object.create(hh.prototype)).point=function(e,t){hh.prototype.point.call(this,t,e)};function DA(e){this._context=e}DA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function WB(e){return new hh(e)}function HB(e){return new FA(e)}function IA(e){this._context=e}IA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=jS(e),a=jS(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function jS(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function VB(e){return new IA(e)}function mx(e,t){this._context=e,this._t=t}mx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function GB(e){return new mx(e,.5)}function XB(e){return new mx(e,0)}function KB(e){return new mx(e,1)}function Ml(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function jv(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function qB(e,t){return e[t]}function YB(e){const t=[];return t.key=e,t}function QB(){var e=dt([]),t=jv,r=Ml,n=qB;function a(i){var s=Array.from(e.apply(this,arguments),YB),o,c=s.length,u=-1,f;for(const d of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(d,s[o].key,u,i)]).data=d;for(o=0,f=ub(t(s));o<c;++o)s[f[o]].index=o;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:dt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:dt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?jv:typeof i=="function"?i:dt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Ml,a):r},a}function ZB(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Ml(e,t)}}function JB(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Ml(e,t)}}function e7(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var f=e[t[o]],d=f[n][1]||0,h=f[n-1][1]||0,p=(d-h)/2,m=0;m<o;++m){var g=e[t[m]],y=g[n][1]||0,v=g[n-1][1]||0;p+=y-v}c+=d,u+=p*d}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Ml(e,t)}}function Zu(e){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zu(e)}var t7=["type","size","sizeType"];function Ev(){return Ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ev.apply(this,arguments)}function ES(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function TS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ES(Object(r),!0).forEach(function(n){r7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ES(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r7(e,t,r){return t=n7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n7(e){var t=a7(e,"string");return Zu(t)=="symbol"?t:t+""}function a7(e,t){if(Zu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zu(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i7(e,t){if(e==null)return{};var r=s7(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s7(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var RA={symbolCircle:fb,symbolCross:EB,symbolDiamond:AB,symbolSquare:OB,symbolStar:FB,symbolTriangle:DB,symbolWye:RB},o7=Math.PI/180,l7=function(t){var r="symbol".concat(hx(t));return RA[r]||fb},c7=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*o7;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},u7=function(t,r){RA["symbol".concat(hx(t))]=r},db=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,o=s===void 0?"area":s,c=i7(t,t7),u=TS(TS({},c),{},{type:n,size:i,sizeType:o}),f=function(){var y=l7(n),v=$B().type(y).size(c7(i,o,n));return v()},d=u.className,h=u.cx,p=u.cy,m=Ce(u,!0);return h===+h&&p===+p&&i===+i?q.createElement("path",Ev({},m,{className:ze("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(p,")"),d:f()})):null};db.registerSymbol=u7;function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}function Tv(){return Tv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tv.apply(this,arguments)}function AS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AS(Object(r),!0).forEach(function(n){Ju(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LA(n.key),n)}}function p7(e,t,r){return t&&h7(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function x7(e,t,r){return t=ph(t),m7(e,$A()?Reflect.construct(t,r||[],ph(e).constructor):t.apply(e,r))}function m7(e,t){if(t&&(Fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g7(e)}function g7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($A=function(){return!!e})()}function ph(e){return ph=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ph(e)}function v7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Av(e,t)}function Av(e,t){return Av=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Av(e,t)}function Ju(e,t,r){return t=LA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LA(e){var t=y7(e,"string");return Fl(t)=="symbol"?t:t+""}function y7(e,t){if(Fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wn=32,hb=function(e){function t(){return d7(this,t),x7(this,t,arguments)}return v7(t,e),p7(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Wn/2,s=Wn/6,o=Wn/3,c=n.inactive?a:n.color;if(n.type==="plainline")return q.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Wn,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return q.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Wn,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return q.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Wn/8,"h").concat(Wn,"v").concat(Wn*3/4,"h").concat(-Wn,"z"),className:"recharts-legend-icon"});if(q.isValidElement(n.legendIcon)){var u=f7({},n);return delete u.legendIcon,q.cloneElement(n.legendIcon,u)}return q.createElement(db,{fill:c,cx:i,cy:i,size:Wn,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,o=a.layout,c=a.formatter,u=a.inactiveColor,f={x:0,y:0,width:Wn,height:Wn},d={display:o==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,m){var g=p.formatter||c,y=ze(Ju(Ju({"recharts-legend-item":!0},"legend-item-".concat(m),!0),"inactive",p.inactive));if(p.type==="none")return null;var v=Ie(p.value)?null:p.value;Oa(!Ie(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?u:p.color;return q.createElement("li",Tv({className:y,style:d,key:"legend-item-".concat(m)},co(n.props,p,m)),q.createElement(yv,{width:s,height:s,viewBox:f,style:h},n.renderIcon(p)),q.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(v,p,m):v))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var o={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return q.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(H.PureComponent);Ju(hb,"displayName","Legend");Ju(hb,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var b7=ex;function w7(){this.__data__=new b7,this.size=0}var S7=w7;function _7(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var k7=_7;function N7(e){return this.__data__.get(e)}var j7=N7;function E7(e){return this.__data__.has(e)}var T7=E7,A7=ex,O7=eb,C7=tb,P7=200;function M7(e,t){var r=this.__data__;if(r instanceof A7){var n=r.__data__;if(!O7||n.length<P7-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new C7(n)}return r.set(e,t),this.size=r.size,this}var F7=M7,D7=ex,I7=S7,R7=k7,$7=j7,L7=T7,B7=F7;function bc(e){var t=this.__data__=new D7(e);this.size=t.size}bc.prototype.clear=I7;bc.prototype.delete=R7;bc.prototype.get=$7;bc.prototype.has=L7;bc.prototype.set=B7;var BA=bc,U7="__lodash_hash_undefined__";function z7(e){return this.__data__.set(e,U7),this}var W7=z7;function H7(e){return this.__data__.has(e)}var V7=H7,G7=tb,X7=W7,K7=V7;function xh(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new G7;++t<r;)this.add(e[t])}xh.prototype.add=xh.prototype.push=X7;xh.prototype.has=K7;var UA=xh;function q7(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var zA=q7;function Y7(e,t){return e.has(t)}var WA=Y7,Q7=UA,Z7=zA,J7=WA,e9=1,t9=2;function r9(e,t,r,n,a,i){var s=r&e9,o=e.length,c=t.length;if(o!=c&&!(s&&c>o))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var d=-1,h=!0,p=r&t9?new Q7:void 0;for(i.set(e,t),i.set(t,e);++d<o;){var m=e[d],g=t[d];if(n)var y=s?n(g,m,d,t,e,i):n(m,g,d,e,t,i);if(y!==void 0){if(y)continue;h=!1;break}if(p){if(!Z7(t,function(v,b){if(!J7(p,b)&&(m===v||a(m,v,r,n,i)))return p.push(b)})){h=!1;break}}else if(!(m===g||a(m,g,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var HA=r9,n9=Ja,a9=n9.Uint8Array,i9=a9;function s9(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var o9=s9;function l9(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var pb=l9,OS=s0,CS=i9,c9=Jy,u9=HA,f9=o9,d9=pb,h9=1,p9=2,x9="[object Boolean]",m9="[object Date]",g9="[object Error]",v9="[object Map]",y9="[object Number]",b9="[object RegExp]",w9="[object Set]",S9="[object String]",_9="[object Symbol]",k9="[object ArrayBuffer]",N9="[object DataView]",PS=OS?OS.prototype:void 0,Fm=PS?PS.valueOf:void 0;function j9(e,t,r,n,a,i,s){switch(r){case N9:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case k9:return!(e.byteLength!=t.byteLength||!i(new CS(e),new CS(t)));case x9:case m9:case y9:return c9(+e,+t);case g9:return e.name==t.name&&e.message==t.message;case b9:case S9:return e==t+"";case v9:var o=f9;case w9:var c=n&h9;if(o||(o=d9),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;n|=p9,s.set(e,t);var f=u9(o(e),o(t),n,a,i,s);return s.delete(e),f;case _9:if(Fm)return Fm.call(e)==Fm.call(t)}return!1}var E9=j9;function T9(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var VA=T9,A9=VA,O9=yn;function C9(e,t,r){var n=t(e);return O9(e)?n:A9(n,r(e))}var P9=C9;function M9(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var F9=M9;function D9(){return[]}var I9=D9,R9=F9,$9=I9,L9=Object.prototype,B9=L9.propertyIsEnumerable,MS=Object.getOwnPropertySymbols,U9=MS?function(e){return e==null?[]:(e=Object(e),R9(MS(e),function(t){return B9.call(e,t)}))}:$9,z9=U9;function W9(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var H9=W9,V9=Ai,G9=Oi,X9="[object Arguments]";function K9(e){return G9(e)&&V9(e)==X9}var q9=K9,FS=q9,Y9=Oi,GA=Object.prototype,Q9=GA.hasOwnProperty,Z9=GA.propertyIsEnumerable,J9=FS(function(){return arguments}())?FS:function(e){return Y9(e)&&Q9.call(e,"callee")&&!Z9.call(e,"callee")},xb=J9,mh={exports:{}};function eU(){return!1}var tU=eU;mh.exports;(function(e,t){var r=Ja,n=tU,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,u=c||n;e.exports=u})(mh,mh.exports);var XA=mh.exports,rU=9007199254740991,nU=/^(?:0|[1-9]\d*)$/;function aU(e,t){var r=typeof e;return t=t??rU,!!t&&(r=="number"||r!="symbol"&&nU.test(e))&&e>-1&&e%1==0&&e<t}var mb=aU,iU=9007199254740991;function sU(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=iU}var gb=sU,oU=Ai,lU=gb,cU=Oi,uU="[object Arguments]",fU="[object Array]",dU="[object Boolean]",hU="[object Date]",pU="[object Error]",xU="[object Function]",mU="[object Map]",gU="[object Number]",vU="[object Object]",yU="[object RegExp]",bU="[object Set]",wU="[object String]",SU="[object WeakMap]",_U="[object ArrayBuffer]",kU="[object DataView]",NU="[object Float32Array]",jU="[object Float64Array]",EU="[object Int8Array]",TU="[object Int16Array]",AU="[object Int32Array]",OU="[object Uint8Array]",CU="[object Uint8ClampedArray]",PU="[object Uint16Array]",MU="[object Uint32Array]",vt={};vt[NU]=vt[jU]=vt[EU]=vt[TU]=vt[AU]=vt[OU]=vt[CU]=vt[PU]=vt[MU]=!0;vt[uU]=vt[fU]=vt[_U]=vt[dU]=vt[kU]=vt[hU]=vt[pU]=vt[xU]=vt[mU]=vt[gU]=vt[vU]=vt[yU]=vt[bU]=vt[wU]=vt[SU]=!1;function FU(e){return cU(e)&&lU(e.length)&&!!vt[oU(e)]}var DU=FU;function IU(e){return function(t){return e(t)}}var KA=IU,gh={exports:{}};gh.exports;(function(e,t){var r=rA,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,o=function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=o})(gh,gh.exports);var RU=gh.exports,$U=DU,LU=KA,DS=RU,IS=DS&&DS.isTypedArray,BU=IS?LU(IS):$U,qA=BU,UU=H9,zU=xb,WU=yn,HU=XA,VU=mb,GU=qA,XU=Object.prototype,KU=XU.hasOwnProperty;function qU(e,t){var r=WU(e),n=!r&&zU(e),a=!r&&!n&&HU(e),i=!r&&!n&&!a&&GU(e),s=r||n||a||i,o=s?UU(e.length,String):[],c=o.length;for(var u in e)(t||KU.call(e,u))&&!(s&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||VU(u,c)))&&o.push(u);return o}var YU=qU,QU=Object.prototype;function ZU(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||QU;return e===r}var JU=ZU;function ez(e,t){return function(r){return e(t(r))}}var YA=ez,tz=YA,rz=tz(Object.keys,Object),nz=rz,az=JU,iz=nz,sz=Object.prototype,oz=sz.hasOwnProperty;function lz(e){if(!az(e))return iz(e);var t=[];for(var r in Object(e))oz.call(e,r)&&r!="constructor"&&t.push(r);return t}var cz=lz,uz=Zy,fz=gb;function dz(e){return e!=null&&fz(e.length)&&!uz(e)}var l0=dz,hz=YU,pz=cz,xz=l0;function mz(e){return xz(e)?hz(e):pz(e)}var gx=mz,gz=P9,vz=z9,yz=gx;function bz(e){return gz(e,yz,vz)}var wz=bz,RS=wz,Sz=1,_z=Object.prototype,kz=_z.hasOwnProperty;function Nz(e,t,r,n,a,i){var s=r&Sz,o=RS(e),c=o.length,u=RS(t),f=u.length;if(c!=f&&!s)return!1;for(var d=c;d--;){var h=o[d];if(!(s?h in t:kz.call(t,h)))return!1}var p=i.get(e),m=i.get(t);if(p&&m)return p==t&&m==e;var g=!0;i.set(e,t),i.set(t,e);for(var y=s;++d<c;){h=o[d];var v=e[h],b=t[h];if(n)var x=s?n(b,v,h,t,e,i):n(v,b,h,e,t,i);if(!(x===void 0?v===b||a(v,b,r,n,i):x)){g=!1;break}y||(y=h=="constructor")}if(g&&!y){var _=e.constructor,w=t.constructor;_!=w&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof w=="function"&&w instanceof w)&&(g=!1)}return i.delete(e),i.delete(t),g}var jz=Nz,Ez=ko,Tz=Ja,Az=Ez(Tz,"DataView"),Oz=Az,Cz=ko,Pz=Ja,Mz=Cz(Pz,"Promise"),Fz=Mz,Dz=ko,Iz=Ja,Rz=Dz(Iz,"Set"),QA=Rz,$z=ko,Lz=Ja,Bz=$z(Lz,"WeakMap"),Uz=Bz,Ov=Oz,Cv=eb,Pv=Fz,Mv=QA,Fv=Uz,ZA=Ai,wc=aA,$S="[object Map]",zz="[object Object]",LS="[object Promise]",BS="[object Set]",US="[object WeakMap]",zS="[object DataView]",Wz=wc(Ov),Hz=wc(Cv),Vz=wc(Pv),Gz=wc(Mv),Xz=wc(Fv),Rs=ZA;(Ov&&Rs(new Ov(new ArrayBuffer(1)))!=zS||Cv&&Rs(new Cv)!=$S||Pv&&Rs(Pv.resolve())!=LS||Mv&&Rs(new Mv)!=BS||Fv&&Rs(new Fv)!=US)&&(Rs=function(e){var t=ZA(e),r=t==zz?e.constructor:void 0,n=r?wc(r):"";if(n)switch(n){case Wz:return zS;case Hz:return $S;case Vz:return LS;case Gz:return BS;case Xz:return US}return t});var Kz=Rs,Dm=BA,qz=HA,Yz=E9,Qz=jz,WS=Kz,HS=yn,VS=XA,Zz=qA,Jz=1,GS="[object Arguments]",XS="[object Array]",K0="[object Object]",eW=Object.prototype,KS=eW.hasOwnProperty;function tW(e,t,r,n,a,i){var s=HS(e),o=HS(t),c=s?XS:WS(e),u=o?XS:WS(t);c=c==GS?K0:c,u=u==GS?K0:u;var f=c==K0,d=u==K0,h=c==u;if(h&&VS(e)){if(!VS(t))return!1;s=!0,f=!1}if(h&&!f)return i||(i=new Dm),s||Zz(e)?qz(e,t,r,n,a,i):Yz(e,t,c,r,n,a,i);if(!(r&Jz)){var p=f&&KS.call(e,"__wrapped__"),m=d&&KS.call(t,"__wrapped__");if(p||m){var g=p?e.value():e,y=m?t.value():t;return i||(i=new Dm),a(g,y,r,n,i)}}return h?(i||(i=new Dm),Qz(e,t,r,n,a,i)):!1}var rW=tW,nW=rW,qS=Oi;function JA(e,t,r,n,a){return e===t?!0:e==null||t==null||!qS(e)&&!qS(t)?e!==e&&t!==t:nW(e,t,r,n,JA,a)}var vb=JA,aW=BA,iW=vb,sW=1,oW=2;function lW(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var o=r[a];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<i;){o=r[a];var c=o[0],u=e[c],f=o[1];if(s&&o[2]){if(u===void 0&&!(c in e))return!1}else{var d=new aW;if(n)var h=n(u,f,c,e,t,d);if(!(h===void 0?iW(f,u,sW|oW,n,d):h))return!1}}return!0}var cW=lW,uW=vs;function fW(e){return e===e&&!uW(e)}var e3=fW,dW=e3,hW=gx;function pW(e){for(var t=hW(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,dW(a)]}return t}var xW=pW;function mW(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var t3=mW,gW=cW,vW=xW,yW=t3;function bW(e){var t=vW(e);return t.length==1&&t[0][2]?yW(t[0][0],t[0][1]):function(r){return r===e||gW(r,e,t)}}var wW=bW;function SW(e,t){return e!=null&&t in Object(e)}var _W=SW,kW=cA,NW=xb,jW=yn,EW=mb,TW=gb,AW=rx;function OW(e,t,r){t=kW(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=AW(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&TW(a)&&EW(s,a)&&(jW(e)||NW(e)))}var CW=OW,PW=_W,MW=CW;function FW(e,t){return e!=null&&MW(e,t,PW)}var DW=FW,IW=vb,RW=uA,$W=DW,LW=Qy,BW=e3,UW=t3,zW=rx,WW=1,HW=2;function VW(e,t){return LW(e)&&BW(t)?UW(zW(e),t):function(r){var n=RW(r,e);return n===void 0&&n===t?$W(r,e):IW(t,n,WW|HW)}}var GW=VW;function XW(e){return e}var Sc=XW;function KW(e){return function(t){return t==null?void 0:t[e]}}var qW=KW,YW=ab;function QW(e){return function(t){return YW(t,e)}}var ZW=QW,JW=qW,eH=ZW,tH=Qy,rH=rx;function nH(e){return tH(e)?JW(rH(e)):eH(e)}var aH=nH,iH=wW,sH=GW,oH=Sc,lH=yn,cH=aH;function uH(e){return typeof e=="function"?e:e==null?oH:typeof e=="object"?lH(e)?sH(e[0],e[1]):iH(e):cH(e)}var ei=uH;function fH(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var r3=fH;function dH(e){return e!==e}var hH=dH;function pH(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var xH=pH,mH=r3,gH=hH,vH=xH;function yH(e,t,r){return t===t?vH(e,t,r):mH(e,gH,r)}var bH=yH,wH=bH;function SH(e,t){var r=e==null?0:e.length;return!!r&&wH(e,t,0)>-1}var _H=SH;function kH(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var NH=kH;function jH(){}var EH=jH,Im=QA,TH=EH,AH=pb,OH=1/0,CH=Im&&1/AH(new Im([,-0]))[1]==OH?function(e){return new Im(e)}:TH,PH=CH,MH=UA,FH=_H,DH=NH,IH=WA,RH=PH,$H=pb,LH=200;function BH(e,t,r){var n=-1,a=FH,i=e.length,s=!0,o=[],c=o;if(r)s=!1,a=DH;else if(i>=LH){var u=t?null:RH(e);if(u)return $H(u);s=!1,a=IH,c=new MH}else c=t?[]:o;e:for(;++n<i;){var f=e[n],d=t?t(f):f;if(f=r||f!==0?f:0,s&&d===d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(f)}else a(c,d,r)||(c!==o&&c.push(d),o.push(f))}return o}var UH=BH,zH=ei,WH=UH;function HH(e,t){return e&&e.length?WH(e,zH(t)):[]}var VH=HH;const YS=st(VH);function n3(e,t,r){return t===!0?YS(e,r):Ie(t)?YS(e,t):e}function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}var GH=["ref"];function QS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QS(Object(r),!0).forEach(function(n){vx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i3(n.key),n)}}function KH(e,t,r){return t&&ZS(e.prototype,t),r&&ZS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qH(e,t,r){return t=vh(t),YH(e,a3()?Reflect.construct(t,r||[],vh(e).constructor):t.apply(e,r))}function YH(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QH(e)}function QH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(a3=function(){return!!e})()}function vh(e){return vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vh(e)}function ZH(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dv(e,t)}function Dv(e,t){return Dv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Dv(e,t)}function vx(e,t,r){return t=i3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i3(e){var t=JH(e,"string");return Dl(t)=="symbol"?t:t+""}function JH(e,t){if(Dl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function eV(e,t){if(e==null)return{};var r=tV(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tV(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function rV(e){return e.value}function nV(e,t){if(q.isValidElement(e))return q.cloneElement(e,t);if(typeof e=="function")return q.createElement(e,t);t.ref;var r=eV(t,GH);return q.createElement(hb,r)}var JS=1,na=function(e){function t(){var r;XH(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=qH(this,t,[].concat(a)),vx(r,"lastBoundingBox",{width:-1,height:-1}),r}return ZH(t,e),KH(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>JS||Math.abs(a.height-this.lastBoundingBox.height)>JS)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ai({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,o=a.verticalAlign,c=a.margin,u=a.chartWidth,f=a.chartHeight,d,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();d={left:((u||0)-p.width)/2}}else d=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(o==="middle"){var m=this.getBBoxSnapshot();h={top:((f||0)-m.height)/2}}else h=o==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return ai(ai({},d),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,o=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,f=a.payload,d=ai(ai({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(c)),c);return q.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(p){n.wrapperNode=p}},nV(i,ai(ai({},this.props),{},{payload:n3(f,u,rV)})))}}],[{key:"getWithHeight",value:function(n,a){var i=ai(ai({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&ge(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(H.PureComponent);vx(na,"displayName","Legend");vx(na,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var e_=s0,aV=xb,iV=yn,t_=e_?e_.isConcatSpreadable:void 0;function sV(e){return iV(e)||aV(e)||!!(t_&&e&&e[t_])}var oV=sV,lV=VA,cV=oV;function s3(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=cV),a||(a=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?s3(o,t-1,r,n,a):lV(a,o):n||(a[a.length]=o)}return a}var o3=s3;function uV(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),o=s.length;o--;){var c=s[e?o:++a];if(r(i[c],c,i)===!1)break}return t}}var fV=uV,dV=fV,hV=dV(),pV=hV,xV=pV,mV=gx;function gV(e,t){return e&&xV(e,t,mV)}var l3=gV,vV=l0;function yV(e,t){return function(r,n){if(r==null)return r;if(!vV(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var bV=yV,wV=l3,SV=bV,_V=SV(wV),yb=_V,kV=yb,NV=l0;function jV(e,t){var r=-1,n=NV(e)?Array(e.length):[];return kV(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var c3=jV;function EV(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var TV=EV,r_=pc;function AV(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=r_(e),s=t!==void 0,o=t===null,c=t===t,u=r_(t);if(!o&&!u&&!i&&e>t||i&&s&&c&&!o&&!u||n&&s&&c||!r&&c||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||o&&r&&a||!s&&a||!c)return-1}return 0}var OV=AV,CV=OV;function PV(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,o=r.length;++n<s;){var c=CV(a[n],i[n]);if(c){if(n>=o)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return e.index-t.index}var MV=PV,Rm=nb,FV=ab,DV=ei,IV=c3,RV=TV,$V=KA,LV=MV,BV=Sc,UV=yn;function zV(e,t,r){t.length?t=Rm(t,function(i){return UV(i)?function(s){return FV(s,i.length===1?i[0]:i)}:i}):t=[BV];var n=-1;t=Rm(t,$V(DV));var a=IV(e,function(i,s,o){var c=Rm(t,function(u){return u(i)});return{criteria:c,index:++n,value:i}});return RV(a,function(i,s){return LV(i,s,r)})}var WV=zV;function HV(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var VV=HV,GV=VV,n_=Math.max;function XV(e,t,r){return t=n_(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=n_(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),GV(e,this,o)}}var KV=XV;function qV(e){return function(){return e}}var YV=qV,QV=ko,ZV=function(){try{var e=QV(Object,"defineProperty");return e({},"",{}),e}catch{}}(),u3=ZV,JV=YV,a_=u3,eG=Sc,tG=a_?function(e,t){return a_(e,"toString",{configurable:!0,enumerable:!1,value:JV(t),writable:!0})}:eG,rG=tG,nG=800,aG=16,iG=Date.now;function sG(e){var t=0,r=0;return function(){var n=iG(),a=aG-(n-r);if(r=n,a>0){if(++t>=nG)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var oG=sG,lG=rG,cG=oG,uG=cG(lG),fG=uG,dG=Sc,hG=KV,pG=fG;function xG(e,t){return pG(hG(e,t,dG),e+"")}var mG=xG,gG=Jy,vG=l0,yG=mb,bG=vs;function wG(e,t,r){if(!bG(r))return!1;var n=typeof t;return(n=="number"?vG(r)&&yG(t,r.length):n=="string"&&t in r)?gG(r[t],e):!1}var yx=wG,SG=o3,_G=WV,kG=mG,i_=yx,NG=kG(function(e,t){if(e==null)return[];var r=t.length;return r>1&&i_(e,t[0],t[1])?t=[]:r>2&&i_(t[0],t[1],t[2])&&(t=[t[0]]),_G(e,SG(t,1),[])}),jG=NG;const bb=st(jG);function ef(e){"@babel/helpers - typeof";return ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ef(e)}function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(this,arguments)}function EG(e,t){return CG(e)||OG(e,t)||AG(e,t)||TG()}function TG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AG(e,t){if(e){if(typeof e=="string")return s_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s_(e,t)}}function s_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function CG(e){if(Array.isArray(e))return e}function o_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $m(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o_(Object(r),!0).forEach(function(n){PG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PG(e,t,r){return t=MG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MG(e){var t=FG(e,"string");return ef(t)=="symbol"?t:t+""}function FG(e,t){if(ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DG(e){return Array.isArray(e)&&cr(e[0])&&cr(e[1])?e.join(" ~ "):e}var IG=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,o=s===void 0?{}:s,c=t.labelStyle,u=c===void 0?{}:c,f=t.payload,d=t.formatter,h=t.itemSorter,p=t.wrapperClassName,m=t.labelClassName,g=t.label,y=t.labelFormatter,v=t.accessibilityLayer,b=v===void 0?!1:v,x=function(){if(f&&f.length){var T={padding:0,margin:0},F=(h?bb(f,h):f).map(function(G,M){if(G.type==="none")return null;var W=$m({display:"block",paddingTop:4,paddingBottom:4,color:G.color||"#000"},o),Y=G.formatter||d||DG,K=G.value,D=G.name,Z=K,ee=D;if(Y&&Z!=null&&ee!=null){var O=Y(K,D,G,M,f);if(Array.isArray(O)){var L=EG(O,2);Z=L[0],ee=L[1]}else Z=O}return q.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:W},cr(ee)?q.createElement("span",{className:"recharts-tooltip-item-name"},ee):null,cr(ee)?q.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,q.createElement("span",{className:"recharts-tooltip-item-value"},Z),q.createElement("span",{className:"recharts-tooltip-item-unit"},G.unit||""))});return q.createElement("ul",{className:"recharts-tooltip-item-list",style:T},F)}return null},_=$m({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),w=$m({margin:0},u),S=!$e(g),k=S?g:"",N=ze("recharts-default-tooltip",p),j=ze("recharts-tooltip-label",m);S&&y&&f!==void 0&&f!==null&&(k=y(g,f));var E=b?{role:"status","aria-live":"assertive"}:{};return q.createElement("div",Iv({className:N,style:_},E),q.createElement("p",{className:j,style:w},q.isValidElement(k)?k:"".concat(k)),x())};function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function q0(e,t,r){return t=RG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RG(e){var t=$G(e,"string");return tf(t)=="symbol"?t:t+""}function $G(e,t){if(tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wc="recharts-tooltip-wrapper",LG={visibility:"hidden"};function BG(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ze(Wc,q0(q0(q0(q0({},"".concat(Wc,"-right"),ge(r)&&t&&ge(t.x)&&r>=t.x),"".concat(Wc,"-left"),ge(r)&&t&&ge(t.x)&&r<t.x),"".concat(Wc,"-bottom"),ge(n)&&t&&ge(t.y)&&n>=t.y),"".concat(Wc,"-top"),ge(n)&&t&&ge(t.y)&&n<t.y))}function l_(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,o=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&ge(i[n]))return i[n];var f=r[n]-o-a,d=r[n]+a;if(t[n])return s[n]?f:d;if(s[n]){var h=f,p=c[n];return h<p?Math.max(d,c[n]):Math.max(f,c[n])}var m=d+o,g=c[n]+u;return m>g?Math.max(f,c[n]):Math.max(d,c[n])}function UG(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function zG(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,o=e.useTranslate3d,c=e.viewBox,u,f,d;return s.height>0&&s.width>0&&r?(f=l_({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),d=l_({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=UG({translateX:f,translateY:d,useTranslate3d:o})):u=LG,{cssProperties:u,cssClasses:BG({translateX:f,translateY:d,coordinate:r})}}function Il(e){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Il(e)}function c_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c_(Object(r),!0).forEach(function(n){$v(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d3(n.key),n)}}function VG(e,t,r){return t&&HG(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GG(e,t,r){return t=yh(t),XG(e,f3()?Reflect.construct(t,r||[],yh(e).constructor):t.apply(e,r))}function XG(e,t){if(t&&(Il(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KG(e)}function KG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f3=function(){return!!e})()}function yh(e){return yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yh(e)}function qG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rv(e,t)}function Rv(e,t){return Rv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Rv(e,t)}function $v(e,t,r){return t=d3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d3(e){var t=YG(e,"string");return Il(t)=="symbol"?t:t+""}function YG(e,t){if(Il(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Il(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var f_=1,QG=function(e){function t(){var r;WG(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=GG(this,t,[].concat(a)),$v(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),$v(r,"handleKeyDown",function(s){if(s.key==="Escape"){var o,c,u,f;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&o!==void 0?o:0,y:(u=(f=r.props.coordinate)===null||f===void 0?void 0:f.y)!==null&&u!==void 0?u:0}})}}),r}return qG(t,e),VG(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>f_||Math.abs(n.height-this.state.lastBoundingBox.height)>f_)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.children,f=a.coordinate,d=a.hasPayload,h=a.isAnimationActive,p=a.offset,m=a.position,g=a.reverseDirection,y=a.useTranslate3d,v=a.viewBox,b=a.wrapperStyle,x=zG({allowEscapeViewBox:s,coordinate:f,offsetTopLeft:p,position:m,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:v}),_=x.cssClasses,w=x.cssProperties,S=u_(u_({transition:h&&i?"transform ".concat(o,"ms ").concat(c):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&d?"visible":"hidden",position:"absolute",top:0,left:0},b);return q.createElement("div",{tabIndex:-1,className:_,style:S,ref:function(N){n.wrapperNode=N}},u)}}])}(H.PureComponent),ZG=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},No={isSsr:ZG()};function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function d_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function h_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d_(Object(r),!0).forEach(function(n){wb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eX(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p3(n.key),n)}}function tX(e,t,r){return t&&eX(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rX(e,t,r){return t=bh(t),nX(e,h3()?Reflect.construct(t,r||[],bh(e).constructor):t.apply(e,r))}function nX(e,t){if(t&&(Rl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aX(e)}function aX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(h3=function(){return!!e})()}function bh(e){return bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bh(e)}function iX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lv(e,t)}function Lv(e,t){return Lv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Lv(e,t)}function wb(e,t,r){return t=p3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p3(e){var t=sX(e,"string");return Rl(t)=="symbol"?t:t+""}function sX(e,t){if(Rl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function oX(e){return e.dataKey}function lX(e,t){return q.isValidElement(e)?q.cloneElement(e,t):typeof e=="function"?q.createElement(e,t):q.createElement(IG,t)}var ir=function(e){function t(){return JG(this,t),rX(this,t,arguments)}return iX(t,e),tX(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.content,f=a.coordinate,d=a.filterNull,h=a.isAnimationActive,p=a.offset,m=a.payload,g=a.payloadUniqBy,y=a.position,v=a.reverseDirection,b=a.useTranslate3d,x=a.viewBox,_=a.wrapperStyle,w=m??[];d&&w.length&&(w=n3(m.filter(function(k){return k.value!=null&&(k.hide!==!0||n.props.includeHidden)}),g,oX));var S=w.length>0;return q.createElement(QG,{allowEscapeViewBox:s,animationDuration:o,animationEasing:c,isAnimationActive:h,active:i,coordinate:f,hasPayload:S,offset:p,position:y,reverseDirection:v,useTranslate3d:b,viewBox:x,wrapperStyle:_},lX(u,h_(h_({},this.props),{},{payload:w})))}}])}(H.PureComponent);wb(ir,"displayName","Tooltip");wb(ir,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!No.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var cX=Ja,uX=function(){return cX.Date.now()},fX=uX,dX=/\s/;function hX(e){for(var t=e.length;t--&&dX.test(e.charAt(t)););return t}var pX=hX,xX=pX,mX=/^\s+/;function gX(e){return e&&e.slice(0,xX(e)+1).replace(mX,"")}var vX=gX,yX=vX,p_=vs,bX=pc,x_=NaN,wX=/^[-+]0x[0-9a-f]+$/i,SX=/^0b[01]+$/i,_X=/^0o[0-7]+$/i,kX=parseInt;function NX(e){if(typeof e=="number")return e;if(bX(e))return x_;if(p_(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=p_(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=yX(e);var r=SX.test(e);return r||_X.test(e)?kX(e.slice(2),r?2:8):wX.test(e)?x_:+e}var x3=NX,jX=vs,Lm=fX,m_=x3,EX="Expected a function",TX=Math.max,AX=Math.min;function OX(e,t,r){var n,a,i,s,o,c,u=0,f=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(EX);t=m_(t)||0,jX(r)&&(f=!!r.leading,d="maxWait"in r,i=d?TX(m_(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function p(S){var k=n,N=a;return n=a=void 0,u=S,s=e.apply(N,k),s}function m(S){return u=S,o=setTimeout(v,t),f?p(S):s}function g(S){var k=S-c,N=S-u,j=t-k;return d?AX(j,i-N):j}function y(S){var k=S-c,N=S-u;return c===void 0||k>=t||k<0||d&&N>=i}function v(){var S=Lm();if(y(S))return b(S);o=setTimeout(v,g(S))}function b(S){return o=void 0,h&&n?p(S):(n=a=void 0,s)}function x(){o!==void 0&&clearTimeout(o),u=0,n=c=a=o=void 0}function _(){return o===void 0?s:b(Lm())}function w(){var S=Lm(),k=y(S);if(n=arguments,a=this,c=S,k){if(o===void 0)return m(c);if(d)return clearTimeout(o),o=setTimeout(v,t),p(c)}return o===void 0&&(o=setTimeout(v,t)),s}return w.cancel=x,w.flush=_,w}var CX=OX,PX=CX,MX=vs,FX="Expected a function";function DX(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(FX);return MX(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),PX(e,t,{leading:n,maxWait:t,trailing:a})}var IX=DX;const m3=st(IX);function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function g_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g_(Object(r),!0).forEach(function(n){RX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RX(e,t,r){return t=$X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $X(e){var t=LX(e,"string");return rf(t)=="symbol"?t:t+""}function LX(e,t){if(rf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BX(e,t){return HX(e)||WX(e,t)||zX(e,t)||UX()}function UX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zX(e,t){if(e){if(typeof e=="string")return v_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v_(e,t)}}function v_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function HX(e){if(Array.isArray(e))return e}var qa=H.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,o=e.height,c=o===void 0?"100%":o,u=e.minWidth,f=u===void 0?0:u,d=e.minHeight,h=e.maxHeight,p=e.children,m=e.debounce,g=m===void 0?0:m,y=e.id,v=e.className,b=e.onResize,x=e.style,_=x===void 0?{}:x,w=H.useRef(null),S=H.useRef();S.current=b,H.useImperativeHandle(t,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var k=H.useState({containerWidth:a.width,containerHeight:a.height}),N=BX(k,2),j=N[0],E=N[1],A=H.useCallback(function(F,G){E(function(M){var W=Math.round(F),Y=Math.round(G);return M.containerWidth===W&&M.containerHeight===Y?M:{containerWidth:W,containerHeight:Y}})},[]);H.useEffect(function(){var F=function(D){var Z,ee=D[0].contentRect,O=ee.width,L=ee.height;A(O,L),(Z=S.current)===null||Z===void 0||Z.call(S,O,L)};g>0&&(F=m3(F,g,{trailing:!0,leading:!1}));var G=new ResizeObserver(F),M=w.current.getBoundingClientRect(),W=M.width,Y=M.height;return A(W,Y),G.observe(w.current),function(){G.disconnect()}},[A,g]);var T=H.useMemo(function(){var F=j.containerWidth,G=j.containerHeight;if(F<0||G<0)return null;Oa(Hs(s)||Hs(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),Oa(!r||r>0,"The aspect(%s) must be greater than zero.",r);var M=Hs(s)?F:s,W=Hs(c)?G:c;r&&r>0&&(M?W=M/r:W&&(M=W*r),h&&W>h&&(W=h)),Oa(M>0||W>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,M,W,s,c,f,d,r);var Y=!Array.isArray(p)&&xi(p.type).endsWith("Chart");return q.Children.map(p,function(K){return q.isValidElement(K)?H.cloneElement(K,Y0({width:M,height:W},Y?{style:Y0({height:"100%",width:"100%",maxHeight:W,maxWidth:M},K.props.style)}:{})):K})},[r,p,c,h,d,f,j,s]);return q.createElement("div",{id:y?"".concat(y):void 0,className:ze("recharts-responsive-container",v),style:Y0(Y0({},_),{},{width:s,height:c,minWidth:f,minHeight:d,maxHeight:h}),ref:w},T)}),Ci=function(t){return null};Ci.displayName="Cell";function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function y_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y_(Object(r),!0).forEach(function(n){VX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VX(e,t,r){return t=GX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GX(e){var t=XX(e,"string");return nf(t)=="symbol"?t:t+""}function XX(e,t){if(nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ro={widthCache:{},cacheCount:0},KX=2e3,qX={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},b_="recharts_measurement_span";function YX(e){var t=Bv({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var bu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||No.isSsr)return{width:0,height:0};var n=YX(r),a=JSON.stringify({text:t,copyStyle:n});if(Ro.widthCache[a])return Ro.widthCache[a];try{var i=document.getElementById(b_);i||(i=document.createElement("span"),i.setAttribute("id",b_),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=Bv(Bv({},qX),n);Object.assign(i.style,s),i.textContent="".concat(t);var o=i.getBoundingClientRect(),c={width:o.width,height:o.height};return Ro.widthCache[a]=c,++Ro.cacheCount>KX&&(Ro.cacheCount=0,Ro.widthCache={}),c}catch{return{width:0,height:0}}},QX=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function wh(e,t){return tK(e)||eK(e,t)||JX(e,t)||ZX()}function ZX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JX(e,t){if(e){if(typeof e=="string")return w_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w_(e,t)}}function w_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function tK(e){if(Array.isArray(e))return e}function rK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aK(n.key),n)}}function nK(e,t,r){return t&&S_(e.prototype,t),r&&S_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aK(e){var t=iK(e,"string");return af(t)=="symbol"?t:t+""}function iK(e,t){if(af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var __=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,k_=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,sK=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,oK=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,g3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},lK=Object.keys(g3),ol="NaN";function cK(e,t){return e*g3[t]}var Q0=function(){function e(t,r){rK(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!sK.test(r)&&(this.num=NaN,this.unit=""),lK.includes(r)&&(this.num=cK(t,r),this.unit="px")}return nK(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=oK.exec(r))!==null&&n!==void 0?n:[],i=wh(a,3),s=i[1],o=i[2];return new e(parseFloat(s),o??"")}}])}();function v3(e){if(e.includes(ol))return ol;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=__.exec(t))!==null&&r!==void 0?r:[],a=wh(n,4),i=a[1],s=a[2],o=a[3],c=Q0.parse(i??""),u=Q0.parse(o??""),f=s==="*"?c.multiply(u):c.divide(u);if(f.isNaN())return ol;t=t.replace(__,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,h=(d=k_.exec(t))!==null&&d!==void 0?d:[],p=wh(h,4),m=p[1],g=p[2],y=p[3],v=Q0.parse(m??""),b=Q0.parse(y??""),x=g==="+"?v.add(b):v.subtract(b);if(x.isNaN())return ol;t=t.replace(k_,x.toString())}return t}var N_=/\(([^()]*)\)/;function uK(e){for(var t=e;t.includes("(");){var r=N_.exec(t),n=wh(r,2),a=n[1];t=t.replace(N_,v3(a))}return t}function fK(e){var t=e.replace(/\s+/g,"");return t=uK(t),t=v3(t),t}function dK(e){try{return fK(e)}catch{return ol}}function Bm(e){var t=dK(e.slice(5,-1));return t===ol?"":t}var hK=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],pK=["dx","dy","angle","className","breakAll"];function Uv(){return Uv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uv.apply(this,arguments)}function j_(e,t){if(e==null)return{};var r=xK(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xK(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function E_(e,t){return yK(e)||vK(e,t)||gK(e,t)||mK()}function mK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gK(e,t){if(e){if(typeof e=="string")return T_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T_(e,t)}}function T_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function yK(e){if(Array.isArray(e))return e}var y3=/[ \f\n\r\t\v\u2028\u2029]+/,b3=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];$e(r)||(n?i=r.toString().split(""):i=r.toString().split(y3));var s=i.map(function(c){return{word:c,width:bu(c,a).width}}),o=n?0:bu("",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},bK=function(t,r,n,a,i){var s=t.maxLines,o=t.children,c=t.style,u=t.breakAll,f=ge(s),d=o,h=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce(function(W,Y){var K=Y.word,D=Y.width,Z=W[W.length-1];if(Z&&(a==null||i||Z.width+D+n<Number(a)))Z.words.push(K),Z.width+=D+n;else{var ee={words:[K],width:D};W.push(ee)}return W},[])},p=h(r),m=function(M){return M.reduce(function(W,Y){return W.width>Y.width?W:Y})};if(!f)return p;for(var g="",y=function(M){var W=d.slice(0,M),Y=b3({breakAll:u,style:c,children:W+g}).wordsWithComputedWidth,K=h(Y),D=K.length>s||m(K).width>Number(a);return[D,K]},v=0,b=d.length-1,x=0,_;v<=b&&x<=d.length-1;){var w=Math.floor((v+b)/2),S=w-1,k=y(S),N=E_(k,2),j=N[0],E=N[1],A=y(w),T=E_(A,1),F=T[0];if(!j&&!F&&(v=w+1),j&&F&&(b=w-1),!j&&F){_=E;break}x++}return _||p},A_=function(t){var r=$e(t)?[]:t.toString().split(y3);return[{words:r}]},wK=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,o=t.maxLines;if((r||n)&&!No.isSsr){var c,u,f=b3({breakAll:s,children:a,style:i});if(f){var d=f.wordsWithComputedWidth,h=f.spaceWidth;c=d,u=h}else return A_(a);return bK({breakAll:s,children:a,maxLines:o,style:i},c,u,r,n)}return A_(a)},O_="#808080",uo=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,o=s===void 0?"1em":s,c=t.capHeight,u=c===void 0?"0.71em":c,f=t.scaleToFit,d=f===void 0?!1:f,h=t.textAnchor,p=h===void 0?"start":h,m=t.verticalAnchor,g=m===void 0?"end":m,y=t.fill,v=y===void 0?O_:y,b=j_(t,hK),x=H.useMemo(function(){return wK({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:d,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,d,b.style,b.width]),_=b.dx,w=b.dy,S=b.angle,k=b.className,N=b.breakAll,j=j_(b,pK);if(!cr(n)||!cr(i))return null;var E=n+(ge(_)?_:0),A=i+(ge(w)?w:0),T;switch(g){case"start":T=Bm("calc(".concat(u,")"));break;case"middle":T=Bm("calc(".concat((x.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:T=Bm("calc(".concat(x.length-1," * -").concat(o,")"));break}var F=[];if(d){var G=x[0].width,M=b.width;F.push("scale(".concat((ge(M)?M/G:1)/G,")"))}return S&&F.push("rotate(".concat(S,", ").concat(E,", ").concat(A,")")),F.length&&(j.transform=F.join(" ")),q.createElement("text",Uv({},Ce(j,!0),{x:E,y:A,className:ze("recharts-text",k),textAnchor:p,fill:v.includes("url")?O_:v}),x.map(function(W,Y){var K=W.words.join(N?"":" ");return q.createElement("tspan",{x:E,dy:Y===0?T:o,key:"".concat(K,"-").concat(Y)},K)}))};function ns(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function SK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sb(e){let t,r,n;e.length!==2?(t=ns,r=(o,c)=>ns(e(o),c),n=(o,c)=>e(o)-c):(t=e===ns||e===SK?e:_K,r=e,n=e);function a(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<0?u=d+1:f=d}while(u<f)}return u}function i(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<=0?u=d+1:f=d}while(u<f)}return u}function s(o,c,u=0,f=o.length){const d=a(o,c,u,f-1);return d>u&&n(o[d-1],c)>-n(o[d],c)?d-1:d}return{left:a,center:s,right:i}}function _K(){return 0}function w3(e){return e===null?NaN:+e}function*kK(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const NK=Sb(ns),c0=NK.right;Sb(w3).center;class C_ extends Map{constructor(t,r=TK){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(P_(this,t))}has(t){return super.has(P_(this,t))}set(t,r){return super.set(jK(this,t),r)}delete(t){return super.delete(EK(this,t))}}function P_({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function jK({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function EK({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function TK(e){return e!==null&&typeof e=="object"?e.valueOf():e}function AK(e=ns){if(e===ns)return S3;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function S3(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const OK=Math.sqrt(50),CK=Math.sqrt(10),PK=Math.sqrt(2);function Sh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=OK?10:i>=CK?5:i>=PK?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Sh(e,t,r*2):[o,c,u]}function zv(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?Sh(t,e,r):Sh(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function Wv(e,t,r){return t=+t,e=+e,r=+r,Sh(e,t,r)[2]}function Hv(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Wv(t,e,r):Wv(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function M_(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function F_(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function _3(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?S3:AK(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,f=Math.log(c),d=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*d*(c-d)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*d/c+h)),m=Math.min(n,Math.floor(t+(c-u)*d/c+h));_3(e,t,p,m,a)}const i=e[t];let s=r,o=n;for(Hc(e,r,t),a(e[n],i)>0&&Hc(e,r,n);s<o;){for(Hc(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Hc(e,r,o):(++o,Hc(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Hc(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function MK(e,t,r){if(e=Float64Array.from(kK(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return F_(e);if(t>=1)return M_(e);var n,a=(n-1)*t,i=Math.floor(a),s=M_(_3(e,i).subarray(0,i+1)),o=F_(e.subarray(i+1));return s+(o-s)*(a-i)}}function FK(e,t,r=w3){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function DK(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ha(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Pi(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Vv=Symbol("implicit");function _b(){var e=new C_,t=[],r=[],n=Vv;function a(i){let s=e.get(i);if(s===void 0){if(n!==Vv)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new C_;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return _b(t,r).unknown(n)},ha.apply(a,arguments),a}function sf(){var e=_b().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,f=.5;delete e.unknown;function d(){var h=t().length,p=a<n,m=p?a:n,g=p?n:a;i=(g-m)/Math.max(1,h-c+u*2),o&&(i=Math.floor(i)),m+=(g-m-i*(h-c))*f,s=i*(1-c),o&&(m=Math.round(m),s=Math.round(s));var y=DK(h).map(function(v){return m+i*v});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,d()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,o=!0,d()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(o=!!h,d()):o},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),d()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),d()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,d()):u},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),d()):f},e.copy=function(){return sf(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(f)},ha.apply(d(),arguments)}function k3(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return k3(t())},e}function wu(){return k3(sf.apply(null,arguments).paddingInner(1))}function kb(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function N3(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function u0(){}var of=.7,_h=1/of,bl="\\s*([+-]?\\d+)\\s*",lf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IK=/^#([0-9a-f]{3,8})$/,RK=new RegExp(`^rgb\\(${bl},${bl},${bl}\\)$`),$K=new RegExp(`^rgb\\(${Xa},${Xa},${Xa}\\)$`),LK=new RegExp(`^rgba\\(${bl},${bl},${bl},${lf}\\)$`),BK=new RegExp(`^rgba\\(${Xa},${Xa},${Xa},${lf}\\)$`),UK=new RegExp(`^hsl\\(${lf},${Xa},${Xa}\\)$`),zK=new RegExp(`^hsla\\(${lf},${Xa},${Xa},${lf}\\)$`),D_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};kb(u0,cf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:I_,formatHex:I_,formatHex8:WK,formatHsl:HK,formatRgb:R_,toString:R_});function I_(){return this.rgb().formatHex()}function WK(){return this.rgb().formatHex8()}function HK(){return j3(this).formatHsl()}function R_(){return this.rgb().formatRgb()}function cf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=IK.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?$_(t):r===3?new hn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Z0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Z0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=RK.exec(e))?new hn(t[1],t[2],t[3],1):(t=$K.exec(e))?new hn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=LK.exec(e))?Z0(t[1],t[2],t[3],t[4]):(t=BK.exec(e))?Z0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=UK.exec(e))?U_(t[1],t[2]/100,t[3]/100,1):(t=zK.exec(e))?U_(t[1],t[2]/100,t[3]/100,t[4]):D_.hasOwnProperty(e)?$_(D_[e]):e==="transparent"?new hn(NaN,NaN,NaN,0):null}function $_(e){return new hn(e>>16&255,e>>8&255,e&255,1)}function Z0(e,t,r,n){return n<=0&&(e=t=r=NaN),new hn(e,t,r,n)}function VK(e){return e instanceof u0||(e=cf(e)),e?(e=e.rgb(),new hn(e.r,e.g,e.b,e.opacity)):new hn}function Gv(e,t,r,n){return arguments.length===1?VK(e):new hn(e,t,r,n??1)}function hn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}kb(hn,Gv,N3(u0,{brighter(e){return e=e==null?_h:Math.pow(_h,e),new hn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?of:Math.pow(of,e),new hn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new hn(Qs(this.r),Qs(this.g),Qs(this.b),kh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:L_,formatHex:L_,formatHex8:GK,formatRgb:B_,toString:B_}));function L_(){return`#${Vs(this.r)}${Vs(this.g)}${Vs(this.b)}`}function GK(){return`#${Vs(this.r)}${Vs(this.g)}${Vs(this.b)}${Vs((isNaN(this.opacity)?1:this.opacity)*255)}`}function B_(){const e=kh(this.opacity);return`${e===1?"rgb(":"rgba("}${Qs(this.r)}, ${Qs(this.g)}, ${Qs(this.b)}${e===1?")":`, ${e})`}`}function kh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Qs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vs(e){return e=Qs(e),(e<16?"0":"")+e.toString(16)}function U_(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Na(e,t,r,n)}function j3(e){if(e instanceof Na)return new Na(e.h,e.s,e.l,e.opacity);if(e instanceof u0||(e=cf(e)),!e)return new Na;if(e instanceof Na)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new Na(s,o,c,e.opacity)}function XK(e,t,r,n){return arguments.length===1?j3(e):new Na(e,t,r,n??1)}function Na(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}kb(Na,XK,N3(u0,{brighter(e){return e=e==null?_h:Math.pow(_h,e),new Na(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?of:Math.pow(of,e),new Na(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new hn(Um(e>=240?e-240:e+120,a,n),Um(e,a,n),Um(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Na(z_(this.h),J0(this.s),J0(this.l),kh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=kh(this.opacity);return`${e===1?"hsl(":"hsla("}${z_(this.h)}, ${J0(this.s)*100}%, ${J0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function z_(e){return e=(e||0)%360,e<0?e+360:e}function J0(e){return Math.max(0,Math.min(1,e||0))}function Um(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Nb=e=>()=>e;function KK(e,t){return function(r){return e+r*t}}function qK(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function YK(e){return(e=+e)==1?E3:function(t,r){return r-t?qK(t,r,e):Nb(isNaN(t)?r:t)}}function E3(e,t){var r=t-e;return r?KK(e,r):Nb(isNaN(e)?t:e)}const W_=function e(t){var r=YK(t);function n(a,i){var s=r((a=Gv(a)).r,(i=Gv(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=E3(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=c(f),a.opacity=u(f),a+""}}return n.gamma=e,n}(1);function QK(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function ZK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function JK(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=_c(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function eq(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Nh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function tq(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=_c(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Xv=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zm=new RegExp(Xv.source,"g");function rq(e){return function(){return e}}function nq(e){return function(t){return e(t)+""}}function aq(e,t){var r=Xv.lastIndex=zm.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=Xv.exec(e))&&(a=zm.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:Nh(n,a)})),r=zm.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?nq(c[0].x):rq(t):(t=c.length,function(u){for(var f=0,d;f<t;++f)o[(d=c[f]).i]=d.x(u);return o.join("")})}function _c(e,t){var r=typeof t,n;return t==null||r==="boolean"?Nb(t):(r==="number"?Nh:r==="string"?(n=cf(t))?(t=n,W_):aq:t instanceof cf?W_:t instanceof Date?eq:ZK(t)?QK:Array.isArray(t)?JK:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?tq:Nh)(e,t)}function jb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function iq(e,t){t===void 0&&(t=e,e=_c);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function sq(e){return function(){return e}}function jh(e){return+e}var H_=[0,1];function nn(e){return e}function Kv(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:sq(isNaN(t)?NaN:.5)}function oq(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function lq(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=Kv(a,n),i=r(s,i)):(n=Kv(n,a),i=r(i,s)),function(o){return i(n(o))}}function cq(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=Kv(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=c0(e,o,1,n)-1;return i[c](a[c](o))}}function f0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bx(){var e=H_,t=H_,r=_c,n,a,i,s=nn,o,c,u;function f(){var h=Math.min(e.length,t.length);return s!==nn&&(s=oq(e[0],e[h-1])),o=h>2?cq:lq,c=u=null,d}function d(h){return h==null||isNaN(h=+h)?i:(c||(c=o(e.map(n),t,r)))(n(s(h)))}return d.invert=function(h){return s(a((u||(u=o(t,e.map(n),Nh)))(h)))},d.domain=function(h){return arguments.length?(e=Array.from(h,jh),f()):e.slice()},d.range=function(h){return arguments.length?(t=Array.from(h),f()):t.slice()},d.rangeRound=function(h){return t=Array.from(h),r=jb,f()},d.clamp=function(h){return arguments.length?(s=h?!0:nn,f()):s!==nn},d.interpolate=function(h){return arguments.length?(r=h,f()):r},d.unknown=function(h){return arguments.length?(i=h,d):i},function(h,p){return n=h,a=p,f()}}function Eb(){return bx()(nn,nn)}function uq(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Eh(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function $l(e){return e=Eh(Math.abs(e)),e?e[1]:NaN}function fq(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function dq(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var hq=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uf(e){if(!(t=hq.exec(e)))throw new Error("invalid format: "+e);var t;return new Tb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}uf.prototype=Tb.prototype;function Tb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Tb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function pq(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var Th;function xq(e,t){var r=Eh(e,t);if(!r)return Th=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(Th=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Eh(e,Math.max(0,t+i-1))[0]}function V_(e,t){var r=Eh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const G_={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:uq,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>V_(e*100,t),r:V_,s:xq,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function X_(e){return e}var K_=Array.prototype.map,q_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function mq(e){var t=e.grouping===void 0||e.thousands===void 0?X_:fq(K_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?X_:dq(K_.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(d,h){d=uf(d);var p=d.fill,m=d.align,g=d.sign,y=d.symbol,v=d.zero,b=d.width,x=d.comma,_=d.precision,w=d.trim,S=d.type;S==="n"?(x=!0,S="g"):G_[S]||(_===void 0&&(_=12),w=!0,S="g"),(v||p==="0"&&m==="=")&&(v=!0,p="0",m="=");var k=(h&&h.prefix!==void 0?h.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():""),N=(y==="$"?n:/[%p]/.test(S)?s:"")+(h&&h.suffix!==void 0?h.suffix:""),j=G_[S],E=/[defgprs%]/.test(S);_=_===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function A(T){var F=k,G=N,M,W,Y;if(S==="c")G=j(T)+G,T="";else{T=+T;var K=T<0||1/T<0;if(T=isNaN(T)?c:j(Math.abs(T),_),w&&(T=pq(T)),K&&+T==0&&g!=="+"&&(K=!1),F=(K?g==="("?g:o:g==="-"||g==="("?"":g)+F,G=(S==="s"&&!isNaN(T)&&Th!==void 0?q_[8+Th/3]:"")+G+(K&&g==="("?")":""),E){for(M=-1,W=T.length;++M<W;)if(Y=T.charCodeAt(M),48>Y||Y>57){G=(Y===46?a+T.slice(M+1):T.slice(M))+G,T=T.slice(0,M);break}}}x&&!v&&(T=t(T,1/0));var D=F.length+T.length+G.length,Z=D<b?new Array(b-D+1).join(p):"";switch(x&&v&&(T=t(Z+T,Z.length?b-G.length:1/0),Z=""),m){case"<":T=F+T+G+Z;break;case"=":T=F+Z+T+G;break;case"^":T=Z.slice(0,D=Z.length>>1)+F+T+G+Z.slice(D);break;default:T=Z+F+T+G;break}return i(T)}return A.toString=function(){return d+""},A}function f(d,h){var p=Math.max(-8,Math.min(8,Math.floor($l(h)/3)))*3,m=Math.pow(10,-p),g=u((d=uf(d),d.type="f",d),{suffix:q_[8+p/3]});return function(y){return g(m*y)}}return{format:u,formatPrefix:f}}var ed,Ab,T3;gq({thousands:",",grouping:[3],currency:["$",""]});function gq(e){return ed=mq(e),Ab=ed.format,T3=ed.formatPrefix,ed}function vq(e){return Math.max(0,-$l(Math.abs(e)))}function yq(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($l(t)/3)))*3-$l(Math.abs(e)))}function bq(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$l(t)-$l(e))+1}function A3(e,t,r,n){var a=Hv(e,t,r),i;switch(n=uf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=yq(a,s))&&(n.precision=i),T3(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=bq(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=vq(a))&&(n.precision=i-(n.type==="%")*2);break}}return Ab(n)}function ys(e){var t=e.domain;return e.ticks=function(r){var n=t();return zv(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return A3(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,f=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);f-- >0;){if(u=Wv(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function Ah(){var e=Eb();return e.copy=function(){return f0(e,Ah())},ha.apply(e,arguments),ys(e)}function O3(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,jh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return O3(e).unknown(t)},e=arguments.length?Array.from(e,jh):[0,1],ys(r)}function C3(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Y_(e){return Math.log(e)}function Q_(e){return Math.exp(e)}function wq(e){return-Math.log(-e)}function Sq(e){return-Math.exp(-e)}function _q(e){return isFinite(e)?+("1e"+e):e<0?0:e}function kq(e){return e===10?_q:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Nq(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Z_(e){return(t,r)=>-e(-t,r)}function Ob(e){const t=e(Y_,Q_),r=t.domain;let n=10,a,i;function s(){return a=Nq(n),i=kq(n),r()[0]<0?(a=Z_(a),i=Z_(i),e(wq,Sq)):e(Y_,Q_),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],f=c[c.length-1];const d=f<u;d&&([u,f]=[f,u]);let h=a(u),p=a(f),m,g;const y=o==null?10:+o;let v=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(m=1;m<n;++m)if(g=h<0?m/i(-h):m*i(h),!(g<u)){if(g>f)break;v.push(g)}}else for(;h<=p;++h)for(m=n-1;m>=1;--m)if(g=h>0?m/i(-h):m*i(h),!(g<u)){if(g>f)break;v.push(g)}v.length*2<y&&(v=zv(u,f,y))}else v=zv(h,p,Math.min(p-h,y)).map(i);return d?v.reverse():v},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=uf(c)).precision==null&&(c.trim=!0),c=Ab(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=u?c(f):""}},t.nice=()=>r(C3(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function P3(){const e=Ob(bx()).domain([1,10]);return e.copy=()=>f0(e,P3()).base(e.base()),ha.apply(e,arguments),e}function J_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function ek(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Cb(e){var t=1,r=e(J_(t),ek(t));return r.constant=function(n){return arguments.length?e(J_(t=+n),ek(t)):t},ys(r)}function M3(){var e=Cb(bx());return e.copy=function(){return f0(e,M3()).constant(e.constant())},ha.apply(e,arguments)}function tk(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function jq(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Eq(e){return e<0?-e*e:e*e}function Pb(e){var t=e(nn,nn),r=1;function n(){return r===1?e(nn,nn):r===.5?e(jq,Eq):e(tk(r),tk(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ys(t)}function Mb(){var e=Pb(bx());return e.copy=function(){return f0(e,Mb()).exponent(e.exponent())},ha.apply(e,arguments),e}function Tq(){return Mb.apply(null,arguments).exponent(.5)}function rk(e){return Math.sign(e)*e*e}function Aq(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function F3(){var e=Eb(),t=[0,1],r=!1,n;function a(i){var s=Aq(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(rk(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,jh)).map(rk)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return F3(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ha.apply(a,arguments),ys(a)}function D3(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=FK(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[c0(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ns),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return D3().domain(e).range(t).unknown(n)},ha.apply(i,arguments)}function I3(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[c0(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return I3().domain([e,t]).range(a).unknown(i)},ha.apply(ys(s),arguments)}function R3(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[c0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return R3().domain(e).range(t).unknown(r)},ha.apply(a,arguments)}const Wm=new Date,Hm=new Date;function dr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>dr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Wm.setTime(+i),Hm.setTime(+s),e(Wm),e(Hm),Math.floor(r(Wm,Hm))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Oh=dr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Oh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?dr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Oh);Oh.range;const ui=1e3,ea=ui*60,fi=ea*60,ki=fi*24,Fb=ki*7,nk=ki*30,Vm=ki*365,Gs=dr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ui)},(e,t)=>(t-e)/ui,e=>e.getUTCSeconds());Gs.range;const Db=dr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ui)},(e,t)=>{e.setTime(+e+t*ea)},(e,t)=>(t-e)/ea,e=>e.getMinutes());Db.range;const Ib=dr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ea)},(e,t)=>(t-e)/ea,e=>e.getUTCMinutes());Ib.range;const Rb=dr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ui-e.getMinutes()*ea)},(e,t)=>{e.setTime(+e+t*fi)},(e,t)=>(t-e)/fi,e=>e.getHours());Rb.range;const $b=dr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*fi)},(e,t)=>(t-e)/fi,e=>e.getUTCHours());$b.range;const d0=dr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ea)/ki,e=>e.getDate()-1);d0.range;const wx=dr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ki,e=>e.getUTCDate()-1);wx.range;const $3=dr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ki,e=>Math.floor(e/ki));$3.range;function jo(e){return dr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ea)/Fb)}const Sx=jo(0),Ch=jo(1),Oq=jo(2),Cq=jo(3),Ll=jo(4),Pq=jo(5),Mq=jo(6);Sx.range;Ch.range;Oq.range;Cq.range;Ll.range;Pq.range;Mq.range;function Eo(e){return dr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Fb)}const _x=Eo(0),Ph=Eo(1),Fq=Eo(2),Dq=Eo(3),Bl=Eo(4),Iq=Eo(5),Rq=Eo(6);_x.range;Ph.range;Fq.range;Dq.range;Bl.range;Iq.range;Rq.range;const Lb=dr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Lb.range;const Bb=dr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Bb.range;const Ni=dr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ni.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:dr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ni.range;const ji=dr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ji.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:dr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ji.range;function L3(e,t,r,n,a,i){const s=[[Gs,1,ui],[Gs,5,5*ui],[Gs,15,15*ui],[Gs,30,30*ui],[i,1,ea],[i,5,5*ea],[i,15,15*ea],[i,30,30*ea],[a,1,fi],[a,3,3*fi],[a,6,6*fi],[a,12,12*fi],[n,1,ki],[n,2,2*ki],[r,1,Fb],[t,1,nk],[t,3,3*nk],[e,1,Vm]];function o(u,f,d){const h=f<u;h&&([u,f]=[f,u]);const p=d&&typeof d.range=="function"?d:c(u,f,d),m=p?p.range(u,+f+1):[];return h?m.reverse():m}function c(u,f,d){const h=Math.abs(f-u)/d,p=Sb(([,,y])=>y).right(s,h);if(p===s.length)return e.every(Hv(u/Vm,f/Vm,d));if(p===0)return Oh.every(Math.max(Hv(u,f,d),1));const[m,g]=s[h/s[p-1][2]<s[p][2]/h?p-1:p];return m.every(g)}return[o,c]}const[$q,Lq]=L3(ji,Bb,_x,$3,$b,Ib),[Bq,Uq]=L3(Ni,Lb,Sx,d0,Rb,Db);function Gm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Xm(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Vc(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function zq(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=Gc(a),f=Xc(a),d=Gc(i),h=Xc(i),p=Gc(s),m=Xc(s),g=Gc(o),y=Xc(o),v=Gc(c),b=Xc(c),x={a:Y,A:K,b:D,B:Z,c:null,d:ck,e:ck,f:fY,g:wY,G:_Y,H:lY,I:cY,j:uY,L:B3,m:dY,M:hY,p:ee,q:O,Q:dk,s:hk,S:pY,u:xY,U:mY,V:gY,w:vY,W:yY,x:null,X:null,y:bY,Y:SY,Z:kY,"%":fk},_={a:L,A:R,b:X,B:J,c:null,d:uk,e:uk,f:TY,g:$Y,G:BY,H:NY,I:jY,j:EY,L:z3,m:AY,M:OY,p:le,q:se,Q:dk,s:hk,S:CY,u:PY,U:MY,V:FY,w:DY,W:IY,x:null,X:null,y:RY,Y:LY,Z:UY,"%":fk},w={a:E,A,b:T,B:F,c:G,d:ok,e:ok,f:aY,g:sk,G:ik,H:lk,I:lk,j:eY,L:nY,m:Jq,M:tY,p:j,q:Zq,Q:sY,s:oY,S:rY,u:Xq,U:Kq,V:qq,w:Gq,W:Yq,x:M,X:W,y:sk,Y:ik,Z:Qq,"%":iY};x.x=S(r,x),x.X=S(n,x),x.c=S(t,x),_.x=S(r,_),_.X=S(n,_),_.c=S(t,_);function S(Q,te){return function(fe){var P=[],ke=-1,be=0,Te=Q.length,Ae,he,We;for(fe instanceof Date||(fe=new Date(+fe));++ke<Te;)Q.charCodeAt(ke)===37&&(P.push(Q.slice(be,ke)),(he=ak[Ae=Q.charAt(++ke)])!=null?Ae=Q.charAt(++ke):he=Ae==="e"?" ":"0",(We=te[Ae])&&(Ae=We(fe,he)),P.push(Ae),be=ke+1);return P.push(Q.slice(be,ke)),P.join("")}}function k(Q,te){return function(fe){var P=Vc(1900,void 0,1),ke=N(P,Q,fe+="",0),be,Te;if(ke!=fe.length)return null;if("Q"in P)return new Date(P.Q);if("s"in P)return new Date(P.s*1e3+("L"in P?P.L:0));if(te&&!("Z"in P)&&(P.Z=0),"p"in P&&(P.H=P.H%12+P.p*12),P.m===void 0&&(P.m="q"in P?P.q:0),"V"in P){if(P.V<1||P.V>53)return null;"w"in P||(P.w=1),"Z"in P?(be=Xm(Vc(P.y,0,1)),Te=be.getUTCDay(),be=Te>4||Te===0?Ph.ceil(be):Ph(be),be=wx.offset(be,(P.V-1)*7),P.y=be.getUTCFullYear(),P.m=be.getUTCMonth(),P.d=be.getUTCDate()+(P.w+6)%7):(be=Gm(Vc(P.y,0,1)),Te=be.getDay(),be=Te>4||Te===0?Ch.ceil(be):Ch(be),be=d0.offset(be,(P.V-1)*7),P.y=be.getFullYear(),P.m=be.getMonth(),P.d=be.getDate()+(P.w+6)%7)}else("W"in P||"U"in P)&&("w"in P||(P.w="u"in P?P.u%7:"W"in P?1:0),Te="Z"in P?Xm(Vc(P.y,0,1)).getUTCDay():Gm(Vc(P.y,0,1)).getDay(),P.m=0,P.d="W"in P?(P.w+6)%7+P.W*7-(Te+5)%7:P.w+P.U*7-(Te+6)%7);return"Z"in P?(P.H+=P.Z/100|0,P.M+=P.Z%100,Xm(P)):Gm(P)}}function N(Q,te,fe,P){for(var ke=0,be=te.length,Te=fe.length,Ae,he;ke<be;){if(P>=Te)return-1;if(Ae=te.charCodeAt(ke++),Ae===37){if(Ae=te.charAt(ke++),he=w[Ae in ak?te.charAt(ke++):Ae],!he||(P=he(Q,fe,P))<0)return-1}else if(Ae!=fe.charCodeAt(P++))return-1}return P}function j(Q,te,fe){var P=u.exec(te.slice(fe));return P?(Q.p=f.get(P[0].toLowerCase()),fe+P[0].length):-1}function E(Q,te,fe){var P=p.exec(te.slice(fe));return P?(Q.w=m.get(P[0].toLowerCase()),fe+P[0].length):-1}function A(Q,te,fe){var P=d.exec(te.slice(fe));return P?(Q.w=h.get(P[0].toLowerCase()),fe+P[0].length):-1}function T(Q,te,fe){var P=v.exec(te.slice(fe));return P?(Q.m=b.get(P[0].toLowerCase()),fe+P[0].length):-1}function F(Q,te,fe){var P=g.exec(te.slice(fe));return P?(Q.m=y.get(P[0].toLowerCase()),fe+P[0].length):-1}function G(Q,te,fe){return N(Q,t,te,fe)}function M(Q,te,fe){return N(Q,r,te,fe)}function W(Q,te,fe){return N(Q,n,te,fe)}function Y(Q){return s[Q.getDay()]}function K(Q){return i[Q.getDay()]}function D(Q){return c[Q.getMonth()]}function Z(Q){return o[Q.getMonth()]}function ee(Q){return a[+(Q.getHours()>=12)]}function O(Q){return 1+~~(Q.getMonth()/3)}function L(Q){return s[Q.getUTCDay()]}function R(Q){return i[Q.getUTCDay()]}function X(Q){return c[Q.getUTCMonth()]}function J(Q){return o[Q.getUTCMonth()]}function le(Q){return a[+(Q.getUTCHours()>=12)]}function se(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var te=S(Q+="",x);return te.toString=function(){return Q},te},parse:function(Q){var te=k(Q+="",!1);return te.toString=function(){return Q},te},utcFormat:function(Q){var te=S(Q+="",_);return te.toString=function(){return Q},te},utcParse:function(Q){var te=k(Q+="",!0);return te.toString=function(){return Q},te}}}var ak={"-":"",_:" ",0:"0"},_r=/^\s*\d+/,Wq=/^%/,Hq=/[\\^$*+?|[\]().{}]/g;function et(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Vq(e){return e.replace(Hq,"\\$&")}function Gc(e){return new RegExp("^(?:"+e.map(Vq).join("|")+")","i")}function Xc(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Gq(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Xq(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Kq(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function qq(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Yq(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ik(e,t,r){var n=_r.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function sk(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Qq(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Zq(e,t,r){var n=_r.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Jq(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function ok(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function eY(e,t,r){var n=_r.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function lk(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function tY(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function rY(e,t,r){var n=_r.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function nY(e,t,r){var n=_r.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function aY(e,t,r){var n=_r.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function iY(e,t,r){var n=Wq.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function sY(e,t,r){var n=_r.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function oY(e,t,r){var n=_r.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function ck(e,t){return et(e.getDate(),t,2)}function lY(e,t){return et(e.getHours(),t,2)}function cY(e,t){return et(e.getHours()%12||12,t,2)}function uY(e,t){return et(1+d0.count(Ni(e),e),t,3)}function B3(e,t){return et(e.getMilliseconds(),t,3)}function fY(e,t){return B3(e,t)+"000"}function dY(e,t){return et(e.getMonth()+1,t,2)}function hY(e,t){return et(e.getMinutes(),t,2)}function pY(e,t){return et(e.getSeconds(),t,2)}function xY(e){var t=e.getDay();return t===0?7:t}function mY(e,t){return et(Sx.count(Ni(e)-1,e),t,2)}function U3(e){var t=e.getDay();return t>=4||t===0?Ll(e):Ll.ceil(e)}function gY(e,t){return e=U3(e),et(Ll.count(Ni(e),e)+(Ni(e).getDay()===4),t,2)}function vY(e){return e.getDay()}function yY(e,t){return et(Ch.count(Ni(e)-1,e),t,2)}function bY(e,t){return et(e.getFullYear()%100,t,2)}function wY(e,t){return e=U3(e),et(e.getFullYear()%100,t,2)}function SY(e,t){return et(e.getFullYear()%1e4,t,4)}function _Y(e,t){var r=e.getDay();return e=r>=4||r===0?Ll(e):Ll.ceil(e),et(e.getFullYear()%1e4,t,4)}function kY(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+et(t/60|0,"0",2)+et(t%60,"0",2)}function uk(e,t){return et(e.getUTCDate(),t,2)}function NY(e,t){return et(e.getUTCHours(),t,2)}function jY(e,t){return et(e.getUTCHours()%12||12,t,2)}function EY(e,t){return et(1+wx.count(ji(e),e),t,3)}function z3(e,t){return et(e.getUTCMilliseconds(),t,3)}function TY(e,t){return z3(e,t)+"000"}function AY(e,t){return et(e.getUTCMonth()+1,t,2)}function OY(e,t){return et(e.getUTCMinutes(),t,2)}function CY(e,t){return et(e.getUTCSeconds(),t,2)}function PY(e){var t=e.getUTCDay();return t===0?7:t}function MY(e,t){return et(_x.count(ji(e)-1,e),t,2)}function W3(e){var t=e.getUTCDay();return t>=4||t===0?Bl(e):Bl.ceil(e)}function FY(e,t){return e=W3(e),et(Bl.count(ji(e),e)+(ji(e).getUTCDay()===4),t,2)}function DY(e){return e.getUTCDay()}function IY(e,t){return et(Ph.count(ji(e)-1,e),t,2)}function RY(e,t){return et(e.getUTCFullYear()%100,t,2)}function $Y(e,t){return e=W3(e),et(e.getUTCFullYear()%100,t,2)}function LY(e,t){return et(e.getUTCFullYear()%1e4,t,4)}function BY(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Bl(e):Bl.ceil(e),et(e.getUTCFullYear()%1e4,t,4)}function UY(){return"+0000"}function fk(){return"%"}function dk(e){return+e}function hk(e){return Math.floor(+e/1e3)}var $o,H3,V3;zY({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zY(e){return $o=zq(e),H3=$o.format,$o.parse,V3=$o.utcFormat,$o.utcParse,$o}function WY(e){return new Date(e)}function HY(e){return e instanceof Date?+e:+new Date(+e)}function Ub(e,t,r,n,a,i,s,o,c,u){var f=Eb(),d=f.invert,h=f.domain,p=u(".%L"),m=u(":%S"),g=u("%I:%M"),y=u("%I %p"),v=u("%a %d"),b=u("%b %d"),x=u("%B"),_=u("%Y");function w(S){return(c(S)<S?p:o(S)<S?m:s(S)<S?g:i(S)<S?y:n(S)<S?a(S)<S?v:b:r(S)<S?x:_)(S)}return f.invert=function(S){return new Date(d(S))},f.domain=function(S){return arguments.length?h(Array.from(S,HY)):h().map(WY)},f.ticks=function(S){var k=h();return e(k[0],k[k.length-1],S??10)},f.tickFormat=function(S,k){return k==null?w:u(k)},f.nice=function(S){var k=h();return(!S||typeof S.range!="function")&&(S=t(k[0],k[k.length-1],S??10)),S?h(C3(k,S)):f},f.copy=function(){return f0(f,Ub(e,t,r,n,a,i,s,o,c,u))},f}function VY(){return ha.apply(Ub(Bq,Uq,Ni,Lb,Sx,d0,Rb,Db,Gs,H3).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function GY(){return ha.apply(Ub($q,Lq,ji,Bb,_x,wx,$b,Ib,Gs,V3).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function kx(){var e=0,t=1,r,n,a,i,s=nn,o=!1,c;function u(d){return d==null||isNaN(d=+d)?c:s(a===0?.5:(d=(i(d)-r)*a,o?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(d){return arguments.length?(o=!!d,u):o},u.interpolator=function(d){return arguments.length?(s=d,u):s};function f(d){return function(h){var p,m;return arguments.length?([p,m]=h,s=d(p,m),u):[s(0),s(1)]}}return u.range=f(_c),u.rangeRound=f(jb),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return i=d,r=d(e),n=d(t),a=r===n?0:1/(n-r),u}}function bs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function G3(){var e=ys(kx()(nn));return e.copy=function(){return bs(e,G3())},Pi.apply(e,arguments)}function X3(){var e=Ob(kx()).domain([1,10]);return e.copy=function(){return bs(e,X3()).base(e.base())},Pi.apply(e,arguments)}function K3(){var e=Cb(kx());return e.copy=function(){return bs(e,K3()).constant(e.constant())},Pi.apply(e,arguments)}function zb(){var e=Pb(kx());return e.copy=function(){return bs(e,zb()).exponent(e.exponent())},Pi.apply(e,arguments)}function XY(){return zb.apply(null,arguments).exponent(.5)}function q3(){var e=[],t=nn;function r(n){if(n!=null&&!isNaN(n=+n))return t((c0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ns),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>MK(e,i/n))},r.copy=function(){return q3(t).domain(e)},Pi.apply(r,arguments)}function Nx(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=nn,f,d=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+f(g))-i)*(n*g<n*i?o:c),u(d?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,a=f(e=+e),i=f(t=+t),s=f(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(d=!!g,p):d},p.interpolator=function(g){return arguments.length?(u=g,p):u};function m(g){return function(y){var v,b,x;return arguments.length?([v,b,x]=y,u=iq(g,[v,b,x]),p):[u(0),u(.5),u(1)]}}return p.range=m(_c),p.rangeRound=m(jb),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return f=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function Y3(){var e=ys(Nx()(nn));return e.copy=function(){return bs(e,Y3())},Pi.apply(e,arguments)}function Q3(){var e=Ob(Nx()).domain([.1,1,10]);return e.copy=function(){return bs(e,Q3()).base(e.base())},Pi.apply(e,arguments)}function Z3(){var e=Cb(Nx());return e.copy=function(){return bs(e,Z3()).constant(e.constant())},Pi.apply(e,arguments)}function Wb(){var e=Pb(Nx());return e.copy=function(){return bs(e,Wb()).exponent(e.exponent())},Pi.apply(e,arguments)}function KY(){return Wb.apply(null,arguments).exponent(.5)}const pk=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:sf,scaleDiverging:Y3,scaleDivergingLog:Q3,scaleDivergingPow:Wb,scaleDivergingSqrt:KY,scaleDivergingSymlog:Z3,scaleIdentity:O3,scaleImplicit:Vv,scaleLinear:Ah,scaleLog:P3,scaleOrdinal:_b,scalePoint:wu,scalePow:Mb,scaleQuantile:D3,scaleQuantize:I3,scaleRadial:F3,scaleSequential:G3,scaleSequentialLog:X3,scaleSequentialPow:zb,scaleSequentialQuantile:q3,scaleSequentialSqrt:XY,scaleSequentialSymlog:K3,scaleSqrt:Tq,scaleSymlog:M3,scaleThreshold:R3,scaleTime:VY,scaleUtc:GY,tickFormat:A3},Symbol.toStringTag,{value:"Module"}));var qY=pc;function YY(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(o===void 0?s===s&&!qY(s):r(s,o)))var o=s,c=i}return c}var jx=YY;function QY(e,t){return e>t}var J3=QY,ZY=jx,JY=J3,eQ=Sc;function tQ(e){return e&&e.length?ZY(e,eQ,JY):void 0}var rQ=tQ;const Ex=st(rQ);function nQ(e,t){return e<t}var eO=nQ,aQ=jx,iQ=eO,sQ=Sc;function oQ(e){return e&&e.length?aQ(e,sQ,iQ):void 0}var lQ=oQ;const Tx=st(lQ);var cQ=nb,uQ=ei,fQ=c3,dQ=yn;function hQ(e,t){var r=dQ(e)?cQ:fQ;return r(e,uQ(t))}var pQ=hQ,xQ=o3,mQ=pQ;function gQ(e,t){return xQ(mQ(e,t),1)}var vQ=gQ;const yQ=st(vQ);var bQ=vb;function wQ(e,t){return bQ(e,t)}var SQ=wQ;const h0=st(SQ);var kc=1e9,_Q={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Vb,jt=!0,oa="[DecimalError] ",Zs=oa+"Invalid argument: ",Hb=oa+"Exponent out of range: ",Nc=Math.floor,$s=Math.pow,kQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,En,pr=1e7,yt=7,tO=9007199254740991,Mh=Nc(tO/yt),je={};je.absoluteValue=je.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};je.comparedTo=je.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};je.decimalPlaces=je.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*yt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};je.dividedBy=je.div=function(e){return mi(this,new this.constructor(e))};je.dividedToIntegerBy=je.idiv=function(e){var t=this,r=t.constructor;return ut(mi(t,new r(e),0,1),r.precision)};je.equals=je.eq=function(e){return!this.cmp(e)};je.exponent=function(){return er(this)};je.greaterThan=je.gt=function(e){return this.cmp(e)>0};je.greaterThanOrEqualTo=je.gte=function(e){return this.cmp(e)>=0};je.isInteger=je.isint=function(){return this.e>this.d.length-2};je.isNegative=je.isneg=function(){return this.s<0};je.isPositive=je.ispos=function(){return this.s>0};je.isZero=function(){return this.s===0};je.lessThan=je.lt=function(e){return this.cmp(e)<0};je.lessThanOrEqualTo=je.lte=function(e){return this.cmp(e)<1};je.logarithm=je.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(En))throw Error(oa+"NaN");if(r.s<1)throw Error(oa+(r.s?"NaN":"-Infinity"));return r.eq(En)?new n(0):(jt=!1,t=mi(ff(r,i),ff(e,i),i),jt=!0,ut(t,a))};je.minus=je.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aO(t,e):rO(t,(e.s=-e.s,e))};je.modulo=je.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(oa+"NaN");return r.s?(jt=!1,t=mi(r,e,0,1).times(e),jt=!0,r.minus(t)):ut(new n(r),a)};je.naturalExponential=je.exp=function(){return nO(this)};je.naturalLogarithm=je.ln=function(){return ff(this)};je.negated=je.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};je.plus=je.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rO(t,e):aO(t,(e.s=-e.s,e))};je.precision=je.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Zs+e);if(t=er(a)+1,n=a.d.length-1,r=n*yt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};je.squareRoot=je.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(oa+"NaN")}for(e=er(o),jt=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Wa(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Nc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(mi(o,i,s+2)).times(.5),Wa(i.d).slice(0,s)===(t=Wa(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(ut(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return jt=!0,ut(n,r)};je.times=je.mul=function(e){var t,r,n,a,i,s,o,c,u,f=this,d=f.constructor,h=f.d,p=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,r=f.e+e.e,c=h.length,u=p.length,c<u&&(i=h,h=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+p[n]*h[a-n-1]+t,i[a--]=o%pr|0,t=o/pr|0;i[a]=(i[a]+t)%pr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,jt?ut(e,d.precision):e};je.toDecimalPlaces=je.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ya(e,0,kc),t===void 0?t=n.rounding:Ya(t,0,8),ut(r,e+er(r)+1,t))};je.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=fo(n,!0):(Ya(e,0,kc),t===void 0?t=a.rounding:Ya(t,0,8),n=ut(new a(n),e+1,t),r=fo(n,!0,e+1)),r};je.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?fo(a):(Ya(e,0,kc),t===void 0?t=i.rounding:Ya(t,0,8),n=ut(new i(a),e+er(a)+1,t),r=fo(n.abs(),!1,e+er(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};je.toInteger=je.toint=function(){var e=this,t=e.constructor;return ut(new t(e),er(e)+1,t.rounding)};je.toNumber=function(){return+this};je.toPower=je.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,f=+(e=new c(e));if(!e.s)return new c(En);if(o=new c(o),!o.s){if(e.s<1)throw Error(oa+"Infinity");return o}if(o.eq(En))return o;if(n=c.precision,e.eq(En))return ut(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=f<0?-f:f)<=tO){for(a=new c(En),t=Math.ceil(n/yt+4),jt=!1;r%2&&(a=a.times(o),mk(a.d,t)),r=Nc(r/2),r!==0;)o=o.times(o),mk(o.d,t);return jt=!0,e.s<0?new c(En).div(a):ut(a,n)}}else if(i<0)throw Error(oa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,jt=!1,a=e.times(ff(o,n+u)),jt=!0,a=nO(a),a.s=i,a};je.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=er(a),n=fo(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ya(e,1,kc),t===void 0?t=i.rounding:Ya(t,0,8),a=ut(new i(a),e,t),r=er(a),n=fo(a,e<=r||r<=i.toExpNeg,e)),n};je.toSignificantDigits=je.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ya(e,1,kc),t===void 0?t=n.rounding:Ya(t,0,8)),ut(new n(r),e,t)};je.toString=je.valueOf=je.val=je.toJSON=je[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=er(e),r=e.constructor;return fo(e,t<=r.toExpNeg||t>=r.toExpPos)};function rO(e,t){var r,n,a,i,s,o,c,u,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),jt?ut(t,d):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(d/yt),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/pr|0,c[i]%=pr;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,jt?ut(t,d):t}function Ya(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Zs+e)}function Wa(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=yt-n.length,r&&(i+=Bi(r)),i+=n;s=e[t],n=s+"",r=yt-n.length,r&&(i+=Bi(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var mi=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%pr|0,s=i/pr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*pr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,f,d,h,p,m,g,y,v,b,x,_,w,S,k,N,j=n.constructor,E=n.s==a.s?1:-1,A=n.d,T=a.d;if(!n.s)return new j(n);if(!a.s)throw Error(oa+"Division by zero");for(c=n.e-a.e,k=T.length,w=A.length,p=new j(E),m=p.d=[],u=0;T[u]==(A[u]||0);)++u;if(T[u]>(A[u]||0)&&--c,i==null?b=i=j.precision:s?b=i+(er(n)-er(a))+1:b=i,b<0)return new j(0);if(b=b/yt+2|0,u=0,k==1)for(f=0,T=T[0],b++;(u<w||f)&&b--;u++)x=f*pr+(A[u]||0),m[u]=x/T|0,f=x%T|0;else{for(f=pr/(T[0]+1)|0,f>1&&(T=e(T,f),A=e(A,f),k=T.length,w=A.length),_=k,g=A.slice(0,k),y=g.length;y<k;)g[y++]=0;N=T.slice(),N.unshift(0),S=T[0],T[1]>=pr/2&&++S;do f=0,o=t(T,g,k,y),o<0?(v=g[0],k!=y&&(v=v*pr+(g[1]||0)),f=v/S|0,f>1?(f>=pr&&(f=pr-1),d=e(T,f),h=d.length,y=g.length,o=t(d,g,h,y),o==1&&(f--,r(d,k<h?N:T,h))):(f==0&&(o=f=1),d=T.slice()),h=d.length,h<y&&d.unshift(0),r(g,d,y),o==-1&&(y=g.length,o=t(T,g,k,y),o<1&&(f++,r(g,k<y?N:T,y))),y=g.length):o===0&&(f++,g=[0]),m[u++]=f,o&&g[0]?g[y++]=A[_]||0:(g=[A[_]],y=1);while((_++<w||g[0]!==void 0)&&b--)}return m[0]||m.shift(),p.e=c,ut(p,s?i+er(p)+1:i)}}();function nO(e,t){var r,n,a,i,s,o,c=0,u=0,f=e.constructor,d=f.precision;if(er(e)>16)throw Error(Hb+er(e));if(!e.s)return new f(En);for(jt=!1,o=d,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log($s(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new f(En),f.precision=o;;){if(a=ut(a.times(e),o),r=r.times(++c),s=i.plus(mi(a,r,o)),Wa(s.d).slice(0,o)===Wa(i.d).slice(0,o)){for(;u--;)i=ut(i.times(i),o);return f.precision=d,t==null?(jt=!0,ut(i,d)):i}i=s}}function er(e){for(var t=e.e*yt,r=e.d[0];r>=10;r/=10)t++;return t}function Km(e,t,r){if(t>e.LN10.sd())throw jt=!0,r&&(e.precision=r),Error(oa+"LN10 precision limit exceeded");return ut(new e(e.LN10),t)}function Bi(e){for(var t="";e--;)t+="0";return t}function ff(e,t){var r,n,a,i,s,o,c,u,f,d=1,h=10,p=e,m=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(oa+(p.s?"NaN":"-Infinity"));if(p.eq(En))return new g(0);if(t==null?(jt=!1,u=y):u=t,p.eq(10))return t==null&&(jt=!0),Km(g,u);if(u+=h,g.precision=u,r=Wa(m),n=r.charAt(0),i=er(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Wa(p.d),n=r.charAt(0),d++;i=er(p),n>1?(p=new g("0."+r),i++):p=new g(n+"."+r.slice(1))}else return c=Km(g,u+2,y).times(i+""),p=ff(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=y,t==null?(jt=!0,ut(p,y)):p;for(o=s=p=mi(p.minus(En),p.plus(En),u),f=ut(p.times(p),u),a=3;;){if(s=ut(s.times(f),u),c=o.plus(mi(s,new g(a),u)),Wa(c.d).slice(0,u)===Wa(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Km(g,u+2,y).times(i+""))),o=mi(o,new g(d),u),g.precision=y,t==null?(jt=!0,ut(o,y)):o;o=c,a+=2}}function xk(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=Nc(r/yt),e.d=[],n=(r+1)%yt,r<0&&(n+=yt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=yt;n<a;)e.d.push(+t.slice(n,n+=yt));t=t.slice(n),n=yt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),jt&&(e.e>Mh||e.e<-Mh))throw Error(Hb+r)}else e.s=0,e.e=0,e.d=[0];return e}function ut(e,t,r){var n,a,i,s,o,c,u,f,d=e.d;for(s=1,i=d[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=yt,a=t,u=d[f=0];else{if(f=Math.ceil((n+1)/yt),i=d.length,f>=i)return e;for(u=i=d[f],s=1;i>=10;i/=10)s++;n%=yt,a=n-yt+s}if(r!==void 0&&(i=$s(10,s-a-1),o=u/i%10|0,c=t<0||d[f+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/$s(10,s-a):0:d[f-1])%10&1||r==(e.s<0?8:7))),t<1||!d[0])return c?(i=er(e),d.length=1,t=t-i-1,d[0]=$s(10,(yt-t%yt)%yt),e.e=Nc(-t/yt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=$s(10,yt-n),d[f]=a>0?(u/$s(10,s-a)%$s(10,a)|0)*i:0),c)for(;;)if(f==0){(d[0]+=i)==pr&&(d[0]=1,++e.e);break}else{if(d[f]+=i,d[f]!=pr)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(jt&&(e.e>Mh||e.e<-Mh))throw Error(Hb+er(e));return e}function aO(e,t){var r,n,a,i,s,o,c,u,f,d,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),jt?ut(t,p):t;if(c=e.d,d=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(f=s<0,f?(r=c,s=-s,o=d.length):(r=d,n=u,o=c.length),a=Math.max(Math.ceil(p/yt),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=d.length,f=a<o,f&&(o=a),a=0;a<o;a++)if(c[a]!=d[a]){f=c[a]<d[a];break}s=0}for(f&&(r=c,c=d,d=r,t.s=-t.s),o=c.length,a=d.length-o;a>0;--a)c[o++]=0;for(a=d.length;a>s;){if(c[--a]<d[a]){for(i=a;i&&c[--i]===0;)c[i]=pr-1;--c[i],c[a]+=pr}c[a]-=d[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,jt?ut(t,p):t):new h(0)}function fo(e,t,r){var n,a=er(e),i=Wa(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Bi(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Bi(-a-1)+i,r&&(n=r-s)>0&&(i+=Bi(n))):a>=s?(i+=Bi(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Bi(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Bi(n))),e.s<0?"-"+i:i}function mk(e,t){if(e.length>t)return e.length=t,!0}function iO(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Zs+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return xk(s,i.toString())}else if(typeof i!="string")throw Error(Zs+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,kQ.test(i))xk(s,i);else throw Error(Zs+i)}if(a.prototype=je,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=iO,a.config=a.set=NQ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function NQ(e){if(!e||typeof e!="object")throw Error(oa+"Object expected");var t,r,n,a=["precision",1,kc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(Nc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Zs+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Zs+r+": "+n);return this}var Vb=iO(_Q);En=new Vb(1);const lt=Vb;function jQ(e){return OQ(e)||AQ(e)||TQ(e)||EQ()}function EQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TQ(e,t){if(e){if(typeof e=="string")return qv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qv(e,t)}}function AQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function OQ(e){if(Array.isArray(e))return qv(e)}function qv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var CQ=function(t){return t},sO={},oO=function(t){return t===sO},gk=function(t){return function r(){return arguments.length===0||arguments.length===1&&oO(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},PQ=function e(t,r){return t===1?r:gk(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(o){return o!==sO}).length;return s>=t?r.apply(void 0,a):e(t-s,gk(function(){for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];var f=a.map(function(d){return oO(d)?c.shift():d});return r.apply(void 0,jQ(f).concat(c))}))})},Ax=function(t){return PQ(t.length,t)},Yv=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},MQ=Ax(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),FQ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return CQ;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(o,c){return c(o)},i.apply(void 0,arguments))}},Qv=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},lO=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(o,c){return o===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function DQ(e){var t;return e===0?t=1:t=Math.floor(new lt(e).abs().log(10).toNumber())+1,t}function IQ(e,t,r){for(var n=new lt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var RQ=Ax(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),$Q=Ax(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),LQ=Ax(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Ox={rangeStep:IQ,getDigitCount:DQ,interpolateNumber:RQ,uninterpolateNumber:$Q,uninterpolateTruncation:LQ};function Zv(e){return zQ(e)||UQ(e)||cO(e)||BQ()}function BQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function zQ(e){if(Array.isArray(e))return Jv(e)}function df(e,t){return VQ(e)||HQ(e,t)||cO(e,t)||WQ()}function WQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cO(e,t){if(e){if(typeof e=="string")return Jv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jv(e,t)}}function Jv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HQ(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function VQ(e){if(Array.isArray(e))return e}function uO(e){var t=df(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function fO(e,t,r){if(e.lte(0))return new lt(0);var n=Ox.getDigitCount(e.toNumber()),a=new lt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new lt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?c:new lt(Math.ceil(c))}function GQ(e,t,r){var n=1,a=new lt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new lt(10).pow(Ox.getDigitCount(e)-1),a=new lt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new lt(Math.floor(e)))}else e===0?a=new lt(Math.floor((t-1)/2)):r||(a=new lt(Math.floor(e)));var s=Math.floor((t-1)/2),o=FQ(MQ(function(c){return a.add(new lt(c-s).mul(n)).toNumber()}),Yv);return o(0,t)}function dO(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new lt(0),tickMin:new lt(0),tickMax:new lt(0)};var i=fO(new lt(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new lt(0):(s=new lt(e).add(t).div(2),s=s.sub(new lt(s).mod(i)));var o=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new lt(t).sub(s).div(i).toNumber()),u=o+c+1;return u>r?dO(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,o=t>0?o:o+(r-u)),{step:i,tickMin:s.sub(new lt(o).mul(i)),tickMax:s.add(new lt(c).mul(i))})}function XQ(e){var t=df(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),o=uO([r,n]),c=df(o,2),u=c[0],f=c[1];if(u===-1/0||f===1/0){var d=f===1/0?[u].concat(Zv(Yv(0,a-1).map(function(){return 1/0}))):[].concat(Zv(Yv(0,a-1).map(function(){return-1/0})),[f]);return r>n?Qv(d):d}if(u===f)return GQ(u,a,i);var h=dO(u,f,s,i),p=h.step,m=h.tickMin,g=h.tickMax,y=Ox.rangeStep(m,g.add(new lt(.1).mul(p)),p);return r>n?Qv(y):y}function KQ(e,t){var r=df(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=uO([n,a]),o=df(s,2),c=o[0],u=o[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var f=Math.max(t,2),d=fO(new lt(u).sub(c).div(f-1),i,0),h=[].concat(Zv(Ox.rangeStep(new lt(c),new lt(u).sub(new lt(.99).mul(d)),d)),[u]);return n>a?Qv(h):h}var qQ=lO(XQ),YQ=lO(KQ),QQ="Invariant failed";function ho(e,t){throw new Error(QQ)}var ZQ=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function Fh(){return Fh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fh.apply(this,arguments)}function JQ(e,t){return nZ(e)||rZ(e,t)||tZ(e,t)||eZ()}function eZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tZ(e,t){if(e){if(typeof e=="string")return vk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vk(e,t)}}function vk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function nZ(e){if(Array.isArray(e))return e}function aZ(e,t){if(e==null)return{};var r=iZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function sZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xO(n.key),n)}}function lZ(e,t,r){return t&&oZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cZ(e,t,r){return t=Dh(t),uZ(e,hO()?Reflect.construct(t,r||[],Dh(e).constructor):t.apply(e,r))}function uZ(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fZ(e)}function fZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hO=function(){return!!e})()}function Dh(e){return Dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Dh(e)}function dZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&e1(e,t)}function e1(e,t){return e1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},e1(e,t)}function pO(e,t,r){return t=xO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xO(e){var t=hZ(e,"string");return Ul(t)=="symbol"?t:t+""}function hZ(e,t){if(Ul(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var p0=function(e){function t(){return sZ(this,t),cZ(this,t,arguments)}return dZ(t,e),lZ(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,o=n.dataKey,c=n.data,u=n.dataPointFormatter,f=n.xAxis,d=n.yAxis,h=aZ(n,ZQ),p=Ce(h,!1);this.props.direction==="x"&&f.type!=="number"&&ho();var m=c.map(function(g){var y=u(g,o),v=y.x,b=y.y,x=y.value,_=y.errorVal;if(!_)return null;var w=[],S,k;if(Array.isArray(_)){var N=JQ(_,2);S=N[0],k=N[1]}else S=k=_;if(i==="vertical"){var j=f.scale,E=b+a,A=E+s,T=E-s,F=j(x-S),G=j(x+k);w.push({x1:G,y1:A,x2:G,y2:T}),w.push({x1:F,y1:E,x2:G,y2:E}),w.push({x1:F,y1:A,x2:F,y2:T})}else if(i==="horizontal"){var M=d.scale,W=v+a,Y=W-s,K=W+s,D=M(x-S),Z=M(x+k);w.push({x1:Y,y1:Z,x2:K,y2:Z}),w.push({x1:W,y1:D,x2:W,y2:Z}),w.push({x1:Y,y1:D,x2:K,y2:D})}return q.createElement(Je,Fh({className:"recharts-errorBar",key:"bar-".concat(w.map(function(ee){return"".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))},p),w.map(function(ee){return q.createElement("line",Fh({},ee,{key:"line-".concat(ee.x1,"-").concat(ee.x2,"-").concat(ee.y1,"-").concat(ee.y2)}))}))});return q.createElement(Je,{className:"recharts-errorBars"},m)}}])}(q.Component);pO(p0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});pO(p0,"displayName","ErrorBar");function hf(e){"@babel/helpers - typeof";return hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hf(e)}function yk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yk(Object(r),!0).forEach(function(n){pZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pZ(e,t,r){return t=xZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xZ(e){var t=mZ(e,"string");return hf(t)=="symbol"?t:t+""}function mZ(e,t){if(hf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mO=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=_n(r,na);if(!s)return null;var o=na.defaultProps,c=o!==void 0?Es(Es({},o),s.props):{},u;return s.props&&s.props.payload?u=s.props&&s.props.payload:i==="children"?u=(n||[]).reduce(function(f,d){var h=d.item,p=d.props,m=p.sectors||p.data||[];return f.concat(m.map(function(g){return{type:s.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):u=(n||[]).map(function(f){var d=f.item,h=d.type.defaultProps,p=h!==void 0?Es(Es({},h),d.props):{},m=p.dataKey,g=p.name,y=p.legendType,v=p.hide;return{inactive:v,dataKey:m,type:c.iconType||y||"square",color:Gb(d),value:g||m,payload:p}}),Es(Es(Es({},c),na.getWithHeight(s,a)),{},{payload:u,item:s})};function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function bk(e){return bZ(e)||yZ(e)||vZ(e)||gZ()}function gZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vZ(e,t){if(e){if(typeof e=="string")return t1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t1(e,t)}}function yZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bZ(e){if(Array.isArray(e))return t1(e)}function t1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){wl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wl(e,t,r){return t=wZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wZ(e){var t=SZ(e,"string");return pf(t)=="symbol"?t:t+""}function SZ(e,t){if(pf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sr(e,t,r){return $e(e)||$e(t)?r:cr(t)?Mn(e,t,r):Ie(t)?t(e):r}function Su(e,t,r,n){var a=yQ(e,function(o){return sr(o,t)});if(r==="number"){var i=a.filter(function(o){return ge(o)||parseFloat(o)});return i.length?[Tx(i),Ex(i)]:[1/0,-1/0]}var s=n?a.filter(function(o){return!$e(o)}):a;return s.map(function(o){return cr(o)||o instanceof Date?o:""})}var _Z=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,o=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<o;u++){var f=u>0?a[u-1].coordinate:a[o-1].coordinate,d=a[u].coordinate,h=u>=o-1?a[0].coordinate:a[u+1].coordinate,p=void 0;if(tn(d-f)!==tn(h-d)){var m=[];if(tn(h-d)===tn(c[1]-c[0])){p=h;var g=d+c[1]-c[0];m[0]=Math.min(g,(g+f)/2),m[1]=Math.max(g,(g+f)/2)}else{p=f;var y=h+c[1]-c[0];m[0]=Math.min(d,(y+d)/2),m[1]=Math.max(d,(y+d)/2)}var v=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(t>v[0]&&t<=v[1]||t>=m[0]&&t<=m[1]){s=a[u].index;break}}else{var b=Math.min(f,h),x=Math.max(f,h);if(t>(b+d)/2&&t<=(x+d)/2){s=a[u].index;break}}}else for(var _=0;_<o;_++)if(_===0&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_>0&&_<o-1&&t>(n[_].coordinate+n[_-1].coordinate)/2&&t<=(n[_].coordinate+n[_+1].coordinate)/2||_===o-1&&t>(n[_].coordinate+n[_-1].coordinate)/2){s=n[_].index;break}return s},Gb=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?$t($t({},t.type.defaultProps),t.props):t.props,s=i.stroke,o=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:o;break;default:c=o;break}return c},kZ=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},o=Object.keys(i),c=0,u=o.length;c<u;c++)for(var f=i[o[c]].stackGroups,d=Object.keys(f),h=0,p=d.length;h<p;h++){var m=f[d[h]],g=m.items,y=m.cateAxisId,v=g.filter(function(k){return xi(k.type).indexOf("Bar")>=0});if(v&&v.length){var b=v[0].type.defaultProps,x=b!==void 0?$t($t({},b),v[0].props):v[0].props,_=x.barSize,w=x[y];s[w]||(s[w]=[]);var S=$e(_)?r:_;s[w].push({item:v[0],stackList:v.slice(1),barSize:$e(S)?void 0:rn(S,n,0)})}}return s},NZ=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,o=t.maxBarSize,c=s.length;if(c<1)return null;var u=rn(r,a,0,!0),f,d=[];if(s[0].barSize===+s[0].barSize){var h=!1,p=a/c,m=s.reduce(function(_,w){return _+w.barSize||0},0);m+=(c-1)*u,m>=a&&(m-=(c-1)*u,u=0),m>=a&&p>0&&(h=!0,p*=.9,m=c*p);var g=(a-m)/2>>0,y={offset:g-u,size:0};f=s.reduce(function(_,w){var S={item:w.item,position:{offset:y.offset+y.size+u,size:h?p:w.barSize}},k=[].concat(bk(_),[S]);return y=k[k.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(N){k.push({item:N,position:y})}),k},d)}else{var v=rn(n,a,0,!0);a-2*v-(c-1)*u<=0&&(u=0);var b=(a-2*v-(c-1)*u)/c;b>1&&(b>>=0);var x=o===+o?Math.min(b,o):b;f=s.reduce(function(_,w,S){var k=[].concat(bk(_),[{item:w.item,position:{offset:v+(b+u)*S+(b-x)/2,size:x}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(N){k.push({item:N,position:k[k.length-1].position})}),k},d)}return f},jZ=function(t,r,n,a){var i=n.children,s=n.width,o=n.margin,c=s-(o.left||0)-(o.right||0),u=mO({children:i,legendWidth:c});if(u){var f=a||{},d=f.width,h=f.height,p=u.align,m=u.verticalAlign,g=u.layout;if((g==="vertical"||g==="horizontal"&&m==="middle")&&p!=="center"&&ge(t[p]))return $t($t({},t),{},wl({},p,t[p]+(d||0)));if((g==="horizontal"||g==="vertical"&&p==="center")&&m!=="middle"&&ge(t[m]))return $t($t({},t),{},wl({},m,t[m]+(h||0)))}return t},EZ=function(t,r,n){return $e(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},gO=function(t,r,n,a,i){var s=r.props.children,o=Fn(s,p0).filter(function(u){return EZ(a,i,u.props.direction)});if(o&&o.length){var c=o.map(function(u){return u.props.dataKey});return t.reduce(function(u,f){var d=sr(f,n);if($e(d))return u;var h=Array.isArray(d)?[Tx(d),Ex(d)]:[d,d],p=c.reduce(function(m,g){var y=sr(f,g,0),v=h[0]-Math.abs(Array.isArray(y)?y[0]:y),b=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(v,m[0]),Math.max(b,m[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},TZ=function(t,r,n,a,i){var s=r.map(function(o){return gO(t,o,n,i,a)}).filter(function(o){return!$e(o)});return s&&s.length?s.reduce(function(o,c){return[Math.min(o[0],c[0]),Math.max(o[1],c[1])]},[1/0,-1/0]):null},vO=function(t,r,n,a,i){var s=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&gO(t,c,u,a)||Su(t,u,n,i)});if(n==="number")return s.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var o={};return s.reduce(function(c,u){for(var f=0,d=u.length;f<d;f++)o[u[f]]||(o[u[f]]=!0,c.push(u[f]));return c},[])},yO=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},bO=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,o=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||o.push(r),s||o.push(n),o},di=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,o=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?tn(o[0]-o[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(d){var h=i?i.indexOf(d):d;return{coordinate:a(h)+u,value:d,offset:u}});return f.filter(function(d){return!o0(d.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(d,h){return{coordinate:a(d)+u,value:d,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(d){return{coordinate:a(d)+u,value:d,offset:u}}):a.domain().map(function(d,h){return{coordinate:a(d)+u,value:i?i[d]:d,index:h,offset:u}})},qm=new WeakMap,td=function(t,r){if(typeof r!="function")return t;qm.has(t)||qm.set(t,new WeakMap);var n=qm.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},wO=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,o=t.axisType;if(a==="auto")return s==="radial"&&o==="radiusAxis"?{scale:sf(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:Ah(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:wu(),realScaleType:"point"}:i==="category"?{scale:sf(),realScaleType:"band"}:{scale:Ah(),realScaleType:"linear"};if(lo(a)){var c="scale".concat(hx(a));return{scale:(pk[c]||wu)(),realScaleType:pk[c]?c:"point"}}return Ie(a)?{scale:a}:{scale:wu(),realScaleType:"point"}},Sk=1e-4,SO=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-Sk,s=Math.max(a[0],a[1])+Sk,o=t(r[0]),c=t(r[n-1]);(o<i||o>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},AZ=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},OZ=function(t,r){if(!r||r.length!==2||!ge(r[0])||!ge(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!ge(t[0])||t[0]<n)&&(i[0]=n),(!ge(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},CZ=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,o=0;o<r;++o){var c=o0(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=s,t[o][n][1]=s+c,s=t[o][n][1])}},PZ=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var o=o0(t[s][n][1])?t[s][n][0]:t[s][n][1];o>=0?(t[s][n][0]=i,t[s][n][1]=i+o,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},MZ={sign:CZ,expand:ZB,none:Ml,silhouette:JB,wiggle:e7,positive:PZ},FZ=function(t,r,n){var a=r.map(function(o){return o.props.dataKey}),i=MZ[n],s=QB().keys(a).value(function(o,c){return+sr(o,c,0)}).order(jv).offset(i);return s(t)},DZ=function(t,r,n,a,i,s){if(!t)return null;var o=s?r.reverse():r,c={},u=o.reduce(function(d,h){var p,m=(p=h.type)!==null&&p!==void 0&&p.defaultProps?$t($t({},h.type.defaultProps),h.props):h.props,g=m.stackId,y=m.hide;if(y)return d;var v=m[n],b=d[v]||{hasStack:!1,stackGroups:{}};if(cr(g)){var x=b.stackGroups[g]||{numericAxisId:n,cateAxisId:a,items:[]};x.items.push(h),b.hasStack=!0,b.stackGroups[g]=x}else b.stackGroups[yc("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return $t($t({},d),{},wl({},v,b))},c),f={};return Object.keys(u).reduce(function(d,h){var p=u[h];if(p.hasStack){var m={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(g,y){var v=p.stackGroups[y];return $t($t({},g),{},wl({},y,{numericAxisId:n,cateAxisId:a,items:v.items,stackedData:FZ(t,v.items,i)}))},m)}return $t($t({},d),{},wl({},h,p))},f)},_O=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,o=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=t.domain();if(!u.length)return null;var f=qQ(u,i,o);return t.domain([Tx(f),Ex(f)]),{niceTicks:f}}if(i&&a==="number"){var d=t.domain(),h=YQ(d,i,o);return{niceTicks:h}}return null};function _k(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!$e(a[t.dataKey])){var o=oh(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=sr(a,$e(s)?t.dataKey:s);return $e(c)?null:t.scale(c)}var kk=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,o=t.index;if(r.type==="category")return n[o]?n[o].coordinate+a:null;var c=sr(s,r.dataKey,r.domain[o]);return $e(c)?null:r.scale(c)-i/2+a},IZ=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},RZ=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?$t($t({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(cr(i)){var s=r[i];if(s){var o=s.items.indexOf(t);return o>=0?s.stackedData[o]:null}}return null},$Z=function(t){return t.reduce(function(r,n){return[Tx(n.concat([r[0]]).filter(ge)),Ex(n.concat([r[1]]).filter(ge))]},[1/0,-1/0])},kO=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],o=s.stackedData,c=o.reduce(function(u,f){var d=$Z(f.slice(r,n+1));return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},Nk=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,jk=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,r1=function(t,r,n){if(Ie(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(ge(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(Nk.test(t[0])){var i=+Nk.exec(t[0])[1];a[0]=r[0]-i}else Ie(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(ge(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(jk.test(t[1])){var s=+jk.exec(t[1])[1];a[1]=r[1]+s}else Ie(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Ih=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=bb(r,function(d){return d.coordinate}),s=1/0,o=1,c=i.length;o<c;o++){var u=i[o],f=i[o-1];s=Math.min((u.coordinate||0)-(f.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},Ek=function(t,r,n){return!t||!t.length||h0(t,Mn(n,"type.defaultProps.domain"))?r:t},NO=function(t,r){var n=t.type.defaultProps?$t($t({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,o=n.formatter,c=n.tooltipType,u=n.chartType,f=n.hide;return $t($t({},Ce(t,!1)),{},{dataKey:a,unit:s,formatter:o,name:i||a,color:Gb(t),value:sr(r,a),type:c,payload:r,chartType:u,hide:f})};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function Tk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tk(Object(r),!0).forEach(function(n){jO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jO(e,t,r){return t=LZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LZ(e){var t=BZ(e,"string");return xf(t)=="symbol"?t:t+""}function BZ(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UZ(e,t){return VZ(e)||HZ(e,t)||WZ(e,t)||zZ()}function zZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WZ(e,t){if(e){if(typeof e=="string")return Ak(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ak(e,t)}}function Ak(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function VZ(e){if(Array.isArray(e))return e}var Rh=Math.PI/180,GZ=function(t){return t*180/Math.PI},pt=function(t,r,n,a){return{x:t+Math.cos(-Rh*a)*n,y:r+Math.sin(-Rh*a)*n}},EO=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},XZ=function(t,r,n,a,i){var s=t.width,o=t.height,c=t.startAngle,u=t.endAngle,f=rn(t.cx,s,s/2),d=rn(t.cy,o,o/2),h=EO(s,o,n),p=rn(t.innerRadius,h,0),m=rn(t.outerRadius,h,h*.8),g=Object.keys(r);return g.reduce(function(y,v){var b=r[v],x=b.domain,_=b.reversed,w;if($e(b.range))a==="angleAxis"?w=[c,u]:a==="radiusAxis"&&(w=[p,m]),_&&(w=[w[1],w[0]]);else{w=b.range;var S=w,k=UZ(S,2);c=k[0],u=k[1]}var N=wO(b,i),j=N.realScaleType,E=N.scale;E.domain(x).range(w),SO(E);var A=_O(E,si(si({},b),{},{realScaleType:j})),T=si(si(si({},b),A),{},{range:w,radius:m,realScaleType:j,scale:E,cx:f,cy:d,innerRadius:p,outerRadius:m,startAngle:c,endAngle:u});return si(si({},y),{},jO({},v,T))},{})},KZ=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},qZ=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,o=KZ({x:n,y:a},{x:i,y:s});if(o<=0)return{radius:o};var c=(n-i)/o,u=Math.acos(c);return a>s&&(u=2*Math.PI-u),{radius:o,angle:GZ(u),angleInRadian:u}},YZ=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},QZ=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),o=Math.min(i,s);return t+o*360},Ok=function(t,r){var n=t.x,a=t.y,i=qZ({x:n,y:a},r),s=i.radius,o=i.angle,c=r.innerRadius,u=r.outerRadius;if(s<c||s>u)return!1;if(s===0)return!0;var f=YZ(r),d=f.startAngle,h=f.endAngle,p=o,m;if(d<=h){for(;p>h;)p-=360;for(;p<d;)p+=360;m=p>=d&&p<=h}else{for(;p>d;)p-=360;for(;p<h;)p+=360;m=p>=h&&p<=d}return m?si(si({},r),{},{radius:s,angle:QZ(p,r)}):null},TO=function(t){return!H.isValidElement(t)&&!Ie(t)&&typeof t!="boolean"?t.className:""};function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}var ZZ=["offset"];function JZ(e){return nJ(e)||rJ(e)||tJ(e)||eJ()}function eJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tJ(e,t){if(e){if(typeof e=="string")return n1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n1(e,t)}}function rJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nJ(e){if(Array.isArray(e))return n1(e)}function n1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function aJ(e,t){if(e==null)return{};var r=iJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Ck(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ck(Object(r),!0).forEach(function(n){sJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ck(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sJ(e,t,r){return t=oJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oJ(e){var t=lJ(e,"string");return mf(t)=="symbol"?t:t+""}function lJ(e,t){if(mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gf(){return gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gf.apply(this,arguments)}var cJ=function(t){var r=t.value,n=t.formatter,a=$e(t.children)?r:t.children;return Ie(n)?n(a):a},uJ=function(t,r){var n=tn(r-t),a=Math.min(Math.abs(r-t),360);return n*a},fJ=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,o=t.className,c=i,u=c.cx,f=c.cy,d=c.innerRadius,h=c.outerRadius,p=c.startAngle,m=c.endAngle,g=c.clockWise,y=(d+h)/2,v=uJ(p,m),b=v>=0?1:-1,x,_;a==="insideStart"?(x=p+b*s,_=g):a==="insideEnd"?(x=m-b*s,_=!g):a==="end"&&(x=m+b*s,_=g),_=v<=0?_:!_;var w=pt(u,f,y,x),S=pt(u,f,y,x+(_?1:-1)*359),k="M".concat(w.x,",").concat(w.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(_?0:1,`,
    `).concat(S.x,",").concat(S.y),N=$e(t.id)?yc("recharts-radial-line-"):t.id;return q.createElement("text",gf({},n,{dominantBaseline:"central",className:ze("recharts-radial-bar-label",o)}),q.createElement("defs",null,q.createElement("path",{id:N,d:k})),q.createElement("textPath",{xlinkHref:"#".concat(N)},r))},dJ=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,o=i.cy,c=i.innerRadius,u=i.outerRadius,f=i.startAngle,d=i.endAngle,h=(f+d)/2;if(a==="outside"){var p=pt(s,o,u+n,h),m=p.x,g=p.y;return{x:m,y:g,textAnchor:m>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,v=pt(s,o,y,h),b=v.x,x=v.y;return{x:b,y:x,textAnchor:"middle",verticalAnchor:"middle"}},hJ=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,o=s.x,c=s.y,u=s.width,f=s.height,d=f>=0?1:-1,h=d*a,p=d>0?"end":"start",m=d>0?"start":"end",g=u>=0?1:-1,y=g*a,v=g>0?"end":"start",b=g>0?"start":"end";if(i==="top"){var x={x:o+u/2,y:c-d*a,textAnchor:"middle",verticalAnchor:p};return nr(nr({},x),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var _={x:o+u/2,y:c+f+h,textAnchor:"middle",verticalAnchor:m};return nr(nr({},_),n?{height:Math.max(n.y+n.height-(c+f),0),width:u}:{})}if(i==="left"){var w={x:o-y,y:c+f/2,textAnchor:v,verticalAnchor:"middle"};return nr(nr({},w),n?{width:Math.max(w.x-n.x,0),height:f}:{})}if(i==="right"){var S={x:o+u+y,y:c+f/2,textAnchor:b,verticalAnchor:"middle"};return nr(nr({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:f}:{})}var k=n?{width:u,height:f}:{};return i==="insideLeft"?nr({x:o+y,y:c+f/2,textAnchor:b,verticalAnchor:"middle"},k):i==="insideRight"?nr({x:o+u-y,y:c+f/2,textAnchor:v,verticalAnchor:"middle"},k):i==="insideTop"?nr({x:o+u/2,y:c+h,textAnchor:"middle",verticalAnchor:m},k):i==="insideBottom"?nr({x:o+u/2,y:c+f-h,textAnchor:"middle",verticalAnchor:p},k):i==="insideTopLeft"?nr({x:o+y,y:c+h,textAnchor:b,verticalAnchor:m},k):i==="insideTopRight"?nr({x:o+u-y,y:c+h,textAnchor:v,verticalAnchor:m},k):i==="insideBottomLeft"?nr({x:o+y,y:c+f-h,textAnchor:b,verticalAnchor:p},k):i==="insideBottomRight"?nr({x:o+u-y,y:c+f-h,textAnchor:v,verticalAnchor:p},k):xc(i)&&(ge(i.x)||Hs(i.x))&&(ge(i.y)||Hs(i.y))?nr({x:o+rn(i.x,u),y:c+rn(i.y,f),textAnchor:"end",verticalAnchor:"end"},k):nr({x:o+u/2,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},k)},pJ=function(t){return"cx"in t&&ge(t.cx)};function gr(e){var t=e.offset,r=t===void 0?5:t,n=aJ(e,ZZ),a=nr({offset:r},n),i=a.viewBox,s=a.position,o=a.value,c=a.children,u=a.content,f=a.className,d=f===void 0?"":f,h=a.textBreakAll;if(!i||$e(o)&&$e(c)&&!H.isValidElement(u)&&!Ie(u))return null;if(H.isValidElement(u))return H.cloneElement(u,a);var p;if(Ie(u)){if(p=H.createElement(u,a),H.isValidElement(p))return p}else p=cJ(a);var m=pJ(i),g=Ce(a,!0);if(m&&(s==="insideStart"||s==="insideEnd"||s==="end"))return fJ(a,p,g);var y=m?dJ(a):hJ(a);return q.createElement(uo,gf({className:ze("recharts-label",d)},g,y,{breakAll:h}),p)}gr.displayName="Label";var AO=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,o=t.r,c=t.radius,u=t.innerRadius,f=t.outerRadius,d=t.x,h=t.y,p=t.top,m=t.left,g=t.width,y=t.height,v=t.clockWise,b=t.labelViewBox;if(b)return b;if(ge(g)&&ge(y)){if(ge(d)&&ge(h))return{x:d,y:h,width:g,height:y};if(ge(p)&&ge(m))return{x:p,y:m,width:g,height:y}}return ge(d)&&ge(h)?{x:d,y:h,width:0,height:0}:ge(r)&&ge(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:u||0,outerRadius:f||c||o||0,clockWise:v}:t.viewBox?t.viewBox:{}},xJ=function(t,r){return t?t===!0?q.createElement(gr,{key:"label-implicit",viewBox:r}):cr(t)?q.createElement(gr,{key:"label-implicit",viewBox:r,value:t}):H.isValidElement(t)?t.type===gr?H.cloneElement(t,{key:"label-implicit",viewBox:r}):q.createElement(gr,{key:"label-implicit",content:t,viewBox:r}):Ie(t)?q.createElement(gr,{key:"label-implicit",content:t,viewBox:r}):xc(t)?q.createElement(gr,gf({viewBox:r},t,{key:"label-implicit"})):null:null},mJ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=AO(t),s=Fn(a,gr).map(function(c,u){return H.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return s;var o=xJ(t.label,r||i);return[o].concat(JZ(s))};gr.parseViewBox=AO;gr.renderCallByParent=mJ;function gJ(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var vJ=gJ;const yJ=st(vJ);function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}var bJ=["valueAccessor"],wJ=["data","dataKey","clockWise","id","textBreakAll"];function SJ(e){return jJ(e)||NJ(e)||kJ(e)||_J()}function _J(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kJ(e,t){if(e){if(typeof e=="string")return a1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a1(e,t)}}function NJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jJ(e){if(Array.isArray(e))return a1(e)}function a1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$h.apply(this,arguments)}function Pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pk(Object(r),!0).forEach(function(n){EJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EJ(e,t,r){return t=TJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TJ(e){var t=AJ(e,"string");return vf(t)=="symbol"?t:t+""}function AJ(e,t){if(vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fk(e,t){if(e==null)return{};var r=OJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function OJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var CJ=function(t){return Array.isArray(t.value)?yJ(t.value):t.value};function Dn(e){var t=e.valueAccessor,r=t===void 0?CJ:t,n=Fk(e,bJ),a=n.data,i=n.dataKey,s=n.clockWise,o=n.id,c=n.textBreakAll,u=Fk(n,wJ);return!a||!a.length?null:q.createElement(Je,{className:"recharts-label-list"},a.map(function(f,d){var h=$e(i)?r(f,d):sr(f&&f.payload,i),p=$e(o)?{}:{id:"".concat(o,"-").concat(d)};return q.createElement(gr,$h({},Ce(f,!0),u,p,{parentViewBox:f.parentViewBox,value:h,textBreakAll:c,viewBox:gr.parseViewBox($e(s)?f:Mk(Mk({},f),{},{clockWise:s})),key:"label-".concat(d),index:d}))}))}Dn.displayName="LabelList";function PJ(e,t){return e?e===!0?q.createElement(Dn,{key:"labelList-implicit",data:t}):q.isValidElement(e)||Ie(e)?q.createElement(Dn,{key:"labelList-implicit",data:t,content:e}):xc(e)?q.createElement(Dn,$h({data:t},e,{key:"labelList-implicit"})):null:null}function MJ(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Fn(n,Dn).map(function(s,o){return H.cloneElement(s,{data:t,key:"labelList-".concat(o)})});if(!r)return a;var i=PJ(e.label,t);return[i].concat(SJ(a))}Dn.renderCallByParent=MJ;function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(this,arguments)}function Dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ik(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dk(Object(r),!0).forEach(function(n){FJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FJ(e,t,r){return t=DJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DJ(e){var t=IJ(e,"string");return yf(t)=="symbol"?t:t+""}function IJ(e,t){if(yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RJ=function(t,r){var n=tn(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},rd=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,o=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,f=c*(o?1:-1)+a,d=Math.asin(c/f)/Rh,h=u?i:i+s*d,p=pt(r,n,f,h),m=pt(r,n,a,h),g=u?i-s*d:i,y=pt(r,n,f*Math.cos(d*Rh),g);return{center:p,circleTangency:m,lineTangency:y,theta:d}},OO=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,o=t.endAngle,c=RJ(s,o),u=s+c,f=pt(r,n,i,s),d=pt(r,n,i,u),h="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>u),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var p=pt(r,n,a,s),m=pt(r,n,a,u);h+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},$J=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,o=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,f=t.endAngle,d=tn(f-u),h=rd({cx:r,cy:n,radius:i,angle:u,sign:d,cornerRadius:s,cornerIsExternal:c}),p=h.circleTangency,m=h.lineTangency,g=h.theta,y=rd({cx:r,cy:n,radius:i,angle:f,sign:-d,cornerRadius:s,cornerIsExternal:c}),v=y.circleTangency,b=y.lineTangency,x=y.theta,_=c?Math.abs(u-f):Math.abs(u-f)-g-x;if(_<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):OO({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:f});var w="M ".concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
  `);if(a>0){var S=rd({cx:r,cy:n,radius:a,angle:u,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),k=S.circleTangency,N=S.lineTangency,j=S.theta,E=rd({cx:r,cy:n,radius:a,angle:f,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),A=E.circleTangency,T=E.lineTangency,F=E.theta,G=c?Math.abs(u-f):Math.abs(u-f)-j-F;if(G<0&&s===0)return"".concat(w,"L").concat(r,",").concat(n,"Z");w+="L".concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(A.x,",").concat(A.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(G>180),",").concat(+(d>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else w+="L".concat(r,",").concat(n,"Z");return w},LJ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},CO=function(t){var r=Ik(Ik({},LJ),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,o=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,f=r.startAngle,d=r.endAngle,h=r.className;if(s<i||f===d)return null;var p=ze("recharts-sector",h),m=s-i,g=rn(o,m,0,!0),y;return g>0&&Math.abs(f-d)<360?y=$J({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(g,m/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:f,endAngle:d}):y=OO({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:f,endAngle:d}),q.createElement("path",i1({},Ce(r,!0),{className:p,d:y,role:"img"}))};function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}function Rk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $k(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rk(Object(r),!0).forEach(function(n){BJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BJ(e,t,r){return t=UJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UJ(e){var t=zJ(e,"string");return bf(t)=="symbol"?t:t+""}function zJ(e,t){if(bf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lk={curveBasisClosed:BB,curveBasisOpen:UB,curveBasis:LB,curveBumpX:NB,curveBumpY:jB,curveLinearClosed:zB,curveLinear:xx,curveMonotoneX:WB,curveMonotoneY:HB,curveNatural:VB,curveStep:GB,curveStepAfter:KB,curveStepBefore:XB},nd=function(t){return t.x===+t.x&&t.y===+t.y},Kc=function(t){return t.x},qc=function(t){return t.y},WJ=function(t,r){if(Ie(t))return t;var n="curve".concat(hx(t));return(n==="curveMonotone"||n==="curveBump")&&r?Lk["".concat(n).concat(r==="vertical"?"Y":"X")]:Lk[n]||xx},HJ=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,o=t.layout,c=t.connectNulls,u=c===void 0?!1:c,f=WJ(n,o),d=u?i.filter(function(g){return nd(g)}):i,h;if(Array.isArray(s)){var p=u?s.filter(function(g){return nd(g)}):s,m=d.map(function(g,y){return $k($k({},g),{},{base:p[y]})});return o==="vertical"?h=X0().y(qc).x1(Kc).x0(function(g){return g.base.x}):h=X0().x(Kc).y1(qc).y0(function(g){return g.base.y}),h.defined(nd).curve(f),h(m)}return o==="vertical"&&ge(s)?h=X0().y(qc).x1(Kc).x0(s):ge(s)?h=X0().x(Kc).y1(qc).y0(s):h=jA().x(Kc).y(qc),h.defined(nd).curve(f),h(d)},Lh=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?HJ(t):a;return H.createElement("path",s1({},Ce(t,!1),lh(t),{className:ze("recharts-curve",r),d:s,ref:i}))},PO={exports:{}},VJ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",GJ=VJ,XJ=GJ;function MO(){}function FO(){}FO.resetWarningCache=MO;var KJ=function(){function e(n,a,i,s,o,c){if(c!==XJ){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:FO,resetWarningCache:MO};return r.PropTypes=r,r};PO.exports=KJ();var qJ=PO.exports;const tt=st(qJ),{getOwnPropertyNames:YJ,getOwnPropertySymbols:QJ}=Object,{hasOwnProperty:ZJ}=Object.prototype;function Ym(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function ad(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,s=i.get(r),o=i.get(n);if(s&&o)return s===n&&o===r;i.set(r,n),i.set(n,r);const c=e(r,n,a);return i.delete(r),i.delete(n),c}}function JJ(e){return e!=null?e[Symbol.toStringTag]:void 0}function Bk(e){return YJ(e).concat(QJ(e))}const eee=Object.hasOwn||((e,t)=>ZJ.call(e,t));function To(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const tee="__v",ree="__o",nee="_owner",{getOwnPropertyDescriptor:Uk,keys:zk}=Object;function aee(e,t){return e.byteLength===t.byteLength&&Bh(new Uint8Array(e),new Uint8Array(t))}function iee(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function see(e,t){return e.byteLength===t.byteLength&&Bh(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function oee(e,t){return To(e.getTime(),t.getTime())}function lee(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function cee(e,t){return e===t}function Wk(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let s,o,c=0;for(;(s=i.next())&&!s.done;){const u=t.entries();let f=!1,d=0;for(;(o=u.next())&&!o.done;){if(a[d]){d++;continue}const h=s.value,p=o.value;if(r.equals(h[0],p[0],c,d,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){f=a[d]=!0;break}d++}if(!f)return!1;c++}return!0}const uee=To;function fee(e,t,r){const n=zk(e);let a=n.length;if(zk(t).length!==a)return!1;for(;a-- >0;)if(!DO(e,t,r,n[a]))return!1;return!0}function Yc(e,t,r){const n=Bk(e);let a=n.length;if(Bk(t).length!==a)return!1;let i,s,o;for(;a-- >0;)if(i=n[a],!DO(e,t,r,i)||(s=Uk(e,i),o=Uk(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function dee(e,t){return To(e.valueOf(),t.valueOf())}function hee(e,t){return e.source===t.source&&e.flags===t.flags}function Hk(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let s,o;for(;(s=i.next())&&!s.done;){const c=t.values();let u=!1,f=0;for(;(o=c.next())&&!o.done;){if(!a[f]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1}return!0}function Bh(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function pee(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function DO(e,t,r,n){return(n===nee||n===ree||n===tee)&&(e.$$typeof||t.$$typeof)?!0:eee(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const xee="[object ArrayBuffer]",mee="[object Arguments]",gee="[object Boolean]",vee="[object DataView]",yee="[object Date]",bee="[object Error]",wee="[object Map]",See="[object Number]",_ee="[object Object]",kee="[object RegExp]",Nee="[object Set]",jee="[object String]",Eee={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Tee="[object URL]",Aee=Object.prototype.toString;function Oee({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:c,arePrimitiveWrappersEqual:u,areRegExpsEqual:f,areSetsEqual:d,areTypedArraysEqual:h,areUrlsEqual:p,unknownTagComparators:m}){return function(y,v,b){if(y===v)return!0;if(y==null||v==null)return!1;const x=typeof y;if(x!==typeof v)return!1;if(x!=="object")return x==="number"?o(y,v,b):x==="function"?i(y,v,b):!1;const _=y.constructor;if(_!==v.constructor)return!1;if(_===Object)return c(y,v,b);if(Array.isArray(y))return t(y,v,b);if(_===Date)return n(y,v,b);if(_===RegExp)return f(y,v,b);if(_===Map)return s(y,v,b);if(_===Set)return d(y,v,b);const w=Aee.call(y);if(w===yee)return n(y,v,b);if(w===kee)return f(y,v,b);if(w===wee)return s(y,v,b);if(w===Nee)return d(y,v,b);if(w===_ee)return typeof y.then!="function"&&typeof v.then!="function"&&c(y,v,b);if(w===Tee)return p(y,v,b);if(w===bee)return a(y,v,b);if(w===mee)return c(y,v,b);if(Eee[w])return h(y,v,b);if(w===xee)return e(y,v,b);if(w===vee)return r(y,v,b);if(w===gee||w===See||w===jee)return u(y,v,b);if(m){let S=m[w];if(!S){const k=JJ(y);k&&(S=m[k])}if(S)return S(y,v,b)}return!1}}function Cee({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:aee,areArraysEqual:r?Yc:iee,areDataViewsEqual:see,areDatesEqual:oee,areErrorsEqual:lee,areFunctionsEqual:cee,areMapsEqual:r?Ym(Wk,Yc):Wk,areNumbersEqual:uee,areObjectsEqual:r?Yc:fee,arePrimitiveWrappersEqual:dee,areRegExpsEqual:hee,areSetsEqual:r?Ym(Hk,Yc):Hk,areTypedArraysEqual:r?Ym(Bh,Yc):Bh,areUrlsEqual:pee,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=ad(n.areArraysEqual),i=ad(n.areMapsEqual),s=ad(n.areObjectsEqual),o=ad(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:o})}return n}function Pee(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function Mee({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(o,c){const{cache:u=e?new WeakMap:void 0,meta:f}=r();return t(o,c,{cache:u,equals:n,meta:f,strict:a})};if(e)return function(o,c){return t(o,c,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(o,c){return t(o,c,i)}}const Fee=ws();ws({strict:!0});ws({circular:!0});ws({circular:!0,strict:!0});ws({createInternalComparator:()=>To});ws({strict:!0,createInternalComparator:()=>To});ws({circular:!0,createInternalComparator:()=>To});ws({circular:!0,createInternalComparator:()=>To,strict:!0});function ws(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=Cee(e),s=Oee(i),o=r?r(s):Pee(s);return Mee({circular:t,comparator:s,createState:n,equals:o,strict:a})}function Dee(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Vk(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):Dee(a)};requestAnimationFrame(n)}function o1(e){"@babel/helpers - typeof";return o1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o1(e)}function Iee(e){return Bee(e)||Lee(e)||$ee(e)||Ree()}function Ree(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ee(e,t){if(e){if(typeof e=="string")return Gk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gk(e,t)}}function Gk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Lee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bee(e){if(Array.isArray(e))return e}function Uee(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,o=Iee(s),c=o[0],u=o.slice(1);if(typeof c=="number"){Vk(a.bind(null,u),c);return}a(c),Vk(a.bind(null,u));return}o1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){IO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IO(e,t,r){return t=zee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zee(e){var t=Wee(e,"string");return wf(t)==="symbol"?t:String(t)}function Wee(e,t){if(wf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hee=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},Vee=function(t){return t},Gee=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},_u=function(t,r){return Object.keys(r).reduce(function(n,a){return Kk(Kk({},n),{},IO({},a,t(a,r[a])))},{})},qk=function(t,r,n){return t.map(function(a){return"".concat(Gee(a)," ").concat(r,"ms ").concat(n)}).join(",")};function Xee(e,t){return Yee(e)||qee(e,t)||RO(e,t)||Kee()}function Kee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Yee(e){if(Array.isArray(e))return e}function Qee(e){return ete(e)||Jee(e)||RO(e)||Zee()}function Zee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RO(e,t){if(e){if(typeof e=="string")return l1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l1(e,t)}}function Jee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ete(e){if(Array.isArray(e))return l1(e)}function l1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Uh=1e-4,$O=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},LO=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Yk=function(t,r){return function(n){var a=$O(t,r);return LO(a,n)}},tte=function(t,r){return function(n){var a=$O(t,r),i=[].concat(Qee(a.map(function(s,o){return s*o}).slice(1)),[0]);return LO(i,n)}},Qk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,o=1;break;case"ease":a=.25,i=.1,s=.25,o=1;break;case"ease-in":a=.42,i=0,s=1,o=1;break;case"ease-out":a=.42,i=0,s=.58,o=1;break;case"ease-in-out":a=0,i=0,s=.58,o=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),f=Xee(u,4);a=f[0],i=f[1],s=f[2],o=f[3]}}}var d=Yk(a,s),h=Yk(i,o),p=tte(a,s),m=function(v){return v>1?1:v<0?0:v},g=function(v){for(var b=v>1?1:v,x=b,_=0;_<8;++_){var w=d(x)-b,S=p(x);if(Math.abs(w-b)<Uh||S<Uh)return h(x);x=m(x-w/S)}return h(x)};return g.isStepper=!1,g},rte=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,o=s===void 0?17:s,c=function(f,d,h){var p=-(f-d)*n,m=h*i,g=h+(p-m)*o/1e3,y=h*o/1e3+f;return Math.abs(y-d)<Uh&&Math.abs(g)<Uh?[d,0]:[y,g]};return c.isStepper=!0,c.dt=o,c},nte=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Qk(a);case"spring":return rte();default:if(a.split("(")[0]==="cubic-bezier")return Qk(a)}return typeof a=="function"?a:null};function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function Zk(e){return ste(e)||ite(e)||BO(e)||ate()}function ate(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ite(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ste(e){if(Array.isArray(e))return u1(e)}function Jk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jk(Object(r),!0).forEach(function(n){c1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c1(e,t,r){return t=ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e){var t=lte(e,"string");return Sf(t)==="symbol"?t:String(t)}function lte(e,t){if(Sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cte(e,t){return dte(e)||fte(e,t)||BO(e,t)||ute()}function ute(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BO(e,t){if(e){if(typeof e=="string")return u1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u1(e,t)}}function u1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fte(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function dte(e){if(Array.isArray(e))return e}var zh=function(t,r,n){return t+(r-t)*n},f1=function(t){var r=t.from,n=t.to;return r!==n},hte=function e(t,r,n){var a=_u(function(i,s){if(f1(s)){var o=t(s.from,s.to,s.velocity),c=cte(o,2),u=c[0],f=c[1];return jr(jr({},s),{},{from:u,velocity:f})}return s},r);return n<1?_u(function(i,s){return f1(s)?jr(jr({},s),{},{velocity:zh(s.velocity,a[i].velocity,n),from:zh(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const pte=function(e,t,r,n,a){var i=Hee(e,t),s=i.reduce(function(y,v){return jr(jr({},y),{},c1({},v,[e[v],t[v]]))},{}),o=i.reduce(function(y,v){return jr(jr({},y),{},c1({},v,{from:e[v],velocity:0,to:t[v]}))},{}),c=-1,u,f,d=function(){return null},h=function(){return _u(function(v,b){return b.from},o)},p=function(){return!Object.values(o).filter(f1).length},m=function(v){u||(u=v);var b=v-u,x=b/r.dt;o=hte(r,o,x),a(jr(jr(jr({},e),t),h())),u=v,p()||(c=requestAnimationFrame(d))},g=function(v){f||(f=v);var b=(v-f)/n,x=_u(function(w,S){return zh.apply(void 0,Zk(S).concat([r(b)]))},s);if(a(jr(jr(jr({},e),t),x)),b<1)c=requestAnimationFrame(d);else{var _=_u(function(w,S){return zh.apply(void 0,Zk(S).concat([r(1)]))},s);a(jr(jr(jr({},e),t),_))}};return d=r.isStepper?m:g,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}var xte=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function mte(e,t){if(e==null)return{};var r=gte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gte(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Qm(e){return wte(e)||bte(e)||yte(e)||vte()}function vte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yte(e,t){if(e){if(typeof e=="string")return d1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d1(e,t)}}function bte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wte(e){if(Array.isArray(e))return d1(e)}function d1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eN(Object(r),!0).forEach(function(n){ou(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ou(e,t,r){return t=UO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ste(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UO(n.key),n)}}function kte(e,t,r){return t&&_te(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UO(e){var t=Nte(e,"string");return zl(t)==="symbol"?t:String(t)}function Nte(e,t){if(zl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h1(e,t)}function h1(e,t){return h1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},h1(e,t)}function Ete(e){var t=Tte();return function(){var n=Wh(e),a;if(t){var i=Wh(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return p1(this,a)}}function p1(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x1(e)}function x1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wh(e)}var Qa=function(e){jte(r,e);var t=Ete(r);function r(n,a){var i;Ste(this,r),i=t.call(this,n,a);var s=i.props,o=s.isActive,c=s.attributeName,u=s.from,f=s.to,d=s.steps,h=s.children,p=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(x1(i)),i.changeStyle=i.changeStyle.bind(x1(i)),!o||p<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:f}),p1(i);if(d&&d.length)i.state={style:d[0].style};else if(u){if(typeof h=="function")return i.state={style:u},p1(i);i.state={style:c?ou({},c,u):u}}else i.state={style:{}};return i}return kte(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,o=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,f=i.to,d=i.from,h=this.state.style;if(o){if(!s){var p={style:c?ou({},c,f):f};this.state&&h&&(c&&h[c]!==f||!c&&h!==f)&&this.setState(p);return}if(!(Fee(a.to,f)&&a.canBegin&&a.isActive)){var m=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=m||u?d:a.to;if(this.state&&h){var y={style:c?ou({},c,g):g};(c&&h[c]!==g||!c&&h!==g)&&this.setState(y)}this.runAnimation(va(va({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,o=a.to,c=a.duration,u=a.easing,f=a.begin,d=a.onAnimationEnd,h=a.onAnimationStart,p=pte(s,o,nte(u),c,this.changeStyle),m=function(){i.stopJSAnimation=p()};this.manager.start([h,f,m,c,d])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,o=a.begin,c=a.onAnimationStart,u=s[0],f=u.style,d=u.duration,h=d===void 0?0:d,p=function(g,y,v){if(v===0)return g;var b=y.duration,x=y.easing,_=x===void 0?"ease":x,w=y.style,S=y.properties,k=y.onAnimationEnd,N=v>0?s[v-1]:y,j=S||Object.keys(w);if(typeof _=="function"||_==="spring")return[].concat(Qm(g),[i.runJSAnimation.bind(i,{from:N.style,to:w,duration:b,easing:_}),b]);var E=qk(j,b,_),A=va(va(va({},N.style),w),{},{transition:E});return[].concat(Qm(g),[A,b,k]).filter(Vee)};return this.manager.start([c].concat(Qm(s.reduce(p,[f,Math.max(h,o)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=Uee());var i=a.begin,s=a.duration,o=a.attributeName,c=a.to,u=a.easing,f=a.onAnimationStart,d=a.onAnimationEnd,h=a.steps,p=a.children,m=this.manager;if(this.unSubscribe=m.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var g=o?ou({},o,c):c,y=qk(Object.keys(g),s,u);m.start([f,i,va(va({},g),{},{transition:y}),s,d])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var o=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=mte(a,xte),u=H.Children.count(i),f=this.state.style;if(typeof i=="function")return i(f);if(!o||u===0||s<=0)return i;var d=function(p){var m=p.props,g=m.style,y=g===void 0?{}:g,v=m.className,b=H.cloneElement(p,va(va({},c),{},{style:va(va({},y),f),className:v}));return b};return u===1?d(H.Children.only(i)):q.createElement("div",null,H.Children.map(i,function(h){return d(h)}))}}]),r}(H.PureComponent);Qa.displayName="Animate";Qa.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Qa.propTypes={from:tt.oneOfType([tt.object,tt.string]),to:tt.oneOfType([tt.object,tt.string]),attributeName:tt.string,duration:tt.number,begin:tt.number,easing:tt.oneOfType([tt.string,tt.func]),steps:tt.arrayOf(tt.shape({duration:tt.number.isRequired,style:tt.object.isRequired,easing:tt.oneOfType([tt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),tt.func]),properties:tt.arrayOf("string"),onAnimationEnd:tt.func})),children:tt.oneOfType([tt.node,tt.func]),isActive:tt.bool,canBegin:tt.bool,onAnimationEnd:tt.func,shouldReAnimate:tt.bool,onAnimationStart:tt.func,onAnimationReStart:tt.func};function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function Hh(){return Hh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hh.apply(this,arguments)}function Ate(e,t){return Mte(e)||Pte(e,t)||Cte(e,t)||Ote()}function Ote(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cte(e,t){if(e){if(typeof e=="string")return tN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tN(e,t)}}function tN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pte(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Mte(e){if(Array.isArray(e))return e}function rN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rN(Object(r),!0).forEach(function(n){Fte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fte(e,t,r){return t=Dte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dte(e){var t=Ite(e,"string");return _f(t)=="symbol"?t:t+""}function Ite(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aN=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,f;if(s>0&&i instanceof Array){for(var d=[0,0,0,0],h=0,p=4;h<p;h++)d[h]=i[h]>s?s:i[h];f="M".concat(t,",").concat(r+o*d[0]),d[0]>0&&(f+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(u,",").concat(t+c*d[0],",").concat(r)),f+="L ".concat(t+n-c*d[1],",").concat(r),d[1]>0&&(f+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+o*d[1])),f+="L ".concat(t+n,",").concat(r+a-o*d[2]),d[2]>0&&(f+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(u,`,
        `).concat(t+n-c*d[2],",").concat(r+a)),f+="L ".concat(t+c*d[3],",").concat(r+a),d[3]>0&&(f+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-o*d[3])),f+="Z"}else if(s>0&&i===+i&&i>0){var m=Math.min(s,i);f="M ".concat(t,",").concat(r+o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+c*m,",").concat(r,`
            L `).concat(t+n-c*m,",").concat(r,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+n,",").concat(r+o*m,`
            L `).concat(t+n,",").concat(r+a-o*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t+n-c*m,",").concat(r+a,`
            L `).concat(t+c*m,",").concat(r+a,`
            A `).concat(m,",").concat(m,",0,0,").concat(u,",").concat(t,",").concat(r+a-o*m," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},Rte=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,o=r.width,c=r.height;if(Math.abs(o)>0&&Math.abs(c)>0){var u=Math.min(i,i+o),f=Math.max(i,i+o),d=Math.min(s,s+c),h=Math.max(s,s+c);return n>=u&&n<=f&&a>=d&&a<=h}return!1},$te={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Xb=function(t){var r=nN(nN({},$te),t),n=H.useRef(),a=H.useState(-1),i=Ate(a,2),s=i[0],o=i[1];H.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var _=n.current.getTotalLength();_&&o(_)}catch{}},[]);var c=r.x,u=r.y,f=r.width,d=r.height,h=r.radius,p=r.className,m=r.animationEasing,g=r.animationDuration,y=r.animationBegin,v=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||u!==+u||f!==+f||d!==+d||f===0||d===0)return null;var x=ze("recharts-rectangle",p);return b?q.createElement(Qa,{canBegin:s>0,from:{width:f,height:d,x:c,y:u},to:{width:f,height:d,x:c,y:u},duration:g,animationEasing:m,isActive:b},function(_){var w=_.width,S=_.height,k=_.x,N=_.y;return q.createElement(Qa,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:v,easing:m},q.createElement("path",Hh({},Ce(r,!0),{className:x,d:aN(k,N,w,S,h),ref:n})))}):q.createElement("path",Hh({},Ce(r,!0),{className:x,d:aN(c,u,f,d,h)}))},Lte=["points","className","baseLinePoints","connectNulls"];function ll(){return ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ll.apply(this,arguments)}function Bte(e,t){if(e==null)return{};var r=Ute(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ute(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function iN(e){return Vte(e)||Hte(e)||Wte(e)||zte()}function zte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wte(e,t){if(e){if(typeof e=="string")return m1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m1(e,t)}}function Hte(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vte(e){if(Array.isArray(e))return m1(e)}function m1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sN=function(t){return t&&t.x===+t.x&&t.y===+t.y},Gte=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){sN(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),sN(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},ku=function(t,r){var n=Gte(t);r&&(n=[n.reduce(function(i,s){return[].concat(iN(i),iN(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,o,c){return"".concat(s).concat(c===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},Xte=function(t,r,n){var a=ku(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(ku(r.reverse(),n).slice(1))},Kte=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=Bte(t,Lte);if(!r||!r.length)return null;var o=ze("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",u=Xte(r,a,i);return q.createElement("g",{className:o},q.createElement("path",ll({},Ce(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:u})),c?q.createElement("path",ll({},Ce(s,!0),{fill:"none",d:ku(r,i)})):null,c?q.createElement("path",ll({},Ce(s,!0),{fill:"none",d:ku(a,i)})):null)}var f=ku(r,i);return q.createElement("path",ll({},Ce(s,!0),{fill:f.slice(-1)==="Z"?s.fill:"none",className:o,d:f}))};function g1(){return g1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g1.apply(this,arguments)}var Cx=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ze("recharts-dot",i);return r===+r&&n===+n&&a===+a?H.createElement("circle",g1({},Ce(t,!1),lh(t),{className:s,cx:r,cy:n,r:a})):null};function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}var qte=["x","y","top","left","width","height","className"];function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v1.apply(this,arguments)}function oN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oN(Object(r),!0).forEach(function(n){Qte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qte(e,t,r){return t=Zte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zte(e){var t=Jte(e,"string");return kf(t)=="symbol"?t:t+""}function Jte(e,t){if(kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ere(e,t){if(e==null)return{};var r=tre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function tre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var rre=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},nre=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,o=s===void 0?0:s,c=t.left,u=c===void 0?0:c,f=t.width,d=f===void 0?0:f,h=t.height,p=h===void 0?0:h,m=t.className,g=ere(t,qte),y=Yte({x:n,y:i,top:o,left:u,width:d,height:p},g);return!ge(n)||!ge(i)||!ge(d)||!ge(p)||!ge(o)||!ge(u)?null:q.createElement("path",v1({},Ce(y,!0),{className:ze("recharts-cross",m),d:rre(n,i,d,p,o,u)}))},are=jx,ire=J3,sre=ei;function ore(e,t){return e&&e.length?are(e,sre(t),ire):void 0}var lre=ore;const cre=st(lre);var ure=jx,fre=ei,dre=eO;function hre(e,t){return e&&e.length?ure(e,fre(t),dre):void 0}var pre=hre;const xre=st(pre);var mre=["cx","cy","angle","ticks","axisLine"],gre=["ticks","tick","angle","tickFormatter","stroke"];function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function Nu(){return Nu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nu.apply(this,arguments)}function lN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lN(Object(r),!0).forEach(function(n){Px(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cN(e,t){if(e==null)return{};var r=vre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WO(n.key),n)}}function bre(e,t,r){return t&&uN(e.prototype,t),r&&uN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wre(e,t,r){return t=Vh(t),Sre(e,zO()?Reflect.construct(t,r||[],Vh(e).constructor):t.apply(e,r))}function Sre(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _re(e)}function _re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zO=function(){return!!e})()}function Vh(e){return Vh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Vh(e)}function kre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y1(e,t)}function y1(e,t){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},y1(e,t)}function Px(e,t,r){return t=WO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WO(e){var t=Nre(e,"string");return Wl(t)=="symbol"?t:t+""}function Nre(e,t){if(Wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mx=function(e){function t(){return yre(this,t),wre(this,t,arguments)}return kre(t,e),bre(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,o=i.cx,c=i.cy;return pt(o,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=cre(o,function(f){return f.coordinate||0}),u=xre(o,function(f){return f.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=n.axisLine,u=cN(n,mre),f=o.reduce(function(m,g){return[Math.min(m[0],g.coordinate),Math.max(m[1],g.coordinate)]},[1/0,-1/0]),d=pt(a,i,f[0],s),h=pt(a,i,f[1],s),p=Ts(Ts(Ts({},Ce(u,!1)),{},{fill:"none"},Ce(c,!1)),{},{x1:d.x,y1:d.y,x2:h.x,y2:h.y});return q.createElement("line",Nu({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.angle,c=a.tickFormatter,u=a.stroke,f=cN(a,gre),d=this.getTickTextAnchor(),h=Ce(f,!1),p=Ce(s,!1),m=i.map(function(g,y){var v=n.getTickValueCoord(g),b=Ts(Ts(Ts(Ts({textAnchor:d,transform:"rotate(".concat(90-o,", ").concat(v.x,", ").concat(v.y,")")},h),{},{stroke:"none",fill:u},p),{},{index:y},v),{},{payload:g});return q.createElement(Je,Nu({className:ze("recharts-polar-radius-axis-tick",TO(s)),key:"tick-".concat(g.coordinate)},co(n.props,g,y)),t.renderTickItem(s,b,c?c(g.value,y):g.value))});return q.createElement(Je,{className:"recharts-polar-radius-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:q.createElement(Je,{className:ze("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),gr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return q.isValidElement(n)?s=q.cloneElement(n,a):Ie(n)?s=n(a):s=q.createElement(uo,Nu({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])}(H.PureComponent);Px(Mx,"displayName","PolarRadiusAxis");Px(Mx,"axisType","radiusAxis");Px(Mx,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function Ls(){return Ls=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ls.apply(this,arguments)}function fN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function As(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(r),!0).forEach(function(n){Fx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,VO(n.key),n)}}function Ere(e,t,r){return t&&dN(e.prototype,t),r&&dN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tre(e,t,r){return t=Gh(t),Are(e,HO()?Reflect.construct(t,r||[],Gh(e).constructor):t.apply(e,r))}function Are(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ore(e)}function Ore(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HO=function(){return!!e})()}function Gh(e){return Gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gh(e)}function Cre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b1(e,t)}function b1(e,t){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b1(e,t)}function Fx(e,t,r){return t=VO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VO(e){var t=Pre(e,"string");return Hl(t)=="symbol"?t:t+""}function Pre(e,t){if(Hl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mre=Math.PI/180,hN=1e-5,Dx=function(e){function t(){return jre(this,t),Tre(this,t,arguments)}return Cre(t,e),Ere(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,o=a.radius,c=a.orientation,u=a.tickSize,f=u||8,d=pt(i,s,o,n.coordinate),h=pt(i,s,o+(c==="inner"?-1:1)*f,n.coordinate);return{x1:d.x,y1:d.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*Mre),s;return i>hN?s=a==="outer"?"start":"end":i<-hN?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,o=n.axisLine,c=n.axisLineType,u=As(As({},Ce(this.props,!1)),{},{fill:"none"},Ce(o,!1));if(c==="circle")return q.createElement(Cx,Ls({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:s}));var f=this.props.ticks,d=f.map(function(h){return pt(a,i,s,h.coordinate)});return q.createElement(Kte,Ls({className:"recharts-polar-angle-axis-line"},u,{points:d}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.tickLine,c=a.tickFormatter,u=a.stroke,f=Ce(this.props,!1),d=Ce(s,!1),h=As(As({},f),{},{fill:"none"},Ce(o,!1)),p=i.map(function(m,g){var y=n.getTickLineCoord(m),v=n.getTickTextAnchor(m),b=As(As(As({textAnchor:v},f),{},{stroke:"none",fill:u},d),{},{index:g,payload:m,x:y.x2,y:y.y2});return q.createElement(Je,Ls({className:ze("recharts-polar-angle-axis-tick",TO(s)),key:"tick-".concat(m.coordinate)},co(n.props,m,g)),o&&q.createElement("line",Ls({className:"recharts-polar-angle-axis-tick-line"},h,y)),s&&t.renderTickItem(s,b,c?c(m.value,g):m.value))});return q.createElement(Je,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:q.createElement(Je,{className:ze("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return q.isValidElement(n)?s=q.cloneElement(n,a):Ie(n)?s=n(a):s=q.createElement(uo,Ls({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])}(H.PureComponent);Fx(Dx,"displayName","PolarAngleAxis");Fx(Dx,"axisType","angleAxis");Fx(Dx,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Fre=YA,Dre=Fre(Object.getPrototypeOf,Object),Ire=Dre,Rre=Ai,$re=Ire,Lre=Oi,Bre="[object Object]",Ure=Function.prototype,zre=Object.prototype,GO=Ure.toString,Wre=zre.hasOwnProperty,Hre=GO.call(Object);function Vre(e){if(!Lre(e)||Rre(e)!=Bre)return!1;var t=$re(e);if(t===null)return!0;var r=Wre.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&GO.call(r)==Hre}var Gre=Vre;const Xre=st(Gre);var Kre=Ai,qre=Oi,Yre="[object Boolean]";function Qre(e){return e===!0||e===!1||qre(e)&&Kre(e)==Yre}var Zre=Qre;const Jre=st(Zre);function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xh.apply(this,arguments)}function ene(e,t){return ane(e)||nne(e,t)||rne(e,t)||tne()}function tne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rne(e,t){if(e){if(typeof e=="string")return pN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pN(e,t)}}function pN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function ane(e){if(Array.isArray(e))return e}function xN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xN(Object(r),!0).forEach(function(n){ine(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ine(e,t,r){return t=sne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sne(e){var t=one(e,"string");return Nf(t)=="symbol"?t:t+""}function one(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gN=function(t,r,n,a,i){var s=n-a,o;return o="M ".concat(t,",").concat(r),o+="L ".concat(t+n,",").concat(r),o+="L ".concat(t+n-s/2,",").concat(r+i),o+="L ".concat(t+n-s/2-a,",").concat(r+i),o+="L ".concat(t,",").concat(r," Z"),o},lne={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},cne=function(t){var r=mN(mN({},lne),t),n=H.useRef(),a=H.useState(-1),i=ene(a,2),s=i[0],o=i[1];H.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var x=n.current.getTotalLength();x&&o(x)}catch{}},[]);var c=r.x,u=r.y,f=r.upperWidth,d=r.lowerWidth,h=r.height,p=r.className,m=r.animationEasing,g=r.animationDuration,y=r.animationBegin,v=r.isUpdateAnimationActive;if(c!==+c||u!==+u||f!==+f||d!==+d||h!==+h||f===0&&d===0||h===0)return null;var b=ze("recharts-trapezoid",p);return v?q.createElement(Qa,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:u},to:{upperWidth:f,lowerWidth:d,height:h,x:c,y:u},duration:g,animationEasing:m,isActive:v},function(x){var _=x.upperWidth,w=x.lowerWidth,S=x.height,k=x.x,N=x.y;return q.createElement(Qa,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:m},q.createElement("path",Xh({},Ce(r,!0),{className:b,d:gN(k,N,_,w,S),ref:n})))}):q.createElement("g",null,q.createElement("path",Xh({},Ce(r,!0),{className:b,d:gN(c,u,f,d,h)})))},une=["option","shapeType","propTransformer","activeClassName","isActive"];function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function fne(e,t){if(e==null)return{};var r=dne(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dne(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function vN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vN(Object(r),!0).forEach(function(n){hne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hne(e,t,r){return t=pne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pne(e){var t=xne(e,"string");return jf(t)=="symbol"?t:t+""}function xne(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mne(e,t){return Kh(Kh({},t),e)}function gne(e,t){return e==="symbols"}function yN(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return q.createElement(Xb,r);case"trapezoid":return q.createElement(cne,r);case"sector":return q.createElement(CO,r);case"symbols":if(gne(t))return q.createElement(db,r);break;default:return null}}function vne(e){return H.isValidElement(e)?e.props:e}function XO(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?mne:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,o=e.isActive,c=fne(e,une),u;if(H.isValidElement(t))u=H.cloneElement(t,Kh(Kh({},c),vne(t)));else if(Ie(t))u=t(c);else if(Xre(t)&&!Jre(t)){var f=a(t,c);u=q.createElement(yN,{shapeType:r,elementProps:f})}else{var d=c;u=q.createElement(yN,{shapeType:r,elementProps:d})}return o?q.createElement(Je,{className:s},u):u}function Ix(e,t){return t!=null&&"trapezoids"in e.props}function Rx(e,t){return t!=null&&"sectors"in e.props}function Ef(e,t){return t!=null&&"points"in e.props}function yne(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function bne(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function wne(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function Sne(e,t){var r;return Ix(e,t)?r=yne:Rx(e,t)?r=bne:Ef(e,t)&&(r=wne),r}function _ne(e,t){var r;return Ix(e,t)?r="trapezoids":Rx(e,t)?r="sectors":Ef(e,t)&&(r="points"),r}function kne(e,t){if(Ix(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Rx(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Ef(e,t)?t.payload:{}}function Nne(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=_ne(r,t),i=kne(r,t),s=n.filter(function(c,u){var f=h0(i,c),d=r.props[a].filter(function(m){var g=Sne(r,t);return g(m,t)}),h=r.props[a].indexOf(d[d.length-1]),p=u===h;return f&&p}),o=n.indexOf(s[s.length-1]);return o}var Md;function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cl.apply(this,arguments)}function bN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bN(Object(r),!0).forEach(function(n){Zn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qO(n.key),n)}}function Ene(e,t,r){return t&&wN(e.prototype,t),r&&wN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tne(e,t,r){return t=qh(t),Ane(e,KO()?Reflect.construct(t,r||[],qh(e).constructor):t.apply(e,r))}function Ane(e,t){if(t&&(Vl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return One(e)}function One(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KO=function(){return!!e})()}function qh(e){return qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qh(e)}function Cne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w1(e,t)}function w1(e,t){return w1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},w1(e,t)}function Zn(e,t,r){return t=qO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qO(e){var t=Pne(e,"string");return Vl(t)=="symbol"?t:t+""}function Pne(e,t){if(Vl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pa=function(e){function t(r){var n;return jne(this,t),n=Tne(this,t,[r]),Zn(n,"pieRef",null),Zn(n,"sectorRefs",[]),Zn(n,"id",yc("recharts-pie-")),Zn(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Ie(a)&&a()}),Zn(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Ie(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return Cne(t,e),Ene(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,o=i.labelLine,c=i.dataKey,u=i.valueKey,f=Ce(this.props,!1),d=Ce(s,!1),h=Ce(o,!1),p=s&&s.offsetRadius||20,m=n.map(function(g,y){var v=(g.startAngle+g.endAngle)/2,b=pt(g.cx,g.cy,g.outerRadius+p,v),x=ft(ft(ft(ft({},f),g),{},{stroke:"none"},d),{},{index:y,textAnchor:t.getTextAnchor(b.x,g.cx)},b),_=ft(ft(ft(ft({},f),g),{},{fill:"none",stroke:g.fill},h),{},{index:y,points:[pt(g.cx,g.cy,g.outerRadius,v),b]}),w=c;return $e(c)&&$e(u)?w="value":$e(c)&&(w=u),q.createElement(Je,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},o&&t.renderLabelLineItem(o,_,"line"),t.renderLabelItem(s,x,sr(g,w)))});return q.createElement(Je,{className:"recharts-pie-labels"},m)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,o=i.blendStroke,c=i.inactiveShape;return n.map(function(u,f){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var d=a.isActiveIndex(f),h=c&&a.hasActiveIndex()?c:null,p=d?s:h,m=ft(ft({},u),{},{stroke:o?u.fill:u.stroke,tabIndex:-1});return q.createElement(Je,cl({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},co(a.props,u,f),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(f)}),q.createElement(XO,cl({option:p,isActive:d,shapeType:"sector"},m)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,o=a.animationBegin,c=a.animationDuration,u=a.animationEasing,f=a.animationId,d=this.state,h=d.prevSectors,p=d.prevIsAnimationActive;return q.createElement(Qa,{begin:o,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(m){var g=m.t,y=[],v=i&&i[0],b=v.startAngle;return i.forEach(function(x,_){var w=h&&h[_],S=_>0?Mn(x,"paddingAngle",0):0;if(w){var k=kn(w.endAngle-w.startAngle,x.endAngle-x.startAngle),N=ft(ft({},x),{},{startAngle:b+S,endAngle:b+k(g)+S});y.push(N),b=N.endAngle}else{var j=x.endAngle,E=x.startAngle,A=kn(0,j-E),T=A(g),F=ft(ft({},x),{},{startAngle:b+S,endAngle:b+T+S});y.push(F),b=F.endAngle}}),q.createElement(Je,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var o=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!h0(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,o=a.className,c=a.label,u=a.cx,f=a.cy,d=a.innerRadius,h=a.outerRadius,p=a.isAnimationActive,m=this.state.isAnimationFinished;if(i||!s||!s.length||!ge(u)||!ge(f)||!ge(d)||!ge(h))return null;var g=ze("recharts-pie",o);return q.createElement(Je,{tabIndex:this.props.rootTabIndex,className:g,ref:function(v){n.pieRef=v}},this.renderSectors(),c&&this.renderLabels(s),gr.renderCallByParent(this.props,null,!1),(!p||m)&&Dn.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(q.isValidElement(n))return q.cloneElement(n,a);if(Ie(n))return n(a);var s=ze("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return q.createElement(Lh,cl({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(q.isValidElement(n))return q.cloneElement(n,a);var s=i;if(Ie(n)&&(s=n(a),q.isValidElement(s)))return s;var o=ze("recharts-pie-label-text",typeof n!="boolean"&&!Ie(n)?n.className:"");return q.createElement(uo,cl({},a,{alignmentBaseline:"middle",className:o}),s)}}])}(H.PureComponent);Md=pa;Zn(pa,"displayName","Pie");Zn(pa,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!No.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Zn(pa,"parseDeltaAngle",function(e,t){var r=tn(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Zn(pa,"getRealPieData",function(e){var t=e.data,r=e.children,n=Ce(e,!1),a=Fn(r,Ci);return t&&t.length?t.map(function(i,s){return ft(ft(ft({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return ft(ft({},n),i.props)}):[]});Zn(pa,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=EO(a,i),o=n+rn(e.cx,a,a/2),c=r+rn(e.cy,i,i/2),u=rn(e.innerRadius,s,0),f=rn(e.outerRadius,s,s*.8),d=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:o,cy:c,innerRadius:u,outerRadius:f,maxRadius:d}});Zn(pa,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?ft(ft({},t.type.defaultProps),t.props):t.props,a=Md.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,o=n.endAngle,c=n.paddingAngle,u=n.dataKey,f=n.nameKey,d=n.valueKey,h=n.tooltipType,p=Math.abs(n.minAngle),m=Md.parseCoordinateOfPie(n,r),g=Md.parseDeltaAngle(s,o),y=Math.abs(g),v=u;$e(u)&&$e(d)?(Oa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v="value"):$e(u)&&(Oa(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),v=d);var b=a.filter(function(N){return sr(N,v,0)!==0}).length,x=(y>=360?b:b-1)*c,_=y-b*p-x,w=a.reduce(function(N,j){var E=sr(j,v,0);return N+(ge(E)?E:0)},0),S;if(w>0){var k;S=a.map(function(N,j){var E=sr(N,v,0),A=sr(N,f,j),T=(ge(E)?E:0)/w,F;j?F=k.endAngle+tn(g)*c*(E!==0?1:0):F=s;var G=F+tn(g)*((E!==0?p:0)+T*_),M=(F+G)/2,W=(m.innerRadius+m.outerRadius)/2,Y=[{name:A,value:E,payload:N,dataKey:v,type:h}],K=pt(m.cx,m.cy,W,M);return k=ft(ft(ft({percent:T,cornerRadius:i,name:A,tooltipPayload:Y,midAngle:M,middleRadius:W,tooltipPosition:K},N),m),{},{value:sr(N,v),startAngle:F,endAngle:G,payload:N,paddingAngle:tn(g)*c}),k})}return ft(ft({},m),{},{sectors:S,data:a})});var Mne=Math.ceil,Fne=Math.max;function Dne(e,t,r,n){for(var a=-1,i=Fne(Mne((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var Ine=Dne,Rne=x3,SN=1/0,$ne=17976931348623157e292;function Lne(e){if(!e)return e===0?e:0;if(e=Rne(e),e===SN||e===-SN){var t=e<0?-1:1;return t*$ne}return e===e?e:0}var YO=Lne,Bne=Ine,Une=yx,Zm=YO;function zne(e){return function(t,r,n){return n&&typeof n!="number"&&Une(t,r,n)&&(r=n=void 0),t=Zm(t),r===void 0?(r=t,t=0):r=Zm(r),n=n===void 0?t<r?1:-1:Zm(n),Bne(t,r,n,e)}}var Wne=zne,Hne=Wne,Vne=Hne(),Gne=Vne;const Yh=st(Gne);function Tf(e){"@babel/helpers - typeof";return Tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tf(e)}function _N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_N(Object(r),!0).forEach(function(n){QO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QO(e,t,r){return t=Xne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xne(e){var t=Kne(e,"string");return Tf(t)=="symbol"?t:t+""}function Kne(e,t){if(Tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qne=["Webkit","Moz","O","ms"],Yne=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=qne.reduce(function(i,s){return kN(kN({},i),{},QO({},s+n,r))},{});return a[t]=r,a};function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}function Qh(){return Qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qh.apply(this,arguments)}function NN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Jm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NN(Object(r),!0).forEach(function(n){wn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JO(n.key),n)}}function Zne(e,t,r){return t&&jN(e.prototype,t),r&&jN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jne(e,t,r){return t=Zh(t),eae(e,ZO()?Reflect.construct(t,r||[],Zh(e).constructor):t.apply(e,r))}function eae(e,t){if(t&&(Gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tae(e)}function tae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZO=function(){return!!e})()}function Zh(e){return Zh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Zh(e)}function rae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S1(e,t)}function S1(e,t){return S1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},S1(e,t)}function wn(e,t,r){return t=JO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JO(e){var t=nae(e,"string");return Gl(t)=="symbol"?t:t+""}function nae(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aae=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,o=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=wu().domain(Yh(0,c)).range([i,i+s-o]),f=u.domain().map(function(d){return u(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:f}},EN=function(t){return t.changedTouches&&!!t.changedTouches.length},Xl=function(e){function t(r){var n;return Qne(this,t),n=Jne(this,t,[r]),wn(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),wn(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),wn(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,o=a.startIndex;s==null||s({endIndex:i,startIndex:o})}),n.detachDragEndListener()}),wn(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),wn(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),wn(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),wn(n,"handleSlideDragStart",function(a){var i=EN(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return rae(t,e),Zne(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,o=this.props,c=o.gap,u=o.data,f=u.length-1,d=Math.min(a,i),h=Math.max(a,i),p=t.getIndexInRange(s,d),m=t.getIndexInRange(s,h);return{startIndex:p-p%c,endIndex:m===f?f:m-m%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,o=a.dataKey,c=sr(i[n],o,n);return Ie(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,o=a.endX,c=this.props,u=c.x,f=c.width,d=c.travellerWidth,h=c.startIndex,p=c.endIndex,m=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,u+f-d-o,u+f-d-s):g<0&&(g=Math.max(g,u-s,u-o));var y=this.getIndex({startX:s+g,endX:o+g});(y.startIndex!==h||y.endIndex!==p)&&m&&m(y),this.setState({startX:s+g,endX:o+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=EN(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,o=a.endX,c=a.startX,u=this.state[s],f=this.props,d=f.x,h=f.width,p=f.travellerWidth,m=f.onChange,g=f.gap,y=f.data,v={startX:this.state.startX,endX:this.state.endX},b=n.pageX-i;b>0?b=Math.min(b,d+h-p-u):b<0&&(b=Math.max(b,d-u)),v[s]=u+b;var x=this.getIndex(v),_=x.startIndex,w=x.endIndex,S=function(){var N=y.length-1;return s==="startX"&&(o>c?_%g===0:w%g===0)||o<c&&w===N||s==="endX"&&(o>c?w%g===0:_%g===0)||o>c&&w===N};this.setState(wn(wn({},s,u+b),"brushMoveStartX",n.pageX),function(){m&&S()&&m(x)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,o=s.scaleValues,c=s.startX,u=s.endX,f=this.state[a],d=o.indexOf(f);if(d!==-1){var h=d+n;if(!(h===-1||h>=o.length)){var p=o[h];a==="startX"&&p>=u||a==="endX"&&p<=c||this.setState(wn({},a,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.fill,u=n.stroke;return q.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:s,height:o})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.data,u=n.children,f=n.padding,d=H.Children.only(u);return d?q.cloneElement(d,{x:a,y:i,width:s,height:o,margin:f,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,o=this,c=this.props,u=c.y,f=c.travellerWidth,d=c.height,h=c.traveller,p=c.ariaLabel,m=c.data,g=c.startIndex,y=c.endIndex,v=Math.max(n,this.props.x),b=Jm(Jm({},Ce(this.props,!1)),{},{x:v,y:u,width:f,height:d}),x=p||"Min value: ".concat((i=m[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=m[y])===null||s===void 0?void 0:s.name);return q.createElement(Je,{tabIndex:0,role:"slider","aria-label":x,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),o.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,a))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,o=i.height,c=i.stroke,u=i.travellerWidth,f=Math.min(n,a)+u,d=Math.max(Math.abs(a-n)-u,0);return q.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:f,y:s,width:d,height:o})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,o=n.height,c=n.travellerWidth,u=n.stroke,f=this.state,d=f.startX,h=f.endX,p=5,m={pointerEvents:"none",fill:u};return q.createElement(Je,{className:"recharts-brush-texts"},q.createElement(uo,Qh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,h)-p,y:s+o/2},m),this.getTextOfTick(a)),q.createElement(uo,Qh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,h)+c+p,y:s+o/2},m),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,o=n.x,c=n.y,u=n.width,f=n.height,d=n.alwaysShowText,h=this.state,p=h.startX,m=h.endX,g=h.isTextActive,y=h.isSlideMoving,v=h.isTravellerMoving,b=h.isTravellerFocused;if(!a||!a.length||!ge(o)||!ge(c)||!ge(u)||!ge(f)||u<=0||f<=0)return null;var x=ze("recharts-brush",i),_=q.Children.count(s)===1,w=Yne("userSelect","none");return q.createElement(Je,{className:x,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(p,m),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(m,"endX"),(g||y||v||b||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,o=n.height,c=n.stroke,u=Math.floor(i+o/2)-1;return q.createElement(q.Fragment,null,q.createElement("rect",{x:a,y:i,width:s,height:o,fill:c,stroke:"none"}),q.createElement("line",{x1:a+1,y1:u,x2:a+s-1,y2:u,fill:"none",stroke:"#fff"}),q.createElement("line",{x1:a+1,y1:u+2,x2:a+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return q.isValidElement(n)?i=q.cloneElement(n,a):Ie(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,o=n.x,c=n.travellerWidth,u=n.updateId,f=n.startIndex,d=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return Jm({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s},i&&i.length?aae({data:i,width:s,x:o,travellerWidth:c,startIndex:f,endIndex:d}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||o!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([o,o+s-c]);var h=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,o=i-1;o-s>1;){var c=Math.floor((s+o)/2);n[c]>a?o=c:s=c}return a>=n[o]?o:s}}])}(H.PureComponent);wn(Xl,"displayName","Brush");wn(Xl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var iae=yb;function sae(e,t){var r;return iae(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var oae=sae,lae=zA,cae=ei,uae=oae,fae=yn,dae=yx;function hae(e,t,r){var n=fae(e)?lae:uae;return r&&dae(e,t,r)&&(t=void 0),n(e,cae(t))}var pae=hae;const xae=st(pae);var Ka=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},TN=u3;function mae(e,t,r){t=="__proto__"&&TN?TN(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var gae=mae,vae=gae,yae=l3,bae=ei;function wae(e,t){var r={};return t=bae(t),yae(e,function(n,a,i){vae(r,a,t(n,a,i))}),r}var Sae=wae;const _ae=st(Sae);function kae(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Nae=kae,jae=yb;function Eae(e,t){var r=!0;return jae(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var Tae=Eae,Aae=Nae,Oae=Tae,Cae=ei,Pae=yn,Mae=yx;function Fae(e,t,r){var n=Pae(e)?Aae:Oae;return r&&Mae(e,t,r)&&(t=void 0),n(e,Cae(t))}var Dae=Fae;const eC=st(Dae);var Iae=["x","y"];function Af(e){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(e)}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_1.apply(this,arguments)}function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(n){Rae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rae(e,t,r){return t=$ae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $ae(e){var t=Lae(e,"string");return Af(t)=="symbol"?t:t+""}function Lae(e,t){if(Af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bae(e,t){if(e==null)return{};var r=Uae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Uae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zae(e,t){var r=e.x,n=e.y,a=Bae(e,Iae),i="".concat(r),s=parseInt(i,10),o="".concat(n),c=parseInt(o,10),u="".concat(t.height||a.height),f=parseInt(u,10),d="".concat(t.width||a.width),h=parseInt(d,10);return Qc(Qc(Qc(Qc(Qc({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:f,width:h,name:t.name,radius:t.radius})}function ON(e){return q.createElement(XO,_1({shapeType:"rectangle",propTransformer:zae,activeClassName:"recharts-active-bar"},e))}var Wae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=ge(n)||uL(n);return i?t(n,a):(i||ho(),r)}},Hae=["value","background"],tC;function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function Vae(e,t){if(e==null)return{};var r=Gae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Gae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Jh(){return Jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jh.apply(this,arguments)}function CN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CN(Object(r),!0).forEach(function(n){Gi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nC(n.key),n)}}function Kae(e,t,r){return t&&PN(e.prototype,t),r&&PN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qae(e,t,r){return t=ep(t),Yae(e,rC()?Reflect.construct(t,r||[],ep(e).constructor):t.apply(e,r))}function Yae(e,t){if(t&&(Kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qae(e)}function Qae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rC=function(){return!!e})()}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}function Zae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k1(e,t)}function k1(e,t){return k1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},k1(e,t)}function Gi(e,t,r){return t=nC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nC(e){var t=Jae(e,"string");return Kl(t)=="symbol"?t:t+""}function Jae(e,t){if(Kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ia=function(e){function t(){var r;Xae(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=qae(this,t,[].concat(a)),Gi(r,"state",{isAnimationFinished:!1}),Gi(r,"id",yc("recharts-bar-")),Gi(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Gi(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return Zae(t,e),Kae(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,o=i.dataKey,c=i.activeIndex,u=i.activeBar,f=Ce(this.props,!1);return n&&n.map(function(d,h){var p=h===c,m=p?u:s,g=Yt(Yt(Yt({},f),d),{},{isActive:p,option:m,index:h,dataKey:o,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return q.createElement(Je,Jh({className:"recharts-bar-rectangle"},co(a.props,d,h),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(h)}),q.createElement(ON,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,o=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,f=a.animationEasing,d=a.animationId,h=this.state.prevData;return q.createElement(Qa,{begin:c,duration:u,isActive:o,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var m=p.t,g=i.map(function(y,v){var b=h&&h[v];if(b){var x=kn(b.x,y.x),_=kn(b.y,y.y),w=kn(b.width,y.width),S=kn(b.height,y.height);return Yt(Yt({},y),{},{x:x(m),y:_(m),width:w(m),height:S(m)})}if(s==="horizontal"){var k=kn(0,y.height),N=k(m);return Yt(Yt({},y),{},{y:y.y+y.height-N,height:N})}var j=kn(0,y.width),E=j(m);return Yt(Yt({},y),{},{width:E})});return q.createElement(Je,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!h0(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,o=a.activeIndex,c=Ce(this.props.background,!1);return i.map(function(u,f){u.value;var d=u.background,h=Vae(u,Hae);if(!d)return null;var p=Yt(Yt(Yt(Yt(Yt({},h),{},{fill:"#eee"},d),c),co(n.props,u,f)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:f,className:"recharts-bar-background-rectangle"});return q.createElement(ON,Jh({key:"background-bar-".concat(f),option:n.props.background,isActive:f===o},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,o=i.xAxis,c=i.yAxis,u=i.layout,f=i.children,d=Fn(f,p0);if(!d)return null;var h=u==="vertical"?s[0].height/2:s[0].width/2,p=function(y,v){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:sr(y,v)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return q.createElement(Je,m,d.map(function(g){return q.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:s,xAxis:o,yAxis:c,layout:u,offset:h,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,o=n.xAxis,c=n.yAxis,u=n.left,f=n.top,d=n.width,h=n.height,p=n.isAnimationActive,m=n.background,g=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,v=ze("recharts-bar",s),b=o&&o.allowDataOverflow,x=c&&c.allowDataOverflow,_=b||x,w=$e(g)?this.id:g;return q.createElement(Je,{className:v},b||x?q.createElement("defs",null,q.createElement("clipPath",{id:"clipPath-".concat(w)},q.createElement("rect",{x:b?u:u-d/2,y:x?f:f-h/2,width:b?d:d*2,height:x?h:h*2}))):null,q.createElement(Je,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(w,")"):null},m?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,w),(!p||y)&&Dn.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(H.PureComponent);tC=Ia;Gi(Ia,"displayName","Bar");Gi(Ia,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!No.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Gi(Ia,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,o=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,f=e.dataStartIndex,d=e.displayedData,h=e.offset,p=AZ(n,r);if(!p)return null;var m=t.layout,g=r.type.defaultProps,y=g!==void 0?Yt(Yt({},g),r.props):r.props,v=y.dataKey,b=y.children,x=y.minPointSize,_=m==="horizontal"?s:i,w=u?_.scale.domain():null,S=IZ({numericAxis:_}),k=Fn(b,Ci),N=d.map(function(j,E){var A,T,F,G,M,W;u?A=OZ(u[f+E],w):(A=sr(j,v),Array.isArray(A)||(A=[S,A]));var Y=Wae(x,tC.defaultProps.minPointSize)(A[1],E);if(m==="horizontal"){var K,D=[s.scale(A[0]),s.scale(A[1])],Z=D[0],ee=D[1];T=kk({axis:i,ticks:o,bandSize:a,offset:p.offset,entry:j,index:E}),F=(K=ee??Z)!==null&&K!==void 0?K:void 0,G=p.size;var O=Z-ee;if(M=Number.isNaN(O)?0:O,W={x:T,y:s.y,width:G,height:s.height},Math.abs(Y)>0&&Math.abs(M)<Math.abs(Y)){var L=tn(M||Y)*(Math.abs(Y)-Math.abs(M));F-=L,M+=L}}else{var R=[i.scale(A[0]),i.scale(A[1])],X=R[0],J=R[1];if(T=X,F=kk({axis:s,ticks:c,bandSize:a,offset:p.offset,entry:j,index:E}),G=J-X,M=p.size,W={x:i.x,y:F,width:i.width,height:M},Math.abs(Y)>0&&Math.abs(G)<Math.abs(Y)){var le=tn(G||Y)*(Math.abs(Y)-Math.abs(G));G+=le}}return Yt(Yt(Yt({},j),{},{x:T,y:F,width:G,height:M,value:u?A:A[1],payload:j,background:W},k&&k[E]&&k[E].props),{},{tooltipPayload:[NO(r,j)],tooltipPosition:{x:T+G/2,y:F+M/2}})});return Yt({data:N,layout:m},h)});function Of(e){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(e)}function eie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aC(n.key),n)}}function tie(e,t,r){return t&&MN(e.prototype,t),r&&MN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FN(Object(r),!0).forEach(function(n){$x(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $x(e,t,r){return t=aC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aC(e){var t=rie(e,"string");return Of(t)=="symbol"?t:t+""}function rie(e,t){if(Of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iC=function(t,r,n,a,i){var s=t.width,o=t.height,c=t.layout,u=t.children,f=Object.keys(r),d={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},h=!!_n(u,Ia);return f.reduce(function(p,m){var g=r[m],y=g.orientation,v=g.domain,b=g.padding,x=b===void 0?{}:b,_=g.mirror,w=g.reversed,S="".concat(y).concat(_?"Mirror":""),k,N,j,E,A;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var T=v[1]-v[0],F=1/0,G=g.categoricalDomain.sort(hL);if(G.forEach(function(R,X){X>0&&(F=Math.min((R||0)-(G[X-1]||0),F))}),Number.isFinite(F)){var M=F/T,W=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(k=M*W/2),g.padding==="no-gap"){var Y=rn(t.barCategoryGap,M*W),K=M*W/2;k=K-Y-(K-Y)/W*Y}}}a==="xAxis"?N=[n.left+(x.left||0)+(k||0),n.left+n.width-(x.right||0)-(k||0)]:a==="yAxis"?N=c==="horizontal"?[n.top+n.height-(x.bottom||0),n.top+(x.top||0)]:[n.top+(x.top||0)+(k||0),n.top+n.height-(x.bottom||0)-(k||0)]:N=g.range,w&&(N=[N[1],N[0]]);var D=wO(g,i,h),Z=D.scale,ee=D.realScaleType;Z.domain(v).range(N),SO(Z);var O=_O(Z,Sa(Sa({},g),{},{realScaleType:ee}));a==="xAxis"?(A=y==="top"&&!_||y==="bottom"&&_,j=n.left,E=d[S]-A*g.height):a==="yAxis"&&(A=y==="left"&&!_||y==="right"&&_,j=d[S]-A*g.width,E=n.top);var L=Sa(Sa(Sa({},g),O),{},{realScaleType:ee,x:j,y:E,scale:Z,width:a==="xAxis"?n.width:g.width,height:a==="yAxis"?n.height:g.height});return L.bandSize=Ih(L,O),!g.hide&&a==="xAxis"?d[S]+=(A?-1:1)*L.height:g.hide||(d[S]+=(A?-1:1)*L.width),Sa(Sa({},p),{},$x({},m,L))},{})},sC=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},nie=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return sC({x:r,y:n},{x:a,y:i})},oC=function(){function e(t){eie(this,e),this.scale=t}return tie(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();$x(oC,"EPS",1e-4);var Kb=function(t){var r=Object.keys(t).reduce(function(n,a){return Sa(Sa({},n),{},$x({},a,oC.create(t[a])))},{});return Sa(Sa({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,o=i.position;return _ae(a,function(c,u){return r[u].apply(c,{bandAware:s,position:o})})},isInRange:function(a){return eC(a,function(i,s){return r[s].isInRange(i)})}})};function aie(e){return(e%180+180)%180}var iie=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=aie(a),s=i*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},sie=ei,oie=l0,lie=gx;function cie(e){return function(t,r,n){var a=Object(t);if(!oie(t)){var i=sie(r);t=lie(t),r=function(o){return i(a[o],o,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var uie=cie,fie=YO;function die(e){var t=fie(e),r=t%1;return t===t?r?t-r:t:0}var hie=die,pie=r3,xie=ei,mie=hie,gie=Math.max;function vie(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:mie(r);return a<0&&(a=gie(n+a,0)),pie(e,xie(t),a)}var yie=vie,bie=uie,wie=yie,Sie=bie(wie),_ie=Sie;const kie=st(_ie);var Nie=m$(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),qb=H.createContext(void 0),Yb=H.createContext(void 0),lC=H.createContext(void 0),cC=H.createContext({}),uC=H.createContext(void 0),fC=H.createContext(0),dC=H.createContext(0),DN=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,o=t.children,c=t.width,u=t.height,f=Nie(i);return q.createElement(qb.Provider,{value:n},q.createElement(Yb.Provider,{value:a},q.createElement(cC.Provider,{value:i},q.createElement(lC.Provider,{value:f},q.createElement(uC.Provider,{value:s},q.createElement(fC.Provider,{value:u},q.createElement(dC.Provider,{value:c},o)))))))},jie=function(){return H.useContext(uC)},hC=function(t){var r=H.useContext(qb);r==null&&ho();var n=r[t];return n==null&&ho(),n},Eie=function(){var t=H.useContext(qb);return Wi(t)},Tie=function(){var t=H.useContext(Yb),r=kie(t,function(n){return eC(n.domain,Number.isFinite)});return r||Wi(t)},pC=function(t){var r=H.useContext(Yb);r==null&&ho();var n=r[t];return n==null&&ho(),n},Aie=function(){var t=H.useContext(lC);return t},Oie=function(){return H.useContext(cC)},Qb=function(){return H.useContext(dC)},Zb=function(){return H.useContext(fC)};function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function Cie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mC(n.key),n)}}function Mie(e,t,r){return t&&Pie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fie(e,t,r){return t=tp(t),Die(e,xC()?Reflect.construct(t,r||[],tp(e).constructor):t.apply(e,r))}function Die(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iie(e)}function Iie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xC=function(){return!!e})()}function tp(e){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tp(e)}function Rie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N1(e,t)}function N1(e,t){return N1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},N1(e,t)}function IN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(r),!0).forEach(function(n){Jb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jb(e,t,r){return t=mC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mC(e){var t=$ie(e,"string");return ql(t)=="symbol"?t:t+""}function $ie(e,t){if(ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Lie(e,t){return Wie(e)||zie(e,t)||Uie(e,t)||Bie()}function Bie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uie(e,t){if(e){if(typeof e=="string")return $N(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $N(e,t)}}function $N(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Wie(e){if(Array.isArray(e))return e}function j1(){return j1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j1.apply(this,arguments)}var Hie=function(t,r){var n;return q.isValidElement(t)?n=q.cloneElement(t,r):Ie(t)?n=t(r):n=q.createElement("line",j1({},r,{className:"recharts-reference-line-line"})),n},Vie=function(t,r,n,a,i,s,o,c,u){var f=i.x,d=i.y,h=i.width,p=i.height;if(n){var m=u.y,g=t.y.apply(m,{position:s});if(Ka(u,"discard")&&!t.y.isInRange(g))return null;var y=[{x:f+h,y:g},{x:f,y:g}];return c==="left"?y.reverse():y}if(r){var v=u.x,b=t.x.apply(v,{position:s});if(Ka(u,"discard")&&!t.x.isInRange(b))return null;var x=[{x:b,y:d+p},{x:b,y:d}];return o==="top"?x.reverse():x}if(a){var _=u.segment,w=_.map(function(S){return t.apply(S,{position:s})});return Ka(u,"discard")&&xae(w,function(S){return!t.isInRange(S)})?null:w}return null};function Gie(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,o=e.className,c=e.alwaysShow,u=jie(),f=hC(a),d=pC(i),h=Aie();if(!u||!h)return null;Oa(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=Kb({x:f.scale,y:d.scale}),m=cr(t),g=cr(r),y=n&&n.length===2,v=Vie(p,m,g,y,h,e.position,f.orientation,d.orientation,e);if(!v)return null;var b=Lie(v,2),x=b[0],_=x.x,w=x.y,S=b[1],k=S.x,N=S.y,j=Ka(e,"hidden")?"url(#".concat(u,")"):void 0,E=RN(RN({clipPath:j},Ce(e,!0)),{},{x1:_,y1:w,x2:k,y2:N});return q.createElement(Je,{className:ze("recharts-reference-line",o)},Hie(s,E),gr.renderCallByParent(e,nie({x1:_,y1:w,x2:k,y2:N})))}var x0=function(e){function t(){return Cie(this,t),Fie(this,t,arguments)}return Rie(t,e),Mie(t,[{key:"render",value:function(){return q.createElement(Gie,this.props)}}])}(q.Component);Jb(x0,"displayName","ReferenceLine");Jb(x0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function E1(){return E1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E1.apply(this,arguments)}function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function LN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function BN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LN(Object(r),!0).forEach(function(n){Lx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vC(n.key),n)}}function qie(e,t,r){return t&&Kie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yie(e,t,r){return t=rp(t),Qie(e,gC()?Reflect.construct(t,r||[],rp(e).constructor):t.apply(e,r))}function Qie(e,t){if(t&&(Yl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Zie(e)}function Zie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gC=function(){return!!e})()}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}function Jie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T1(e,t)}function T1(e,t){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T1(e,t)}function Lx(e,t,r){return t=vC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vC(e){var t=ese(e,"string");return Yl(t)=="symbol"?t:t+""}function ese(e,t){if(Yl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var tse=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=Kb({x:a.scale,y:i.scale}),o=s.apply({x:r,y:n},{bandAware:!0});return Ka(t,"discard")&&!s.isInRange(o)?null:o},Bx=function(e){function t(){return Xie(this,t),Yie(this,t,arguments)}return Jie(t,e),qie(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,o=n.alwaysShow,c=n.clipPathId,u=cr(a),f=cr(i);if(Oa(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!f)return null;var d=tse(this.props);if(!d)return null;var h=d.x,p=d.y,m=this.props,g=m.shape,y=m.className,v=Ka(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=BN(BN({clipPath:v},Ce(this.props,!0)),{},{cx:h,cy:p});return q.createElement(Je,{className:ze("recharts-reference-dot",y)},t.renderDot(g,b),gr.renderCallByParent(this.props,{x:h-s,y:p-s,width:2*s,height:2*s}))}}])}(q.Component);Lx(Bx,"displayName","ReferenceDot");Lx(Bx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Lx(Bx,"renderDot",function(e,t){var r;return q.isValidElement(e)?r=q.cloneElement(e,t):Ie(e)?r=e(t):r=q.createElement(Cx,E1({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function A1(){return A1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A1.apply(this,arguments)}function Ql(e){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(e)}function UN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UN(Object(r),!0).forEach(function(n){Ux(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bC(n.key),n)}}function ase(e,t,r){return t&&nse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ise(e,t,r){return t=np(t),sse(e,yC()?Reflect.construct(t,r||[],np(e).constructor):t.apply(e,r))}function sse(e,t){if(t&&(Ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ose(e)}function ose(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yC=function(){return!!e})()}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}function lse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O1(e,t)}function O1(e,t){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},O1(e,t)}function Ux(e,t,r){return t=bC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bC(e){var t=cse(e,"string");return Ql(t)=="symbol"?t:t+""}function cse(e,t){if(Ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var use=function(t,r,n,a,i){var s=i.x1,o=i.x2,c=i.y1,u=i.y2,f=i.xAxis,d=i.yAxis;if(!f||!d)return null;var h=Kb({x:f.scale,y:d.scale}),p={x:t?h.x.apply(s,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},m={x:r?h.x.apply(o,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return Ka(i,"discard")&&(!h.isInRange(p)||!h.isInRange(m))?null:sC(p,m)},zx=function(e){function t(){return rse(this,t),ise(this,t,arguments)}return lse(t,e),ase(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,o=n.y2,c=n.className,u=n.alwaysShow,f=n.clipPathId;Oa(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=cr(a),h=cr(i),p=cr(s),m=cr(o),g=this.props.shape;if(!d&&!h&&!p&&!m&&!g)return null;var y=use(d,h,p,m,this.props);if(!y&&!g)return null;var v=Ka(this.props,"hidden")?"url(#".concat(f,")"):void 0;return q.createElement(Je,{className:ze("recharts-reference-area",c)},t.renderRect(g,zN(zN({clipPath:v},Ce(this.props,!0)),y)),gr.renderCallByParent(this.props,y))}}])}(q.Component);Ux(zx,"displayName","ReferenceArea");Ux(zx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Ux(zx,"renderRect",function(e,t){var r;return q.isValidElement(e)?r=q.cloneElement(e,t):Ie(e)?r=e(t):r=q.createElement(Xb,A1({},t,{className:"recharts-reference-area-rect"})),r});function wC(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function fse(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return iie(n,r)}function dse(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,o=e.height;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function ap(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function hse(e,t){return wC(e,t+1)}function pse(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,o=t.end,c=0,u=1,f=s,d=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:wC(n,u)};var g=c,y,v=function(){return y===void 0&&(y=r(m,g)),y},b=m.coordinate,x=c===0||ap(e,b,v,f,o);x||(c=0,f=s,u+=1),x&&(f=b+e*(v()/2+a),c+=u)},h;u<=i.length;)if(h=d(),h)return h.v;return[]}function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function WN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WN(Object(r),!0).forEach(function(n){xse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xse(e,t,r){return t=mse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mse(e){var t=gse(e,"string");return Cf(t)=="symbol"?t:t+""}function gse(e,t){if(Cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vse(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,o=t.start,c=t.end,u=function(h){var p=i[h],m,g=function(){return m===void 0&&(m=r(p,h)),m};if(h===s-1){var y=e*(p.coordinate+e*g()/2-c);i[h]=p=Br(Br({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[h]=p=Br(Br({},p),{},{tickCoord:p.coordinate});var v=ap(e,p.tickCoord,g,o,c);v&&(c=p.tickCoord-e*(g()/2+a),i[h]=Br(Br({},p),{},{isShow:!0}))},f=s-1;f>=0;f--)u(f);return i}function yse(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,c=t.start,u=t.end;if(i){var f=n[o-1],d=r(f,o-1),h=e*(f.coordinate+e*d/2-u);s[o-1]=f=Br(Br({},f),{},{tickCoord:h>0?f.coordinate-h*e:f.coordinate});var p=ap(e,f.tickCoord,function(){return d},c,u);p&&(u=f.tickCoord-e*(d/2+a),s[o-1]=Br(Br({},f),{},{isShow:!0}))}for(var m=i?o-1:o,g=function(b){var x=s[b],_,w=function(){return _===void 0&&(_=r(x,b)),_};if(b===0){var S=e*(x.coordinate-e*w()/2-c);s[b]=x=Br(Br({},x),{},{tickCoord:S<0?x.coordinate-S*e:x.coordinate})}else s[b]=x=Br(Br({},x),{},{tickCoord:x.coordinate});var k=ap(e,x.tickCoord,w,c,u);k&&(c=x.tickCoord+e*(w()/2+a),s[b]=Br(Br({},x),{},{isShow:!0}))},y=0;y<m;y++)g(y);return s}function ew(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,o=e.orientation,c=e.interval,u=e.tickFormatter,f=e.unit,d=e.angle;if(!a||!a.length||!n)return[];if(ge(c)||No.isSsr)return hse(a,typeof c=="number"&&ge(c)?c:0);var h=[],p=o==="top"||o==="bottom"?"width":"height",m=f&&p==="width"?bu(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(x,_){var w=Ie(u)?u(x.value,_):x.value;return p==="width"?fse(bu(w,{fontSize:t,letterSpacing:r}),m,d):bu(w,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?tn(a[1].coordinate-a[0].coordinate):1,v=dse(i,y,p);return c==="equidistantPreserveStart"?pse(y,v,g,a,s):(c==="preserveStart"||c==="preserveStartEnd"?h=yse(y,v,g,a,s,c==="preserveStartEnd"):h=vse(y,v,g,a,s),h.filter(function(b){return b.isShow}))}var bse=["viewBox"],wse=["viewBox"],Sse=["ticks"];function Zl(e){"@babel/helpers - typeof";return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function ul(){return ul=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ul.apply(this,arguments)}function HN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HN(Object(r),!0).forEach(function(n){tw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eg(e,t){if(e==null)return{};var r=_se(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _se(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_C(n.key),n)}}function Nse(e,t,r){return t&&VN(e.prototype,t),r&&VN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jse(e,t,r){return t=ip(t),Ese(e,SC()?Reflect.construct(t,r||[],ip(e).constructor):t.apply(e,r))}function Ese(e,t){if(t&&(Zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tse(e)}function Tse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SC=function(){return!!e})()}function ip(e){return ip=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ip(e)}function Ase(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C1(e,t)}function C1(e,t){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},C1(e,t)}function tw(e,t,r){return t=_C(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _C(e){var t=Ose(e,"string");return Zl(t)=="symbol"?t:t+""}function Ose(e,t){if(Zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var jc=function(e){function t(r){var n;return kse(this,t),n=jse(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return Ase(t,e),Nse(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=eg(n,bse),o=this.props,c=o.viewBox,u=eg(o,wse);return!yl(i,c)||!yl(s,u)||!yl(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,o=a.width,c=a.height,u=a.orientation,f=a.tickSize,d=a.mirror,h=a.tickMargin,p,m,g,y,v,b,x=d?-1:1,_=n.tickSize||f,w=ge(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":p=m=n.coordinate,y=s+ +!d*c,g=y-x*_,b=g-x*h,v=w;break;case"left":g=y=n.coordinate,m=i+ +!d*o,p=m-x*_,v=p-x*h,b=w;break;case"right":g=y=n.coordinate,m=i+ +d*o,p=m+x*_,v=p+x*h,b=w;break;default:p=m=n.coordinate,y=s+ +d*c,g=y+x*_,b=g+x*h,v=w;break}return{line:{x1:p,y1:g,x2:m,y2:y},tick:{x:v,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.orientation,u=n.mirror,f=n.axisLine,d=rr(rr(rr({},Ce(this.props,!1)),Ce(f,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!u||c==="bottom"&&u);d=rr(rr({},d),{},{x1:a,y1:i+h*o,x2:a+s,y2:i+h*o})}else{var p=+(c==="left"&&!u||c==="right"&&u);d=rr(rr({},d),{},{x1:a+p*s,y1:i,x2:a+p*s,y2:i+o})}return q.createElement("line",ul({},d,{className:ze("recharts-cartesian-axis-line",Mn(f,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,o=this.props,c=o.tickLine,u=o.stroke,f=o.tick,d=o.tickFormatter,h=o.unit,p=ew(rr(rr({},this.props),{},{ticks:n}),a,i),m=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Ce(this.props,!1),v=Ce(f,!1),b=rr(rr({},y),{},{fill:"none"},Ce(c,!1)),x=p.map(function(_,w){var S=s.getTickLineCoord(_),k=S.line,N=S.tick,j=rr(rr(rr(rr({textAnchor:m,verticalAnchor:g},y),{},{stroke:"none",fill:u},v),N),{},{index:w,payload:_,visibleTicksCount:p.length,tickFormatter:d});return q.createElement(Je,ul({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},co(s.props,_,w)),c&&q.createElement("line",ul({},b,k,{className:ze("recharts-cartesian-axis-tick-line",Mn(c,"className"))})),f&&t.renderTickItem(f,j,"".concat(Ie(d)?d(_.value,w):_.value).concat(h||"")))});return q.createElement("g",{className:"recharts-cartesian-axis-ticks"},x)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,o=a.height,c=a.ticksGenerator,u=a.className,f=a.hide;if(f)return null;var d=this.props,h=d.ticks,p=eg(d,Sse),m=h;return Ie(c)&&(m=h&&h.length>0?c(this.props):c(p)),s<=0||o<=0||!m||!m.length?null:q.createElement(Je,{className:ze("recharts-cartesian-axis",u),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(m,this.state.fontSize,this.state.letterSpacing),gr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,o=ze(a.className,"recharts-cartesian-axis-tick-value");return q.isValidElement(n)?s=q.cloneElement(n,rr(rr({},a),{},{className:o})):Ie(n)?s=n(rr(rr({},a),{},{className:o})):s=q.createElement(uo,ul({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(H.Component);tw(jc,"displayName","CartesianAxis");tw(jc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Cse=["x1","y1","x2","y2","key"],Pse=["offset"];function po(e){"@babel/helpers - typeof";return po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},po(e)}function GN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GN(Object(r),!0).forEach(function(n){Mse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mse(e,t,r){return t=Fse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fse(e){var t=Dse(e,"string");return po(t)=="symbol"?t:t+""}function Dse(e,t){if(po(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(po(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xs(){return Xs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xs.apply(this,arguments)}function XN(e,t){if(e==null)return{};var r=Ise(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ise(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Rse=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,o=t.height,c=t.ry;return q.createElement("rect",{x:a,y:i,ry:c,width:s,height:o,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function kC(e,t){var r;if(q.isValidElement(e))r=q.cloneElement(e,t);else if(Ie(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,o=t.key,c=XN(t,Cse),u=Ce(c,!1);u.offset;var f=XN(u,Pse);r=q.createElement("line",Xs({},f,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function $se(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,c){var u=Hr(Hr({},e),{},{x1:t,y1:o,x2:t+r,y2:o,key:"line-".concat(c),index:c});return kC(a,u)});return q.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function Lse(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,c){var u=Hr(Hr({},e),{},{x1:o,y1:t,x2:o,y2:t+r,key:"line-".concat(c),index:c});return kC(a,u)});return q.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function Bse(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,o=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var f=o.map(function(h){return Math.round(h+a-a)}).sort(function(h,p){return h-p});a!==f[0]&&f.unshift(0);var d=f.map(function(h,p){var m=!f[p+1],g=m?a+s-h:f[p+1]-h;if(g<=0)return null;var y=p%t.length;return q.createElement("rect",{key:"react-".concat(p),y:h,x:n,height:g,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return q.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function Use(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,o=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var f=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,p){return h-p});i!==f[0]&&f.unshift(0);var d=f.map(function(h,p){var m=!f[p+1],g=m?i+o-h:f[p+1]-h;if(g<=0)return null;var y=p%n.length;return q.createElement("rect",{key:"react-".concat(p),x:h,y:s,width:g,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return q.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var zse=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return bO(ew(Hr(Hr(Hr({},jc.defaultProps),n),{},{ticks:di(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},Wse=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return bO(ew(Hr(Hr(Hr({},jc.defaultProps),n),{},{ticks:di(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},Lo={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Pf(e){var t,r,n,a,i,s,o=Qb(),c=Zb(),u=Oie(),f=Hr(Hr({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Lo.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Lo.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Lo.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Lo.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Lo.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Lo.verticalFill,x:ge(e.x)?e.x:u.left,y:ge(e.y)?e.y:u.top,width:ge(e.width)?e.width:u.width,height:ge(e.height)?e.height:u.height}),d=f.x,h=f.y,p=f.width,m=f.height,g=f.syncWithTicks,y=f.horizontalValues,v=f.verticalValues,b=Eie(),x=Tie();if(!ge(p)||p<=0||!ge(m)||m<=0||!ge(d)||d!==+d||!ge(h)||h!==+h)return null;var _=f.verticalCoordinatesGenerator||zse,w=f.horizontalCoordinatesGenerator||Wse,S=f.horizontalPoints,k=f.verticalPoints;if((!S||!S.length)&&Ie(w)){var N=y&&y.length,j=w({yAxis:x?Hr(Hr({},x),{},{ticks:N?y:x.ticks}):void 0,width:o,height:c,offset:u},N?!0:g);Oa(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(po(j),"]")),Array.isArray(j)&&(S=j)}if((!k||!k.length)&&Ie(_)){var E=v&&v.length,A=_({xAxis:b?Hr(Hr({},b),{},{ticks:E?v:b.ticks}):void 0,width:o,height:c,offset:u},E?!0:g);Oa(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(po(A),"]")),Array.isArray(A)&&(k=A)}return q.createElement("g",{className:"recharts-cartesian-grid"},q.createElement(Rse,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),q.createElement($se,Xs({},f,{offset:u,horizontalPoints:S,xAxis:b,yAxis:x})),q.createElement(Lse,Xs({},f,{offset:u,verticalPoints:k,xAxis:b,yAxis:x})),q.createElement(Bse,Xs({},f,{horizontalPoints:S})),q.createElement(Use,Xs({},f,{verticalPoints:k})))}Pf.displayName="CartesianGrid";var Hse=["type","layout","connectNulls","ref"],Vse=["key"];function Jl(e){"@babel/helpers - typeof";return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(e)}function KN(e,t){if(e==null)return{};var r=Gse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Gse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ju.apply(this,arguments)}function qN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qN(Object(r),!0).forEach(function(n){_a(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bo(e){return Yse(e)||qse(e)||Kse(e)||Xse()}function Xse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kse(e,t){if(e){if(typeof e=="string")return P1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P1(e,t)}}function qse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yse(e){if(Array.isArray(e))return P1(e)}function P1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jC(n.key),n)}}function Zse(e,t,r){return t&&YN(e.prototype,t),r&&YN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jse(e,t,r){return t=sp(t),eoe(e,NC()?Reflect.construct(t,r||[],sp(e).constructor):t.apply(e,r))}function eoe(e,t){if(t&&(Jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return toe(e)}function toe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NC=function(){return!!e})()}function sp(e){return sp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sp(e)}function roe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M1(e,t)}function M1(e,t){return M1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},M1(e,t)}function _a(e,t,r){return t=jC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jC(e){var t=noe(e,"string");return Jl(t)=="symbol"?t:t+""}function noe(e,t){if(Jl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var m0=function(e){function t(){var r;Qse(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Jse(this,t,[].concat(a)),_a(r,"state",{isAnimationFinished:!0,totalLength:0}),_a(r,"generateSimpleStrokeDasharray",function(s,o){return"".concat(o,"px ").concat(s-o,"px")}),_a(r,"getStrokeDasharray",function(s,o,c){var u=c.reduce(function(v,b){return v+b});if(!u)return r.generateSimpleStrokeDasharray(o,s);for(var f=Math.floor(s/u),d=s%u,h=o-s,p=[],m=0,g=0;m<c.length;g+=c[m],++m)if(g+c[m]>d){p=[].concat(Bo(c.slice(0,m)),[d-g]);break}var y=p.length%2===0?[0,h]:[h];return[].concat(Bo(t.repeat(c,f)),Bo(p),y).map(function(v){return"".concat(v,"px")}).join(", ")}),_a(r,"id",yc("recharts-line-")),_a(r,"pathRef",function(s){r.mainCurve=s}),_a(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),_a(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return roe(t,e),Zse(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,o=i.xAxis,c=i.yAxis,u=i.layout,f=i.children,d=Fn(f,p0);if(!d)return null;var h=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:sr(g.payload,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return q.createElement(Je,p,d.map(function(m){return q.cloneElement(m,{key:"bar-".concat(m.props.dataKey),data:s,xAxis:o,yAxis:c,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,c=o.dot,u=o.points,f=o.dataKey,d=Ce(this.props,!1),h=Ce(c,!0),p=u.map(function(g,y){var v=bn(bn(bn({key:"dot-".concat(y),r:3},d),h),{},{index:y,cx:g.x,cy:g.y,value:g.value,dataKey:f,payload:g.payload,points:u});return t.renderDotItem(c,v)}),m={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return q.createElement(Je,ju({className:"recharts-line-dots",key:"dots"},m),p)}},{key:"renderCurveStatically",value:function(n,a,i,s){var o=this.props,c=o.type,u=o.layout,f=o.connectNulls;o.ref;var d=KN(o,Hse),h=bn(bn(bn({},Ce(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:u,connectNulls:f});return q.createElement(Lh,ju({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,o=s.points,c=s.strokeDasharray,u=s.isAnimationActive,f=s.animationBegin,d=s.animationDuration,h=s.animationEasing,p=s.animationId,m=s.animateNewValues,g=s.width,y=s.height,v=this.state,b=v.prevPoints,x=v.totalLength;return q.createElement(Qa,{begin:f,duration:d,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var w=_.t;if(b){var S=b.length/o.length,k=o.map(function(T,F){var G=Math.floor(F*S);if(b[G]){var M=b[G],W=kn(M.x,T.x),Y=kn(M.y,T.y);return bn(bn({},T),{},{x:W(w),y:Y(w)})}if(m){var K=kn(g*2,T.x),D=kn(y/2,T.y);return bn(bn({},T),{},{x:K(w),y:D(w)})}return bn(bn({},T),{},{x:T.x,y:T.y})});return i.renderCurveStatically(k,n,a)}var N=kn(0,x),j=N(w),E;if(c){var A="".concat(c).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});E=i.getStrokeDasharray(j,x,A)}else E=i.generateSimpleStrokeDasharray(x,j);return i.renderCurveStatically(o,n,a,{strokeDasharray:E})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,o=i.isAnimationActive,c=this.state,u=c.prevPoints,f=c.totalLength;return o&&s&&s.length&&(!u&&f>0||!h0(u,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,o=a.points,c=a.className,u=a.xAxis,f=a.yAxis,d=a.top,h=a.left,p=a.width,m=a.height,g=a.isAnimationActive,y=a.id;if(i||!o||!o.length)return null;var v=this.state.isAnimationFinished,b=o.length===1,x=ze("recharts-line",c),_=u&&u.allowDataOverflow,w=f&&f.allowDataOverflow,S=_||w,k=$e(y)?this.id:y,N=(n=Ce(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},j=N.r,E=j===void 0?3:j,A=N.strokeWidth,T=A===void 0?2:A,F=SL(s)?s:{},G=F.clipDot,M=G===void 0?!0:G,W=E*2+T;return q.createElement(Je,{className:x},_||w?q.createElement("defs",null,q.createElement("clipPath",{id:"clipPath-".concat(k)},q.createElement("rect",{x:_?h:h-p/2,y:w?d:d-m/2,width:_?p:p*2,height:w?m:m*2})),!M&&q.createElement("clipPath",{id:"clipPath-dots-".concat(k)},q.createElement("rect",{x:h-W/2,y:d-W/2,width:p+W,height:m+W}))):null,!b&&this.renderCurve(S,k),this.renderErrorBar(S,k),(b||s)&&this.renderDots(S,M,k),(!g||v)&&Dn.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Bo(n),[0]):n,s=[],o=0;o<a;++o)s=[].concat(Bo(s),Bo(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(q.isValidElement(n))i=q.cloneElement(n,a);else if(Ie(n))i=n(a);else{var s=a.key,o=KN(a,Vse),c=ze("recharts-line-dot",typeof n!="boolean"?n.className:"");i=q.createElement(Cx,ju({key:s},o,{className:c}))}return i}}])}(H.PureComponent);_a(m0,"displayName","Line");_a(m0,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!No.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});_a(m0,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,o=e.bandSize,c=e.displayedData,u=e.offset,f=t.layout,d=c.map(function(h,p){var m=sr(h,s);return f==="horizontal"?{x:_k({axis:r,ticks:a,bandSize:o,entry:h,index:p}),y:$e(m)?null:n.scale(m),value:m,payload:h}:{x:$e(m)?null:r.scale(m),y:_k({axis:n,ticks:i,bandSize:o,entry:h,index:p}),value:m,payload:h}});return bn({points:d,layout:f},u)});function ec(e){"@babel/helpers - typeof";return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ec(e)}function aoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ioe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AC(n.key),n)}}function soe(e,t,r){return t&&ioe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ooe(e,t,r){return t=op(t),loe(e,EC()?Reflect.construct(t,r||[],op(e).constructor):t.apply(e,r))}function loe(e,t){if(t&&(ec(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return coe(e)}function coe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EC=function(){return!!e})()}function op(e){return op=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},op(e)}function uoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F1(e,t)}function F1(e,t){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},F1(e,t)}function TC(e,t,r){return t=AC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AC(e){var t=foe(e,"string");return ec(t)=="symbol"?t:t+""}function foe(e,t){if(ec(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ec(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function D1(){return D1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D1.apply(this,arguments)}function doe(e){var t=e.xAxisId,r=Qb(),n=Zb(),a=hC(t);return a==null?null:H.createElement(jc,D1({},a,{className:ze("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return di(s,!0)}}))}var la=function(e){function t(){return aoe(this,t),ooe(this,t,arguments)}return uoe(t,e),soe(t,[{key:"render",value:function(){return H.createElement(doe,this.props)}}])}(H.Component);TC(la,"displayName","XAxis");TC(la,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function tc(e){"@babel/helpers - typeof";return tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tc(e)}function hoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function poe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PC(n.key),n)}}function xoe(e,t,r){return t&&poe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function moe(e,t,r){return t=lp(t),goe(e,OC()?Reflect.construct(t,r||[],lp(e).constructor):t.apply(e,r))}function goe(e,t){if(t&&(tc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return voe(e)}function voe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OC=function(){return!!e})()}function lp(e){return lp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lp(e)}function yoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I1(e,t)}function I1(e,t){return I1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},I1(e,t)}function CC(e,t,r){return t=PC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PC(e){var t=boe(e,"string");return tc(t)=="symbol"?t:t+""}function boe(e,t){if(tc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function R1(){return R1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R1.apply(this,arguments)}var woe=function(t){var r=t.yAxisId,n=Qb(),a=Zb(),i=pC(r);return i==null?null:H.createElement(jc,R1({},i,{className:ze("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(o){return di(o,!0)}}))},ca=function(e){function t(){return hoe(this,t),moe(this,t,arguments)}return yoe(t,e),xoe(t,[{key:"render",value:function(){return H.createElement(woe,this.props)}}])}(H.Component);CC(ca,"displayName","YAxis");CC(ca,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function QN(e){return Noe(e)||koe(e)||_oe(e)||Soe()}function Soe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _oe(e,t){if(e){if(typeof e=="string")return $1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $1(e,t)}}function koe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Noe(e){if(Array.isArray(e))return $1(e)}function $1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L1=function(t,r,n,a,i){var s=Fn(t,x0),o=Fn(t,Bx),c=[].concat(QN(s),QN(o)),u=Fn(t,zx),f="".concat(a,"Id"),d=a[0],h=r;if(c.length&&(h=c.reduce(function(g,y){if(y.props[f]===n&&Ka(y.props,"extendDomain")&&ge(y.props[d])){var v=y.props[d];return[Math.min(g[0],v),Math.max(g[1],v)]}return g},h)),u.length){var p="".concat(d,"1"),m="".concat(d,"2");h=u.reduce(function(g,y){if(y.props[f]===n&&Ka(y.props,"extendDomain")&&ge(y.props[p])&&ge(y.props[m])){var v=y.props[p],b=y.props[m];return[Math.min(g[0],v,b),Math.max(g[1],v,b)]}return g},h)}return i&&i.length&&(h=i.reduce(function(g,y){return ge(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},h)),h},MC={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function i(c,u,f,d,h){if(typeof f!="function")throw new TypeError("The listener must be a function");var p=new a(f,d||c,h),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)t.call(f,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},o.prototype.listeners=function(u){var f=r?r+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,m=new Array(p);h<p;h++)m[h]=d[h].fn;return m},o.prototype.listenerCount=function(u){var f=r?r+u:u,d=this._events[f];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,f,d,h,p,m){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],v=arguments.length,b,x;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),v){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,d),!0;case 4:return y.fn.call(y.context,f,d,h),!0;case 5:return y.fn.call(y.context,f,d,h,p),!0;case 6:return y.fn.call(y.context,f,d,h,p,m),!0}for(x=1,b=new Array(v-1);x<v;x++)b[x-1]=arguments[x];y.fn.apply(y.context,b)}else{var _=y.length,w;for(x=0;x<_;x++)switch(y[x].once&&this.removeListener(u,y[x].fn,void 0,!0),v){case 1:y[x].fn.call(y[x].context);break;case 2:y[x].fn.call(y[x].context,f);break;case 3:y[x].fn.call(y[x].context,f,d);break;case 4:y[x].fn.call(y[x].context,f,d,h);break;default:if(!b)for(w=1,b=new Array(v-1);w<v;w++)b[w-1]=arguments[w];y[x].fn.apply(y[x].context,b)}}return!0},o.prototype.on=function(u,f,d){return i(this,u,f,d,!1)},o.prototype.once=function(u,f,d){return i(this,u,f,d,!0)},o.prototype.removeListener=function(u,f,d,h){var p=r?r+u:u;if(!this._events[p])return this;if(!f)return s(this,p),this;var m=this._events[p];if(m.fn)m.fn===f&&(!h||m.once)&&(!d||m.context===d)&&s(this,p);else{for(var g=0,y=[],v=m.length;g<v;g++)(m[g].fn!==f||h&&!m[g].once||d&&m[g].context!==d)&&y.push(m[g]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},o.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(MC);var joe=MC.exports;const Eoe=st(joe);var tg=new Eoe,rg="recharts.syncMouseEvents";function Mf(e){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mf(e)}function Toe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Aoe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FC(n.key),n)}}function Ooe(e,t,r){return t&&Aoe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ng(e,t,r){return t=FC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FC(e){var t=Coe(e,"string");return Mf(t)=="symbol"?t:t+""}function Coe(e,t){if(Mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Poe=function(){function e(){Toe(this,e),ng(this,"activeIndex",0),ng(this,"coordinateList",[]),ng(this,"layout","horizontal")}return Ooe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,o=s===void 0?null:s,c=r.layout,u=c===void 0?null:c,f=r.offset,d=f===void 0?null:f,h=r.mouseHandlerCallback,p=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=o??this.container,this.layout=u??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,o=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,f=((n=window)===null||n===void 0?void 0:n.scrollY)||0,d=i+c+u,h=s+this.offset.top+o/2+f;this.mouseHandlerCallback({pageX:d,pageY:h})}}}])}();function Moe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&ge(n)&&ge(a))return!0}return!1}function Foe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function DC(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=pt(t,r,n,a),o=pt(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Doe(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,c=t.cy,u=t.innerRadius,f=t.outerRadius,d=t.angle,h=pt(o,c,u,d),p=pt(o,c,f,d);n=h.x,a=h.y,i=p.x,s=p.y}else return DC(t);return[{x:n,y:a},{x:i,y:s}]}function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function ZN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function id(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZN(Object(r),!0).forEach(function(n){Ioe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ioe(e,t,r){return t=Roe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Roe(e){var t=$oe(e,"string");return Ff(t)=="symbol"?t:t+""}function $oe(e,t){if(Ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Loe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,o=e.activePayload,c=e.offset,u=e.activeTooltipIndex,f=e.tooltipAxisBandSize,d=e.layout,h=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!i||!s||h!=="ScatterChart"&&a!=="axis")return null;var m,g=Lh;if(h==="ScatterChart")m=s,g=nre;else if(h==="BarChart")m=Foe(d,s,c,f),g=Xb;else if(d==="radial"){var y=DC(s),v=y.cx,b=y.cy,x=y.radius,_=y.startAngle,w=y.endAngle;m={cx:v,cy:b,startAngle:_,endAngle:w,innerRadius:x,outerRadius:x},g=CO}else m={points:Doe(d,s,c)},g=Lh;var S=id(id(id(id({stroke:"#ccc",pointerEvents:"none"},c),m),Ce(p,!1)),{},{payload:o,payloadIndex:u,className:ze("recharts-tooltip-cursor",p.className)});return H.isValidElement(p)?H.cloneElement(p,S):H.createElement(g,S)}var Boe=["item"],Uoe=["children","className","width","height","style","compact","title","desc"];function rc(e){"@babel/helpers - typeof";return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rc(e)}function fl(){return fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fl.apply(this,arguments)}function JN(e,t){return Hoe(e)||Woe(e,t)||RC(e,t)||zoe()}function zoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Woe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Hoe(e){if(Array.isArray(e))return e}function ej(e,t){if(e==null)return{};var r=Voe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Voe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Goe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xoe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$C(n.key),n)}}function Koe(e,t,r){return t&&Xoe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qoe(e,t,r){return t=cp(t),Yoe(e,IC()?Reflect.construct(t,r||[],cp(e).constructor):t.apply(e,r))}function Yoe(e,t){if(t&&(rc(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qoe(e)}function Qoe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IC=function(){return!!e})()}function cp(e){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cp(e)}function Zoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B1(e,t)}function B1(e,t){return B1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},B1(e,t)}function nc(e){return tle(e)||ele(e)||RC(e)||Joe()}function Joe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RC(e,t){if(e){if(typeof e=="string")return U1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U1(e,t)}}function ele(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tle(e){if(Array.isArray(e))return U1(e)}function U1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ce(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tj(Object(r),!0).forEach(function(n){Pe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pe(e,t,r){return t=$C(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $C(e){var t=rle(e,"string");return rc(t)=="symbol"?t:t+""}function rle(e,t){if(rc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nle={xAxis:["bottom","top"],yAxis:["left","right"]},ale={width:"100%",height:"100%"},LC={x:0,y:0};function sd(e){return e}var ile=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},sle=function(t,r,n,a){var i=r.find(function(f){return f&&f.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,o=a.radius;return ce(ce(ce({},a),pt(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var c=i.coordinate,u=a.angle;return ce(ce(ce({},a),pt(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return LC},Wx=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(o,c){var u=c.props.data;return u&&u.length?[].concat(nc(o),nc(u)):o},[]);return s.length>0?s:t&&t.length&&ge(a)&&ge(i)?t.slice(a,i+1):[]};function BC(e){return e==="number"?[0,"auto"]:void 0}var z1=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,o=Wx(r,t);return n<0||!i||!i.length||n>=o.length?null:i.reduce(function(c,u){var f,d=(f=u.props.data)!==null&&f!==void 0?f:r;d&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(d=d.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(s.dataKey&&!s.allowDuplicatedCategory){var p=d===void 0?o:d;h=oh(p,s.dataKey,a)}else h=d&&d[n]||o[n];return h?[].concat(nc(c),[NO(u,h)]):c},[])},rj=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=ile(i,n),o=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,f=_Z(s,o,u,c);if(f>=0&&u){var d=u[f]&&u[f].value,h=z1(t,r,f,d),p=sle(n,o,f,i);return{activeTooltipIndex:f,activeLabel:d,activePayload:h,activeCoordinate:p}}return null},ole=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,h=t.stackOffset,p=yO(f,i);return n.reduce(function(m,g){var y,v=g.type.defaultProps!==void 0?ce(ce({},g.type.defaultProps),g.props):g.props,b=v.type,x=v.dataKey,_=v.allowDataOverflow,w=v.allowDuplicatedCategory,S=v.scale,k=v.ticks,N=v.includeHidden,j=v[s];if(m[j])return m;var E=Wx(t.data,{graphicalItems:a.filter(function(O){var L,R=s in O.props?O.props[s]:(L=O.type.defaultProps)===null||L===void 0?void 0:L[s];return R===j}),dataStartIndex:c,dataEndIndex:u}),A=E.length,T,F,G;Moe(v.domain,_,b)&&(T=r1(v.domain,null,_),p&&(b==="number"||S!=="auto")&&(G=Su(E,x,"category")));var M=BC(b);if(!T||T.length===0){var W,Y=(W=v.domain)!==null&&W!==void 0?W:M;if(x){if(T=Su(E,x,b),b==="category"&&p){var K=dL(T);w&&K?(F=T,T=Yh(0,A)):w||(T=Ek(Y,T,g).reduce(function(O,L){return O.indexOf(L)>=0?O:[].concat(nc(O),[L])},[]))}else if(b==="category")w?T=T.filter(function(O){return O!==""&&!$e(O)}):T=Ek(Y,T,g).reduce(function(O,L){return O.indexOf(L)>=0||L===""||$e(L)?O:[].concat(nc(O),[L])},[]);else if(b==="number"){var D=TZ(E,a.filter(function(O){var L,R,X=s in O.props?O.props[s]:(L=O.type.defaultProps)===null||L===void 0?void 0:L[s],J="hide"in O.props?O.props.hide:(R=O.type.defaultProps)===null||R===void 0?void 0:R.hide;return X===j&&(N||!J)}),x,i,f);D&&(T=D)}p&&(b==="number"||S!=="auto")&&(G=Su(E,x,"category"))}else p?T=Yh(0,A):o&&o[j]&&o[j].hasStack&&b==="number"?T=h==="expand"?[0,1]:kO(o[j].stackGroups,c,u):T=vO(E,a.filter(function(O){var L=s in O.props?O.props[s]:O.type.defaultProps[s],R="hide"in O.props?O.props.hide:O.type.defaultProps.hide;return L===j&&(N||!R)}),b,f,!0);if(b==="number")T=L1(d,T,j,i,k),Y&&(T=r1(Y,T,_));else if(b==="category"&&Y){var Z=Y,ee=T.every(function(O){return Z.indexOf(O)>=0});ee&&(T=Z)}}return ce(ce({},m),{},Pe({},j,ce(ce({},v),{},{axisType:i,domain:T,categoricalDomain:G,duplicateDomain:F,originalDomain:(y=v.domain)!==null&&y!==void 0?y:M,isCategorical:p,layout:f})))},{})},lle=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,h=Wx(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=h.length,m=yO(f,i),g=-1;return n.reduce(function(y,v){var b=v.type.defaultProps!==void 0?ce(ce({},v.type.defaultProps),v.props):v.props,x=b[s],_=BC("number");if(!y[x]){g++;var w;return m?w=Yh(0,p):o&&o[x]&&o[x].hasStack?(w=kO(o[x].stackGroups,c,u),w=L1(d,w,x,i)):(w=r1(_,vO(h,n.filter(function(S){var k,N,j=s in S.props?S.props[s]:(k=S.type.defaultProps)===null||k===void 0?void 0:k[s],E="hide"in S.props?S.props.hide:(N=S.type.defaultProps)===null||N===void 0?void 0:N.hide;return j===x&&!E}),"number",f),a.defaultProps.allowDataOverflow),w=L1(d,w,x,i)),ce(ce({},y),{},Pe({},x,ce(ce({axisType:i},a.defaultProps),{},{hide:!0,orientation:Mn(nle,"".concat(i,".").concat(g%2),null),domain:w,originalDomain:_,isCategorical:m,layout:f})))}return y},{})},cle=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.children,d="".concat(a,"Id"),h=Fn(f,i),p={};return h&&h.length?p=ole(t,{axes:h,graphicalItems:s,axisType:a,axisIdKey:d,stackGroups:o,dataStartIndex:c,dataEndIndex:u}):s&&s.length&&(p=lle(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:d,stackGroups:o,dataStartIndex:c,dataEndIndex:u})),p},ule=function(t){var r=Wi(t),n=di(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:bb(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Ih(r,n)}},nj=function(t){var r=t.children,n=t.defaultShowTooltip,a=_n(r,Xl),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},fle=function(t){return!t||!t.length?!1:t.some(function(r){var n=xi(r&&r.type);return n&&n.indexOf("Bar")>=0})},aj=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},dle=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,o=t.yAxisMap,c=o===void 0?{}:o,u=n.width,f=n.height,d=n.children,h=n.margin||{},p=_n(d,Xl),m=_n(d,na),g=Object.keys(c).reduce(function(w,S){var k=c[S],N=k.orientation;return!k.mirror&&!k.hide?ce(ce({},w),{},Pe({},N,w[N]+k.width)):w},{left:h.left||0,right:h.right||0}),y=Object.keys(s).reduce(function(w,S){var k=s[S],N=k.orientation;return!k.mirror&&!k.hide?ce(ce({},w),{},Pe({},N,Mn(w,"".concat(N))+k.height)):w},{top:h.top||0,bottom:h.bottom||0}),v=ce(ce({},y),g),b=v.bottom;p&&(v.bottom+=p.props.height||Xl.defaultProps.height),m&&r&&(v=jZ(v,a,n,r));var x=u-v.left-v.right,_=f-v.top-v.bottom;return ce(ce({brushBottom:b},v),{},{width:Math.max(x,0),height:Math.max(_,0)})},hle=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},rw=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,o=s===void 0?["axis"]:s,c=t.axisComponents,u=t.legendContent,f=t.formatAxisMap,d=t.defaultProps,h=function(v,b){var x=b.graphicalItems,_=b.stackGroups,w=b.offset,S=b.updateId,k=b.dataStartIndex,N=b.dataEndIndex,j=v.barSize,E=v.layout,A=v.barGap,T=v.barCategoryGap,F=v.maxBarSize,G=aj(E),M=G.numericAxisName,W=G.cateAxisName,Y=fle(x),K=[];return x.forEach(function(D,Z){var ee=Wx(v.data,{graphicalItems:[D],dataStartIndex:k,dataEndIndex:N}),O=D.type.defaultProps!==void 0?ce(ce({},D.type.defaultProps),D.props):D.props,L=O.dataKey,R=O.maxBarSize,X=O["".concat(M,"Id")],J=O["".concat(W,"Id")],le={},se=c.reduce(function(zt,kr){var Xt=b["".concat(kr.axisType,"Map")],It=O["".concat(kr.axisType,"Id")];Xt&&Xt[It]||kr.axisType==="zAxis"||ho();var Kt=Xt[It];return ce(ce({},zt),{},Pe(Pe({},kr.axisType,Kt),"".concat(kr.axisType,"Ticks"),di(Kt)))},le),Q=se[W],te=se["".concat(W,"Ticks")],fe=_&&_[X]&&_[X].hasStack&&RZ(D,_[X].stackGroups),P=xi(D.type).indexOf("Bar")>=0,ke=Ih(Q,te),be=[],Te=Y&&kZ({barSize:j,stackGroups:_,totalSize:hle(se,W)});if(P){var Ae,he,We=$e(R)?F:R,xt=(Ae=(he=Ih(Q,te,!0))!==null&&he!==void 0?he:We)!==null&&Ae!==void 0?Ae:0;be=NZ({barGap:A,barCategoryGap:T,bandSize:xt!==ke?xt:ke,sizeList:Te[J],maxBarSize:We}),xt!==ke&&(be=be.map(function(zt){return ce(ce({},zt),{},{position:ce(ce({},zt.position),{},{offset:zt.position.offset-xt/2})})}))}var tr=D&&D.type&&D.type.getComposedData;tr&&K.push({props:ce(ce({},tr(ce(ce({},se),{},{displayedData:ee,props:v,dataKey:L,item:D,bandSize:ke,barPosition:be,offset:w,stackedData:fe,layout:E,dataStartIndex:k,dataEndIndex:N}))),{},Pe(Pe(Pe({key:D.key||"item-".concat(Z)},M,se[M]),W,se[W]),"animationId",S)),childIndex:NL(D,v.children),item:D})}),K},p=function(v,b){var x=v.props,_=v.dataStartIndex,w=v.dataEndIndex,S=v.updateId;if(!bS({props:x}))return null;var k=x.children,N=x.layout,j=x.stackOffset,E=x.data,A=x.reverseStackOrder,T=aj(N),F=T.numericAxisName,G=T.cateAxisName,M=Fn(k,n),W=DZ(E,M,"".concat(F,"Id"),"".concat(G,"Id"),j,A),Y=c.reduce(function(O,L){var R="".concat(L.axisType,"Map");return ce(ce({},O),{},Pe({},R,cle(x,ce(ce({},L),{},{graphicalItems:M,stackGroups:L.axisType===F&&W,dataStartIndex:_,dataEndIndex:w}))))},{}),K=dle(ce(ce({},Y),{},{props:x,graphicalItems:M}),b==null?void 0:b.legendBBox);Object.keys(Y).forEach(function(O){Y[O]=f(x,Y[O],K,O.replace("Map",""),r)});var D=Y["".concat(G,"Map")],Z=ule(D),ee=h(x,ce(ce({},Y),{},{dataStartIndex:_,dataEndIndex:w,updateId:S,graphicalItems:M,stackGroups:W,offset:K}));return ce(ce({formattedGraphicalItems:ee,graphicalItems:M,offset:K,stackGroups:W},Z),Y)},m=function(y){function v(b){var x,_,w;return Goe(this,v),w=qoe(this,v,[b]),Pe(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Pe(w,"accessibilityManager",new Poe),Pe(w,"handleLegendBBoxUpdate",function(S){if(S){var k=w.state,N=k.dataStartIndex,j=k.dataEndIndex,E=k.updateId;w.setState(ce({legendBBox:S},p({props:w.props,dataStartIndex:N,dataEndIndex:j,updateId:E},ce(ce({},w.state),{},{legendBBox:S}))))}}),Pe(w,"handleReceiveSyncEvent",function(S,k,N){if(w.props.syncId===S){if(N===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(k)}}),Pe(w,"handleBrushChange",function(S){var k=S.startIndex,N=S.endIndex;if(k!==w.state.dataStartIndex||N!==w.state.dataEndIndex){var j=w.state.updateId;w.setState(function(){return ce({dataStartIndex:k,dataEndIndex:N},p({props:w.props,dataStartIndex:k,dataEndIndex:N,updateId:j},w.state))}),w.triggerSyncEvent({dataStartIndex:k,dataEndIndex:N})}}),Pe(w,"handleMouseEnter",function(S){var k=w.getMouseInfo(S);if(k){var N=ce(ce({},k),{},{isTooltipActive:!0});w.setState(N),w.triggerSyncEvent(N);var j=w.props.onMouseEnter;Ie(j)&&j(N,S)}}),Pe(w,"triggeredAfterMouseMove",function(S){var k=w.getMouseInfo(S),N=k?ce(ce({},k),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(N),w.triggerSyncEvent(N);var j=w.props.onMouseMove;Ie(j)&&j(N,S)}),Pe(w,"handleItemMouseEnter",function(S){w.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),Pe(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),Pe(w,"handleMouseMove",function(S){S.persist(),w.throttleTriggeredAfterMouseMove(S)}),Pe(w,"handleMouseLeave",function(S){w.throttleTriggeredAfterMouseMove.cancel();var k={isTooltipActive:!1};w.setState(k),w.triggerSyncEvent(k);var N=w.props.onMouseLeave;Ie(N)&&N(k,S)}),Pe(w,"handleOuterEvent",function(S){var k=kL(S),N=Mn(w.props,"".concat(k));if(k&&Ie(N)){var j,E;/.*touch.*/i.test(k)?E=w.getMouseInfo(S.changedTouches[0]):E=w.getMouseInfo(S),N((j=E)!==null&&j!==void 0?j:{},S)}}),Pe(w,"handleClick",function(S){var k=w.getMouseInfo(S);if(k){var N=ce(ce({},k),{},{isTooltipActive:!0});w.setState(N),w.triggerSyncEvent(N);var j=w.props.onClick;Ie(j)&&j(N,S)}}),Pe(w,"handleMouseDown",function(S){var k=w.props.onMouseDown;if(Ie(k)){var N=w.getMouseInfo(S);k(N,S)}}),Pe(w,"handleMouseUp",function(S){var k=w.props.onMouseUp;if(Ie(k)){var N=w.getMouseInfo(S);k(N,S)}}),Pe(w,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),Pe(w,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseDown(S.changedTouches[0])}),Pe(w,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&w.handleMouseUp(S.changedTouches[0])}),Pe(w,"handleDoubleClick",function(S){var k=w.props.onDoubleClick;if(Ie(k)){var N=w.getMouseInfo(S);k(N,S)}}),Pe(w,"handleContextMenu",function(S){var k=w.props.onContextMenu;if(Ie(k)){var N=w.getMouseInfo(S);k(N,S)}}),Pe(w,"triggerSyncEvent",function(S){w.props.syncId!==void 0&&tg.emit(rg,w.props.syncId,S,w.eventEmitterSymbol)}),Pe(w,"applySyncEvent",function(S){var k=w.props,N=k.layout,j=k.syncMethod,E=w.state.updateId,A=S.dataStartIndex,T=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)w.setState(ce({dataStartIndex:A,dataEndIndex:T},p({props:w.props,dataStartIndex:A,dataEndIndex:T,updateId:E},w.state)));else if(S.activeTooltipIndex!==void 0){var F=S.chartX,G=S.chartY,M=S.activeTooltipIndex,W=w.state,Y=W.offset,K=W.tooltipTicks;if(!Y)return;if(typeof j=="function")M=j(K,S);else if(j==="value"){M=-1;for(var D=0;D<K.length;D++)if(K[D].value===S.activeLabel){M=D;break}}var Z=ce(ce({},Y),{},{x:Y.left,y:Y.top}),ee=Math.min(F,Z.x+Z.width),O=Math.min(G,Z.y+Z.height),L=K[M]&&K[M].value,R=z1(w.state,w.props.data,M),X=K[M]?{x:N==="horizontal"?K[M].coordinate:ee,y:N==="horizontal"?O:K[M].coordinate}:LC;w.setState(ce(ce({},S),{},{activeLabel:L,activeCoordinate:X,activePayload:R,activeTooltipIndex:M}))}else w.setState(S)}),Pe(w,"renderCursor",function(S){var k,N=w.state,j=N.isTooltipActive,E=N.activeCoordinate,A=N.activePayload,T=N.offset,F=N.activeTooltipIndex,G=N.tooltipAxisBandSize,M=w.getTooltipEventType(),W=(k=S.props.active)!==null&&k!==void 0?k:j,Y=w.props.layout,K=S.key||"_recharts-cursor";return q.createElement(Loe,{key:K,activeCoordinate:E,activePayload:A,activeTooltipIndex:F,chartName:r,element:S,isActive:W,layout:Y,offset:T,tooltipAxisBandSize:G,tooltipEventType:M})}),Pe(w,"renderPolarAxis",function(S,k,N){var j=Mn(S,"type.axisType"),E=Mn(w.state,"".concat(j,"Map")),A=S.type.defaultProps,T=A!==void 0?ce(ce({},A),S.props):S.props,F=E&&E[T["".concat(j,"Id")]];return H.cloneElement(S,ce(ce({},F),{},{className:ze(j,F.className),key:S.key||"".concat(k,"-").concat(N),ticks:di(F,!0)}))}),Pe(w,"renderPolarGrid",function(S){var k=S.props,N=k.radialLines,j=k.polarAngles,E=k.polarRadius,A=w.state,T=A.radiusAxisMap,F=A.angleAxisMap,G=Wi(T),M=Wi(F),W=M.cx,Y=M.cy,K=M.innerRadius,D=M.outerRadius;return H.cloneElement(S,{polarAngles:Array.isArray(j)?j:di(M,!0).map(function(Z){return Z.coordinate}),polarRadius:Array.isArray(E)?E:di(G,!0).map(function(Z){return Z.coordinate}),cx:W,cy:Y,innerRadius:K,outerRadius:D,key:S.key||"polar-grid",radialLines:N})}),Pe(w,"renderLegend",function(){var S=w.state.formattedGraphicalItems,k=w.props,N=k.children,j=k.width,E=k.height,A=w.props.margin||{},T=j-(A.left||0)-(A.right||0),F=mO({children:N,formattedGraphicalItems:S,legendWidth:T,legendContent:u});if(!F)return null;var G=F.item,M=ej(F,Boe);return H.cloneElement(G,ce(ce({},M),{},{chartWidth:j,chartHeight:E,margin:A,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),Pe(w,"renderTooltip",function(){var S,k=w.props,N=k.children,j=k.accessibilityLayer,E=_n(N,ir);if(!E)return null;var A=w.state,T=A.isTooltipActive,F=A.activeCoordinate,G=A.activePayload,M=A.activeLabel,W=A.offset,Y=(S=E.props.active)!==null&&S!==void 0?S:T;return H.cloneElement(E,{viewBox:ce(ce({},W),{},{x:W.left,y:W.top}),active:Y,label:M,payload:Y?G:[],coordinate:F,accessibilityLayer:j})}),Pe(w,"renderBrush",function(S){var k=w.props,N=k.margin,j=k.data,E=w.state,A=E.offset,T=E.dataStartIndex,F=E.dataEndIndex,G=E.updateId;return H.cloneElement(S,{key:S.key||"_recharts-brush",onChange:td(w.handleBrushChange,S.props.onChange),data:j,x:ge(S.props.x)?S.props.x:A.left,y:ge(S.props.y)?S.props.y:A.top+A.height+A.brushBottom-(N.bottom||0),width:ge(S.props.width)?S.props.width:A.width,startIndex:T,endIndex:F,updateId:"brush-".concat(G)})}),Pe(w,"renderReferenceElement",function(S,k,N){if(!S)return null;var j=w,E=j.clipPathId,A=w.state,T=A.xAxisMap,F=A.yAxisMap,G=A.offset,M=S.type.defaultProps||{},W=S.props,Y=W.xAxisId,K=Y===void 0?M.xAxisId:Y,D=W.yAxisId,Z=D===void 0?M.yAxisId:D;return H.cloneElement(S,{key:S.key||"".concat(k,"-").concat(N),xAxis:T[K],yAxis:F[Z],viewBox:{x:G.left,y:G.top,width:G.width,height:G.height},clipPathId:E})}),Pe(w,"renderActivePoints",function(S){var k=S.item,N=S.activePoint,j=S.basePoint,E=S.childIndex,A=S.isRange,T=[],F=k.props.key,G=k.item.type.defaultProps!==void 0?ce(ce({},k.item.type.defaultProps),k.item.props):k.item.props,M=G.activeDot,W=G.dataKey,Y=ce(ce({index:E,dataKey:W,cx:N.x,cy:N.y,r:4,fill:Gb(k.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},Ce(M,!1)),lh(M));return T.push(v.renderActiveDot(M,Y,"".concat(F,"-activePoint-").concat(E))),j?T.push(v.renderActiveDot(M,ce(ce({},Y),{},{cx:j.x,cy:j.y}),"".concat(F,"-basePoint-").concat(E))):A&&T.push(null),T}),Pe(w,"renderGraphicChild",function(S,k,N){var j=w.filterFormatItem(S,k,N);if(!j)return null;var E=w.getTooltipEventType(),A=w.state,T=A.isTooltipActive,F=A.tooltipAxis,G=A.activeTooltipIndex,M=A.activeLabel,W=w.props.children,Y=_n(W,ir),K=j.props,D=K.points,Z=K.isRange,ee=K.baseLine,O=j.item.type.defaultProps!==void 0?ce(ce({},j.item.type.defaultProps),j.item.props):j.item.props,L=O.activeDot,R=O.hide,X=O.activeBar,J=O.activeShape,le=!!(!R&&T&&Y&&(L||X||J)),se={};E!=="axis"&&Y&&Y.props.trigger==="click"?se={onClick:td(w.handleItemMouseEnter,S.props.onClick)}:E!=="axis"&&(se={onMouseLeave:td(w.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:td(w.handleItemMouseEnter,S.props.onMouseEnter)});var Q=H.cloneElement(S,ce(ce({},j.props),se));function te(kr){return typeof F.dataKey=="function"?F.dataKey(kr.payload):null}if(le)if(G>=0){var fe,P;if(F.dataKey&&!F.allowDuplicatedCategory){var ke=typeof F.dataKey=="function"?te:"payload.".concat(F.dataKey.toString());fe=oh(D,ke,M),P=Z&&ee&&oh(ee,ke,M)}else fe=D==null?void 0:D[G],P=Z&&ee&&ee[G];if(J||X){var be=S.props.activeIndex!==void 0?S.props.activeIndex:G;return[H.cloneElement(S,ce(ce(ce({},j.props),se),{},{activeIndex:be})),null,null]}if(!$e(fe))return[Q].concat(nc(w.renderActivePoints({item:j,activePoint:fe,basePoint:P,childIndex:G,isRange:Z})))}else{var Te,Ae=(Te=w.getItemByXY(w.state.activeCoordinate))!==null&&Te!==void 0?Te:{graphicalItem:Q},he=Ae.graphicalItem,We=he.item,xt=We===void 0?S:We,tr=he.childIndex,zt=ce(ce(ce({},j.props),se),{},{activeIndex:tr});return[H.cloneElement(xt,zt),null,null]}return Z?[Q,null,null]:[Q,null]}),Pe(w,"renderCustomized",function(S,k,N){return H.cloneElement(S,ce(ce({key:"recharts-customized-".concat(N)},w.props),w.state))}),Pe(w,"renderMap",{CartesianGrid:{handler:sd,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:sd},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:sd},YAxis:{handler:sd},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((x=b.id)!==null&&x!==void 0?x:yc("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=m3(w.triggeredAfterMouseMove,(_=b.throttleDelay)!==null&&_!==void 0?_:1e3/60),w.state={},w}return Zoe(v,y),Koe(v,[{key:"componentDidMount",value:function(){var x,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(x=this.props.margin.left)!==null&&x!==void 0?x:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var x=this.props,_=x.children,w=x.data,S=x.height,k=x.layout,N=_n(_,ir);if(N){var j=N.props.defaultIndex;if(!(typeof j!="number"||j<0||j>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[j]&&this.state.tooltipTicks[j].value,A=z1(this.state,w,j,E),T=this.state.tooltipTicks[j].coordinate,F=(this.state.offset.top+S)/2,G=k==="horizontal",M=G?{x:T,y:F}:{y:T,x:F},W=this.state.formattedGraphicalItems.find(function(K){var D=K.item;return D.type.name==="Scatter"});W&&(M=ce(ce({},M),W.props.points[j].tooltipPosition),A=W.props.points[j].tooltipPayload);var Y={activeTooltipIndex:j,isTooltipActive:!0,activeLabel:E,activePayload:A,activeCoordinate:M};this.setState(Y),this.renderCursor(N),this.accessibilityManager.setIndex(j)}}}},{key:"getSnapshotBeforeUpdate",value:function(x,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==x.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==x.margin){var w,S;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(x){gv([_n(x.children,ir)],[_n(this.props.children,ir)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var x=_n(this.props.children,ir);if(x&&typeof x.props.shared=="boolean"){var _=x.props.shared?"axis":"item";return o.indexOf(_)>=0?_:i}return i}},{key:"getMouseInfo",value:function(x){if(!this.container)return null;var _=this.container,w=_.getBoundingClientRect(),S=QX(w),k={chartX:Math.round(x.pageX-S.left),chartY:Math.round(x.pageY-S.top)},N=w.width/_.offsetWidth||1,j=this.inRange(k.chartX,k.chartY,N);if(!j)return null;var E=this.state,A=E.xAxisMap,T=E.yAxisMap,F=this.getTooltipEventType(),G=rj(this.state,this.props.data,this.props.layout,j);if(F!=="axis"&&A&&T){var M=Wi(A).scale,W=Wi(T).scale,Y=M&&M.invert?M.invert(k.chartX):null,K=W&&W.invert?W.invert(k.chartY):null;return ce(ce({},k),{},{xValue:Y,yValue:K},G)}return G?ce(ce({},k),G):null}},{key:"inRange",value:function(x,_){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,k=x/w,N=_/w;if(S==="horizontal"||S==="vertical"){var j=this.state.offset,E=k>=j.left&&k<=j.left+j.width&&N>=j.top&&N<=j.top+j.height;return E?{x:k,y:N}:null}var A=this.state,T=A.angleAxisMap,F=A.radiusAxisMap;if(T&&F){var G=Wi(T);return Ok({x:k,y:N},G)}return null}},{key:"parseEventsOfWrapper",value:function(){var x=this.props.children,_=this.getTooltipEventType(),w=_n(x,ir),S={};w&&_==="axis"&&(w.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var k=lh(this.props,this.handleOuterEvent);return ce(ce({},k),S)}},{key:"addListener",value:function(){tg.on(rg,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){tg.removeListener(rg,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(x,_,w){for(var S=this.state.formattedGraphicalItems,k=0,N=S.length;k<N;k++){var j=S[k];if(j.item===x||j.props.key===x.key||_===xi(j.item.type)&&w===j.childIndex)return j}return null}},{key:"renderClipPath",value:function(){var x=this.clipPathId,_=this.state.offset,w=_.left,S=_.top,k=_.height,N=_.width;return q.createElement("defs",null,q.createElement("clipPath",{id:x},q.createElement("rect",{x:w,y:S,height:k,width:N})))}},{key:"getXScales",value:function(){var x=this.state.xAxisMap;return x?Object.entries(x).reduce(function(_,w){var S=JN(w,2),k=S[0],N=S[1];return ce(ce({},_),{},Pe({},k,N.scale))},{}):null}},{key:"getYScales",value:function(){var x=this.state.yAxisMap;return x?Object.entries(x).reduce(function(_,w){var S=JN(w,2),k=S[0],N=S[1];return ce(ce({},_),{},Pe({},k,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(x){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[x])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(x){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[x])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(x){var _=this.state,w=_.formattedGraphicalItems,S=_.activeItem;if(w&&w.length)for(var k=0,N=w.length;k<N;k++){var j=w[k],E=j.props,A=j.item,T=A.type.defaultProps!==void 0?ce(ce({},A.type.defaultProps),A.props):A.props,F=xi(A.type);if(F==="Bar"){var G=(E.data||[]).find(function(K){return Rte(x,K)});if(G)return{graphicalItem:j,payload:G}}else if(F==="RadialBar"){var M=(E.data||[]).find(function(K){return Ok(x,K)});if(M)return{graphicalItem:j,payload:M}}else if(Ix(j,S)||Rx(j,S)||Ef(j,S)){var W=Nne({graphicalItem:j,activeTooltipItem:S,itemData:T.data}),Y=T.activeIndex===void 0?W:T.activeIndex;return{graphicalItem:ce(ce({},j),{},{childIndex:Y}),payload:Ef(j,S)?T.data[W]:j.props.data[W]}}}return null}},{key:"render",value:function(){var x=this;if(!bS(this))return null;var _=this.props,w=_.children,S=_.className,k=_.width,N=_.height,j=_.style,E=_.compact,A=_.title,T=_.desc,F=ej(_,Uoe),G=Ce(F,!1);if(E)return q.createElement(DN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},q.createElement(yv,fl({},G,{width:k,height:N,title:A,desc:T}),this.renderClipPath(),SS(w,this.renderMap)));if(this.props.accessibilityLayer){var M,W;G.tabIndex=(M=this.props.tabIndex)!==null&&M!==void 0?M:0,G.role=(W=this.props.role)!==null&&W!==void 0?W:"application",G.onKeyDown=function(K){x.accessibilityManager.keyboardEvent(K)},G.onFocus=function(){x.accessibilityManager.focus()}}var Y=this.parseEventsOfWrapper();return q.createElement(DN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},q.createElement("div",fl({className:ze("recharts-wrapper",S),style:ce({position:"relative",cursor:"default",width:k,height:N},j)},Y,{ref:function(D){x.container=D}}),q.createElement(yv,fl({},G,{width:k,height:N,title:A,desc:T,style:ale}),this.renderClipPath(),SS(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(H.Component);Pe(m,"displayName",r),Pe(m,"defaultProps",ce({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),Pe(m,"getDerivedStateFromProps",function(y,v){var b=y.dataKey,x=y.data,_=y.children,w=y.width,S=y.height,k=y.layout,N=y.stackOffset,j=y.margin,E=v.dataStartIndex,A=v.dataEndIndex;if(v.updateId===void 0){var T=nj(y);return ce(ce(ce({},T),{},{updateId:0},p(ce(ce({props:y},T),{},{updateId:0}),v)),{},{prevDataKey:b,prevData:x,prevWidth:w,prevHeight:S,prevLayout:k,prevStackOffset:N,prevMargin:j,prevChildren:_})}if(b!==v.prevDataKey||x!==v.prevData||w!==v.prevWidth||S!==v.prevHeight||k!==v.prevLayout||N!==v.prevStackOffset||!yl(j,v.prevMargin)){var F=nj(y),G={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},M=ce(ce({},rj(v,x,k)),{},{updateId:v.updateId+1}),W=ce(ce(ce({},F),G),M);return ce(ce(ce({},W),p(ce({props:y},W),v)),{},{prevDataKey:b,prevData:x,prevWidth:w,prevHeight:S,prevLayout:k,prevStackOffset:N,prevMargin:j,prevChildren:_})}if(!gv(_,v.prevChildren)){var Y,K,D,Z,ee=_n(_,Xl),O=ee&&(Y=(K=ee.props)===null||K===void 0?void 0:K.startIndex)!==null&&Y!==void 0?Y:E,L=ee&&(D=(Z=ee.props)===null||Z===void 0?void 0:Z.endIndex)!==null&&D!==void 0?D:A,R=O!==E||L!==A,X=!$e(x),J=X&&!R?v.updateId:v.updateId+1;return ce(ce({updateId:J},p(ce(ce({props:y},v),{},{updateId:J,dataStartIndex:O,dataEndIndex:L}),v)),{},{prevChildren:_,dataStartIndex:O,dataEndIndex:L})}return null}),Pe(m,"renderActiveDot",function(y,v,b){var x;return H.isValidElement(y)?x=H.cloneElement(y,v):Ie(y)?x=y(v):x=q.createElement(Cx,v),q.createElement(Je,{className:"recharts-active-dot",key:b},x)});var g=H.forwardRef(function(v,b){return q.createElement(m,fl({},v,{ref:b}))});return g.displayName=m.displayName,g},ple=rw({chartName:"LineChart",GraphicalChild:m0,axisComponents:[{axisType:"xAxis",AxisComp:la},{axisType:"yAxis",AxisComp:ca}],formatAxisMap:iC}),g0=rw({chartName:"BarChart",GraphicalChild:Ia,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:la},{axisType:"yAxis",AxisComp:ca}],formatAxisMap:iC}),Hx=rw({chartName:"PieChart",GraphicalChild:pa,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Dx},{axisType:"radiusAxis",AxisComp:Mx}],formatAxisMap:XZ,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const nw=({data:e,groups:t,unit:r,height:n="100%",showLegend:a=!0,layout:i="vertical",barSize:s=40,maxCategories:o=6,showLabels:c=!0})=>{const{chartData:u,activeGroups:f}=H.useMemo(()=>{let h=t;if(t.length>o){const m=t.slice(0,o-1),g={id:"_other",name:"Other",color:"#94a3b8",items:[]};h=[...m,g]}return{chartData:e.map(m=>{const g={...m,_total:0};let y=0;if(t.forEach(v=>{m[v.id]&&(y+=m[v.id])}),t.length>o){t.slice(0,o-1);const v=t.slice(o-1);let b=0;v.forEach(x=>{g[x.id]!==void 0&&(b+=g[x.id],delete g[x.id])}),g._other=b}return g._total=y,g}),activeGroups:h}},[e,t,o]),d=h=>{const{x:p,y:m,width:g,height:y,value:v,payload:b}=h,x=b&&typeof b._total=="number"?b._total:0,_=x>0?v/x:0;if(_<.05)return null;const w=i==="vertical",S=20;return w&&g<S||!w&&y<S?null:l.jsx("text",{x:p+g/2,y:m+y/2,fill:"#fff",textAnchor:"middle",dominantBaseline:"middle",fontSize:10,fontWeight:"bold",style:{pointerEvents:"none",textShadow:"0px 0px 3px rgba(0,0,0,0.6)"},children:`${(_*100).toFixed(0)}%`})};return l.jsx(qa,{width:"100%",height:n,children:l.jsxs(g0,{data:u,layout:i,barSize:s,margin:{top:20,right:30,left:20,bottom:5},children:[i==="vertical"?l.jsxs(l.Fragment,{children:[l.jsx(la,{type:"number",hide:!0}),l.jsx(ca,{type:"category",dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"},width:100})]}):l.jsxs(l.Fragment,{children:[l.jsx(la,{dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"}}),l.jsx(ca,{type:"number",hide:!0})]}),l.jsx(ir,{cursor:{fill:"transparent"},content:({active:h,payload:p})=>{if(h&&p&&p.length&&p[0].payload){const m=p[0].payload._total||0;return l.jsxs("div",{className:"bg-white p-3 border border-slate-200 rounded-lg shadow-xl text-xs z-50",children:[l.jsxs("div",{className:"font-bold text-slate-800 mb-2 border-b border-slate-100 pb-1",children:[p[0].payload.name," Total: ",Math.round(m).toLocaleString()," ",r]}),p.map((g,y)=>l.jsxs("div",{className:"flex justify-between items-center gap-4 mb-1",children:[l.jsxs("span",{style:{color:g.color},className:"font-semibold",children:[g.name,":"]}),l.jsxs("span",{className:"text-slate-600 font-mono",children:[Math.round(g.value).toLocaleString()," (",m>0?(g.value/m*100).toFixed(1):0,"%)"]})]},y))]})}return null}}),a&&l.jsx(na,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}}),f.map(h=>l.jsx(Ia,{dataKey:h.id,name:h.name,stackId:"a",fill:h.color,radius:[0,0,0,0],children:c&&l.jsx(Dn,{dataKey:h.id,content:d})},h.id))]})})},xle=[{id:"work_open",label:"Fixed Workstations"},{id:"work_enclosed",label:"Enclosed Offices (Private)"},{id:"work_alt",label:"Alternative Workpoints"},{id:"meet",label:"Meeting Rooms (Enclosed)"},{id:"phone",label:"Phone Booths"},{id:"circ",label:"Circulation"}],ij=["#6366f1","#ec4899","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#64748b"],mle=({groups:e,supportSpaces:t,onSave:r,onClose:n})=>{const[a,i]=H.useState(JSON.parse(JSON.stringify(e))),s=[...xle,...t.map(p=>({id:p.id,label:p.name}))],o=()=>{const p=`g-${Date.now()}`,m=ij[a.length%ij.length];i([...a,{id:p,name:"New Category",color:m,items:[]}])},c=p=>{if(a.length<=1)return;const m=a.find(v=>v.id===p),g=a.find(v=>v.id!==p);if(!g)return;const y=a.filter(v=>v.id!==p).map(v=>v.id===g.id?{...v,items:[...v.items,...(m==null?void 0:m.items)||[]]}:v);i(y)},u=(p,m)=>{const g=a.map(y=>({...y,items:y.id===m?[...y.items,p]:y.items.filter(v=>v!==p)}));i(g)},f=(p,m)=>{i(a.map(g=>g.id===p?{...g,color:m}:g))},d=(p,m)=>{i(a.map(g=>g.id===p?{...g,name:m}:g))},h=a.length>6;return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/30 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[85vh]",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Configure Program Structure"}),l.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Define how space types are categorized for visual analysis and reporting."})]}),l.jsx("button",{onClick:n,children:l.jsx(on,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[h&&l.jsxs("div",{className:"mb-6 flex items-start gap-3 bg-amber-50 border border-amber-200 p-3 rounded-lg text-sm text-amber-800",children:[l.jsx(ur,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold",children:"Recommendation:"})," You have defined ",a.length,' categories. For optimal clarity in client presentations, we recommend sticking to 4-6 distinct program categories. Excess categories will be automatically collapsed into "Other" in some summary charts.']})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(p=>l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b border-slate-100 pb-3",children:[l.jsx("input",{type:"color",value:p.color,onChange:m=>f(p.id,m.target.value),className:"w-6 h-6 rounded cursor-pointer border-0 p-0 overflow-hidden"}),l.jsx("input",{type:"text",value:p.name,onChange:m=>d(p.id,m.target.value),className:"font-bold text-sm bg-transparent border-b border-transparent focus:border-indigo-500 outline-none text-slate-800 flex-grow",placeholder:"Category Name"}),a.length>1&&l.jsx("button",{onClick:()=>c(p.id),className:"text-slate-300 hover:text-rose-500 transition-colors",title:"Delete Category (Items will be moved)",children:l.jsx(gs,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"space-y-2",children:p.items.length===0?l.jsx("div",{className:"text-xs text-slate-400 italic py-4 text-center border-2 border-dashed border-slate-100 rounded",children:"No items assigned"}):p.items.map(m=>{const g=s.find(y=>y.id===m);return l.jsxs("div",{className:"relative group flex items-center bg-slate-50 border border-slate-200 rounded px-3 py-2 text-xs hover:border-indigo-300 transition-colors",children:[l.jsx("span",{className:"mr-2 text-slate-700 font-medium truncate flex-grow",title:g==null?void 0:g.label,children:(g==null?void 0:g.label)||m}),l.jsxs("div",{className:"relative",children:[l.jsx(Fa,{className:"w-3 h-3 text-slate-300 group-hover:text-indigo-600"}),l.jsx("select",{className:"absolute right-0 top-0 w-6 h-6 opacity-0 cursor-pointer",value:p.id,onChange:y=>u(m,y.target.value),children:a.map(y=>l.jsxs("option",{value:y.id,children:["Move to ",y.name]},y.id))})]})]},m)})})]},p.id)),l.jsxs("button",{onClick:o,className:"flex flex-col items-center justify-center gap-2 p-6 rounded-xl border-2 border-dashed border-slate-300 text-slate-400 hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all min-h-[200px]",children:[l.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:l.jsx(Za,{className:"w-6 h-6"})}),l.jsx("span",{className:"text-sm font-bold",children:"Add Category"})]})]})]}),l.jsxs("div",{className:"p-5 border-t border-slate-200 flex justify-between items-center bg-white",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[l.jsx("strong",{children:"Integrity Check:"})," All space types must belong to exactly one category."]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:n,className:"px-5 py-2.5 text-sm font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),l.jsx("button",{onClick:()=>r(a),className:"px-6 py-2.5 bg-indigo-600 text-white text-sm font-bold rounded-lg hover:bg-indigo-700 shadow-md transition-all transform hover:scale-105",children:"Apply Configuration"})]})]})]})})},UC=({metrics:e,project:t,strategy:r,mode:n="default",onUpdateProject:a})=>{const[i,s]=H.useState(n==="review"?"visual":"summary"),[o,c]=H.useState("qty"),[u,f]=H.useState(!1),[d,h]=H.useState(!1),[p,m]=H.useState(!1),[g,y]=H.useState(t.programStructure||i0(t.projectType));H.useEffect(()=>{t.programStructure&&y(t.programStructure)},[t.programStructure]);const v=E=>{y(E),a&&a({...t,programStructure:E}),m(!1)},b=t.unit.toUpperCase(),x=t.floors,_=()=>{const E=["Space Type",...x.map(F=>F.name),"Total"].join("	"),A=[["Headcount",...e.floorMetrics.map(F=>F.headcount),e.totalHeadcountWithGrowth],["Total Seats",...e.floorMetrics.map(F=>F.totalDesks),e.requiredDesks],["Used Area",...e.floorMetrics.map(F=>Math.round(F.areaUsed)),Math.round(e.totalUsedArea)]],T=[E,...A.map(F=>F.join("	"))].join(`
`);navigator.clipboard.writeText(T),f(!0),setTimeout(()=>f(!1),2e3)},w=()=>h(!d),S=H.useMemo(()=>{const E=a0(t.unit);return x.map(A=>{const T=e.floorMetrics.find(G=>G.floorId===A.id);if(!T)return{name:A.name};const F={name:A.name};return g.forEach(G=>{let M=0;G.items.forEach(W=>{if(W==="work_open")M+=T.openDesks*E.deskOpen;else if(W==="work_enclosed")M+=T.enclosedOffices*E.deskEnclosed;else if(W==="work_alt")M+=T.altDesks*E.deskAlt;else if(W==="meet")M+=T.areaMeeting;else if(W==="phone")M+=T.areaPhone;else if(W==="circ")M+=T.areaCirculation;else{const Y=r.supportSpaces.find(K=>K.id===W);if(Y){const K=T.supportSummary.find(D=>D.name===Y.name);K&&(M+=K.area)}}}),F[G.id]=M}),F})},[e,t,g,r]),k=d?"fixed inset-0 z-50 bg-white flex flex-col":"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full",N=({val:E,isTotal:A=!1,type:T="number"})=>l.jsx("td",{className:`px-4 py-3 text-right text-xs whitespace-nowrap ${A?"font-bold bg-indigo-50 text-indigo-900 border-l border-slate-200 sticky right-0 z-10":"text-slate-600 border-b border-slate-50"}`,children:T==="area"?Math.round(E).toLocaleString():T==="percent"?`${E.toFixed(0)}%`:E.toLocaleString()}),j=({label:E,isGroup:A=!1})=>l.jsx("td",{className:`sticky left-0 bg-white z-10 px-4 py-3 text-xs border-r border-slate-100 ${A?"font-bold text-slate-800 bg-slate-50 uppercase tracking-wide":"font-medium text-slate-600"}`,children:E});return l.jsxs("div",{className:k,children:[l.jsxs("div",{className:"p-3 border-b border-slate-200 bg-slate-50 flex justify-between items-center flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Mr,{className:"w-4 h-4 text-indigo-600"}),d?"Stacking Plan (Full Screen)":"Stacking Plan"]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4 bg-white border border-slate-200 rounded-lg p-0.5",children:[l.jsxs("button",{onClick:()=>s("summary"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="summary"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(UT,{className:"w-3 h-3"})," Summary"]}),l.jsxs("button",{onClick:()=>s("matrix"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="matrix"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Hp,{className:"w-3 h-3"})," Matrix"]}),l.jsxs("button",{onClick:()=>s("visual"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="visual"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(dc,{className:"w-3 h-3"})," Program Mix"]})]}),i==="visual"&&l.jsx(l.Fragment,{children:l.jsxs("button",{onClick:()=>m(!0),className:"ml-2 flex items-center gap-1 px-3 py-1.5 text-xs font-bold text-slate-600 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition border border-transparent hover:border-slate-200",children:[l.jsx(r0,{className:"w-3 h-3"})," Structure"]})}),i==="matrix"&&l.jsxs("div",{className:"flex bg-white border border-slate-200 rounded-lg p-0.5 ml-2",children:[l.jsx("button",{onClick:()=>c("qty"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="qty"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Qty"}),l.jsx("button",{onClick:()=>c("area"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="area"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Area"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:_,className:"flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-300 rounded-lg text-xs font-bold text-slate-700 hover:bg-slate-50 transition",children:[u?l.jsx(Cn,{className:"w-3 h-3 text-emerald-600"}):l.jsx(Vp,{className:"w-3 h-3"}),u?"Copied":"Export"]}),l.jsx("button",{onClick:w,className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition",title:d?"Exit Full Screen":"Expand to Full Screen",children:d?l.jsx(HT,{className:"w-4 h-4"}):l.jsx(Yy,{className:"w-4 h-4"})}),d&&l.jsx("button",{onClick:w,className:"ml-2 p-1 text-slate-400 hover:text-slate-700",children:l.jsx(on,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:`flex-grow overflow-auto relative custom-scrollbar ${d?"p-6 bg-slate-100":""}`,children:i==="visual"?l.jsx("div",{className:`h-full flex flex-col ${d?"bg-white shadow-sm rounded-lg p-6":"p-4"}`,children:l.jsx("div",{className:"flex-grow w-full min-h-[300px]",children:l.jsx(nw,{data:S,groups:g,unit:b,layout:"vertical",showLabels:!0})})}):l.jsx("div",{className:d?"bg-white shadow-sm rounded-lg overflow-hidden":"",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{className:"sticky top-0 bg-white z-20 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"sticky left-0 z-30 bg-white border-b border-slate-200 px-4 py-3 text-xs font-bold text-slate-500 uppercase tracking-wider min-w-[160px] border-r border-slate-100",children:"Space Type"}),x.map(E=>l.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200 bg-slate-50 min-w-[100px]",children:E.name},E.id)),l.jsx("th",{className:"sticky right-0 z-30 bg-indigo-50 border-b border-l border-slate-200 px-4 py-3 text-right text-xs font-bold text-indigo-800 uppercase tracking-wider min-w-[100px]",children:"Total"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i==="summary"?l.jsxs(l.Fragment,{children:[l.jsxs("tr",{children:[l.jsx(j,{label:"Headcount (Capacity)",isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.headcount},E.floorId)),l.jsx(N,{val:e.totalHeadcountWithGrowth,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Workpoints (Seats)"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.totalDesks},E.floorId)),l.jsx(N,{val:e.requiredDesks,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting Rooms"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.meetingRoomsTotal},E.floorId)),l.jsx(N,{val:e.totalMeetingRooms,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:`Total Area (${b})`,isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.areaUsed,type:"area"},E.floorId)),l.jsx(N,{val:e.totalUsedArea,isTotal:!0,type:"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Space Utilization Index"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.utilization,type:"percent"},E.floorId)),l.jsx(N,{val:e.fitFactor,isTotal:!0,type:"percent"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"WORKSTATIONS",isGroup:!0}),l.jsx("td",{colSpan:x.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Enclosed Offices"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.enclosedOffices:E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.enclosedOffices:e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Fixed Workstations"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.openDesks:E.areaWorkstations-E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.openDesks:e.areaWorkstations-e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Alternative Workpoints"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.altDesks:E.altDesks*3,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.altDesks:e.altDesks*3,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"MEETING ROOMS",isGroup:!0}),l.jsx("td",{colSpan:x.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.meetingRoomsTotal:E.areaMeeting,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.totalMeetingRooms:e.areaMeeting,isTotal:!0,type:o==="qty"?"number":"area"})]})]})})]})})}),p&&l.jsx(mle,{groups:g,supportSpaces:r.supportSpaces,onSave:v,onClose:()=>m(!1)})]})},gle=({metrics:e,strategy:t,project:r})=>{var f;const n=r.programStructure||i0(r.projectType),a=a0(r.unit),i=H.useMemo(()=>n.map(d=>{let h=0;return e.floorMetrics.forEach(p=>{d.items.forEach(m=>{if(m==="work_open")h+=p.openDesks*a.deskOpen;else if(m==="work_enclosed")h+=p.enclosedOffices*a.deskEnclosed;else if(m==="work_alt")h+=p.altDesks*a.deskAlt;else if(m==="meet")h+=p.areaMeeting;else if(m==="phone")h+=p.areaPhone;else if(m==="circ")h+=p.areaCirculation;else{const g=t.supportSpaces.find(y=>y.id===m);if(g){const y=p.supportSummary.find(v=>v.name===g.name);y&&(h+=y.area)}}})}),{name:d.name,value:h,color:d.color}}).filter(d=>d.value>0),[e,n,t,a]),s=r.unit.toUpperCase(),o=e.fitFactor>100?"text-rose-600":"text-emerald-600",c=({cx:d,cy:h,midAngle:p,innerRadius:m,outerRadius:g,percent:y})=>{if(y<.05)return null;const v=Math.PI/180,b=m+(g-m)*.5,x=d+b*Math.cos(-p*v),_=h+b*Math.sin(-p*v);return l.jsx("text",{x,y:_,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:"bold",style:{textShadow:"0px 0px 3px rgba(0,0,0,0.5)",pointerEvents:"none"},children:`${(y*100).toFixed(0)}%`})},u=d=>{const h=i.find(p=>p.name===d);return h?Math.round(h.value).toLocaleString():"0"};return l.jsxs("div",{className:"h-full flex flex-col gap-6",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-shrink-0",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Capacity"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.totalHeadcountWithGrowth}),l.jsx("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:"Total People (w/ Growth)"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Rn,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Workpoints"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.requiredDesks}),l.jsxs("div",{className:"text-xs text-slate-400 flex gap-2 mt-1 font-medium",children:[l.jsxs("span",{children:[e.openDesks," Open"]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:[e.enclosedOffices," Enc"]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Meeting Rms"})]}),l.jsxs("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:[e.totalMeetingRooms," ",l.jsx("span",{className:"text-lg font-normal text-slate-400",children:"rms"})]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:["Ratio 1 : ",e.derivedMeetingRatio.toFixed(1)]})]}),l.jsxs("div",{className:`bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-shadow ${e.fitFactor>100?"border-l-4 border-l-rose-500":"border-l-4 border-l-emerald-500"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Kp,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Space Utilization Index"})]}),l.jsxs("div",{className:`text-3xl font-bold tracking-tight ${o}`,children:[e.fitFactor.toFixed(0),"%"]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:[Math.round(e.totalUsedArea).toLocaleString()," / ",Math.round(r.calculatedNia).toLocaleString()," ",s]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 flex-grow min-h-0",children:[l.jsxs("div",{className:"flex flex-col gap-6 min-h-0",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-64 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-white flex justify-between items-center rounded-t-xl",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Strategic Metrics Overview"}),l.jsxs("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-0.5 rounded",children:[e.density.toFixed(1)," ",s,"/p"]})]}),l.jsx("div",{className:"flex-grow p-2",children:l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(Hx,{children:[l.jsx(pa,{data:i,innerRadius:60,outerRadius:80,paddingAngle:2,dataKey:"value",label:c,labelLine:!1,children:i.map((d,h)=>l.jsx(Ci,{fill:d.color,stroke:"none"},`cell-${h}`))}),l.jsx(ir,{formatter:d=>[`${Math.round(d).toLocaleString()} ${s}`,"Area"],contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),l.jsx(na,{iconType:"circle",layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col flex-grow overflow-hidden",children:[l.jsx("div",{className:"p-4 border-b border-slate-100 bg-white rounded-t-xl",children:l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Program Budget"})}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Workstations"}),l.jsx("span",{children:u("Workstations")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Open (",e.openDesks,")"]})," ",l.jsx("span",{children:"Fixed Points"})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Enclosed (",e.enclosedOffices,")"]})," ",l.jsx("span",{children:"Fixed Points"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Meeting Rooms"}),l.jsx("span",{children:u("Meeting Rooms")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Rooms"})," ",l.jsx("span",{children:e.totalMeetingRooms})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Ratio"})," ",l.jsxs("span",{children:["1:",e.derivedMeetingRatio.toFixed(0)]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Collaboration"}),l.jsx("span",{children:u("Collaboration")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Open Zones"})," ",l.jsx("span",{className:"text-[10px] text-slate-400",children:"Calculated"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Support"}),l.jsx("span",{children:u("Support")})]}),(f=e.floorMetrics[0])==null?void 0:f.supportSummary.filter(d=>d.name!=="Open Collaboration").map((d,h)=>l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:d.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"Included"})]},h))]})]})]})]}),l.jsx("div",{className:"min-h-0 h-full",children:l.jsx(UC,{metrics:e,project:r,strategy:t})})]})]})},vle=({scenarios:e,activeId:t,project:r,metrics:n,onActivate:a,onAdd:i,onDuplicate:s,onDelete:o,onRename:c,compareId:u,onCompare:f,compareMetrics:d,onGoToDecision:h})=>{const p=e.find(b=>b.id===t),m=e.find(b=>b.id===u),g=({label:b,v1:x,v2:_,unit:w="",inverse:S=!1})=>{const k=x-_,N=k===0,j=k>0,E=N?"text-slate-300":j?"text-blue-600":"text-orange-600",A=j?"+":"";return l.jsxs("div",{className:"flex justify-between items-center text-xs py-1 border-b border-slate-50 last:border-0",children:[l.jsx("span",{className:"text-slate-500",children:b}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-bold text-slate-800",children:x.toLocaleString()}),!N&&l.jsxs("span",{className:`font-mono text-[10px] ${E}`,children:[A,k.toLocaleString()]})]})]})},v=d?((b,x)=>{const _=b.requiredDesks-x.requiredDesks,w=b.totalUsedArea-x.totalUsedArea,S=b.density-x.density;let k="";_>0?k=`Increases capacity by ${_} workpoints (+${(_/x.requiredDesks*100).toFixed(0)}%).`:_<0?k=`Reduces capacity by ${Math.abs(_)} workpoints.`:k="Maintains equivalent workpoint capacity.";let N="";w>0?N=`Requires ${Math.round(w)} ${r.unit} additional area, putting pressure on the spatial budget.`:w<0?N=`Recovers ${Math.round(Math.abs(w))} ${r.unit} of area, improving spatial efficiency.`:N="Neutral impact on overall area consumption.";let j="";return S<-1?j="Consider: Does the higher density impact acoustic comfort?":S>1?j="Consider: Is the generous density essential for experience targets?":j="Consider: Trade-off lies primarily in operational style rather than space.",{varianceText:k,impactText:N,decisionText:j}})(n,d):null;return l.jsxs("div",{className:"bg-white border-l border-slate-200 h-full flex flex-col w-80",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:"Scenarios"}),l.jsxs("button",{onClick:i,className:"text-xs flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-bold",children:[l.jsx(Za,{className:"w-3 h-3"})," New"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(b=>l.jsx("div",{onClick:()=>a(b.id),className:`group p-2 rounded-lg border cursor-pointer transition-all ${t===b.id?"bg-white border-indigo-500 shadow-sm ring-1 ring-indigo-500":"bg-white border-slate-200 hover:border-indigo-300"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[t===b.id?l.jsx("input",{value:b.name,onChange:x=>c(b.id,x.target.value),className:"text-sm font-bold text-indigo-700 bg-transparent outline-none w-full",onClick:x=>x.stopPropagation()}):l.jsx("span",{className:"text-sm font-medium text-slate-600 group-hover:text-indigo-600",children:b.name}),t===b.id&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:x=>{x.stopPropagation(),s()},className:"p-1 text-slate-400 hover:text-indigo-600",title:"Duplicate",children:l.jsx(Vp,{className:"w-3 h-3"})}),e.length>1&&l.jsx("button",{onClick:x=>{x.stopPropagation(),o(b.id)},className:"p-1 text-slate-400 hover:text-rose-500",title:"Delete",children:l.jsx(gs,{className:"w-3 h-3"})})]})]})},b.id))}),l.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:l.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-lg text-xs font-bold transition-colors border border-indigo-200",children:[l.jsx(ms,{className:"w-4 h-4"})," Compare & Decide"]})})]}),l.jsxs("div",{className:"p-4 border-b border-slate-200",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-2 block flex items-center gap-2",children:[l.jsx(Fa,{className:"w-3 h-3"})," Quick Comparison"]}),l.jsxs("select",{className:"w-full text-sm p-2 border border-slate-200 rounded-md bg-slate-50 focus:outline-none",value:u||"",onChange:b=>f(b.target.value||null),children:[l.jsx("option",{value:"",children:"None (Single View)"}),e.filter(b=>b.id!==t).map(b=>l.jsx("option",{value:b.id,children:b.name},b.id))]})]}),d&&m&&v?l.jsxs("div",{className:"flex-grow overflow-y-auto p-4 bg-slate-50",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-600 truncate max-w-[100px]",children:p==null?void 0:p.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"vs"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 truncate max-w-[100px]",children:m.name})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Seating"}),l.jsx(g,{label:"Open Seats",v1:n.openDesks,v2:d.openDesks}),l.jsx(g,{label:"Alt Seats",v1:n.altDesks,v2:d.altDesks}),l.jsx(g,{label:"Total",v1:n.requiredDesks,v2:d.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Spaces"}),l.jsx(g,{label:"Meeting Rms",v1:n.totalMeetingRooms,v2:d.totalMeetingRooms}),l.jsx(g,{label:"Phone Booths",v1:n.totalPhoneBooths,v2:d.totalPhoneBooths})]}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:["Area (",r.unit,")"]}),l.jsx(g,{label:"Used Area",v1:Math.round(n.totalUsedArea),v2:Math.round(d.totalUsedArea)}),l.jsxs("div",{className:"flex justify-between items-center text-xs py-1",children:[l.jsx("span",{className:"text-slate-500",children:"Utilization Index"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:`font-bold ${n.fitFactor>100?"text-rose-600":"text-emerald-600"}`,children:[n.fitFactor.toFixed(0),"%"]}),l.jsx("span",{className:"text-slate-300",children:"/"}),l.jsxs("span",{className:"text-slate-400",children:[d.fitFactor.toFixed(0),"%"]})]})]})]})]}),l.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-100 rounded-lg text-xs text-blue-800",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(hc,{className:"w-4 h-4 mt-0.5 text-blue-600"}),l.jsx("span",{className:"font-bold uppercase text-[10px] text-blue-500 mt-0.5",children:"Analysis"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Variance"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:v.varianceText})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Strategic Impact"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:v.impactText})]}),l.jsx("div",{className:"pt-2 border-t border-blue-100 mt-1",children:l.jsx("span",{className:"leading-tight block text-blue-700 italic",children:v.decisionText})})]})]})]}):l.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-slate-400 p-8 text-center",children:[l.jsx(Fa,{className:"w-8 h-8 mb-2 opacity-20"}),l.jsx("p",{className:"text-xs",children:"Select a scenario above to compare metrics."})]})]})},Zc={s:4,m:8,l:14,b:20,t:40},Jc={s:10,m:18,l:25,b:40,t:80},W1=(e,t)=>{var K,D,Z,ee;const r=a0(e.unit),n=e.calculatedNia;let a=0,i=0,s=0,o=0,c=0,u=0,f=0,d=0,h=0,p=0,m=0,g=0,y=0,v=0;const b={small:0,medium:0,large:0,board:0,townhall:0},x=[],_=e.floors.reduce((O,L)=>O+L.headcount,0)||e.headcount,w=((K=t.workpoints)==null?void 0:K.fixed)||0,S=((D=t.workpoints)==null?void 0:D.alternative)||0,k=t.enclosedOfficeCount||0,N=Math.max(0,w-k);e.floors.forEach(O=>{const L=Math.ceil(O.headcount*(1+t.growthBuffer/100));a+=L;const R=_>0?O.headcount/_:0,X=Math.round(k*R),J=Math.round(N*R),le=Math.round(S*R),se=X+J+le;c+=X,s+=J,o+=le,i+=se;const Q=t.meetingRatios.small>0?Math.ceil(L/t.meetingRatios.small):0,te=t.meetingRatios.medium>0?Math.ceil(L/t.meetingRatios.medium):0,fe=t.meetingRatios.large>0?Math.ceil(L/t.meetingRatios.large):0,P=t.meetingRatios.board>0?Math.ceil(L/t.meetingRatios.board):0,ke=t.meetingRatios.townhall>0?Math.ceil(L/t.meetingRatios.townhall):0,be=Q+te+fe+P+ke,Te=Q*Zc.s+te*Zc.m+fe*Zc.l+P*Zc.b+ke*Zc.t;u+=be,f+=Te,b.small+=Q,b.medium+=te,b.large+=fe,b.board+=P,b.townhall+=ke;const Ae=Math.max(1,t.phoneBoothRatio),he=Math.ceil(L/Ae);d+=he;let We=0;const xt=[];t.supportSpaces.forEach(He=>{let Ke=0,Tt=0;if(He.logic==="ratio")Ke=Math.ceil(L/Math.max(1,He.value)),Tt=Ke*(He.areaPerUnit||0);else if(He.logic==="fixed_count"){const Ns=He.value*R;Tt=Ns*(He.areaPerUnit||0),Ke=Ns}else He.logic==="area_per_person"?(Tt=L*He.value,Ke=0):He.logic==="pct_nia"?(Tt=n*R*(He.value/100),Ke=0):He.logic==="fixed_area"&&(Tt=He.value*R,Ke=0);We+=Tt,xt.push({name:He.name,count:Ke,area:Tt})});const tr=X*r.deskEnclosed,zt=J*r.deskOpen,kr=le*r.deskAlt,Xt=tr+zt+kr;let It=Q*Jc.s+te*Jc.m+fe*Jc.l+P*Jc.b+ke*Jc.t;const Kt=e.unit==="sqft"?It*10.76:It,Dr=he*r.phoneBooth,ma=Xt+Kt+Dr+We,Et=ma*(t.circulationPct/100),hr=ma+Et,Re=n*R,mt=Re>0?hr/Re*100:0;h+=Xt,p+=Kt,m+=Dr,g+=We,y+=Et,v+=hr,x.push({floorId:O.id,name:O.name,headcount:L,enclosedOffices:X,openDesks:J,altDesks:le,totalDesks:se,meetingRoomsTotal:be,roomsSmall:Q,roomsMedium:te,roomsLarge:fe,roomsBoard:P,roomsTownhall:ke,phoneBooths:he,supportSummary:xt,areaUsed:hr,areaWorkstations:Xt,areaMeeting:Kt,areaPhone:Dr,areaSupport:We,areaCirculation:Et,utilization:mt})});const j=e.departments,E=j.length,A=[],T={};j.forEach(O=>{T[O.id]={},O.collaborators.forEach(L=>{L.deptId&&(T[O.id][L.deptId]=L.strength)})});let F=0,G=0;for(let O=0;O<E;O++)for(let L=O+1;L<E;L++){const R=j[O],X=j[L],J=((Z=T[R.id])==null?void 0:Z[X.id])||0,le=((ee=T[X.id])==null?void 0:ee[R.id])||0,se=J+le;if(se>0){const Q=R.pinnedFloor,te=X.pinnedFloor;let fe=0;!Q&&!te||Q===te?fe=1:fe=0;const P=1-fe,ke=se/2,be=ke*P;F+=ke,G+=be;let Te="Low";se>=160?Te="Critical":se>=100?Te="High":se>=50&&(Te="Medium"),A.push({dept1:R,dept2:X,score:se,strengthLabel:Te,isCrossFloor:P===1,asymmetry:Math.abs(J-le),friction:be,overlap:fe})}}const M=F>0?G/F*100:0,W=u>0?a/u:0,Y=i>0?a/i:0;return{totalHeadcountWithGrowth:a,totalOpenPlanPeople:a-c,requiredDesks:i,openDesks:s,altDesks:o,enclosedOffices:c,totalMeetingRooms:u,totalMeetingSeats:f,totalPhoneBooths:d,derivedMeetingRatio:W,effectiveDeskRatio:Y,areaWorkstations:h,areaMeeting:p,areaPhone:m,areaSupport:g,areaCirculation:y,totalUsedArea:v,remainingArea:n-v,density:a>0?n/a:0,occupancyRatio:i>0?n/i:0,fitFactor:v/n*100,roomMix:b,floorMetrics:x,adjacencyStats:{stressScore:M,topFrictionPairs:A.filter(O=>O.friction>0).sort((O,L)=>L.friction-O.friction),allPairs:A.sort((O,L)=>L.score-O.score),matrix:T}}},eu={s:4,m:8,l:14,b:20,t:40},tu={s:10,m:18,l:25,b:40,t:80},up=(e,t)=>{var K,D,Z,ee;const r=_o(e.unit),n=e.calculatedNia;let a=0,i=0,s=0,o=0,c=0,u=0,f=0,d=0,h=0,p=0,m=0,g=0,y=0,v=0;const b={small:0,medium:0,large:0,board:0,townhall:0},x=[],_=e.floors.reduce((O,L)=>O+L.headcount,0)||e.headcount,w=((K=t.workpoints)==null?void 0:K.fixed)||0,S=((D=t.workpoints)==null?void 0:D.alternative)||0,k=t.enclosedOfficeCount||0,N=Math.max(0,w-k);e.floors.forEach(O=>{const L=Math.ceil(O.headcount*(1+t.growthBuffer/100));a+=L;const R=_>0?O.headcount/_:0,X=Math.round(k*R),J=Math.round(N*R),le=Math.round(S*R),se=X+J+le;c+=X,s+=J,o+=le,i+=se;const Q=t.meetingRatios.small>0?Math.ceil(L/t.meetingRatios.small):0,te=t.meetingRatios.medium>0?Math.ceil(L/t.meetingRatios.medium):0,fe=t.meetingRatios.large>0?Math.ceil(L/t.meetingRatios.large):0,P=t.meetingRatios.board>0?Math.ceil(L/t.meetingRatios.board):0,ke=t.meetingRatios.townhall>0?Math.ceil(L/t.meetingRatios.townhall):0,be=Q+te+fe+P+ke,Te=Q*eu.s+te*eu.m+fe*eu.l+P*eu.b+ke*eu.t;u+=be,f+=Te,b.small+=Q,b.medium+=te,b.large+=fe,b.board+=P,b.townhall+=ke;const Ae=Math.max(1,t.phoneBoothRatio),he=Math.ceil(L/Ae);d+=he;let We=0;const xt=[];t.supportSpaces.forEach(He=>{let Ke=0,Tt=0;if(He.logic==="ratio")Ke=Math.ceil(L/Math.max(1,He.value)),Tt=Ke*(He.areaPerUnit||0);else if(He.logic==="fixed_count"){const Ns=He.value*R;Tt=Ns*(He.areaPerUnit||0),Ke=Ns}else He.logic==="area_per_person"?(Tt=L*He.value,Ke=0):He.logic==="pct_nia"?(Tt=n*R*(He.value/100),Ke=0):He.logic==="fixed_area"&&(Tt=He.value*R,Ke=0);We+=Tt,xt.push({name:He.name,count:Ke,area:Tt})});const tr=X*r.deskEnclosed,zt=J*r.deskOpen,kr=le*r.deskAlt,Xt=tr+zt+kr;let It=Q*tu.s+te*tu.m+fe*tu.l+P*tu.b+ke*tu.t;const Kt=e.unit==="sqft"?It*10.76:It,Dr=he*r.phoneBooth,ma=Xt+Kt+Dr+We,Et=ma*(t.circulationPct/100),hr=ma+Et,Re=n*R,mt=Re>0?hr/Re*100:0;h+=Xt,p+=Kt,m+=Dr,g+=We,y+=Et,v+=hr,x.push({floorId:O.id,name:O.name,headcount:L,enclosedOffices:X,openDesks:J,altDesks:le,totalDesks:se,meetingRoomsTotal:be,roomsSmall:Q,roomsMedium:te,roomsLarge:fe,roomsBoard:P,roomsTownhall:ke,phoneBooths:he,supportSummary:xt,areaUsed:hr,areaWorkstations:Xt,areaMeeting:Kt,areaPhone:Dr,areaSupport:We,areaCirculation:Et,utilization:mt})});const j=e.departments,E=j.length,A=[],T={};j.forEach(O=>{T[O.id]={},O.collaborators.forEach(L=>{L.deptId&&(T[O.id][L.deptId]=L.strength)})});let F=0,G=0;for(let O=0;O<E;O++)for(let L=O+1;L<E;L++){const R=j[O],X=j[L],J=((Z=T[R.id])==null?void 0:Z[X.id])||0,le=((ee=T[X.id])==null?void 0:ee[R.id])||0,se=J+le;if(se>0){const Q=R.pinnedFloor,te=X.pinnedFloor;let fe=0;!Q&&!te||Q===te?fe=1:fe=0;const P=1-fe,ke=se/2,be=ke*P;F+=ke,G+=be;let Te="Low";se>=160?Te="Critical":se>=100?Te="High":se>=50&&(Te="Medium"),A.push({dept1:R,dept2:X,score:se,strengthLabel:Te,isCrossFloor:P===1,asymmetry:Math.abs(J-le),friction:be,overlap:fe})}}const M=F>0?G/F*100:0,W=u>0?a/u:0,Y=i>0?a/i:0;return{totalHeadcountWithGrowth:a,totalOpenPlanPeople:a-c,requiredDesks:i,openDesks:s,altDesks:o,enclosedOffices:c,totalMeetingRooms:u,totalMeetingSeats:f,totalPhoneBooths:d,derivedMeetingRatio:W,effectiveDeskRatio:Y,areaWorkstations:h,areaMeeting:p,areaPhone:m,areaSupport:g,areaCirculation:y,totalUsedArea:v,remainingArea:n-v,density:a>0?n/a:0,occupancyRatio:i>0?n/i:0,fitFactor:v/n*100,roomMix:b,floorMetrics:x,adjacencyStats:{stressScore:M,topFrictionPairs:A.filter(O=>O.friction>0).sort((O,L)=>L.friction-O.friction),allPairs:A.sort((O,L)=>L.score-O.score),matrix:T}}},v0=({data:e,groups:t,unit:r,height:n="100%",showLegend:a=!0,layout:i="vertical",barSize:s=40,maxCategories:o=6,showLabels:c=!0})=>{const{chartData:u,activeGroups:f}=H.useMemo(()=>{let h=t;if(t.length>o){const m=t.slice(0,o-1),g={id:"_other",name:"Other",color:"#94a3b8",items:[]};h=[...m,g]}return{chartData:e.map(m=>{const g={...m,_total:0};let y=0;if(t.forEach(v=>{m[v.id]&&(y+=m[v.id])}),t.length>o){t.slice(0,o-1);const v=t.slice(o-1);let b=0;v.forEach(x=>{g[x.id]!==void 0&&(b+=g[x.id],delete g[x.id])}),g._other=b}return g._total=y,g}),activeGroups:h}},[e,t,o]),d=h=>{const{x:p,y:m,width:g,height:y,value:v,payload:b}=h,x=b&&typeof b._total=="number"?b._total:0,_=x>0?v/x:0;if(_<.05)return null;const w=i==="vertical",S=20;return w&&g<S||!w&&y<S?null:l.jsx("text",{x:p+g/2,y:m+y/2,fill:"#fff",textAnchor:"middle",dominantBaseline:"middle",fontSize:10,fontWeight:"bold",style:{pointerEvents:"none",textShadow:"0px 0px 3px rgba(0,0,0,0.6)"},children:`${(_*100).toFixed(0)}%`})};return l.jsx(qa,{width:"100%",height:n,children:l.jsxs(g0,{data:u,layout:i,barSize:s,margin:{top:20,right:30,left:20,bottom:5},children:[i==="vertical"?l.jsxs(l.Fragment,{children:[l.jsx(la,{type:"number",hide:!0}),l.jsx(ca,{type:"category",dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"},width:100})]}):l.jsxs(l.Fragment,{children:[l.jsx(la,{dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"}}),l.jsx(ca,{type:"number",hide:!0})]}),l.jsx(ir,{cursor:{fill:"transparent"},content:({active:h,payload:p})=>{if(h&&p&&p.length&&p[0].payload){const m=p[0].payload._total||0;return l.jsxs("div",{className:"bg-white p-3 border border-slate-200 rounded-lg shadow-xl text-xs z-50",children:[l.jsxs("div",{className:"font-bold text-slate-800 mb-2 border-b border-slate-100 pb-1",children:[p[0].payload.name," Total: ",Math.round(m).toLocaleString()," ",r]}),p.map((g,y)=>l.jsxs("div",{className:"flex justify-between items-center gap-4 mb-1",children:[l.jsxs("span",{style:{color:g.color},className:"font-semibold",children:[g.name,":"]}),l.jsxs("span",{className:"text-slate-600 font-mono",children:[Math.round(g.value).toLocaleString()," (",m>0?(g.value/m*100).toFixed(1):0,"%)"]})]},y))]})}return null}}),a&&l.jsx(na,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}}),f.map(h=>l.jsx(Ia,{dataKey:h.id,name:h.name,stackId:"a",fill:h.color,radius:[0,0,0,0],children:c&&l.jsx(Dn,{dataKey:h.id,content:d})},h.id))]})})},yle=({label:e,count:t,area:r,totalFloorArea:n,deltaCount:a,deltaArea:i,unit:s,key:o})=>{const c=n>0?r/n*100:0;return l.jsxs("tr",{className:"border-b border-slate-50 hover:bg-slate-50/80 transition-colors group",children:[l.jsx("td",{className:"py-2 pl-4 text-sm font-medium text-slate-700",children:e}),l.jsxs("td",{className:"py-2 px-2 text-right text-sm text-slate-600 font-mono",children:[t>0?t:"-",a!==void 0&&a!==0&&l.jsxs("span",{className:`ml-1 text-[10px] ${a>0?"text-blue-600":"text-orange-600"}`,children:[a>0?"+":"",a]})]}),l.jsxs("td",{className:"py-2 px-2 text-right text-sm text-slate-600 font-mono",children:[Math.round(r).toLocaleString(),i!==void 0&&i!==0&&l.jsxs("span",{className:`ml-1 text-[10px] ${i>0?"text-blue-600":"text-orange-600"}`,children:[i>0?"+":"",Math.round(i)]})]}),l.jsx("td",{className:"py-2 pr-4 text-right text-xs text-slate-400 font-mono",children:c>0?`${c.toFixed(1)}%`:"-"})]})},ble=(e,t)=>{const r=[];let n="Low";e.utilization>100?(n="High",r.push("Over Capacity (>100% Util)")):e.utilization>90&&(n="Medium",r.push("High Utilization (>90%)"));const a=e.areaUsed/e.headcount,i=t==="sqm"?8:85;return a<i&&(n==="Low"&&(n="Medium"),r.push(`High Density (<${i} ${t}/p)`)),e.headcount/(e.meetingRoomsTotal||1)>40&&r.push("Low Meeting Availability"),{level:n,drivers:r}},wle=({floor:e,fMetric:t,project:r,scenario:n,programGroups:a,compareFMetric:i,onGoToStacking:s,key:o})=>{const[c,u]=H.useState(!1),[f,d]=H.useState(!0),h=r.unit.toUpperCase(),p=_o(r.unit),{level:m,drivers:g}=ble(t,r.unit),y=m==="High"?"text-rose-600 bg-rose-50 border-rose-100":m==="Medium"?"text-amber-600 bg-amber-50 border-amber-100":"text-emerald-600 bg-emerald-50 border-emerald-100",v=w=>[{group:"Work",label:"Open Workstations",count:w.openDesks,area:w.openDesks*p.deskOpen},{group:"Work",label:"Enclosed Offices",count:w.enclosedOffices,area:w.enclosedOffices*p.deskEnclosed},{group:"Work",label:"Alternative Points",count:w.altDesks,area:w.altDesks*p.deskAlt},{group:"Meet",label:"Small Mtg (4p)",count:w.roomsSmall,area:w.roomsSmall*(r.unit==="sqm"?10:100)},{group:"Meet",label:"Medium Mtg (8p)",count:w.roomsMedium,area:w.roomsMedium*(r.unit==="sqm"?18:190)},{group:"Meet",label:"Large Mtg (14p)",count:w.roomsLarge,area:w.roomsLarge*(r.unit==="sqm"?25:270)},{group:"Meet",label:"Boardroom (20p)",count:w.roomsBoard,area:w.roomsBoard*(r.unit==="sqm"?40:430)},{group:"Meet",label:"Phone Booths",count:w.phoneBooths,area:w.phoneBooths*p.phoneBooth},...w.supportSummary.map(S=>({group:"Support",label:S.name,count:S.count,area:S.area})),{group:"Circ",label:"Circulation",count:0,area:w.areaCirculation}].filter(S=>S.area>0||S.count>0),b=v(t),x=i?v(i):[],_=H.useMemo(()=>{const w={name:e.name};return a.forEach(S=>{let k=0;S.items.forEach(N=>{if(N==="work_open")k+=t.openDesks*p.deskOpen;else if(N==="work_enclosed")k+=t.enclosedOffices*p.deskEnclosed;else if(N==="work_alt")k+=t.altDesks*p.deskAlt;else if(N==="meet")k+=t.areaMeeting;else if(N==="phone")k+=t.areaPhone;else if(N==="circ")k+=t.areaCirculation;else{const j=n.supportSpaces.find(E=>E.id===N);if(j){const E=t.supportSummary.find(A=>A.name===j.name);E&&(k+=E.area)}}}),w[S.id]=k}),[w]},[t,a,n,p]);return l.jsxs("div",{className:`bg-white rounded-xl border transition-all duration-300 overflow-hidden ${c?"border-indigo-200 shadow-md ring-1 ring-indigo-50":"border-slate-200 shadow-sm"}`,children:[l.jsxs("div",{className:`p-4 flex items-center justify-between cursor-pointer hover:bg-slate-50 transition-colors ${c?"bg-slate-50/50":""}`,onClick:()=>u(!c),children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`p-1.5 rounded-lg transition-colors ${c?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-400"}`,children:c?l.jsx(Xr,{className:"w-5 h-5"}):l.jsx(Pr,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800",children:e.name}),l.jsxs("div",{className:"text-xs text-slate-500 flex gap-3",children:[l.jsxs("span",{className:"font-mono",children:[Math.round(t.areaUsed).toLocaleString()," ",h]}),l.jsx("span",{children:""}),l.jsxs("span",{children:[t.headcount," HC"]})]})]})]}),l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("div",{className:"hidden sm:flex flex-col items-end",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Occupancy"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-16 h-1.5 bg-slate-100 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full rounded-full ${t.utilization>100?"bg-rose-500":"bg-emerald-500"}`,style:{width:`${Math.min(t.utilization,100)}%`}})}),l.jsxs("span",{className:"text-xs font-bold text-slate-700",children:[t.utilization.toFixed(0),"%"]})]})]}),l.jsxs("div",{className:`px-2.5 py-1 rounded-md border text-[10px] font-bold uppercase tracking-wider flex items-center gap-1.5 ${y}`,children:[m==="High"?l.jsx(ur,{className:"w-3 h-3"}):l.jsx(uc,{className:"w-3 h-3"}),m," Stress"]})]})]}),c&&l.jsxs("div",{className:"border-t border-slate-100 animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-b border-slate-100 flex justify-between items-start",children:[l.jsx("div",{className:"flex gap-4",children:g.length>0?l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Stress Drivers"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((w,S)=>l.jsx("span",{className:"text-xs font-medium text-slate-600 bg-white border border-slate-200 px-2 py-0.5 rounded shadow-sm",children:w},S))})]}):l.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-600 font-medium",children:[l.jsx(Cn,{className:"w-4 h-4"})," No critical stress factors detected."]})}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>d(!f),className:`text-xs font-bold px-3 py-1.5 rounded border flex items-center gap-1.5 transition-colors ${f?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-white text-slate-400 border-slate-200"}`,title:"Include in Design Handoff Export",children:[f?l.jsx(Cn,{className:"w-3 h-3"}):l.jsx("div",{className:"w-3 h-3 rounded-full border border-slate-300"}),"Export"]}),l.jsxs("button",{onClick:s,className:"text-xs font-bold px-3 py-1.5 rounded bg-white border border-slate-200 text-slate-600 hover:text-indigo-600 hover:border-indigo-200 flex items-center gap-1.5 shadow-sm",children:[l.jsx(Mr,{className:"w-3 h-3"})," Edit in Stacking"]})]})]}),l.jsxs("div",{className:"p-6 pb-2",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase mb-2 flex items-center gap-2",children:[l.jsx(dc,{className:"w-3 h-3"})," Program Mix"]}),l.jsx("div",{className:"h-16 mb-6 bg-white rounded-lg border border-slate-100 p-2 shadow-sm",children:l.jsx(v0,{data:_,groups:a,unit:h,layout:"horizontal",barSize:24,showLabels:!0,showLegend:!1})})]}),l.jsxs("div",{className:"px-6 pb-6",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-400 uppercase mb-2 flex items-center gap-2",children:[l.jsx(Rn,{className:"w-3 h-3"})," Space Breakdown (Design Schedule)"]}),l.jsx("div",{className:"border border-slate-200 rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"py-2 pl-4 text-left text-xs font-bold text-slate-500 uppercase",children:"Space Type"}),l.jsx("th",{className:"py-2 px-2 text-right text-xs font-bold text-slate-500 uppercase",children:"Qty"}),l.jsxs("th",{className:"py-2 px-2 text-right text-xs font-bold text-slate-500 uppercase",children:["Area (",h,")"]}),l.jsx("th",{className:"py-2 pr-4 text-right text-xs font-bold text-slate-500 uppercase",children:"% Floor"})]})}),l.jsx("tbody",{children:b.map((w,S)=>{let k=0,N=0;if(i){const j=x.find(E=>E.label===w.label);j?(k=w.count-j.count,N=w.area-j.area):(k=w.count,N=w.area)}return l.jsx(yle,{label:w.label,count:w.count,area:w.area,totalFloorArea:t.areaUsed,unit:h,deltaCount:i?k:void 0,deltaArea:i?N:void 0},S)})})]})})]})]})]})},zC=({project:e,scenario:t,metrics:r,allScenarios:n,onBack:a,programGroups:i,onSwitchScenario:s,onGoToStacking:o})=>{const[c,u]=H.useState(null),f=n.find(p=>p.id===c),d=f?up(e,f):null,h=H.useMemo(()=>{const p=_o(e.unit),m={name:"Project Total"};return i.forEach(g=>{let y=0;r.floorMetrics.forEach(v=>{g.items.forEach(b=>{if(b==="work_open")y+=v.openDesks*p.deskOpen;else if(b==="work_enclosed")y+=v.enclosedOffices*p.deskEnclosed;else if(b==="work_alt")y+=v.altDesks*p.deskAlt;else if(b==="meet")y+=v.areaMeeting;else if(b==="phone")y+=v.areaPhone;else if(b==="circ")y+=v.areaCirculation;else{const x=t.supportSpaces.find(_=>_.id===b);if(x){const _=v.supportSummary.find(w=>w.name===x.name);_&&(y+=_.area)}}})}),m[g.id]=y}),[m]},[r,i,t,e]);return l.jsxs("div",{className:"flex flex-col h-full bg-slate-50/50",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm z-10 sticky top-0",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-full text-slate-500 transition-colors",title:"Back to Comparison",children:l.jsx(MT,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide mb-0.5",children:"Active Deep Dive"}),l.jsxs("div",{className:"relative group",children:[l.jsx("select",{className:"appearance-none bg-transparent text-xl font-bold text-slate-800 outline-none cursor-pointer pr-8 hover:text-indigo-600 transition-colors",value:t.id,onChange:p=>s(p.target.value),children:n.map(p=>l.jsx("option",{value:p.id,children:p.name},p.id))}),l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute right-0 top-1/2 -translate-y-1/2 pointer-events-none"})]})]}),l.jsx("div",{className:"h-8 w-px bg-slate-200 mx-2 hidden sm:block"}),l.jsxs("div",{className:"hidden sm:block",children:[l.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Project"}),l.jsx("div",{className:"text-sm font-medium text-slate-600",children:e.projectName})]})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-50 border border-slate-200 rounded-lg hover:border-slate-300 transition-colors",children:[l.jsx(Fa,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase mr-2 hidden sm:inline",children:"Side-by-Side"}),l.jsxs("select",{className:"bg-transparent text-sm font-bold text-indigo-700 outline-none cursor-pointer w-32 sm:w-auto",value:c||"",onChange:p=>u(p.target.value||null),children:[l.jsx("option",{value:"",children:"None"}),n.filter(p=>p.id!==t.id).map(p=>l.jsx("option",{value:p.id,children:p.name},p.id))]})]}),l.jsxs("button",{onClick:o,className:"hidden sm:flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold shadow-sm transition-all text-sm",children:[l.jsx(Mr,{className:"w-4 h-4"})," Stacking Plan"]})]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-8 custom-scrollbar",children:l.jsxs("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8",children:[l.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase mb-4 flex items-center gap-2",children:[l.jsx(Yy,{className:"w-4 h-4"})," Project Totals"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Total Area"}),l.jsxs("div",{className:"text-xl font-bold text-slate-800",children:[Math.round(r.totalUsedArea).toLocaleString()," ",l.jsx("span",{className:"text-xs font-normal text-slate-400",children:e.unit.toUpperCase()})]}),d&&l.jsxs("div",{className:`text-xs font-mono ${r.totalUsedArea>d.totalUsedArea?"text-orange-600":"text-blue-600"}`,children:[r.totalUsedArea>d.totalUsedArea?"+":"",Math.round(r.totalUsedArea-d.totalUsedArea)," vs Base"]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Utilization"}),l.jsxs("div",{className:`text-xl font-bold ${r.fitFactor>100?"text-rose-600":"text-emerald-600"}`,children:[r.fitFactor.toFixed(0),"%"]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Seat Count"}),l.jsx("div",{className:"text-xl font-bold text-slate-800",children:r.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-xs text-slate-500",children:"Density"}),l.jsx("div",{className:"text-xl font-bold text-slate-800",children:r.density.toFixed(1)})]})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase mb-4 flex items-center gap-2",children:[l.jsx(dc,{className:"w-4 h-4"})," Program Distribution"]}),l.jsx("div",{className:"h-64",children:l.jsx(v0,{data:h,groups:i,unit:e.unit.toUpperCase(),layout:"vertical",barSize:50,showLabels:!0,showLegend:!0})})]}),l.jsxs("div",{className:"bg-indigo-50 p-6 rounded-xl border border-indigo-100 shadow-sm",children:[l.jsxs("h3",{className:"text-sm font-bold text-indigo-900 uppercase mb-2 flex items-center gap-2",children:[l.jsx(uc,{className:"w-4 h-4"})," Test Fit Diagnostics"]}),l.jsx("p",{className:"text-xs text-indigo-700 mb-4 leading-relaxed",children:"Overall feasibility assessment based on floor plate capacity and programmatic needs."}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:`text-2xl font-bold ${r.adjacencyStats.stressScore>30?"text-amber-600":"text-emerald-600"}`,children:[Math.max(0,100-r.adjacencyStats.stressScore).toFixed(0),"/100"]}),l.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:"Fit Score"})]})]})]}),l.jsxs("div",{className:"lg:col-span-8",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Mr,{className:"w-5 h-5 text-indigo-600"})," Floor Explorer"]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Detailed space breakdown and stress analysis per floor."})]}),l.jsxs("div",{className:"hidden sm:flex items-center gap-3 bg-white px-3 py-1.5 rounded-full border border-slate-200 shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500 uppercase",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})," Low Stress"]}),l.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500 uppercase",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"})," Med Stress"]}),l.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500 uppercase",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-rose-500"})," High Stress"]})]})]}),l.jsx("div",{className:"space-y-4",children:e.floors.map(p=>{const m=r.floorMetrics.find(y=>y.floorId===p.id);if(!m)return null;const g=d?d.floorMetrics.find(y=>y.name===p.name):void 0;return l.jsx(wle,{floor:p,fMetric:m,project:e,scenario:t,programGroups:i,compareFMetric:g,onGoToStacking:o},p.id)})})]})]})})]})},Sle=(e,t=!1)=>{const r=Math.min(...e),n=Math.max(...e);if(r===0&&n===0)return null;if(r===n)return l.jsx("span",{className:"text-[10px] text-slate-400 font-medium px-2",children:"No Variance"});const a=n-r,i=r===0?100:a/r*100;return l.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${i>15?"text-amber-600 bg-amber-50 border-amber-100":"text-slate-600 bg-slate-100 border-slate-200"}`,children:[i>100?">100%":`${i.toFixed(0)}%`," "]})},_le=e=>{const t={};return e.floorMetrics.forEach(r=>{r.supportSummary.forEach(n=>{t[n.name]||(t[n.name]={count:0,area:0}),t[n.name].count+=n.count,t[n.name].area+=n.area})}),t},Os=({title:e,icon:t,isOpen:r,onToggle:n,children:a,deltaValues:i})=>l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-4 ${r?"bg-slate-50 border-b border-slate-100":"bg-white hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`p-1.5 rounded-lg ${r?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}`,children:l.jsx(t,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide",children:e})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[!r&&i&&Sle(i),r?l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400"})]})]}),r&&l.jsx("div",{className:"p-5 animate-in slide-in-from-top-2 duration-200",children:a})]}),ag=({scenarios:e,rows:t})=>l.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-3 pl-4 text-xs font-bold text-slate-400 uppercase w-1/3",children:"Metric / Driver"}),e.map(r=>l.jsx("th",{className:"text-right py-3 px-4 text-xs font-bold text-indigo-800 uppercase w-32",children:r.name},r.id))]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:t.map((r,n)=>l.jsxs("tr",{className:`hover:bg-slate-50/80 ${r.highlight?"bg-indigo-50/30":""}`,children:[l.jsxs("td",{className:"py-3 pl-4",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700",children:r.label}),r.subLabel&&l.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:r.subLabel})]}),r.values.map((a,i)=>l.jsx("td",{className:"py-3 px-4 text-right text-sm font-medium text-slate-700",children:a},i))]},n))})]})}),kle=({scenario:e,metrics:t,project:r,isActive:n,onSelect:a,onDeepDive:i})=>{const s=t.fitFactor<=100,o=r.unit.toUpperCase();return l.jsxs("div",{className:`relative flex flex-col p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md h-full ${n?"bg-white border-indigo-600 shadow-lg z-10":"bg-white border-slate-200 hover:border-indigo-300"}`,onClick:a,children:[n&&l.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:"Selected Direction"}),l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsx("h3",{className:`text-base font-bold truncate ${n?"text-indigo-800":"text-slate-700"}`,title:e.name,children:e.name}),l.jsx("div",{className:`flex-shrink-0 flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${s?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:s?l.jsx(fa,{className:"w-3 h-3"}):l.jsx(FT,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-y-3 gap-x-2 mb-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Total Headcount"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.totalHeadcountWithGrowth})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Workpoints"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Density"}),l.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[t.density.toFixed(1)," ",l.jsxs("span",{className:"text-[10px] font-normal text-slate-400",children:[o,"/p"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Space Utilization Index"}),l.jsxs("div",{className:`text-sm font-bold ${t.fitFactor>100?"text-rose-600":"text-slate-800"}`,children:[t.fitFactor.toFixed(0),"%"]})]})]}),l.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Meeting Ratio"}),l.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:["1 : ",t.derivedMeetingRatio.toFixed(0)]})]}),l.jsxs("button",{onClick:c=>{c.stopPropagation(),i()},className:"text-[10px] flex items-center gap-1 bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1.5 rounded-md font-bold transition-colors border border-slate-200",children:[l.jsx(qT,{className:"w-3 h-3"})," Details"]})]})]})},Nle=({project:e,scenarios:t,metricsMap:r,programGroups:n})=>{const a=a0(e.unit);return l.jsx("div",{className:"space-y-6",children:e.floors.map(i=>{const s=t.map(o=>{const c=r[o.id].floorMetrics.find(f=>f.floorId===i.id),u={name:o.name};return c&&n.forEach(f=>{let d=0;f.items.forEach(h=>{if(h==="work_open")d+=c.openDesks*a.deskOpen;else if(h==="work_enclosed")d+=c.enclosedOffices*a.deskEnclosed;else if(h==="work_alt")d+=c.altDesks*a.deskAlt;else if(h==="meet")d+=c.areaMeeting;else if(h==="phone")d+=c.areaPhone;else if(h==="circ")d+=c.areaCirculation;else{const p=o.supportSpaces.find(m=>m.id===h);if(p){const m=c.supportSummary.find(g=>g.name===p.name);m&&(d+=m.area)}}}),u[f.id]=d}),u});return l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-3 flex justify-between",children:[l.jsx("span",{children:i.name}),l.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:[i.headcount," HC"]})]}),l.jsx("div",{className:"h-24",children:l.jsx(nw,{data:s,groups:n,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:30,showLegend:!1,showLabels:!0})})]},i.id)})})},jle=({scenario:e,metrics:t,project:r,programGroups:n})=>{const a=()=>t.effectiveDeskRatio<=1?"Assignments: Traditional 1:1 model ensures dedicated seating for all, minimizing change management but maximizing area consumption.":t.effectiveDeskRatio<1.4?"Assignments: Hybrid approach introduces sharing while maintaining team anchors. Requires team-level zoning.":"Assignments: High-agility model assumes mostly mobile workforce. Relies heavily on alternative settings to absorb overflow.",i=()=>t.derivedMeetingRatio>25?"Collaboration: Lean meeting ratio may cause room scarcity during peak hours. Focus on bookable open collab zones.":t.derivedMeetingRatio<15?"Collaboration: High provision of enclosed meeting spaces supports intensive privacy needs but impacts open plan capacity.":"Collaboration: Balanced meeting supply aligns with standard benchmarks.",s=()=>t.areaSupport/t.totalUsedArea*100>15?"Experience: Amenity-rich environment emphasizes social connection and wellness over density.":"Experience: Functional approach to amenities prioritizes operational efficiency.";return l.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200 h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3 border-b border-slate-200 pb-2",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 truncate pr-2",children:e.name}),l.jsx("div",{className:"text-[9px] px-1.5 py-0.5 rounded font-bold uppercase bg-slate-200 text-slate-600",children:"Strategy Profile"})]}),l.jsx("ul",{className:"space-y-3 flex-grow",children:[{label:"Workstations",text:a()},{label:"Meeting & Collab",text:i()},{label:"Support",text:s()}].map((o,c)=>l.jsxs("li",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:o.label}),l.jsx("span",{className:"text-xs text-slate-600 leading-snug",children:o.text})]},c))})]})},Ele=({project:e,scenarios:t,activeScenarioId:r,onActivateScenario:n,onProceed:a})=>{const[i,s]=H.useState(null),[o,c]=H.useState([]),[u,f]=H.useState(["metrics","implications"]);H.useEffect(()=>{const x=[r];t.filter(w=>w.id!==r).slice(0,2).forEach(w=>x.push(w.id)),c(x)},[t,r]);const d=x=>{f(_=>_.includes(x)?_.filter(w=>w!==x):[..._,x])},h=H.useMemo(()=>t.reduce((x,_)=>(x[_.id]=W1(e,_),x),{}),[e,t]),p=t.filter(x=>o.includes(x.id)),m=t.find(x=>x.id===r),g=m?h[r]:null,y=e.programStructure||i0(e.projectType),v=H.useMemo(()=>{const x=a0(e.unit);return p.map(_=>{const w=h[_.id],S={name:_.name};return y.forEach(k=>{let N=0;w.floorMetrics.forEach(j=>{k.items.forEach(E=>{if(E==="work_open")N+=j.openDesks*x.deskOpen;else if(E==="work_enclosed")N+=j.enclosedOffices*x.deskEnclosed;else if(E==="work_alt")N+=j.altDesks*x.deskAlt;else if(E==="meet")N+=j.areaMeeting;else if(E==="phone")N+=j.areaPhone;else if(E==="circ")N+=j.areaCirculation;else{const A=_.supportSpaces.find(T=>T.id===E);if(A){const T=j.supportSummary.find(F=>F.name===A.name);T&&(N+=T.area)}}})}),S[k.id]=N}),S})},[p,h,e,y]),b=x=>{o.includes(x)?o.length>1&&c(o.filter(_=>_!==x)):o.length<3&&c([...o,x])};if(i){const x=t.find(_=>_.id===i);if(x&&h[i])return l.jsx(zC,{project:e,scenario:x,metrics:h[i],allScenarios:t,onBack:()=>s(null),programGroups:y,onSwitchScenario:s,onGoToStacking:a})}return l.jsxs("div",{className:"flex h-full bg-slate-50 overflow-hidden",children:[l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col z-10 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(Fa,{className:"w-4 h-4 text-indigo-600"})," Compare"]}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Select up to 3 scenarios."})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:t.map(x=>{const _=o.includes(x.id),w=r===x.id;return l.jsxs("div",{className:`p-3 rounded-lg border transition-all cursor-pointer ${_?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200 hover:border-indigo-200"}`,onClick:()=>b(x.id),children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${_?"bg-indigo-600 border-indigo-600":"border-slate-300"}`,children:_&&l.jsx(fa,{className:"w-3 h-3 text-white"})}),l.jsx("span",{className:`text-sm font-bold ${_?"text-indigo-900":"text-slate-600"}`,children:x.name})]}),w&&l.jsx("div",{className:"ml-6 text-[10px] font-bold text-indigo-600 uppercase tracking-wider",children:"Current Selection"})]},x.id)})})]}),l.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden relative",children:[l.jsx("div",{className:"flex-grow overflow-y-auto p-8 custom-scrollbar bg-slate-50/50",children:l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-32",children:[l.jsx("div",{className:"mb-8",children:l.jsx("div",{className:"flex justify-between items-end",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Strategic Decision Framework"}),l.jsxs("p",{className:"text-slate-500",children:["Evaluating strategies for ",e.projectName,"."]})]})})}),l.jsx(Os,{title:"Strategic Metrics Overview",icon:Rn,isOpen:u.includes("metrics"),onToggle:()=>d("metrics"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(x=>l.jsx(kle,{scenario:x,metrics:h[x.id],project:e,isActive:r===x.id,onSelect:()=>n(x.id),onDeepDive:()=>s(x.id)},x.id))})}),l.jsx(Os,{title:"Workstation Strategy",icon:VT,isOpen:u.includes("workpoints"),onToggle:()=>d("workpoints"),deltaValues:p.map(x=>h[x.id].requiredDesks),children:l.jsx(ag,{scenarios:p,rows:[{label:"Total Workpoints (Seats)",values:p.map(x=>h[x.id].requiredDesks.toLocaleString()),highlight:!0},{label:"Open Workstations",values:p.map(x=>h[x.id].openDesks)},{label:"Enclosed Offices (Private)",values:p.map(x=>h[x.id].enclosedOffices)},{label:"Alternative Workpoints",values:p.map(x=>h[x.id].altDesks)},{label:"Effective Sharing Ratio",subLabel:"Total HC / Total Seats",values:p.map(x=>`1 : ${h[x.id].effectiveDeskRatio.toFixed(2)}`)}]})}),l.jsx(Os,{title:"Meeting Rooms",icon:Fr,isOpen:u.includes("meeting"),onToggle:()=>d("meeting"),deltaValues:p.map(x=>h[x.id].totalMeetingRooms),children:l.jsx(ag,{scenarios:p,rows:[{label:"Total Enclosed Meeting Rooms",values:p.map(x=>h[x.id].totalMeetingRooms),highlight:!0},{label:"Total Meeting Capacity (Seats)",values:p.map(x=>h[x.id].totalMeetingSeats)},{label:"Effective Meeting Ratio",subLabel:"Headcount per Room",values:p.map(x=>`1 : ${h[x.id].derivedMeetingRatio.toFixed(1)}`)},{label:"Small Meeting Rooms (4p)",values:p.map(x=>h[x.id].roomMix.small)},{label:"Medium Meeting Rooms (8p)",values:p.map(x=>h[x.id].roomMix.medium)},{label:"Large Meeting Rooms (14p)",values:p.map(x=>h[x.id].roomMix.large)},{label:"Boardrooms (20p)",values:p.map(x=>h[x.id].roomMix.board)},{label:"Phone Booths (1p)",values:p.map(x=>h[x.id].totalPhoneBooths)}]})}),l.jsx(Os,{title:"Support & Amenity Allocation",icon:Wp,isOpen:u.includes("support"),onToggle:()=>d("support"),deltaValues:p.map(x=>Math.round(h[x.id].areaSupport)),children:l.jsx(ag,{scenarios:p,rows:[{label:"Total Support Area",values:p.map(x=>`${Math.round(h[x.id].areaSupport).toLocaleString()} ${e.unit.toUpperCase()}`),highlight:!0},{label:"% of NIA",values:p.map(x=>`${(h[x.id].areaSupport/e.calculatedNia*100).toFixed(1)}%`)},...(()=>{const x=new Set;return p.forEach(_=>_.supportSpaces.forEach(w=>x.add(w.name))),Array.from(x).map(_=>({label:_,values:p.map(w=>{const S=w.supportSpaces.find(E=>E.name===_),N=_le(h[w.id])[_];if(!S||!N)return"-";const j=S.logic==="ratio"?`1:${S.value}`:S.logic==="pct_nia"?`${S.value}%`:"Fixed";return N.count>0?`${N.count} (${j})`:`${Math.round(N.area)} ${e.unit==="sqm"?"m":"ft"} (${j})`})}))})()]})}),l.jsx(Os,{title:"Program Mix (Space Distribution)",icon:dc,isOpen:u.includes("space_mix"),onToggle:()=>d("space_mix"),children:l.jsx("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-72",children:l.jsx(nw,{data:v,groups:y,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:60,showLabels:!0})})}),l.jsx(Os,{title:"Floor-by-Floor Breakdown",icon:Mr,isOpen:u.includes("floors"),onToggle:()=>d("floors"),children:l.jsx(Nle,{project:e,scenarios:p,metricsMap:h,programGroups:y})}),l.jsx(Os,{title:"Strategic Implications & Recommendations",icon:QT,isOpen:u.includes("implications"),onToggle:()=>d("implications"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(x=>l.jsx(jle,{scenario:x,metrics:h[x.id],project:e,programGroups:y},x.id))})})]})}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-2xl flex justify-between items-center z-20 px-8",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:l.jsx(ms,{className:"w-5 h-5 text-indigo-700"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Selected Strategy"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:m==null?void 0:m.name})]}),g&&l.jsxs("div",{className:`ml-4 px-3 py-1 rounded text-xs font-bold ${g.fitFactor<=100?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[g.fitFactor.toFixed(0),"% Utilization"]})]}),l.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-bold shadow-md transition-all hover:translate-x-1",children:["Proceed to Stacking Plan ",l.jsx(Mr,{className:"w-4 h-4"})]})]})]})]})},Tle=({project:e,activeStrategy:t,handleStrategyChange:r,activeMetrics:n,scenarios:a,activeScenarioId:i,setActiveScenarioId:s,addScenario:o,duplicateScenario:c,deleteScenario:u,renameScenario:f,compareScenarioId:d,setCompareScenarioId:h,compareMetrics:p,onNavigate:m})=>{const[g,y]=H.useState("planning");return l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-6 py-2 flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center bg-slate-100 p-1 rounded-lg",children:[l.jsxs("button",{onClick:()=>y("planning"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${g==="planning"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ps,{className:"w-3 h-3"})," Detailed Planning"]}),l.jsxs("button",{onClick:()=>y("decision"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${g==="decision"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ms,{className:"w-3 h-3"})," Decision Framework"]})]})}),l.jsx("div",{className:"flex-grow overflow-hidden relative",children:g==="decision"?l.jsx(Ele,{project:e,scenarios:a,activeScenarioId:i,onActivateScenario:s,onProceed:()=>m("stacking")}):l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[340px] flex-shrink-0 flex flex-col border-r border-slate-200 bg-white z-10",children:l.jsx("div",{className:"flex-grow overflow-hidden",children:l.jsx(MD,{strategy:t,onChange:r,title:t.name,baseHeadcount:e.headcount})})}),l.jsx("div",{className:"flex-grow overflow-y-auto bg-slate-50/50 p-6",children:l.jsx(gle,{metrics:n,strategy:t,project:e})}),l.jsx("div",{className:"w-80 flex-shrink-0 bg-white border-l border-slate-200 z-10",children:l.jsx(vle,{scenarios:a,activeId:i,project:e,metrics:n,onActivate:s,onAdd:o,onDuplicate:c,onDelete:u,onRename:f,compareId:d,onCompare:h,compareMetrics:p,onGoToDecision:()=>y("decision")})})]})})]})},Ale=({project:e,onChange:t,selectedDeptId:r,onSelectDept:n})=>{const a=(c,u)=>{const f=e.departments.map(d=>d.id===c?{...d,...u}:d);t({...e,departments:f})},i=()=>{const c=`d-${Date.now()}`,u={id:c,name:"New Dept",headcount:10,color:vr.departments[e.departments.length%vr.departments.length],collaborators:[]};t({...e,departments:[...e.departments,u]}),n(c)},s=c=>{const f=e.departments.filter(d=>d.id!==c).map(d=>({...d,collaborators:d.collaborators.filter(h=>h.deptId!==c)}));t({...e,departments:f}),r===c&&n(null)},o=(c,u,f)=>{const d=e.departments.find(m=>m.id===c);if(!d)return;let h=[...d.collaborators];const p=h.findIndex(m=>m.deptId===u);p>=0?f===0?h.splice(p,1):h[p]={...h[p],strength:f}:f>0&&h.push({deptId:u,strength:f}),a(c,{collaborators:h})};return e.departments.find(c=>c.id===r),l.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200 w-full",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(xs,{className:"w-4 h-4 text-orange-600"}),"Departments & Flows"]}),l.jsx("button",{onClick:i,className:"p-1.5 bg-white border border-slate-200 rounded hover:bg-orange-50 hover:text-orange-600 transition-colors",children:l.jsx(Za,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx("div",{className:"divide-y divide-slate-100",children:e.departments.map(c=>{var f;const u=c.id===r;return l.jsxs("div",{className:`group transition-colors ${u?"bg-orange-50/50":"hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"p-3 flex items-center gap-3 cursor-pointer",onClick:()=>n(u?null:c.id),children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:c.color}}),l.jsx("input",{type:"color",className:"absolute inset-0 opacity-0 cursor-pointer",value:c.color,onChange:d=>a(c.id,{color:d.target.value}),onClick:d=>d.stopPropagation()})]}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("input",{className:`text-sm font-bold bg-transparent w-full outline-none truncate ${u?"text-orange-900":"text-slate-700"}`,value:c.name,onChange:d=>a(c.id,{name:d.target.value}),onClick:d=>d.stopPropagation()}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400 mt-0.5",children:[l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(JT,{className:"w-3 h-3"})," ",c.headcount]}),l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(Mr,{className:"w-3 h-3"})," ",((f=e.floors.find(d=>d.id===c.pinnedFloor))==null?void 0:f.name)||"Unassigned"]})]})]}),l.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:d=>{d.stopPropagation(),s(c.id)},className:"p-1.5 text-slate-300 hover:text-rose-500",children:l.jsx(gs,{className:"w-3 h-3"})}),l.jsx(Pr,{className:`w-4 h-4 text-slate-300 transition-transform ${u?"rotate-90":""}`})]})]}),u&&l.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-1",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Headcount"}),l.jsx("input",{type:"number",className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.headcount,onChange:d=>a(c.id,{headcount:parseInt(d.target.value)||0})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Floor"}),l.jsxs("select",{className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.pinnedFloor||"",onChange:d=>a(c.id,{pinnedFloor:d.target.value||void 0}),children:[l.jsx("option",{value:"",children:"Unassigned"}),e.floors.map(d=>l.jsx("option",{value:d.id,children:d.name},d.id))]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2 flex justify-between",children:[l.jsx("span",{children:"Interaction Strength (0-100)"}),l.jsx("span",{className:"text-orange-600",children:"With..."})]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-1",children:e.departments.filter(d=>d.id!==c.id).map(d=>{const h=c.collaborators.find(m=>m.deptId===d.id),p=(h==null?void 0:h.strength)||0;return l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"w-20 truncate text-slate-600",title:d.name,children:d.name}),l.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"flex-grow h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-orange-500",value:p,onChange:m=>o(c.id,d.id,parseInt(m.target.value))}),l.jsx("span",{className:`w-8 text-right font-mono ${p>0?"text-slate-800 font-bold":"text-slate-300"}`,children:p})]},d.id)})})]})]})]},c.id)})}),e.departments.length===0&&l.jsxs("div",{className:"p-8 text-center text-slate-400 text-xs",children:["No departments defined.",l.jsx("br",{}),"Click + to add one."]})]})]})},Ole=({matrix:e,onCellClick:t,hoveredLink:r,onHoverLink:n,sortedDepts:a})=>{const o=100+a.length*28;return l.jsx("div",{className:"w-full h-full overflow-auto flex justify-center items-center p-4 bg-slate-50/50",children:l.jsxs("div",{className:"relative bg-white shadow-sm border border-slate-200 p-2 rounded-lg",style:{width:o+20,height:o+20},children:[l.jsx("div",{className:"absolute left-[100px] top-0 flex pointer-events-none",children:a.map((c,u)=>l.jsx("div",{className:"relative h-[100px]",style:{width:28},children:l.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 origin-bottom-left -rotate-45 text-[10px] font-bold text-slate-600 whitespace-nowrap overflow-visible",style:{width:120},children:c.name})},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-0 flex flex-col pointer-events-none",children:a.map((c,u)=>l.jsxs("div",{className:"h-[28px] w-[100px] flex items-center justify-end pr-2 gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate max-w-[70px]",title:c.name,children:c.name}),l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:c.color}})]},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-[100px] flex flex-col border-t border-l border-slate-200",children:a.map(c=>l.jsx("div",{className:"flex",children:a.map(u=>{var p;if(c.id===u.id)return l.jsx("div",{className:"bg-slate-100 border-r border-b border-slate-200",style:{width:28,height:28}},u.id);const f=((p=e[c.id])==null?void 0:p[u.id])||0,d=f/100,h=r&&(r.d1===c.id&&r.d2===u.id||r.d1===u.id&&r.d2===c.id);return l.jsx("div",{className:`border-r border-b border-slate-200 flex items-center justify-center text-[9px] font-bold cursor-pointer transition-all duration-150 ${h?"ring-2 ring-indigo-500 z-10 scale-110":"hover:bg-slate-50"}`,style:{width:28,height:28,backgroundColor:f>0?`rgba(249, 115, 22, ${d})`:"transparent",color:f>50?"white":"#94a3b8"},onClick:()=>t(c,u),onMouseEnter:()=>n({d1:c.id,d2:u.id}),onMouseLeave:()=>n(null),title:`${c.name}  ${u.name}: ${f}`,children:f>0?f:""},u.id)})},c.id))})]})})},Cle=({sortedDepts:e,pairs:t,onHoverLink:r,hoveredLink:n,project:a})=>{const f=x=>{var _;return((_=a.floors.find(w=>w.id===x))==null?void 0:_.name)||"Unassigned"},d=e.reduce((x,_)=>x+Math.max(_.headcount||0,5),0),h=.05,m=(2*Math.PI-h*e.length)/(d||1);let g=-Math.PI/2;const y=e.map(x=>{const w=Math.max(x.headcount||0,5)*m,S=g,k=g+w,N=(S+k)/2;g=k+h;const j=300+200*Math.cos(N),E=300+200*Math.sin(N);return{...x,start:S,end:k,mid:N,x:j,y:E}}),v=[];if(y.length>0){let x=y[0].pinnedFloor,_=0;y.forEach((w,S)=>{const k=S===y.length-1,N=k?void 0:y[S+1].pinnedFloor;if(N!==x||k){const j=y[_],E=w;v.push({name:f(x),start:j.start-.02,end:E.end+.02}),x=N??x,_=S+1}})}const b=(x,_,w,S=0)=>{const k=300+x*Math.cos(_),N=300+x*Math.sin(_),j=300+x*Math.cos(w),E=300+x*Math.sin(w),A=w-_<=Math.PI?0:1;return`M ${k} ${N} A ${x} ${x} 0 ${A} 1 ${j} ${E}`};return l.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:l.jsxs("svg",{viewBox:"0 0 600 600",className:"w-full h-full max-w-[600px] select-none",children:[v.map((x,_)=>{const w=(x.start+x.end)/2,S=300+275*Math.cos(w),k=300+275*Math.sin(w);return l.jsxs("g",{children:[l.jsx("path",{d:b(250,x.start,x.end),fill:"none",stroke:"#f1f5f9",strokeWidth:"20",strokeLinecap:"butt"}),l.jsx("text",{x:S,y:k,textAnchor:"middle",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-400 uppercase tracking-wide",style:{fontSize:"10px"},children:x.name})]},`floor-${_}`)}),t.map((x,_)=>{const w=y.find(j=>j.id===x.dept1.id),S=y.find(j=>j.id===x.dept2.id);if(!w||!S)return null;const k=n&&(n.d1===w.id&&n.d2===S.id||n.d1===S.id&&n.d2===w.id),N=n&&!k;return l.jsx("path",{d:`M ${w.x} ${w.y} Q 300 300 ${S.x} ${S.y}`,fill:"none",stroke:k?vr.primary:`url(#grad-${_})`,strokeWidth:k?4:Math.max(1,x.score/200*12),opacity:k?1:N?.05:.4,onMouseEnter:()=>r({d1:w.id,d2:S.id}),onMouseLeave:()=>r(null),className:"transition-all duration-300 cursor-pointer"},`link-${_}`)}),l.jsx("defs",{children:t.map((x,_)=>{const w=y.find(k=>k.id===x.dept1.id),S=y.find(k=>k.id===x.dept2.id);return!w||!S?null:l.jsxs("linearGradient",{id:`grad-${_}`,gradientUnits:"userSpaceOnUse",x1:w.x,y1:w.y,x2:S.x,y2:S.y,children:[l.jsx("stop",{offset:"0%",stopColor:w.color}),l.jsx("stop",{offset:"100%",stopColor:S.color})]},`grad-${_}`)})}),y.map(x=>{const _=n&&(n.d1===x.id||n.d2===x.id),w=n&&!_,S=x.mid,k=300+235*Math.cos(S),N=300+235*Math.sin(S),j=S*180/Math.PI+(k<300?180:0);return l.jsxs("g",{className:"transition-opacity duration-300",style:{opacity:w?.2:1},children:[l.jsx("path",{d:b(200,x.start,x.end),fill:"none",stroke:x.color,strokeWidth:"16",className:"cursor-pointer hover:brightness-110",onMouseEnter:()=>r({d1:x.id,d2:x.id}),onMouseLeave:()=>r(null)}),l.jsx("text",{x:k,y:N,textAnchor:k>300?"start":"end",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-700 pointer-events-none",transform:`rotate(${j-(k<300?180:0)}, ${k}, ${N})`,children:x.name})]},x.id)})]})})},Ple=({project:e,onChange:t,metrics:r,onNavigateToStacking:n})=>{const[a,i]=H.useState(null),[s,o]=H.useState(null),[c,u]=H.useState(!0),{adjacencyStats:f}=r,d=H.useMemo(()=>{const p=m=>e.floors.findIndex(g=>g.id===m);return[...e.departments].sort((m,g)=>{const y=p(m.pinnedFloor),v=p(g.pinnedFloor);return y!==v?(y===-1?99:y)-(v===-1?99:v):g.headcount-m.headcount})},[e]),h=(p,m)=>{o(p.id),u(!0)};return l.jsxs("div",{className:"flex h-full bg-slate-100 overflow-hidden relative",children:[l.jsxs("div",{className:`transition-all duration-300 ease-in-out bg-white border-r border-slate-200 z-20 flex-shrink-0 flex flex-col absolute md:relative h-full ${c?"w-80 translate-x-0":"w-0 -translate-x-full md:translate-x-0 md:w-0"}`,children:[l.jsx("div",{className:"flex-grow overflow-hidden w-80",children:l.jsx(Ale,{project:e,onChange:t,selectedDeptId:s,onSelectDept:o})}),l.jsx("button",{onClick:()=>u(!c),className:"absolute top-1/2 -right-8 bg-white border border-l-0 border-slate-200 p-1.5 rounded-r-lg shadow-sm text-slate-500 hover:text-indigo-600 z-30",title:c?"Collapse Panel":"Expand Panel",children:c?l.jsx(WT,{className:"w-4 h-4"}):l.jsx(Pr,{className:"w-4 h-4"})})]}),!c&&l.jsx("button",{onClick:()=>u(!0),className:"absolute top-4 left-4 bg-white p-2 rounded-lg shadow border border-slate-200 z-10 text-slate-600 hover:text-indigo-600",children:l.jsx(Hp,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-grow flex flex-col h-full overflow-hidden",children:[l.jsxs("div",{className:"bg-white p-4 border-b border-slate-200 shadow-sm flex justify-between items-center flex-shrink-0 z-10",children:[l.jsxs("div",{className:"ml-10 md:ml-0",children:[" ",l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(sh,{className:"w-5 h-5 text-orange-500"})," Team Adjacency Model"]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Define departmental flows to optimize stacking."})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"hidden sm:flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-100 text-xs text-slate-500",children:[l.jsx(t0,{className:"w-3 h-3 text-slate-400"}),l.jsx("span",{children:"Hover diagram to trace flows"})]}),l.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold shadow-sm transition-colors",children:["Go to Stacking ",l.jsx(zp,{className:"w-3 h-3"})]})]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-4 md:p-8 bg-slate-50/50",children:l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 h-full min-h-[600px]",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(RT,{className:"w-4 h-4 text-slate-400"})," Interaction Matrix"]}),l.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"Click cell to edit flow"})]}),l.jsx("div",{className:"flex-grow relative",children:l.jsx(Ole,{matrix:f.matrix,onCellClick:h,hoveredLink:a,onHoverLink:i,sortedDepts:d})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(sh,{className:"w-4 h-4 text-slate-400"})," Flow Network"]}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-300"})," Floor Ring"]})})]}),l.jsx("div",{className:"flex-grow relative flex items-center justify-center bg-white",children:l.jsx(Cle,{sortedDepts:d,pairs:f.allPairs,onHoverLink:i,hoveredLink:a,project:e})})]})]})})]})]})},ig=({label:e,score:t,max:r,unit:n,inverse:a=!1,warning:i})=>{const s=Math.min(t/r*100,100),o=a?s<95:s>80,c=i?"text-amber-500":o?"text-emerald-600":"text-rose-600",u=i?"bg-amber-500":o?"bg-emerald-500":"bg-rose-500";return l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:e}),i?l.jsx(ur,{className:"w-4 h-4 text-amber-500"}):l.jsx(uc,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:`text-2xl font-bold ${c}`,children:[t.toLocaleString()," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:["/ ",r.toLocaleString()," ",n]})]}),l.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full mt-2 overflow-hidden",children:l.jsx("div",{className:`h-full ${u} transition-all duration-500`,style:{width:`${s}%`}})})]})]})},Mle=({metrics:e,project:t})=>{const r=e.totalUsedArea/t.calculatedNia*100,n=e.adjacencyStats.stressScore;let a=100;r>100&&(a-=(r-100)*2),e.effectiveDeskRatio>1.8&&(a-=10),e.derivedMeetingRatio>25&&(a-=10),n>20&&(a-=(n-20)*.5),a=Math.max(0,Math.min(100,a));const i=a>85?"Excellent Fit":a>70?"Manageable with Compromise":"High Risk / Not Feasible",s=a>85?"bg-emerald-100 text-emerald-700":a>70?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700";return l.jsxs("div",{className:"flex flex-col h-full gap-6 max-w-5xl mx-auto w-full",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Spatial Stress Analysis"}),l.jsx("p",{className:"text-slate-500",children:"Automated assessment of project constraints vs strategic demand."})]}),l.jsxs("div",{className:`px-6 py-4 rounded-xl text-center ${s}`,children:[l.jsxs("div",{className:"text-3xl font-bold",children:[a.toFixed(0),"/100"]}),l.jsx("div",{className:"text-xs font-bold uppercase tracking-wide mt-1",children:i})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(ig,{label:"Space Utilization Index",score:Math.round(e.totalUsedArea),max:Math.round(t.calculatedNia),unit:t.unit.toUpperCase(),inverse:!0,warning:r>95&&r<=100}),l.jsx(ig,{label:"Operational Stress Index",score:Math.round(n),max:100,unit:"Score",inverse:!0}),l.jsx(ig,{label:"Headcount",score:e.totalHeadcountWithGrowth,max:t.headcount,unit:"ppl",inverse:!0}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Density"}),l.jsx(Kp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:[e.density.toFixed(1)," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:[t.unit.toUpperCase(),"/p"]})]}),l.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Target: 8.0 - 12.0"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex-grow",children:[l.jsx("h3",{className:"text-sm font-bold text-slate-800 uppercase mb-4",children:"Strategic Stress Factors"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-4",children:[{label:"Circulation & Flow",val:e.areaCirculation,max:e.totalUsedArea*.35,desc:"Circulation ratio check."},{label:"Meeting Capacity",val:20,max:e.derivedMeetingRatio,desc:"Meeting capacity verification.",inverse:!0},{label:"Sharing Strategy Alignment",val:e.effectiveDeskRatio,max:1.5,desc:"Evaluates cultural readiness for shared desks."}].map((o,c)=>{const u=c===0?"Good":c===1?"Tight":"Aggressive",f=u==="Good"?"text-emerald-600":"text-amber-600";return l.jsxs("div",{className:"flex items-center p-3 bg-slate-50 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"p-2 bg-white rounded-md shadow-sm mr-4",children:c===0?l.jsx(IT,{className:"w-5 h-5 text-indigo-500"}):l.jsx(Fr,{className:"w-5 h-5 text-indigo-500"})}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("div",{className:"text-sm font-bold text-slate-700",children:o.label}),l.jsx("div",{className:"text-xs text-slate-500",children:o.desc})]}),l.jsx("div",{className:`text-right font-bold text-sm ${f}`,children:u})]},c)})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[l.jsx(xs,{className:"w-4 h-4 text-indigo-500"}),l.jsx("h4",{className:"text-sm font-bold text-slate-800",children:"Top Friction Drivers"}),l.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:"Impact Score (0-100)"})]}),l.jsx("div",{className:"space-y-2",children:e.adjacencyStats.topFrictionPairs.length>0?e.adjacencyStats.topFrictionPairs.slice(0,5).map((o,c)=>l.jsxs("div",{className:"flex justify-between items-center p-2 rounded hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:o.dept1.color}}),o.dept1.name," + ",o.dept2.name]}),l.jsx("div",{className:"text-[10px] text-amber-600 font-medium",children:"Split across floors"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Str: ",(o.score/2).toFixed(0)]}),l.jsx("div",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded text-xs font-bold w-12 text-center",children:o.friction.toFixed(0)})]})]},c)):l.jsxs("div",{className:"text-xs text-slate-500 italic flex items-center gap-2 p-4 bg-emerald-50 rounded border border-emerald-100",children:[l.jsx(fa,{className:"w-4 h-4 text-emerald-500"}),"No significant adjacency friction detected."]})})]})]})]})]})},od=[{id:"overview",label:"Strategic Overview",icon:hs,defaultFormats:["pdf","pptx"]},{id:"comparison",label:"Scenario Comparison",icon:o8,defaultFormats:["pdf","xlsx"]},{id:"program",label:"Program Structure",icon:b8,defaultFormats:["xlsx"]},{id:"stacking",label:"Floor & Space Details",icon:Mr,defaultFormats:["xlsx","csv"]},{id:"analysis",label:"Analysis & Validation",icon:Rn,defaultFormats:["pdf"]}],ld={client:{sections:{overview:!0,comparison:!0,program:!1,stacking:!1,analysis:!0},formats:{overview:["pdf"],comparison:["pdf","pptx"],program:[],stacking:[],analysis:["pdf"]}},designer:{sections:{overview:!1,comparison:!1,program:!0,stacking:!0,analysis:!1},formats:{overview:[],comparison:[],program:["xlsx"],stacking:["xlsx","csv"],analysis:[]}},internal:{sections:{overview:!0,comparison:!0,program:!0,stacking:!0,analysis:!0},formats:{overview:["pdf"],comparison:["xlsx"],program:["xlsx"],stacking:["xlsx"],analysis:["pdf"]}},custom:{sections:{overview:!1,comparison:!1,program:!1,stacking:!1,analysis:!1},formats:{overview:[],comparison:[],program:[],stacking:[],analysis:[]}}},WC=({isOpen:e,onClose:t,scenarios:r,activeScenarioId:n,project:a,initialPreset:i})=>{const[s,o]=H.useState(1),[c,u]=H.useState(!1),[f,d]=H.useState(!1),[h,p]=H.useState({preset:"custom",selectedScenarios:[n],sections:{...ld.custom.sections},formats:{...ld.custom.formats}});if(H.useEffect(()=>{if(e){o(1),d(!1),u(!1);const N=ld[i];p({preset:i,selectedScenarios:i==="internal"?r.map(j=>j.id):[n],sections:{...N.sections},formats:{...N.formats}}),i!=="custom"&&o(2)}},[e,i,n,r]),!e)return null;const m=N=>{const j=ld[N];p(E=>({...E,preset:N,selectedScenarios:N==="internal"?r.map(A=>A.id):[n],sections:{...j.sections},formats:{...j.formats}})),o(2)},g=N=>{p(j=>{const E=j.selectedScenarios,A=E.includes(N);return{...j,selectedScenarios:A?E.filter(T=>T!==N):[...E,N]}})},y=N=>{p(j=>{var T;const E=j.sections[N];let A=j.formats[N];return!E&&(!A||A.length===0)&&(A=[...((T=od.find(G=>G.id===N))==null?void 0:T.defaultFormats)||[]]),{...j,sections:{...j.sections,[N]:!E},formats:{...j.formats,[N]:A}}})},v=(N,j)=>{p(E=>{const A=E.formats[N]||[],F=A.includes(j)?A.filter(G=>G!==j):[...A,j];return{...E,formats:{...E.formats,[N]:F}}})},b=()=>{const N=r.filter(j=>h.selectedScenarios.includes(j.id)).map(j=>{var G,M;const E=Math.ceil(a.headcount*(1+j.growthBuffer/100)),A=((G=j.workpoints)==null?void 0:G.fixed)||0,T=((M=j.workpoints)==null?void 0:M.alternative)||0,F=A+T;return{Scenario:j.name,TotalHeadcount:E,FixedWorkstations:A,AlternativeWorkpoints:T,TotalWorkpoints:F,EnclosedOffices:j.enclosedOfficeCount,Ratio:(F>0?E/F:0).toFixed(2),DeltaVsHeadcount:F-E,Timestamp:new Date().toISOString()}});return console.log("Generating Export with Workpoint Columns:",N),N},x=()=>{u(!0),b(),setTimeout(()=>{u(!1),d(!0),setTimeout(()=>{d(!1),t()},2e3)},2e3)},_=()=>l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Select Export Purpose"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Choose a recommended package or build your own."})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"client",label:"Client Presentation",icon:hs,desc:"High-level insights & charts."},{id:"designer",label:"Designer Handoff",icon:Rn,desc:"Detailed spatial data."},{id:"internal",label:"Internal Record",icon:e0,desc:"Full project archive."},{id:"custom",label:"Custom Build",icon:r0,desc:"Manual selection."}].map(N=>l.jsxs("button",{onClick:()=>m(N.id),className:`p-4 rounded-xl border-2 text-left hover:border-indigo-400 transition-all group ${h.preset===N.id?"border-indigo-600 bg-indigo-50":"border-slate-200 bg-white"}`,children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:`p-2 rounded-lg ${h.preset===N.id?"bg-indigo-600 text-white":"bg-slate-100 text-slate-500 group-hover:bg-indigo-100 group-hover:text-indigo-600"}`,children:l.jsx(N.icon,{className:"w-5 h-5"})}),l.jsx("span",{className:`font-bold ${h.preset===N.id?"text-indigo-900":"text-slate-700"}`,children:N.label})]}),l.jsx("p",{className:"text-xs text-slate-500 ml-12",children:N.desc})]},N.id))})]}),w=()=>l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 h-full",children:[l.jsxs("div",{className:"md:col-span-4 border-r border-slate-100 pr-4",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-3",children:"Include Scenarios"}),l.jsx("div",{className:"space-y-2",children:r.map(N=>{const j=h.selectedScenarios.includes(N.id);return l.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${j?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200 hover:bg-slate-50"}`,children:[l.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center border ${j?"bg-indigo-600 border-indigo-600 text-white":"border-slate-300 bg-white"}`,children:j&&l.jsx(Cn,{className:"w-3 h-3"})}),l.jsx("input",{type:"checkbox",className:"hidden",checked:j,onChange:()=>g(N.id)}),l.jsxs("div",{children:[l.jsx("div",{className:`text-sm font-bold ${j?"text-indigo-900":"text-slate-700"}`,children:N.name}),N.id===n&&l.jsx("div",{className:"text-[10px] text-indigo-500 font-medium",children:"Active Strategy"})]})]},N.id)})})]}),l.jsxs("div",{className:"md:col-span-8",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide mb-3",children:"Select Content Sections"}),l.jsx("div",{className:"space-y-3",children:od.map(N=>{const j=h.sections[N.id];return l.jsx("div",{className:`p-3 rounded-xl border transition-all ${j?"border-indigo-600 shadow-sm":"border-slate-200 opacity-80 hover:opacity-100"}`,children:l.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>y(N.id),children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`p-2 rounded-lg ${j?"bg-indigo-100 text-indigo-700":"bg-slate-100 text-slate-400"}`,children:l.jsx(N.icon,{className:"w-4 h-4"})}),l.jsx("span",{className:`text-sm font-bold ${j?"text-slate-800":"text-slate-500"}`,children:N.label})]}),l.jsx("div",{className:`w-10 h-6 rounded-full p-1 transition-colors ${j?"bg-indigo-600":"bg-slate-200"}`,children:l.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-sm transition-transform ${j?"translate-x-4":""}`})})]})},N.id)})})]})]}),S=()=>l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Output Formats"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Select file types for each content section."})]}),l.jsxs("div",{className:"space-y-4",children:[od.filter(N=>h.sections[N.id]).map(N=>l.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-slate-200 rounded-xl shadow-sm",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-slate-100 rounded-lg text-slate-600",children:l.jsx(N.icon,{className:"w-4 h-4"})}),l.jsx("span",{className:"text-sm font-bold text-slate-800",children:N.label})]}),l.jsx("div",{className:"flex gap-2",children:["pdf","xlsx","csv","pptx","png"].map(j=>{var F;const E=j,A=(F=h.formats[N.id])==null?void 0:F.includes(E),T=E==="xlsx"||E==="csv"?qy:E==="pptx"?J8:E==="png"?k8:hc;return l.jsxs("button",{onClick:()=>v(N.id,E),className:`px-3 py-1.5 rounded-md text-xs font-bold border flex items-center gap-1.5 transition-colors ${A?"bg-indigo-600 text-white border-indigo-600":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}`,children:[A&&l.jsx(Cn,{className:"w-3 h-3"}),l.jsx(T,{className:"w-3 h-3"}),j.toUpperCase()]},j)})})]},N.id)),Object.values(h.sections).every(N=>!N)&&l.jsx("div",{className:"text-center p-8 text-slate-400 border-2 border-dashed border-slate-200 rounded-xl",children:"No content sections selected. Go back to select content."})]})]}),k=()=>{var j;const N=Object.keys(h.sections).filter(E=>h.sections[E]).reduce((E,A)=>{var T;return E+(((T=h.formats[A])==null?void 0:T.length)||0)},0);return l.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-8 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-indigo-50 rounded-full flex items-center justify-center mb-6 animate-pulse",children:l.jsx(ra,{className:"w-8 h-8 text-indigo-600"})}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Ready to Generate"}),l.jsxs("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:["You are about to generate a ",l.jsx("strong",{children:h.preset==="custom"?"Custom":h.preset.charAt(0).toUpperCase()+h.preset.slice(1)})," package containing ",l.jsxs("strong",{children:[N," files"]})," across ",h.selectedScenarios.length," scenarios."]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200 w-full max-w-md text-left text-xs text-slate-600 space-y-2 mb-8",children:[l.jsxs("div",{className:"flex justify-between border-b border-slate-200 pb-2",children:[l.jsx("span",{className:"font-bold",children:"Included Scenarios:"}),l.jsx("span",{children:h.selectedScenarios.length})]}),od.filter(E=>h.sections[E.id]).map(E=>{var A;return l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:E.label}),l.jsx("span",{className:"font-mono text-slate-400",children:(A=h.formats[E.id])==null?void 0:A.map(T=>T.toUpperCase()).join(", ")})]},E.id)}),((j=h.formats.stacking)==null?void 0:j.includes("csv"))&&l.jsxs("div",{className:"mt-2 pt-2 border-t border-slate-200 text-indigo-600 font-bold flex items-center gap-1",children:[l.jsx(Cn,{className:"w-3 h-3"})," Includes Fixed/Alternative counts"]})]}),l.jsxs("button",{onClick:x,disabled:c||f||N===0,className:`flex items-center gap-2 px-8 py-3 rounded-xl text-base font-bold text-white transition-all shadow-lg transform active:scale-95 ${f?"bg-emerald-500 hover:bg-emerald-600":c?"bg-indigo-400 cursor-wait":"bg-indigo-600 hover:bg-indigo-700 hover:shadow-indigo-200"}`,children:[c?"Generating Files...":f?"Download Complete!":"Generate Package",f?l.jsx(Cn,{className:"w-5 h-5"}):!c&&l.jsx(ra,{className:"w-5 h-5"})]})]})};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/50 backdrop-blur-sm animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl overflow-hidden flex flex-col h-[90vh]",children:[l.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50 flex-shrink-0",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(ra,{className:"w-5 h-5 text-indigo-600"}),"Export Builder"]}),l.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Configure your data package."})]}),l.jsx("button",{onClick:t,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-200 rounded-full transition",children:l.jsx(on,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"flex items-center justify-center py-4 bg-white border-b border-slate-100 flex-shrink-0",children:[1,2,3,4].map((N,j)=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-colors ${s>=N?"bg-indigo-600 text-white":"bg-slate-100 text-slate-400"}`,children:N}),j<3&&l.jsx("div",{className:`w-12 h-0.5 mx-2 ${s>N?"bg-indigo-600":"bg-slate-200"}`})]},N))}),l.jsxs("div",{className:"flex-grow p-8 overflow-y-auto bg-slate-50/30",children:[s===1&&_(),s===2&&w(),s===3&&S(),s===4&&k()]}),l.jsxs("div",{className:"p-6 border-t border-slate-100 bg-white flex justify-between items-center flex-shrink-0",children:[s>1?l.jsxs("button",{onClick:()=>o(s-1),className:"px-5 py-2 text-sm font-bold text-slate-600 hover:text-slate-800 flex items-center gap-2",children:[l.jsx(MT,{className:"w-4 h-4"})," Back"]}):l.jsx("button",{onClick:t,className:"px-5 py-2 text-sm font-bold text-slate-400 hover:text-slate-600",children:"Cancel"}),s<4?l.jsxs("button",{onClick:()=>o(s+1),className:"flex items-center gap-2 px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-bold shadow-md transition-all",children:["Next Step ",l.jsx(Pr,{className:"w-4 h-4"})]}):l.jsx("div",{})]})]})})},Fle=({project:e,scenarios:t,activeScenarioId:r})=>{const n=t.find(f=>f.id===r),[a,i]=H.useState(!1),[s,o]=H.useState("custom"),c=f=>{o(f),i(!0)},u=({preset:f,title:d,desc:h,icon:p,color:m,items:g,isCustom:y=!1})=>l.jsxs("div",{className:`relative bg-white p-6 rounded-xl border transition-all flex flex-col h-full group ${y?"border-dashed border-slate-300 hover:border-indigo-400":"border-slate-200 shadow-sm hover:shadow-md"}`,children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110 ${m}`,children:l.jsx(p,{className:`w-6 h-6 ${y?"text-indigo-600":"text-white"}`})}),l.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:d}),l.jsx("p",{className:"text-sm text-slate-500 mb-6 flex-grow",children:h}),l.jsx("ul",{className:"space-y-2 mb-6",children:g.map((v,b)=>l.jsxs("li",{className:"flex items-center gap-2 text-xs text-slate-600",children:[l.jsx(Cn,{className:`w-3 h-3 ${y?"text-slate-400":"text-emerald-500"}`})," ",v]},b))}),l.jsxs("button",{onClick:()=>c(f),className:`w-full py-2.5 rounded-lg border font-bold text-sm flex items-center justify-center gap-2 transition-colors ${y?"border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,children:[y?l.jsx(r0,{className:"w-4 h-4"}):l.jsx(ra,{className:"w-4 h-4"}),y?"Open Builder":"Download Package"]})]});return l.jsxs("div",{className:"max-w-6xl mx-auto w-full h-full flex flex-col p-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Project Exports"}),l.jsx("p",{className:"text-slate-500 mt-1",children:"Generate documentation packages for different stakeholders."}),l.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-full border border-indigo-100",children:["Active Scenario: ",n==null?void 0:n.name]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(u,{preset:"client",title:"Client Presentation",desc:"Executive summary with transparent charts, strategic metrics, and comparisons.",icon:hs,color:"bg-indigo-600",items:["PDF Report","High-level KPIs","Strategic Insights"]}),l.jsx(u,{preset:"designer",title:"Designer Handoff",desc:"Technical data package for architectural teams to begin test fitting.",icon:Rn,color:"bg-pink-600",items:["Excel / CSV","Stacking Matrices","Room Quantities"]}),l.jsx(u,{preset:"internal",title:"Internal Record",desc:"Complete project dump containing all assumptions and metadata.",icon:e0,color:"bg-emerald-600",items:["Excel Workbook","All Scenarios","Full Audit Log"]}),l.jsx(u,{preset:"custom",title:"Custom Builder",desc:"Build a specific export package by selecting content and formats manually.",icon:Za,color:"bg-indigo-50",items:["Select Content","Choose Formats","Multi-Scenario"],isCustom:!0})]}),l.jsx(WC,{isOpen:a,onClose:()=>i(!1),initialPreset:s,scenarios:t,activeScenarioId:r,project:e})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var fp={};fp.version="0.18.5";var HC=1252,Dle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],aw={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},iw=function(e){Dle.indexOf(e)!=-1&&(HC=aw[0]=e)};function Ile(){iw(1252)}var ja=function(e){iw(e)};function sw(){ja(1200),Ile()}function sj(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Rle(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var lu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Rle(e.slice(2)):t==254&&r==255?VC(e.slice(2)):t==65279?e.slice(1):e},cd=function(t){return String.fromCharCode(t)},oj=function(t){return String.fromCharCode(t)},Df,Xi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function If(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Xi.charAt(i)+Xi.charAt(s)+Xi.charAt(o)+Xi.charAt(c);return t}function $n(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Xi.indexOf(e.charAt(u++)),s=Xi.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Xi.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Xi.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Ve=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Mi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ss(e){return Ve?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function lj(e){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Tn=function(t){return Ve?Mi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Vx(e){if(typeof ArrayBuffer>"u")return Tn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ss(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function $le(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ow(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ow(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var yr=Ve?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Mi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Lle(e){for(var t=[],r=0,n=e.length+250,a=ss(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ss(65535),n=65530)}return t.push(a.slice(0,r)),yr(t)}var sn=/\u0000/g,cu=/[\u0001-\u0006]/g;function Sl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ea(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}function lw(e,t){var r=""+e;return r.length>=t?r:Lt(" ",t-r.length)+r}function dp(e,t){var r=""+e;return r.length>=t?r:r+Lt(" ",t-r.length)}function Ble(e,t){var r=""+Math.round(e);return r.length>=t?r:Lt("0",t-r.length)+r}function Ule(e,t){var r=""+e;return r.length>=t?r:Lt("0",t-r.length)+r}var cj=Math.pow(2,32);function Uo(e,t){if(e>cj||e<-cj)return Ble(e,t);var r=Math.round(e);return Ule(r,t)}function hp(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var uj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zle(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},fj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Wle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pp(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*s+i,f=d*u+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=i):(f=u,o=s)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Ks(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=qle(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var GC=new Date(1899,11,31,0,0,0),Hle=GC.getTime(),Vle=new Date(1900,2,1,0,0,0);function XC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Vle&&(r+=24*60*60*1e3),(r-(Hle+(e.getTimezoneOffset()-GC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function cw(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gle(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xle(e){var t=e<0?12:11,r=cw(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Kle(e){var t=cw(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Rf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Xle(e):t===10?r=e.toFixed(10).substr(0,12):r=Kle(e),cw(Gle(r.toUpperCase()))}function xo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Rf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ua(14,XC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function qle(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Yle(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return sg[r.m-1][1];case 5:return sg[r.m-1][0];default:return sg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return uj[r.q][0];default:return uj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ea(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ea(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?Ea(c,u):"";return f}function Ki(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var KC=/%/g;function Qle(e,t,r){var n=t.replace(KC,""),a=t.length-n.length;return gi(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function Zle(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return gi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qC(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var YC=/# (\?+)( ?)\/( ?)(\d+)/;function Jle(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Lt(" ",e[1].length+1+e[4].length):lw(s,e[1].length)+e[2]+"/"+e[3]+Ea(o,e[4].length))}function ece(e,t,r){return r+(t===0?"":""+t)+Lt(" ",e[1].length+2+e[4].length)}var QC=/^#*0*\.([0#]+)/,ZC=/\).*[0#]/,JC=/\(###\) ###\\?-####/;function Jr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function dj(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function hj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function tce(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function rce(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vn("n",n,r):"("+Vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zle(e,t,r);if(t.indexOf("%")!==-1)return Qle(e,t,r);if(t.indexOf("E")!==-1)return qC(t,r);if(t.charCodeAt(0)===36)return"$"+Vn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Uo(c,t.length);if(t.match(/^[#?]+$/))return a=Uo(r,0),a==="0"&&(a=""),a.length>t.length?a:Jr(t.substr(0,t.length-a.length))+a;if(i=t.match(YC))return Jle(i,c,u);if(t.match(/^#+0+$/))return u+Uo(c,t.length-t.indexOf("0"));if(i=t.match(QC))return a=dj(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Jr(i[1])).replace(/\.$/,"."+Jr(i[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+Lt("0",Jr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+dj(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ki(Uo(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vn(e,t,-r):Ki(""+(Math.floor(r)+tce(r,i[1].length)))+"."+Ea(hj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Vn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Sl(Vn(e,t.replace(/[\\-]/g,""),r)),s=0,Sl(Sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(JC))return a=Vn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=pp(c,Math.pow(10,s)-1,!1),a=""+u,f=gi("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=dp(o[2],s),f.length<i[4].length&&(f=Jr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=pp(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lw(o[1],s)+i[2]+"/"+i[3]+dp(o[2],s):Lt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Uo(r,0),t.length<=a.length?a:Jr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Jr(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=hj(r,i[1].length),r<0?"-"+Vn(e,t,-r):Ki(rce(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ea(0,3-m.length):"")+m})+"."+Ea(s,i[1].length);switch(t){case"###,##0.00":return Vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ki(Uo(c,0));return p!=="0"?u+p:"";case"###,###.00":return Vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function nce(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return gi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ace(e,t,r){var n=t.replace(KC,""),a=t.length-n.length;return gi(e,n,r*Math.pow(10,2*a))+Lt("%",a)}function eP(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+eP(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function La(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?La("n",n,r):"("+La("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return nce(e,t,r);if(t.indexOf("%")!==-1)return ace(e,t,r);if(t.indexOf("E")!==-1)return eP(t,r);if(t.charCodeAt(0)===36)return"$"+La(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ea(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Jr(t.substr(0,t.length-a.length))+a;if(i=t.match(YC))return ece(i,c,u);if(t.match(/^#+0+$/))return u+Ea(c,t.length-t.indexOf("0"));if(i=t.match(QC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Jr(i[1])).replace(/\.$/,"."+Jr(i[1])),a=a.replace(/\.(\d*)$/,function(m,g){return"."+g+Lt("0",Jr(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ki(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+La(e,t,-r):Ki(""+r)+"."+Lt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return La(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Sl(La(e,t.replace(/[\\-]/g,""),r)),s=0,Sl(Sl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return s<a.length?a.charAt(s++):m==="0"?"0":""}));if(t.match(JC))return a=La(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=pp(c,Math.pow(10,s)-1,!1),a=""+u,f=gi("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=dp(o[2],s),f.length<i[4].length&&(f=Jr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=pp(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lw(o[1],s)+i[2]+"/"+i[3]+dp(o[2],s):Lt(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Jr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Jr(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+La(e,t,-r):Ki(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ea(0,3-m.length):"")+m})+"."+Ea(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Ki(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return La(e,t.slice(0,t.lastIndexOf(".")),r)+Jr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function gi(e,t,r){return(r|0)===r?La(e,t,r):Vn(e,t,r)}function ice(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var tP=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ec(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":hp(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(tP))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function sce(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,f,d,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!hp(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),m=p==="("||p===")"?p:"t";a[a.length]={t:m,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Ks(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ks(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=Ks(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",s+=5,h="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(tP)){if(u==null&&(u=Ks(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ec(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,v=0,b;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",y<1&&(y=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",_;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Yle(a[s].t.charCodeAt(0),a[s].v,u,v),a[s].t="t";break;case"n":case"?":for(_=s+1;a[_]!=null&&((o=a[_].t)==="?"||o==="D"||(o===" "||o==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[s].v+=a[_].v,a[_]={v:"",t:";"},++_;x+=a[s].v,s=_-1;break;case"G":a[s].t="t",a[s].v=xo(t,r);break}var w="",S,k;if(x.length>0){x.charCodeAt(0)==40?(S=t<0&&x.charCodeAt(0)===45?-t:t,k=gi("n",x,S)):(S=t<0&&n>1?-t:t,k=gi("n",x,S),S<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),_=k.length-1;var N=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){N=s;break}var j=a.length;if(N===a.length&&k.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(_>=a[s].v.length-1?(_-=a[s].v.length,a[s].v=k.substr(_+1,a[s].v.length)):_<0?a[s].v="":(a[s].v=k.substr(0,_+1),_=-1),a[s].t="t",j=s);_>=0&&j<a.length&&(a[j].v=k.substr(0,_+1)+a[j].v)}else if(N!==a.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,s=N;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")-1:a[s].v.length-1,w=a[s].v.substr(f+1);f>=0;--f)_>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(w=k.charAt(_--)+w);a[s].v=w,a[s].t="t",j=s}for(_>=0&&j<a.length&&(a[j].v=k.substr(0,_+1)+a[j].v),_=k.indexOf(".")+1,s=N;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==N)){for(f=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")+1:0,w=a[s].v.substr(0,f);f<a[s].v.length;++f)_<k.length&&(w+=k.charAt(_++));a[s].v=w,a[s].t="t",j=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(S=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=gi(a[s].t,a[s].v,S),a[s].t="t");var E="";for(s=0;s!==a.length;++s)a[s]!=null&&(E+=a[s].v);return E}var pj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function oce(e,t){var r=ice(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(pj),o=r[1].match(pj);return xj(t,s)?[n,r[0]]:xj(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function ua(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Me)[e],n==null&&(n=r.table&&r.table[fj[e]]||Me[fj[e]]),n==null&&(n=Wle[e]||"General");break}if(hp(n,0))return xo(t,r);t instanceof Date&&(t=XC(t,r.date1904));var a=oce(n,t);if(hp(a[1]))return xo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return sce(a[1],t,r,a[0])}function vi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Me[r]==null){t<0&&(t=r);continue}if(Me[r]==e){t=r;break}}t<0&&(t=391)}return Me[t]=e,t}function Gx(e){for(var t=0;t!=392;++t)e[t]!==void 0&&vi(e[t],t)}function Tc(){Me=zle()}var lce={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rP=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cce(e){var t=typeof e=="number"?Me[e]:e;return t=t.replace(rP,"(\\d+)"),new RegExp("^"+t+"$")}function uce(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(rP)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?o=p:a=p;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?f:u+"T"+f}var fce=function(){var e={};e.version="1.2.0";function t(){for(var k=0,N=new Array(256),j=0;j!=256;++j)k=j,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,N[j]=k;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(k){var N=0,j=0,E=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)A[E]=k[E];for(E=0;E!=256;++E)for(j=k[E],N=256+E;N<4096;N+=256)j=A[N]=j>>>8^k[j&255];var T=[];for(E=1;E!=16;++E)T[E-1]=typeof Int32Array<"u"?A.subarray(E*256,E*256+256):A.slice(E*256,E*256+256);return T}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],f=a[5],d=a[6],h=a[7],p=a[8],m=a[9],g=a[10],y=a[11],v=a[12],b=a[13],x=a[14];function _(k,N){for(var j=N^-1,E=0,A=k.length;E<A;)j=j>>>8^r[(j^k.charCodeAt(E++))&255];return~j}function w(k,N){for(var j=N^-1,E=k.length-15,A=0;A<E;)j=x[k[A++]^j&255]^b[k[A++]^j>>8&255]^v[k[A++]^j>>16&255]^y[k[A++]^j>>>24]^g[k[A++]]^m[k[A++]]^p[k[A++]]^h[k[A++]]^d[k[A++]]^f[k[A++]]^u[k[A++]]^c[k[A++]]^o[k[A++]]^s[k[A++]]^i[k[A++]]^r[k[A++]];for(E+=15;A<E;)j=j>>>8^r[(j^k[A++])&255];return~j}function S(k,N){for(var j=N^-1,E=0,A=k.length,T=0,F=0;E<A;)T=k.charCodeAt(E++),T<128?j=j>>>8^r[(j^T)&255]:T<2048?(j=j>>>8^r[(j^(192|T>>6&31))&255],j=j>>>8^r[(j^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,F=k.charCodeAt(E++)&1023,j=j>>>8^r[(j^(240|T>>8&7))&255],j=j>>>8^r[(j^(128|T>>2&63))&255],j=j>>>8^r[(j^(128|F>>6&15|(T&3)<<4))&255],j=j>>>8^r[(j^(128|F&63))&255]):(j=j>>>8^r[(j^(224|T>>12&15))&255],j=j>>>8^r[(j^(128|T>>6&63))&255],j=j>>>8^r[(j^(128|T&63))&255]);return~j}return e.table=r,e.bstr=_,e.buf=w,e.str=S,e}(),Oe=function(){var t={};t.version="1.2.1";function r(C,U){for(var I=C.split("/"),B=U.split("/"),z=0,V=0,ne=Math.min(I.length,B.length);z<ne;++z){if(V=I[z].length-B[z].length)return V;if(I[z]!=B[z])return I[z]<B[z]?-1:1}return I.length-B.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(0,U+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var U=C.lastIndexOf("/");return U===-1?C:C.slice(U+1)}function i(C,U){typeof U=="string"&&(U=new Date(U));var I=U.getHours();I=I<<6|U.getMinutes(),I=I<<5|U.getSeconds()>>>1,C.write_shift(2,I);var B=U.getFullYear()-1980;B=B<<4|U.getMonth()+1,B=B<<5|U.getDate(),C.write_shift(2,B)}function s(C){var U=C.read_shift(2)&65535,I=C.read_shift(2)&65535,B=new Date,z=I&31;I>>>=5;var V=I&15;I>>>=4,B.setMilliseconds(0),B.setFullYear(I+1980),B.setMonth(V-1),B.setDate(z);var ne=U&31;U>>>=5;var ue=U&63;return U>>>=6,B.setHours(U),B.setMinutes(ue),B.setSeconds(ne<<1),B}function o(C){Tr(C,0);for(var U={},I=0;C.l<=C.length-4;){var B=C.read_shift(2),z=C.read_shift(2),V=C.l+z,ne={};switch(B){case 21589:I=C.read_shift(1),I&1&&(ne.mtime=C.read_shift(4)),z>5&&(I&2&&(ne.atime=C.read_shift(4)),I&4&&(ne.ctime=C.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}C.l=V,U[B]=ne}return U}var c;function u(){return c||(c={})}function f(C,U){if(C[0]==80&&C[1]==75)return Xw(C,U);if((C[0]|32)==109&&(C[1]|32)==105)return x6(C,U);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var I=3,B=512,z=0,V=0,ne=0,ue=0,re=0,ae=[],ie=C.slice(0,512);Tr(ie,0);var pe=d(ie);switch(I=pe[0],I){case 3:B=512;break;case 4:B=4096;break;case 0:if(pe[1]==0)return Xw(C,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}B!==512&&(ie=C.slice(0,B),Tr(ie,28));var we=C.slice(0,B);h(ie,I);var _e=ie.read_shift(4,"i");if(I===3&&_e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+_e);ie.l+=4,ne=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),ue=ie.read_shift(4,"i"),z=ie.read_shift(4,"i"),re=ie.read_shift(4,"i"),V=ie.read_shift(4,"i");for(var me=-1,Se=0;Se<109&&(me=ie.read_shift(4,"i"),!(me<0));++Se)ae[Se]=me;var Le=p(C,B);y(re,V,Le,B,ae);var At=b(Le,ne,ae,B);At[ne].name="!Directory",z>0&&ue!==F&&(At[ue].name="!MiniFAT"),At[ae[0]].name="!FAT",At.fat_addrs=ae,At.ssz=B;var Ot={},Ir=[],Cc=[],Pc=[];x(ne,At,Le,Ir,z,Ot,Cc,ue),m(Cc,Pc,Ir),Ir.shift();var Mc={FileIndex:Cc,FullPaths:Pc};return U&&U.raw&&(Mc.raw={header:we,sectors:Le}),Mc}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(G,"Header Signature: "),C.l+=16;var U=C.read_shift(2,"u");return[C.read_shift(2,"u"),U]}function h(C,U){var I=9;switch(C.l+=2,I=C.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,U){for(var I=Math.ceil(C.length/U)-1,B=[],z=1;z<I;++z)B[z-1]=C.slice(z*U,(z+1)*U);return B[I-1]=C.slice(I*U),B}function m(C,U,I){for(var B=0,z=0,V=0,ne=0,ue=0,re=I.length,ae=[],ie=[];B<re;++B)ae[B]=ie[B]=B,U[B]=I[B];for(;ue<ie.length;++ue)B=ie[ue],z=C[B].L,V=C[B].R,ne=C[B].C,ae[B]===B&&(z!==-1&&ae[z]!==z&&(ae[B]=ae[z]),V!==-1&&ae[V]!==V&&(ae[B]=ae[V])),ne!==-1&&(ae[ne]=B),z!==-1&&B!=ae[B]&&(ae[z]=ae[B],ie.lastIndexOf(z)<ue&&ie.push(z)),V!==-1&&B!=ae[B]&&(ae[V]=ae[B],ie.lastIndexOf(V)<ue&&ie.push(V));for(B=1;B<re;++B)ae[B]===B&&(V!==-1&&ae[V]!==V?ae[B]=ae[V]:z!==-1&&ae[z]!==z&&(ae[B]=ae[z]));for(B=1;B<re;++B)if(C[B].type!==0){if(ue=B,ue!=ae[ue])do ue=ae[ue],U[B]=U[ue]+"/"+U[B];while(ue!==0&&ae[ue]!==-1&&ue!=ae[ue]);ae[B]=-1}for(U[0]+="/",B=1;B<re;++B)C[B].type!==2&&(U[B]+="/")}function g(C,U,I){for(var B=C.start,z=C.size,V=[],ne=B;I&&z>0&&ne>=0;)V.push(U.slice(ne*T,ne*T+T)),z-=T,ne=Bs(I,ne*4);return V.length===0?oe(0):yr(V).slice(0,C.size)}function y(C,U,I,B,z){var V=F;if(C===F){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ne=I[C],ue=(B>>>2)-1;if(!ne)return;for(var re=0;re<ue&&(V=Bs(ne,re*4))!==F;++re)z.push(V);y(Bs(ne,B-4),U-1,I,B,z)}}function v(C,U,I,B,z){var V=[],ne=[];z||(z=[]);var ue=B-1,re=0,ae=0;for(re=U;re>=0;){z[re]=!0,V[V.length]=re,ne.push(C[re]);var ie=I[Math.floor(re*4/B)];if(ae=re*4&ue,B<4+ae)throw new Error("FAT boundary crossed: "+re+" 4 "+B);if(!C[ie])break;re=Bs(C[ie],ae)}return{nodes:V,data:Ej([ne])}}function b(C,U,I,B){var z=C.length,V=[],ne=[],ue=[],re=[],ae=B-1,ie=0,pe=0,we=0,_e=0;for(ie=0;ie<z;++ie)if(ue=[],we=ie+U,we>=z&&(we-=z),!ne[we]){re=[];var me=[];for(pe=we;pe>=0;){me[pe]=!0,ne[pe]=!0,ue[ue.length]=pe,re.push(C[pe]);var Se=I[Math.floor(pe*4/B)];if(_e=pe*4&ae,B<4+_e)throw new Error("FAT boundary crossed: "+pe+" 4 "+B);if(!C[Se]||(pe=Bs(C[Se],_e),me[pe]))break}V[we]={nodes:ue,data:Ej([re])}}return V}function x(C,U,I,B,z,V,ne,ue){for(var re=0,ae=B.length?2:0,ie=U[C].data,pe=0,we=0,_e;pe<ie.length;pe+=128){var me=ie.slice(pe,pe+128);Tr(me,64),we=me.read_shift(2),_e=mw(me,0,we-ae),B.push(_e);var Se={name:_e,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Le=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Le!==0&&(Se.ct=_(me,me.l-8));var At=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);At!==0&&(Se.mt=_(me,me.l-8)),Se.start=me.read_shift(4,"i"),Se.size=me.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=F,Se.name=""),Se.type===5?(re=Se.start,z>0&&re!==F&&(U[re].name="!StreamData")):Se.size>=4096?(Se.storage="fat",U[Se.start]===void 0&&(U[Se.start]=v(I,Se.start,U.fat_addrs,U.ssz)),U[Se.start].name=Se.name,Se.content=U[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:re!==F&&Se.start!==F&&U[re]&&(Se.content=g(Se,U[re].data,(U[ue]||{}).data))),Se.content&&Tr(Se.content,0),V[_e]=Se,ne.push(Se)}}function _(C,U){return new Date((jn(C,U+4)/1e7*Math.pow(2,32)+jn(C,U)/1e7-11644473600)*1e3)}function w(C,U){return u(),f(c.readFileSync(C),U)}function S(C,U){var I=U&&U.type;switch(I||Ve&&Buffer.isBuffer(C)&&(I="buffer"),I||"base64"){case"file":return w(C,U);case"base64":return f(Tn($n(C)),U);case"binary":return f(Tn(C),U)}return f(C,U)}function k(C,U){var I=U||{},B=I.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=B+"/",C.FileIndex[0]={name:B,type:5}),I.CLSID&&(C.FileIndex[0].clsid=I.CLSID),N(C)}function N(C){var U="Sh33tJ5";if(!Oe.find(C,"/"+U)){var I=oe(4);I[0]=55,I[1]=I[3]=50,I[2]=54,C.FileIndex.push({name:U,type:2,content:I,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+U),j(C)}}function j(C,U){k(C);for(var I=!1,B=!1,z=C.FullPaths.length-1;z>=0;--z){var V=C.FileIndex[z];switch(V.type){case 0:B?I=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(V.R*V.L*V.C)&&(I=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!U)){var ne=new Date(1987,1,19),ue=0,re=Object.create?Object.create(null):{},ae=[];for(z=0;z<C.FullPaths.length;++z)re[C.FullPaths[z]]=!0,C.FileIndex[z].type!==0&&ae.push([C.FullPaths[z],C.FileIndex[z]]);for(z=0;z<ae.length;++z){var ie=n(ae[z][0]);B=re[ie],B||(ae.push([ie,{name:a(ie).replace("/",""),type:1,clsid:W,ct:ne,mt:ne,content:null}]),re[ie]=!0)}for(ae.sort(function(_e,me){return r(_e[0],me[0])}),C.FullPaths=[],C.FileIndex=[],z=0;z<ae.length;++z)C.FullPaths[z]=ae[z][0],C.FileIndex[z]=ae[z][1];for(z=0;z<ae.length;++z){var pe=C.FileIndex[z],we=C.FullPaths[z];if(pe.name=a(we).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||W,z===0)pe.C=ae.length>1?1:-1,pe.size=0,pe.type=5;else if(we.slice(-1)=="/"){for(ue=z+1;ue<ae.length&&n(C.FullPaths[ue])!=we;++ue);for(pe.C=ue>=ae.length?-1:ue,ue=z+1;ue<ae.length&&n(C.FullPaths[ue])!=n(we);++ue);pe.R=ue>=ae.length?-1:ue,pe.type=1}else n(C.FullPaths[z+1]||"")==n(we)&&(pe.R=z+1),pe.type=2}}}function E(C,U){var I=U||{};if(I.fileType=="mad")return m6(C,I);switch(j(C),I.fileType){case"zip":return c6(C,I)}var B=function(_e){for(var me=0,Se=0,Le=0;Le<_e.FileIndex.length;++Le){var At=_e.FileIndex[Le];if(At.content){var Ot=At.content.length;Ot>0&&(Ot<4096?me+=Ot+63>>6:Se+=Ot+511>>9)}}for(var Ir=_e.FullPaths.length+3>>2,Cc=me+7>>3,Pc=me+127>>7,Mc=Cc+Se+Ir+Pc,js=Mc+127>>7,rm=js<=109?0:Math.ceil((js-109)/127);Mc+js+rm+127>>7>js;)rm=++js<=109?0:Math.ceil((js-109)/127);var ni=[1,rm,js,Pc,Ir,Se,me,0];return _e.FileIndex[0].size=me<<6,ni[7]=(_e.FileIndex[0].start=ni[0]+ni[1]+ni[2]+ni[3]+ni[4]+ni[5])+(ni[6]+7>>3),ni}(C),z=oe(B[7]<<9),V=0,ne=0;{for(V=0;V<8;++V)z.write_shift(1,M[V]);for(V=0;V<8;++V)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),V=0;V<3;++V)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,B[2]),z.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:F),z.write_shift(4,B[3]),z.write_shift(-4,B[1]?B[0]-1:F),z.write_shift(4,B[1]),V=0;V<109;++V)z.write_shift(-4,V<B[2]?B[1]+V:-1)}if(B[1])for(ne=0;ne<B[1];++ne){for(;V<236+ne*127;++V)z.write_shift(-4,V<B[2]?B[1]+V:-1);z.write_shift(-4,ne===B[1]-1?F:ne+1)}var ue=function(_e){for(ne+=_e;V<ne-1;++V)z.write_shift(-4,V+1);_e&&(++V,z.write_shift(-4,F))};for(ne=V=0,ne+=B[1];V<ne;++V)z.write_shift(-4,Y.DIFSECT);for(ne+=B[2];V<ne;++V)z.write_shift(-4,Y.FATSECT);ue(B[3]),ue(B[4]);for(var re=0,ae=0,ie=C.FileIndex[0];re<C.FileIndex.length;++re)ie=C.FileIndex[re],ie.content&&(ae=ie.content.length,!(ae<4096)&&(ie.start=ne,ue(ae+511>>9)));for(ue(B[6]+7>>3);z.l&511;)z.write_shift(-4,Y.ENDOFCHAIN);for(ne=V=0,re=0;re<C.FileIndex.length;++re)ie=C.FileIndex[re],ie.content&&(ae=ie.content.length,!(!ae||ae>=4096)&&(ie.start=ne,ue(ae+63>>6)));for(;z.l&511;)z.write_shift(-4,Y.ENDOFCHAIN);for(V=0;V<B[4]<<2;++V){var pe=C.FullPaths[V];if(!pe||pe.length===0){for(re=0;re<17;++re)z.write_shift(4,0);for(re=0;re<3;++re)z.write_shift(4,-1);for(re=0;re<12;++re)z.write_shift(4,0);continue}ie=C.FileIndex[V],V===0&&(ie.start=ie.size?ie.start-1:F);var we=V===0&&I.root||ie.name;if(ae=2*(we.length+1),z.write_shift(64,we,"utf16le"),z.write_shift(2,ae),z.write_shift(1,ie.type),z.write_shift(1,ie.color),z.write_shift(-4,ie.L),z.write_shift(-4,ie.R),z.write_shift(-4,ie.C),ie.clsid)z.write_shift(16,ie.clsid,"hex");else for(re=0;re<4;++re)z.write_shift(4,0);z.write_shift(4,ie.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,ie.start),z.write_shift(4,ie.size),z.write_shift(4,0)}for(V=1;V<C.FileIndex.length;++V)if(ie=C.FileIndex[V],ie.size>=4096)if(z.l=ie.start+1<<9,Ve&&Buffer.isBuffer(ie.content))ie.content.copy(z,z.l,0,ie.size),z.l+=ie.size+511&-512;else{for(re=0;re<ie.size;++re)z.write_shift(1,ie.content[re]);for(;re&511;++re)z.write_shift(1,0)}for(V=1;V<C.FileIndex.length;++V)if(ie=C.FileIndex[V],ie.size>0&&ie.size<4096)if(Ve&&Buffer.isBuffer(ie.content))ie.content.copy(z,z.l,0,ie.size),z.l+=ie.size+63&-64;else{for(re=0;re<ie.size;++re)z.write_shift(1,ie.content[re]);for(;re&63;++re)z.write_shift(1,0)}if(Ve)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function A(C,U){var I=C.FullPaths.map(function(re){return re.toUpperCase()}),B=I.map(function(re){var ae=re.split("/");return ae[ae.length-(re.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=I[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var V=U.toUpperCase(),ne=z===!0?I.indexOf(V):B.indexOf(V);if(ne!==-1)return C.FileIndex[ne];var ue=!V.match(cu);for(V=V.replace(sn,""),ue&&(V=V.replace(cu,"!")),ne=0;ne<I.length;++ne)if((ue?I[ne].replace(cu,"!"):I[ne]).replace(sn,"")==V||(ue?B[ne].replace(cu,"!"):B[ne]).replace(sn,"")==V)return C.FileIndex[ne];return null}var T=64,F=-2,G="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(C,U,I){u();var B=E(C,I);c.writeFileSync(U,B)}function D(C){for(var U=new Array(C.length),I=0;I<C.length;++I)U[I]=String.fromCharCode(C[I]);return U.join("")}function Z(C,U){var I=E(C,U);switch(U&&U.type||"buffer"){case"file":return u(),c.writeFileSync(U.filename,I),I;case"binary":return typeof I=="string"?I:D(I);case"base64":return If(typeof I=="string"?I:D(I));case"buffer":if(Ve)return Buffer.isBuffer(I)?I:Mi(I);case"array":return typeof I=="string"?Tn(I):I}return I}var ee;function O(C){try{var U=C.InflateRaw,I=new U;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)ee=C;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function L(C,U){if(!ee)return Vw(C,U);var I=ee.InflateRaw,B=new I,z=B._processChunk(C.slice(C.l),B._finishFlushFlag);return C.l+=B.bytesRead,z}function R(C){return ee?ee.deflateRawSync(C):Re(C)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(C){var U=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(U>>16|U>>8|U)&255}for(var Q=typeof Uint8Array<"u",te=Q?new Uint8Array(256):[],fe=0;fe<256;++fe)te[fe]=se(fe);function P(C,U){var I=te[C&255];return U<=8?I>>>8-U:(I=I<<8|te[C>>8&255],U<=16?I>>>16-U:(I=I<<8|te[C>>16&255],I>>>24-U))}function ke(C,U){var I=U&7,B=U>>>3;return(C[B]|(I<=6?0:C[B+1]<<8))>>>I&3}function be(C,U){var I=U&7,B=U>>>3;return(C[B]|(I<=5?0:C[B+1]<<8))>>>I&7}function Te(C,U){var I=U&7,B=U>>>3;return(C[B]|(I<=4?0:C[B+1]<<8))>>>I&15}function Ae(C,U){var I=U&7,B=U>>>3;return(C[B]|(I<=3?0:C[B+1]<<8))>>>I&31}function he(C,U){var I=U&7,B=U>>>3;return(C[B]|(I<=1?0:C[B+1]<<8))>>>I&127}function We(C,U,I){var B=U&7,z=U>>>3,V=(1<<I)-1,ne=C[z]>>>B;return I<8-B||(ne|=C[z+1]<<8-B,I<16-B)||(ne|=C[z+2]<<16-B,I<24-B)||(ne|=C[z+3]<<24-B),ne&V}function xt(C,U,I){var B=U&7,z=U>>>3;return B<=5?C[z]|=(I&7)<<B:(C[z]|=I<<B&255,C[z+1]=(I&7)>>8-B),U+3}function tr(C,U,I){var B=U&7,z=U>>>3;return I=(I&1)<<B,C[z]|=I,U+1}function zt(C,U,I){var B=U&7,z=U>>>3;return I<<=B,C[z]|=I&255,I>>>=8,C[z+1]=I,U+8}function kr(C,U,I){var B=U&7,z=U>>>3;return I<<=B,C[z]|=I&255,I>>>=8,C[z+1]=I&255,C[z+2]=I>>>8,U+16}function Xt(C,U){var I=C.length,B=2*I>U?2*I:U+5,z=0;if(I>=U)return C;if(Ve){var V=lj(B);if(C.copy)C.copy(V);else for(;z<C.length;++z)V[z]=C[z];return V}else if(Q){var ne=new Uint8Array(B);if(ne.set)ne.set(C);else for(;z<I;++z)ne[z]=C[z];return ne}return C.length=B,C}function It(C){for(var U=new Array(C),I=0;I<C;++I)U[I]=0;return U}function Kt(C,U,I){var B=1,z=0,V=0,ne=0,ue=0,re=C.length,ae=Q?new Uint16Array(32):It(32);for(V=0;V<32;++V)ae[V]=0;for(V=re;V<I;++V)C[V]=0;re=C.length;var ie=Q?new Uint16Array(re):It(re);for(V=0;V<re;++V)ae[z=C[V]]++,B<z&&(B=z),ie[V]=0;for(ae[0]=0,V=1;V<=B;++V)ae[V+16]=ue=ue+ae[V-1]<<1;for(V=0;V<re;++V)ue=C[V],ue!=0&&(ie[V]=ae[ue+16]++);var pe=0;for(V=0;V<re;++V)if(pe=C[V],pe!=0)for(ue=P(ie[V],B)>>B-pe,ne=(1<<B+4-pe)-1;ne>=0;--ne)U[ue|ne<<pe]=pe&15|V<<4;return B}var Dr=Q?new Uint16Array(512):It(512),ma=Q?new Uint16Array(32):It(32);if(!Q){for(var Et=0;Et<512;++Et)Dr[Et]=0;for(Et=0;Et<32;++Et)ma[Et]=0}(function(){for(var C=[],U=0;U<32;U++)C.push(5);Kt(C,ma,32);var I=[];for(U=0;U<=143;U++)I.push(8);for(;U<=255;U++)I.push(9);for(;U<=279;U++)I.push(7);for(;U<=287;U++)I.push(8);Kt(I,Dr,288)})();var hr=function(){for(var U=Q?new Uint8Array(32768):[],I=0,B=0;I<le.length-1;++I)for(;B<le[I+1];++B)U[B]=I;for(;B<32768;++B)U[B]=29;var z=Q?new Uint8Array(259):[];for(I=0,B=0;I<J.length-1;++I)for(;B<J[I+1];++B)z[B]=I;function V(ue,re){for(var ae=0;ae<ue.length;){var ie=Math.min(65535,ue.length-ae),pe=ae+ie==ue.length;for(re.write_shift(1,+pe),re.write_shift(2,ie),re.write_shift(2,~ie&65535);ie-- >0;)re[re.l++]=ue[ae++]}return re.l}function ne(ue,re){for(var ae=0,ie=0,pe=Q?new Uint16Array(32768):[];ie<ue.length;){var we=Math.min(65535,ue.length-ie);if(we<10){for(ae=xt(re,ae,+(ie+we==ue.length)),ae&7&&(ae+=8-(ae&7)),re.l=ae/8|0,re.write_shift(2,we),re.write_shift(2,~we&65535);we-- >0;)re[re.l++]=ue[ie++];ae=re.l*8;continue}ae=xt(re,ae,+(ie+we==ue.length)+2);for(var _e=0;we-- >0;){var me=ue[ie];_e=(_e<<5^me)&32767;var Se=-1,Le=0;if((Se=pe[_e])&&(Se|=ie&-32768,Se>ie&&(Se-=32768),Se<ie))for(;ue[Se+Le]==ue[ie+Le]&&Le<250;)++Le;if(Le>2){me=z[Le],me<=22?ae=zt(re,ae,te[me+1]>>1)-1:(zt(re,ae,3),ae+=5,zt(re,ae,te[me-23]>>5),ae+=3);var At=me<8?0:me-4>>2;At>0&&(kr(re,ae,Le-J[me]),ae+=At),me=U[ie-Se],ae=zt(re,ae,te[me]>>3),ae-=3;var Ot=me<4?0:me-2>>1;Ot>0&&(kr(re,ae,ie-Se-le[me]),ae+=Ot);for(var Ir=0;Ir<Le;++Ir)pe[_e]=ie&32767,_e=(_e<<5^ue[ie])&32767,++ie;we-=Le-1}else me<=143?me=me+48:ae=tr(re,ae,1),ae=zt(re,ae,te[me]),pe[_e]=ie&32767,++ie}ae=zt(re,ae,0)-1}return re.l=(ae+7)/8|0,re.l}return function(re,ae){return re.length<8?V(re,ae):ne(re,ae)}}();function Re(C){var U=oe(50+Math.floor(C.length*1.1)),I=hr(C,U);return U.slice(0,I)}var mt=Q?new Uint16Array(32768):It(32768),He=Q?new Uint16Array(32768):It(32768),Ke=Q?new Uint16Array(128):It(128),Tt=1,Do=1;function Ns(C,U){var I=Ae(C,U)+257;U+=5;var B=Ae(C,U)+1;U+=5;var z=Te(C,U)+4;U+=4;for(var V=0,ne=Q?new Uint8Array(19):It(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ae=Q?new Uint8Array(8):It(8),ie=Q?new Uint8Array(8):It(8),pe=ne.length,we=0;we<z;++we)ne[X[we]]=V=be(C,U),re<V&&(re=V),ae[V]++,U+=3;var _e=0;for(ae[0]=0,we=1;we<=re;++we)ie[we]=_e=_e+ae[we-1]<<1;for(we=0;we<pe;++we)(_e=ne[we])!=0&&(ue[we]=ie[_e]++);var me=0;for(we=0;we<pe;++we)if(me=ne[we],me!=0){_e=te[ue[we]]>>8-me;for(var Se=(1<<7-me)-1;Se>=0;--Se)Ke[_e|Se<<me]=me&7|we<<3}var Le=[];for(re=1;Le.length<I+B;)switch(_e=Ke[he(C,U)],U+=_e&7,_e>>>=3){case 16:for(V=3+ke(C,U),U+=2,_e=Le[Le.length-1];V-- >0;)Le.push(_e);break;case 17:for(V=3+be(C,U),U+=3;V-- >0;)Le.push(0);break;case 18:for(V=11+he(C,U),U+=7;V-- >0;)Le.push(0);break;default:Le.push(_e),re<_e&&(re=_e);break}var At=Le.slice(0,I),Ot=Le.slice(I);for(we=I;we<286;++we)At[we]=0;for(we=B;we<30;++we)Ot[we]=0;return Tt=Kt(At,mt,286),Do=Kt(Ot,He,30),U}function o6(C,U){if(C[0]==3&&!(C[1]&3))return[ss(U),2];for(var I=0,B=0,z=lj(U||1<<18),V=0,ne=z.length>>>0,ue=0,re=0;!(B&1);){if(B=be(C,I),I+=3,B>>>1)B>>1==1?(ue=9,re=5):(I=Ns(C,I),ue=Tt,re=Do);else{I&7&&(I+=8-(I&7));var ae=C[I>>>3]|C[(I>>>3)+1]<<8;if(I+=32,ae>0)for(!U&&ne<V+ae&&(z=Xt(z,V+ae),ne=z.length);ae-- >0;)z[V++]=C[I>>>3],I+=8;continue}for(;;){!U&&ne<V+32767&&(z=Xt(z,V+32767),ne=z.length);var ie=We(C,I,ue),pe=B>>>1==1?Dr[ie]:mt[ie];if(I+=pe&15,pe>>>=4,!(pe>>>8&255))z[V++]=pe;else{if(pe==256)break;pe-=257;var we=pe<8?0:pe-4>>2;we>5&&(we=0);var _e=V+J[pe];we>0&&(_e+=We(C,I,we),I+=we),ie=We(C,I,re),pe=B>>>1==1?ma[ie]:He[ie],I+=pe&15,pe>>>=4;var me=pe<4?0:pe-2>>1,Se=le[pe];for(me>0&&(Se+=We(C,I,me),I+=me),!U&&ne<_e&&(z=Xt(z,_e+100),ne=z.length);V<_e;)z[V]=z[V-Se],++V}}}return U?[z,I+7>>>3]:[z.slice(0,V),I+7>>>3]}function Vw(C,U){var I=C.slice(C.l||0),B=o6(I,U);return C.l+=B[1],B[0]}function Gw(C,U){if(C)typeof console<"u"&&console.error(U);else throw new Error(U)}function Xw(C,U){var I=C;Tr(I,0);var B=[],z=[],V={FileIndex:B,FullPaths:z};k(V,{root:U.root});for(var ne=I.length-4;(I[ne]!=80||I[ne+1]!=75||I[ne+2]!=5||I[ne+3]!=6)&&ne>=0;)--ne;I.l=ne+4,I.l+=4;var ue=I.read_shift(2);I.l+=6;var re=I.read_shift(4);for(I.l=re,ne=0;ne<ue;++ne){I.l+=20;var ae=I.read_shift(4),ie=I.read_shift(4),pe=I.read_shift(2),we=I.read_shift(2),_e=I.read_shift(2);I.l+=8;var me=I.read_shift(4),Se=o(I.slice(I.l+pe,I.l+pe+we));I.l+=pe+we+_e;var Le=I.l;I.l=me+4,l6(I,ae,ie,V,Se),I.l=Le}return V}function l6(C,U,I,B,z){C.l+=2;var V=C.read_shift(2),ne=C.read_shift(2),ue=s(C);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var re=C.read_shift(4),ae=C.read_shift(4),ie=C.read_shift(4),pe=C.read_shift(2),we=C.read_shift(2),_e="",me=0;me<pe;++me)_e+=String.fromCharCode(C[C.l++]);if(we){var Se=o(C.slice(C.l,C.l+we));(Se[21589]||{}).mt&&(ue=Se[21589].mt),((z||{})[21589]||{}).mt&&(ue=z[21589].mt)}C.l+=we;var Le=C.slice(C.l,C.l+ae);switch(ne){case 8:Le=L(C,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var At=!1;V&8&&(re=C.read_shift(4),re==134695760&&(re=C.read_shift(4),At=!0),ae=C.read_shift(4),ie=C.read_shift(4)),ae!=U&&Gw(At,"Bad compressed size: "+U+" != "+ae),ie!=I&&Gw(At,"Bad uncompressed size: "+I+" != "+ie),tm(B,_e,Le,{unsafe:!0,mt:ue})}function c6(C,U){var I=U||{},B=[],z=[],V=oe(1),ne=I.compression?8:0,ue=0,re=0,ae=0,ie=0,pe=0,we=C.FullPaths[0],_e=we,me=C.FileIndex[0],Se=[],Le=0;for(re=1;re<C.FullPaths.length;++re)if(_e=C.FullPaths[re].slice(we.length),me=C.FileIndex[re],!(!me.size||!me.content||_e=="Sh33tJ5")){var At=ie,Ot=oe(_e.length);for(ae=0;ae<_e.length;++ae)Ot.write_shift(1,_e.charCodeAt(ae)&127);Ot=Ot.slice(0,Ot.l),Se[pe]=fce.buf(me.content,0);var Ir=me.content;ne==8&&(Ir=R(Ir)),V=oe(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,ue),V.write_shift(2,ne),me.mt?i(V,me.mt):V.write_shift(4,0),V.write_shift(-4,Se[pe]),V.write_shift(4,Ir.length),V.write_shift(4,me.content.length),V.write_shift(2,Ot.length),V.write_shift(2,0),ie+=V.length,B.push(V),ie+=Ot.length,B.push(Ot),ie+=Ir.length,B.push(Ir),V=oe(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,ue),V.write_shift(2,ne),V.write_shift(4,0),V.write_shift(-4,Se[pe]),V.write_shift(4,Ir.length),V.write_shift(4,me.content.length),V.write_shift(2,Ot.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,At),Le+=V.l,z.push(V),Le+=Ot.length,z.push(Ot),++pe}return V=oe(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,pe),V.write_shift(2,pe),V.write_shift(4,Le),V.write_shift(4,ie),V.write_shift(2,0),yr([yr(B),yr(z),V])}var E0={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function u6(C,U){if(C.ctype)return C.ctype;var I=C.name||"",B=I.match(/\.([^\.]+)$/);return B&&E0[B[1]]||U&&(B=(I=U).match(/[\.\\]([^\.\\])+$/),B&&E0[B[1]])?E0[B[1]]:"application/octet-stream"}function f6(C){for(var U=If(C),I=[],B=0;B<U.length;B+=76)I.push(U.slice(B,B+76));return I.join(`\r
`)+`\r
`}function d6(C){var U=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var ie=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],B=U.split(`\r
`),z=0;z<B.length;++z){var V=B[z];if(V.length==0){I.push("");continue}for(var ne=0;ne<V.length;){var ue=76,re=V.slice(ne,ne+ue);re.charAt(ue-1)=="="?ue--:re.charAt(ue-2)=="="?ue-=2:re.charAt(ue-3)=="="&&(ue-=3),re=V.slice(ne,ne+ue),ne+=ue,ne<V.length&&(re+="="),I.push(re)}}return I.join(`\r
`)}function h6(C){for(var U=[],I=0;I<C.length;++I){for(var B=C[I];I<=C.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+C[++I];U.push(B)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Tn(U.join(`\r
`))}function p6(C,U,I){for(var B="",z="",V="",ne,ue=0;ue<10;++ue){var re=U[ue];if(!re||re.match(/^\s*$/))break;var ae=re.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":B=ae[2].trim();break;case"content-type":V=ae[2].trim();break;case"content-transfer-encoding":z=ae[2].trim();break}}switch(++ue,z.toLowerCase()){case"base64":ne=Tn($n(U.slice(ue).join("")));break;case"quoted-printable":ne=h6(U.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var ie=tm(C,B.slice(I.length),ne,{unsafe:!0});V&&(ie.ctype=V)}function x6(C,U){if(D(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=U&&U.root||"",B=(Ve&&Buffer.isBuffer(C)?C.toString("binary"):D(C)).split(`\r
`),z=0,V="";for(z=0;z<B.length;++z)if(V=B[z],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),I||(I=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),V.slice(0,I.length)!=I););var ne=(B[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var ue="--"+(ne[1]||""),re=[],ae=[],ie={FileIndex:re,FullPaths:ae};k(ie);var pe,we=0;for(z=0;z<B.length;++z){var _e=B[z];_e!==ue&&_e!==ue+"--"||(we++&&p6(ie,B.slice(pe,z),I),pe=z)}return ie}function m6(C,U){var I=U||{},B=I.boundary||"SheetJS";B="------="+B;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],V=C.FullPaths[0],ne=V,ue=C.FileIndex[0],re=1;re<C.FullPaths.length;++re)if(ne=C.FullPaths[re].slice(V.length),ue=C.FileIndex[re],!(!ue.size||!ue.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var ae=ue.content,ie=Ve&&Buffer.isBuffer(ae)?ae.toString("binary"):D(ae),pe=0,we=Math.min(1024,ie.length),_e=0,me=0;me<=we;++me)(_e=ie.charCodeAt(me))>=32&&_e<128&&++pe;var Se=pe>=we*4/5;z.push(B),z.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+ne),z.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),z.push("Content-Type: "+u6(ue,ne)),z.push(""),z.push(Se?d6(ie):f6(ie))}return z.push(B+`--\r
`),z.join(`\r
`)}function g6(C){var U={};return k(U,C),U}function tm(C,U,I,B){var z=B&&B.unsafe;z||k(C);var V=!z&&Oe.find(C,U);if(!V){var ne=C.FullPaths[0];U.slice(0,ne.length)==ne?ne=U:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+U).replace("//","/")),V={name:a(U),type:2},C.FileIndex.push(V),C.FullPaths.push(ne),z||Oe.utils.cfb_gc(C)}return V.content=I,V.size=I?I.length:0,B&&(B.CLSID&&(V.clsid=B.CLSID),B.mt&&(V.mt=B.mt),B.ct&&(V.ct=B.ct)),V}function v6(C,U){k(C);var I=Oe.find(C,U);if(I){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==I)return C.FileIndex.splice(B,1),C.FullPaths.splice(B,1),!0}return!1}function y6(C,U,I){k(C);var B=Oe.find(C,U);if(B){for(var z=0;z<C.FileIndex.length;++z)if(C.FileIndex[z]==B)return C.FileIndex[z].name=a(I),C.FullPaths[z]=I,!0}return!1}function b6(C){j(C,!0)}return t.find=A,t.read=S,t.parse=f,t.write=Z,t.writeFile=K,t.utils={cfb_new:g6,cfb_add:tm,cfb_del:v6,cfb_mov:y6,cfb_gc:b6,ReadShift:Eu,CheckField:kP,prep_blob:Tr,bconcat:yr,use_zlib:O,_deflateRaw:Re,_inflateRaw:Vw,consts:Y},t}();function dce(e){return typeof e=="string"?Vx(e):Array.isArray(e)?$le(e):e}function y0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Vx(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ha(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([dce(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ss(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function hce(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ut(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function mj(e,t){for(var r=[],n=Ut(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Xx(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Kx(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function pce(e){for(var t=[],r=Ut(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var xp=new Date(1899,11,30,0,0,0);function fr(e,t){var r=e.getTime(),n=xp.getTime()+(e.getTimezoneOffset()-xp.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var nP=new Date,xce=xp.getTime()+(nP.getTimezoneOffset()-xp.getTimezoneOffset())*6e4,gj=nP.getTimezoneOffset();function qx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+xce),t.getTimezoneOffset()!==gj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-gj)*6e4),t}function mce(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var vj=new Date("2017-02-19T19:06:09.000Z"),aP=isNaN(vj.getFullYear())?new Date("2/19/17"):vj,gce=aP.getFullYear()==2017;function St(e,t){var r=new Date(e);if(gce)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(aP.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function mo(e,t){if(Ve&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ha(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ha(VC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ha(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ha(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function _t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=_t(e[r]));return t}function Lt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ca(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var vce=["january","february","march","april","may","june","july","august","september","october","november","december"];function ac(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&vce.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var yce=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function iP(e){return e?e.content&&e.type?mo(e.content,!0):e.data?lu(e.data):e.asNodeBuffer&&Ve?lu(e.asNodeBuffer().toString("binary")):e.asBinary?lu(e.asBinary()):e._data&&e._data.getContent?lu(mo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function sP(e){if(!e)return null;if(e.data)return sj(e.data);if(e.asNodeBuffer&&Ve)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?sj(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function bce(e){return e&&e.name.slice(-4)===".bin"?sP(e):iP(e)}function Kn(e,t){for(var r=e.FullPaths||Ut(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function uw(e,t){var r=Kn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qt(e,t,r){if(!r)return bce(uw(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function An(e,t,r){if(!r)return iP(uw(e,t));if(!t)return null;try{return An(e,t)}catch{return null}}function wce(e,t,r){return sP(uw(e,t))}function yj(e){for(var t=e.FullPaths||Ut(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ue(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ve?n=Mi(r):n=Lle(r),Oe.utils.cfb_add(e,t,n)}Oe.utils.cfb_add(e,t,r)}else e.file(t,r)}function fw(){return Oe.utils.cfb_new()}function oP(e,t){switch(t.type){case"base64":return Oe.read(e,{type:"base64"});case"binary":return Oe.read(e,{type:"binary"});case"buffer":case"array":return Oe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function uu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Gt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Sce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,bj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_ce=/<[^>]*>/g,Qr=Gt.match(bj)?bj:_ce,kce=/<\w*:/,Nce=/<(\/?)\w+:/;function De(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(Sce),o=0,c="",u=0,f="",d="",h=1;if(s)for(u=0;u!=s.length;++u){for(d=s[u],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(h=(a=d.charCodeAt(i+1))==34||a==39?1:0,c=d.slice(i+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function ti(e){return e.replace(Nce,"<$1")}var lP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},dw=Xx(lP),Ye=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return lP[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),hw=/[&<>'"]/g,jce=/[\u0000-\u0008\u000b-\u001f]/g;function at(e){var t=e+"";return t.replace(hw,function(r){return dw[r]}).replace(jce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wj(e){return at(e).replace(/ /g,"_x0020_")}var cP=/[\u0000-\u001f]/g;function pw(e){var t=e+"";return t.replace(hw,function(r){return dw[r]}).replace(/\n/g,"<br/>").replace(cP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Ece(e){var t=e+"";return t.replace(hw,function(r){return dw[r]}).replace(cP,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Sj=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Tce(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function og(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function _j(e){var t=ss(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function kj(e){return Mi(e,"binary").toString("utf8")}var ud="foo bar baz",ct=Ve&&(kj(ud)==og(ud)&&kj||_j(ud)==og(ud)&&_j)||og,Ha=Ve?function(e){return Mi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$f=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),uP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Ace=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Oce=/<\/?(?:vt:)?variant>/g,Cce=/<(?:vt:)([^>]*)>([\s\S]*)</;function Nj(e,t){var r=De(e),n=e.match(Ace(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(Oce,"").match(Cce);s&&a.push({v:ct(s[2]),t:s[1]})}),a}var fP=/(^\s|\s$|\n)/;function Ar(e,t){return"<"+e+(t.match(fP)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lf(e){return Ut(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ve(e,t,r){return"<"+e+(r!=null?Lf(r):"")+(t!=null?(t.match(fP)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function H1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Pce(e,t){switch(typeof e){case"string":var r=ve("vt:lpwstr",at(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ve((e|0)==e?"vt:i4":"vt:r8",at(String(e)));case"boolean":return ve("vt:bool",e?"true":"false")}if(e instanceof Date)return ve("vt:filetime",H1(e));throw new Error("Unable to serialize "+e)}function xw(e){if(Ve&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ct(Ss(ow(e)));throw new Error("Bad input format: expected Buffer or string")}var Bf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,or={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ao=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Nn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mce(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Fce(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var jj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Ej=Ve?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Mi(t)})):jj(e)}:jj,Tj=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(hi(e,a)));return n.join("").replace(sn,"")},mw=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(sn,""):Tj(e,t,r)}:Tj,Aj=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},dP=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Aj(e,t,r)}:Aj,Oj=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Xo(e,a)));return n.join("")},b0=Ve?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Oj(t,r,n)}:Oj,hP=function(e,t){var r=jn(e,t);return r>0?b0(e,t+4,t+4+r-1):""},pP=hP,xP=function(e,t){var r=jn(e,t);return r>0?b0(e,t+4,t+4+r-1):""},mP=xP,gP=function(e,t){var r=2*jn(e,t);return r>0?b0(e,t+4,t+4+r-1):""},vP=gP,yP=function(t,r){var n=jn(t,r);return n>0?mw(t,r+4,r+4+n):""},bP=yP,wP=function(e,t){var r=jn(e,t);return r>0?b0(e,t+4,t+4+r):""},SP=wP,_P=function(e,t){return Mce(e,t)},mp=_P,gw=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ve&&(pP=function(t,r){if(!Buffer.isBuffer(t))return hP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mP=function(t,r){if(!Buffer.isBuffer(t))return xP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},vP=function(t,r){if(!Buffer.isBuffer(t))return gP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},bP=function(t,r){if(!Buffer.isBuffer(t))return yP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},SP=function(t,r){if(!Buffer.isBuffer(t))return wP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},mp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_P(t,r)},gw=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Xo=function(e,t){return e[t]},hi=function(e,t){return e[t+1]*256+e[t]},Dce=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},jn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Bs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ice=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Eu(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,Ve&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(hi(this,u)),u+=2;e*=2;break;case"utf8":r=b0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mw(this,this.l,this.l+e);break;case"wstr":return Eu.call(this,e,"dbcs");case"lpstr-ansi":r=pP(this,this.l),e=4+jn(this,this.l);break;case"lpstr-cp":r=mP(this,this.l),e=4+jn(this,this.l);break;case"lpwstr":r=vP(this,this.l),e=4+2*jn(this,this.l);break;case"lpp4":e=4+jn(this,this.l),r=bP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+jn(this,this.l),r=SP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Xo(this,this.l+e++))!==0;)i.push(cd(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=hi(this,this.l+e))!==0;)i.push(cd(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Xo(this,u),this.l=u+1,o=Eu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cd(hi(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Xo(this,u),this.l=u+1,o=Eu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cd(Xo(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Xo(this,this.l),this.l++,n;case 2:return n=(t==="i"?Dce:hi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Bs:Ice)(this,this.l),this.l+=4,n):(a=jn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=mp(this,this.l):a=mp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=dP(this,this.l,e);break}}return this.l+=e,r}var Rce=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},$ce=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Lce=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Bce(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Lce(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Rce(this,t,this.l);break;case 8:if(n=8,r==="f"){Fce(this,t,this.l);break}case 16:break;case-4:n=4,$ce(this,t,this.l);break}return this.l+=n,this}function kP(e,t){var r=dP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Tr(e,t){e.l=t,e.read_shift=Eu,e.chk=kP,e.write_shift=Bce}function Yr(e,t){e.l+=t}function oe(e){var t=ss(e);return Tr(t,0),t}function Fi(e,t,r){if(e){var n,a,i;Tr(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Gf[o]||Gf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var f=u.f&&u.f(e,i,r);if(e.l=c,t(f,u,o))return}}}function gn(){var e=[],t=Ve?256:2048,r=function(u){var f=oe(u);return Tr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),yr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function de(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Gf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&gw(r)&&e.push(r)}}function Tu(e,t,r){var n=_t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Cj(e,t,r){var n=_t(e);return n.s=Tu(n.s,t.s,r),n.e=Tu(n.e,t.s,r),n}function Au(e,t){if(e.cRel&&e.c<0)for(e=_t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=_t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Fe(e);return!e.cRel&&e.cRel!=null&&(r=Wce(r)),!e.rRel&&e.rRel!=null&&(r=Uce(r)),r}function lg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Pt(e.s.c)+":"+(e.e.cRel?"":"$")+Pt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Vt(e.s.r)+":"+(e.e.rRel?"":"$")+Vt(e.e.r):Au(e.s,t.biff)+":"+Au(e.e,t.biff)}function vw(e){return parseInt(zce(e),10)-1}function Vt(e){return""+(e+1)}function Uce(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function zce(e){return e.replace(/\$(\d+)$/,"$1")}function yw(e){for(var t=Hce(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Pt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Wce(e){return e.replace(/^([A-Z])/,"$$$1")}function Hce(e){return e.replace(/^\$([A-Z])/,"$1")}function Vce(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Fe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function vn(e){var t=e.indexOf(":");return t==-1?{s:Mt(e),e:Mt(e)}:{s:Mt(e.slice(0,t)),e:Mt(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Fe(e)),typeof t!="string"&&(t=Fe(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Pj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ua(e.z,r?fr(t):t)}catch{}try{return e.w=ua((e.XF||{}).numFmtId||(r?14:0),r?fr(t):t)}catch{return""+t}}function Ei(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Di[e.v]||e.v:t==null?Pj(e,e.v):Pj(e,t))}function _s(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function NP(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Qe(i["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(u.e.r=s=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},m=s+d,g=o+h;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Me[14],n.cellDates?(p.t="d",p.w=ua(p.z,fr(p.v))):(p.t="n",p.v=fr(p.v),p.w=ua(p.z,p.v))):p.t="s";if(a)i[m]||(i[m]=[]),i[m][g]&&i[m][g].z&&(p.z=i[m][g].z),i[m][g]=p;else{var y=Fe({c:g,r:m});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return u.s.c<1e7&&(i["!ref"]=Be(u)),i}function Ac(e,t){return NP(null,e,t)}function Gce(e){return e.read_shift(4,"i")}function Pa(e,t){return t||(t=oe(4)),t.write_shift(4,e),t}function Kr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wr(e,t){var r=!1;return t==null&&(r=!0,t=oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Xce(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Kce(e,t){return t||(t=oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function bw(e,t){var r=e.l,n=e.read_shift(1),a=Kr(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Xce(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function qce(e,t){var r=!1;return t==null&&(r=!0,t=oe(15+4*e.t.length)),t.write_shift(1,0),wr(e.t,t),r?t.slice(0,t.l):t}var Yce=bw;function Qce(e,t){var r=!1;return t==null&&(r=!0,t=oe(23+4*e.t.length)),t.write_shift(1,1),wr(e.t,t),t.write_shift(4,1),Kce({},t),r?t.slice(0,t.l):t}function xa(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Oo(e,t){return t==null&&(t=oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Co(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Po(e,t){return t==null&&(t=oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Zce=Kr,jP=wr;function ww(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function gp(e,t){var r=!1;return t==null&&(r=!0,t=oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Jce=Kr,V1=ww,Sw=gp;function _w(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?mp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Bs(t,0)>>2;return r?a/100:a}function EP(e,t){t==null&&(t=oe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function TP(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function eue(e,t){return t||(t=oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Mo=TP,Oc=eue;function Gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function go(e,t){return(t||oe(8)).write_shift(8,e,"f")}function tue(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Js[a];u&&(t.rgb=zf(u));break;case 2:t.rgb=zf([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function vp(e,t){if(t||(t=oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function rue(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function nue(e,t){t||(t=oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function AP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function aue(e){return AP(e,1)}function iue(e){return AP(e,2)}var kw=2,un=3,fd=11,Mj=12,yp=19,dd=64,sue=65,oue=71,lue=4108,cue=4126,xr=80,OP=81,uue=[xr,OP],G1={1:{n:"CodePage",t:kw},2:{n:"Category",t:xr},3:{n:"PresentationFormat",t:xr},4:{n:"ByteCount",t:un},5:{n:"LineCount",t:un},6:{n:"ParagraphCount",t:un},7:{n:"SlideCount",t:un},8:{n:"NoteCount",t:un},9:{n:"HiddenCount",t:un},10:{n:"MultimediaClipCount",t:un},11:{n:"ScaleCrop",t:fd},12:{n:"HeadingPairs",t:lue},13:{n:"TitlesOfParts",t:cue},14:{n:"Manager",t:xr},15:{n:"Company",t:xr},16:{n:"LinksUpToDate",t:fd},17:{n:"CharacterCount",t:un},19:{n:"SharedDoc",t:fd},22:{n:"HyperlinksChanged",t:fd},23:{n:"AppVersion",t:un,p:"version"},24:{n:"DigSig",t:sue},26:{n:"ContentType",t:xr},27:{n:"ContentStatus",t:xr},28:{n:"Language",t:xr},29:{n:"Version",t:xr},255:{},2147483648:{n:"Locale",t:yp},2147483651:{n:"Behavior",t:yp},1919054434:{}},X1={1:{n:"CodePage",t:kw},2:{n:"Title",t:xr},3:{n:"Subject",t:xr},4:{n:"Author",t:xr},5:{n:"Keywords",t:xr},6:{n:"Comments",t:xr},7:{n:"Template",t:xr},8:{n:"LastAuthor",t:xr},9:{n:"RevNumber",t:xr},10:{n:"EditTime",t:dd},11:{n:"LastPrinted",t:dd},12:{n:"CreatedDate",t:dd},13:{n:"ModifiedDate",t:dd},14:{n:"PageCount",t:un},15:{n:"WordCount",t:un},16:{n:"CharCount",t:un},17:{n:"Thumbnail",t:oue},18:{n:"Application",t:xr},19:{n:"DocSecurity",t:un},255:{},2147483648:{n:"Locale",t:yp},2147483651:{n:"Behavior",t:yp},1919054434:{}},Fj={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fue=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function due(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var hue=due([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Js=_t(hue),Di={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},CP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},K1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Nw(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pue(e){var t=Nw();if(!e||!e.match)return t;var r={};if((e.match(Qr)||[]).forEach(function(n){var a=De(n);switch(a[0].replace(kce,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[K1[a.ContentType]]!==void 0&&t[K1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==or.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function PP(e,t){var r=pce(K1),n=[],a;n[n.length]=Gt,n[n.length]=ve("Types",null,{xmlns:or.CT,"xmlns:xsd":or.xsd,"xmlns:xsi":or.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ve("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ve("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hd[c][t.bookType]||hd[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:hd[c][t.bookType]||hd[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Uf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ou(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Qr)||[]).forEach(function(a){var i=De(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:uu(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function _l(e){var t=[Gt,ve("Relationships",null,{xmlns:or.RELS})];return Ut(e["!id"]).forEach(function(r){t[t.length]=ve("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var xue="application/vnd.oasis.opendocument.spreadsheet";function mue(e,t){for(var r=xw(e),n,a;n=Bf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=De(n[0],!1),a.path=="/"&&a.type!==xue)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function gue(e){var t=[Gt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Dj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function vue(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function yue(e){var t=[Gt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Dj(e[r][0],e[r][1])),t.push(vue("",e[r][0]));return t.push(Dj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function MP(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fp.version+"</meta:generator></office:meta></office:document-meta>"}var aa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bue=function(){for(var e=new Array(aa.length),t=0;t<aa.length;++t){var r=aa[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function FP(e){var t={};e=ct(e);for(var r=0;r<aa.length;++r){var n=aa[r],a=e.match(bue[r]);a!=null&&a.length>0&&(t[n[1]]=Ye(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=St(t[n[1]]))}return t}function cg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=at(t),n[n.length]=r?ve(e,t,r):Ar(e,t))}function DP(e,t){var r=t||{},n=[Gt,ve("cp:coreProperties",null,{"xmlns:cp":or.CORE_PROPS,"xmlns:dc":or.dc,"xmlns:dcterms":or.dcterms,"xmlns:dcmitype":or.dcmitype,"xmlns:xsi":or.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&cg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:H1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&cg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:H1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=aa.length;++i){var s=aa[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&cg(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var eo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],IP=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function RP(e,t,r,n){var a=[];if(typeof e=="string")a=Nj(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(f){return{v:f}}));var s=typeof t=="string"?Nj(t,n).map(function(f){return f.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function wue(e,t,r){var n={};return t||(t={}),e=ct(e),eo.forEach(function(a){var i=(e.match($f(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Ye(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&RP(n.HeadingPairs,n.TitlesOfParts,t,r),t}function $P(e){var t=[],r=ve;return e||(e={}),e.Application="SheetJS",t[t.length]=Gt,t[t.length]=ve("Properties",null,{xmlns:or.EXT_PROPS,"xmlns:vt":or.vt}),eo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=at(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+at(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Sue=/<[^>]+>[^<]*/g;function _ue(e,t){var r={},n="",a=e.match(Sue);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=De(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ye(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ye(f);break;case"bool":r[n]=bt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=St(f);break;case"cy":case"error":r[n]=Ye(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function LP(e){var t=[Gt,ve("Properties",null,{xmlns:or.CUST_PROPS,"xmlns:vt":or.vt})];if(!e)return t.join("");var r=1;return Ut(e).forEach(function(a){++r,t[t.length]=ve("property",Pce(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:at(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var q1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ug;function kue(e,t,r){ug||(ug=Xx(q1)),t=ug[t]||t,e[t]=r}function Nue(e,t){var r=[];return Ut(q1).map(function(n){for(var a=0;a<aa.length;++a)if(aa[a][1]==n)return aa[a];for(a=0;a<eo.length;++a)if(eo[a][1]==n)return eo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Ar(q1[n[1]]||n[1],a))}}),ve("DocumentProperties",r.join(""),{xmlns:Nn.o})}function jue(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Ut(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<aa.length;++s)if(i==aa[s][1])return;for(s=0;s<eo.length;++s)if(i==eo[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ve(wj(i),o,{"dt:dt":c}))}}),t&&Ut(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(ve(wj(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Nn.o+'">'+a.join("")+"</"+n+">"}function jw(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Eue(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=oe(8);return s.write_shift(4,n),s.write_shift(4,a),s}function BP(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function UP(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function zP(e,t,r){return t===31?UP(e):BP(e,t,r)}function Y1(e,t,r){return zP(e,t,r===!1?0:4)}function Tue(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return zP(e,t,0)}function Aue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(sn,""),e.l-a&2&&(e.l+=2)}return r}function Oue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(sn,"");return r}function Cue(e){var t=e.l,r=bp(e,OP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=bp(e,un);return[r,n]}function Pue(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Cue(e));return r}function Ij(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(sn,"").replace(cu,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function WP(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Mue(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function bp(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==Mj&&n!==t&&uue.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Mj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return BP(e,n,4).replace(sn,"");case 31:return UP(e);case 64:return jw(e);case 65:return WP(e);case 71:return Mue(e);case 80:return Y1(e,n,!i.raw).replace(sn,"");case 81:return Tue(e,n).replace(sn,"");case 4108:return Pue(e);case 4126:case 4127:return n==4127?Aue(e):Oue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Rj(e,t){var r=oe(4),n=oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Eue(t);break;case 31:case 80:for(n=oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return yr([r,n])}function $j(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+r]}i.sort(function(b,x){return b[1]-x[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var p=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(p=!1,e.l=i[s][1]),p)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var m=t[i[s][0]];if(h[m.n]=bp(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ja(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(i[s][0]===1){if(o=h.CodePage=bp(e,kw),ja(o),c!==-1){var g=e.l;e.l=i[c][1],u=Ij(e,o),e.l=g}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=Ij(e,o)}else{var y=u[i[s][0]],v;switch(e[e.l]){case 65:e.l+=4,v=WP(e);break;case 30:e.l+=4,v=Y1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Y1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Wt(e,4);break;case 64:e.l+=4,v=St(jw(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=v}}return e.l=r+n,h}var HP=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Fue(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Lj(e,t,r){var n=oe(8),a=[],i=[],s=8,o=0,c=oe(8),u=oe(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=oe(8),u.write_shift(4,0),a.unshift(u);var f=[oe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=oe(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=yr(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(HP.indexOf(e[o][0])>-1||IP.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=Rj(m.t,h)}else{var y=Fue(h);y==-1&&(y=31,h=String(h)),c=Rj(y,h)}i.push(c),u=oe(8),u.write_shift(4,t?p:2+o),a.push(u),s+=8+c.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),yr([n].concat(a).concat(i))}function Bj(e,t,r){var n=e.content;if(!n)return{};Tr(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Oe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var d=$j(n,t),h={SystemIdentifier:u};for(var p in d)h[p]=d[p];if(h.FMTID=i,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=$j(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[i,s],h}function Uj(e,t,r,n,a,i){var s=oe(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Oe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=Lj(e,r,n);if(o.push(c),a){var u=Lj(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return yr(o)}function Ri(e,t){return e.read_shift(t),null}function Due(e,t){t||(t=oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Iue(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Wt(e,t){return e.read_shift(t)===1}function en(e,t){return t||(t=oe(2)),t.write_shift(2,+!!e),t}function Zt(e){return e.read_shift(2,"u")}function qn(e,t){return t||(t=oe(2)),t.write_shift(2,e),t}function VP(e,t){return Iue(e,t,Zt)}function Rue(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function GP(e,t,r){return r||(r=oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function w0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function $ue(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,c={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*s),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Lue(e){var t=e.t||"",r=oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return yr(a)}function vo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function S0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vo(e,n,r)}function Fo(e,t,r){if(r.biff>5)return S0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function XP(e,t,r){return r||(r=oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Bue(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Uue(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(sn,"");return n&&(e.l+=24),a}function zue(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(sn,"");return r+s}function Wue(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Uue(e);case"0303000000000000c000000000000046":return zue(e);default:throw new Error("Unsupported Moniker "+r)}}function pd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(sn,""):"";return r}function zj(e,t){t||(t=oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Hue(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",f,d;a&16&&(i=pd(e,r-e.l)),a&128&&(s=pd(e,r-e.l)),(a&257)===257&&(o=pd(e,r-e.l)),(a&257)===1&&(c=Wue(e,r-e.l)),a&8&&(u=pd(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=jw(e)),e.l=r;var h=s||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),i&&(p.Tooltip=i),p}function Vue(e){var t=oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),zj(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&zj(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function KP(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function qP(e,t){var r=KP(e);return r[3]=0,r}function ri(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function yo(e,t,r,n){return n||(n=oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Gue(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Xue(e,t,r){return t===0?"":Fo(e,t,r)}function Kue(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function YP(e){var t=e.read_shift(2),r=_w(e);return[t,r]}function que(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=w0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Yx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function QP(e,t){return t||(t=oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ZP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var Yue=ZP;function JP(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Que(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Zue(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Lr(e){e.l+=2,e.l+=e.read_shift(2)}var Jue={0:Lr,4:Lr,5:Lr,6:Lr,7:Zue,8:Lr,9:Lr,10:Lr,11:Lr,12:Lr,13:Que,14:Lr,15:Lr,16:Lr,17:Lr,18:Lr,19:Lr,20:Lr,21:JP};function efe(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(Jue[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function xd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ew(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=oe(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function tfe(e,t){return t===0||e.read_shift(2),1200}function rfe(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Fo(e,0,r);return e.read_shift(t+n-e.l),a}function nfe(e,t){var r=!t||t.biff==8,n=oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function afe(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ife(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=w0(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function sfe(e,t){var r=!t||t.biff>=8?2:1,n=oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function ofe(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push($ue(e));return i.Count=n,i.Unique=a,i}function lfe(e,t){var r=oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Lue(e[a]);var i=yr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function cfe(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function ufe(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ffe(e){var t=Gue(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function dfe(e){return e.read_shift(2),e.read_shift(4)}function Wj(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function hfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function pfe(){var e=oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function xfe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function mfe(e){var t=oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function gfe(){}function vfe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=w0(e,0,r),n}function yfe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=oe(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function bfe(e){var t=ri(e);return t.isst=e.read_shift(4),t}function wfe(e,t,r,n){var a=oe(10);return yo(e,t,n,a),a.write_shift(4,r),a}function Sfe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ri(e);r.biff==2&&e.l++;var i=S0(e,n-e.l,r);return a.val=i,a}function _fe(e,t,r,n,a){var i=!a||a.biff==8,s=oe(8+ +i+(1+i)*r.length);return yo(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function kfe(e,t,r){var n=e.read_shift(2),a=Fo(e,0,r);return[n,a]}function Nfe(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var jfe=Fo;function Hj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function Efe(e,t){var r=t.biff==8||!t.biff?4:2,n=oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Tfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=YP(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Afe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(YP(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function Ofe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function Cfe(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=fue[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function Pfe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Cfe(e,t,n.fStyle,r),n}function Vj(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Mfe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Ffe(e){var t=oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Gj(e,t,r){var n=ri(e);(r.biff==2||t==9)&&++e.l;var a=Rue(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Dfe(e,t,r,n,a,i){var s=oe(8);return yo(e,t,n,s),GP(r,i,s),s}function Ife(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ri(e),a=Gr(e);return n.val=a,n}function Rfe(e,t,r,n){var a=oe(14);return yo(e,t,n,a),go(r,a),a}var Xj=Xue;function $fe(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=vo(e,i),o=[];n>e.l;)o.push(S0(e));return[i,a,s,o]}function Kj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=que(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var Lfe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=vo(e,s,r);a&32&&(u=Lfe[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:exe(e,f,r,o);return{chKey:i,Name:u,itab:c,rgce:d}}function e5(e,t,r){if(r.biff<8)return Bfe(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Kue(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Bfe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=w0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Ufe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=vo(e,n,r),s=vo(e,a,r);return[i,s]}function zfe(e,t,r){var n=ZP(e);e.l++;var a=e.read_shift(1);return t-=8,[txe(e,t,r),a,n]}function Yj(e,t,r){var n=Yue(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Zpe(e,t,r)]}function Wfe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Hfe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Fo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function Vfe(e,t,r){return Hfe(e,t,r)}function Gfe(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Yx(e));return r}function Xfe(e){var t=oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)QP(e[r],t);return t}function Kfe(e,t,r){if(r&&r.biff<8)return Yfe(e,t,r);var n=JP(e),a=efe(e,t-22,n[1]);return{cmo:n,ft:a}}var qfe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Yfe(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((qfe[n]||Yr)(e,t,r)),{cmo:[a,n,i],ft:s}}function Qfe(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=Bue(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=vo(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Zfe(e,t){var r=Yx(e);e.l+=16;var n=Hue(e,t-24);return[r,n]}function Jfe(e){var t=oe(24),r=Mt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return yr([t,Vue(e[1])])}function e0e(e,t){e.read_shift(2);var r=Yx(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(sn,""),[r,n]}function t0e(e){var t=e[1].Tooltip,r=oe(10+2*(t.length+1));r.write_shift(2,2048);var n=Mt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function r0e(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Fj[r]||r,r=e.read_shift(2),t[1]=Fj[r]||r,t}function n0e(e){return e||(e=oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function a0e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qP(e));return r}function i0e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qP(e));return r}function s0e(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function t5(e,t,r){if(!r.cellStyles)return Yr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function o0e(e,t){var r=oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function l0e(e,t){var r={};return t<32||(e.l+=16,r.header=Gr(e),r.footer=Gr(e),e.l+=2),r}function c0e(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function u0e(e){for(var t=oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var f0e=ri,d0e=VP,h0e=S0;function p0e(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function x0e(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ri(e);++e.l;var a=Fo(e,t-7,r);return n.t="str",n.val=a,n}function m0e(e){var t=ri(e);++e.l;var r=Gr(e);return t.t="n",t.val=r,t}function g0e(e,t,r){var n=oe(15);return j0(n,e,t),n.write_shift(8,r,"f"),n}function v0e(e){var t=ri(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function y0e(e,t,r){var n=oe(9);return j0(n,e,t),n.write_shift(2,r),n}function b0e(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function w0e(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function S0e(e,t,r){var n=e.l+t,a=ri(e),i=e.read_shift(2),s=vo(e,i,r);return e.l=n,a.t="str",a.val=s,a}var _0e=[2,3,48,49,131,139,140,245],Q1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Xx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=ss(1);switch(c.type){case"base64":f=Tn($n(o));break;case"binary":f=Tn(o);break;case"buffer":case"array":f=o;break}Tr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,m=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,y=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(y=f.read_shift(2));var v=f.read_shift(2),b=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(b=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var x=[],_={},w=Math.min(f.length,d==2?521:y-10-(p?264:0)),S=m?32:11;f.l<w&&f[f.l]!=13;)switch(_={},_.name=Df.utils.decode(b,f.slice(f.l,f.l+S)).replace(/[\u0000\r\n].*$/g,""),f.l+=S,_.type=String.fromCharCode(f.read_shift(1)),d!=2&&!m&&(_.offset=f.read_shift(4)),_.len=f.read_shift(1),d==2&&(_.offset=f.read_shift(2)),_.dec=f.read_shift(1),_.name.length&&x.push(_),d!=2&&(f.l+=m?13:14),_.type){case"B":(!p||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var k=0,N=0;for(u[0]=[],N=0;N!=x.length;++N)u[0][N]=x[N].name;for(;g-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,u[++k]=[],N=0,N=0;N!=x.length;++N){var j=f.slice(f.l,f.l+x[N].len);f.l+=x[N].len,Tr(j,0);var E=Df.utils.decode(b,j);switch(x[N].type){case"C":E.trim().length&&(u[k][N]=E.replace(/\s+$/,""));break;case"D":E.length===8?u[k][N]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):u[k][N]=E;break;case"F":u[k][N]=parseFloat(E.trim());break;case"+":case"I":u[k][N]=m?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":u[k][N]=!0;break;case"N":case"F":u[k][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][N]="##MEMO##"+(m?parseInt(E.trim(),10):j.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(u[k][N]=+E||0);break;case"@":u[k][N]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[k][N]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[k][N]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][N]=-j.read_shift(-8,"f");break;case"B":if(p&&x[N].len==8){u[k][N]=j.read_shift(8,"f");break}case"G":case"P":j.l+=x[N].len;break;case"0":if(x[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[N].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=x,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ac(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,c){try{return _s(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&ja(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=gn(),d=kp(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),m=o["!cols"]||[],g=0,y=0,v=0,b=1;for(g=0;g<h.length;++g){if(((m[g]||{}).DBF||{}).name){h[g]=m[g].DBF.name,++v;continue}if(h[g]!=null){if(++v,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var x=Qe(o["!ref"]),_=[],w=[],S=[];for(g=0;g<=x.e.c-x.s.c;++g){var k="",N="",j=0,E=[];for(y=0;y<p.length;++y)p[y][g]!=null&&E.push(p[y][g]);if(E.length==0||h[g]==null){_[g]="?";continue}for(y=0;y<E.length;++y){switch(typeof E[y]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=E[y]instanceof Date?"D":"C";break;default:N="C"}j=Math.max(j,String(E[y]).length),k=k&&k!=N?"C":N}j>250&&(j=250),N=((m[g]||{}).DBF||{}).type,N=="C"&&m[g].DBF.len>j&&(j=m[g].DBF.len),k=="B"&&N=="N"&&(k="N",S[g]=m[g].DBF.dec,j=m[g].DBF.len),w[g]=k=="C"||N=="N"?j:i[k]||0,b+=w[g],_[g]=k}var A=f.next(32);for(A.write_shift(4,318902576),A.write_shift(4,p.length),A.write_shift(2,296+32*v),A.write_shift(2,b),g=0;g<4;++g)A.write_shift(4,0);for(A.write_shift(4,0|(+t[HC]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var T=f.next(32),F=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,F,"sbcs"),T.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),T.write_shift(4,y),T.write_shift(1,w[g]||i[_[g]]||0),T.write_shift(1,S[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=w[g]||i[_[g]]||0}var G=f.next(264);for(G.write_shift(4,13),g=0;g<65;++g)G.write_shift(4,0);for(g=0;g<p.length;++g){var M=f.next(b);for(M.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(_[y]){case"L":M.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":M.write_shift(8,p[g][y]||0,"f");break;case"N":var W="0";for(typeof p[g][y]=="number"&&(W=p[g][y].toFixed(S[y]||0)),v=0;v<w[y]-W.length;++v)M.write_shift(1,32);M.write_shift(1,W,"sbcs");break;case"D":p[g][y]?(M.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(p[g][y]!=null?p[g][y]:"").slice(0,w[y]);for(M.write_shift(1,Y,"sbcs"),v=0;v<w[y]-Y.length;++v)M.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),r5=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ut(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?oj(m):m},n=function(h,p,m){var g=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?h:oj(g)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return i($n(h),p);case"binary":return i(h,p);case"buffer":return i(Ve&&Buffer.isBuffer(h)?h.toString("binary"):Ss(h),p);case"array":return i(mo(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var m=h.split(/[\n\r]+/),g=-1,y=-1,v=0,b=0,x=[],_=[],w=null,S={},k=[],N=[],j=[],E=0,A;for(+p.codepage>=0&&ja(+p.codepage);v!==m.length;++v){E=0;var T=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),F=T.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),G=F[0],M;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&_.push(T.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,Y=!1,K=!1,D=!1,Z=-1,ee=-1;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"A":break;case"X":y=parseInt(F[b].slice(1))-1,Y=!0;break;case"Y":for(g=parseInt(F[b].slice(1))-1,Y||(y=0),A=x.length;A<=g;++A)x[A]=[];break;case"K":M=F[b].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(Ca(M))?isNaN(ac(M).getDate())||(M=St(M)):(M=Ca(M),w!==null&&Ec(w)&&(M=qx(M))),W=!0;break;case"E":D=!0;var O=kl(F[b].slice(1),{r:g,c:y});x[g][y]=[x[g][y],O];break;case"S":K=!0,x[g][y]=[x[g][y],"S5S"];break;case"G":break;case"R":Z=parseInt(F[b].slice(1))-1;break;case"C":ee=parseInt(F[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(W&&(x[g][y]&&x[g][y].length==2?x[g][y][0]=M:x[g][y]=M,w=null),K){if(D)throw new Error("SYLK shared formula cannot have own formula");var L=Z>-1&&x[Z][ee];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");x[g][y][1]=b5(L[1],{r:g-Z,c:y-ee})}break;case"F":var R=0;for(b=1;b<F.length;++b)switch(F[b].charAt(0)){case"X":y=parseInt(F[b].slice(1))-1,++R;break;case"Y":for(g=parseInt(F[b].slice(1))-1,A=x.length;A<=g;++A)x[A]=[];break;case"M":E=parseInt(F[b].slice(1))/20;break;case"F":break;case"G":break;case"P":w=_[parseInt(F[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=F[b].slice(1).split(" "),A=parseInt(j[0],10);A<=parseInt(j[1],10);++A)E=parseInt(j[2],10),N[A-1]=E===0?{hidden:!0}:{wch:E},os(N[A-1]);break;case"C":y=parseInt(F[b].slice(1))-1,N[y]||(N[y]={});break;case"R":g=parseInt(F[b].slice(1))-1,k[g]||(k[g]={}),E>0?(k[g].hpt=E,k[g].hpx=sc(E)):E===0&&(k[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}R<1&&(w=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return k.length>0&&(S["!rows"]=k),N.length>0&&(S["!cols"]=N),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,S]}function s(h,p){var m=a(h,p),g=m[0],y=m[1],v=Ac(g,p);return Ut(y).forEach(function(b){v[b]=y[b]}),v}function o(h,p){return _s(s(h,p),p)}function c(h,p,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+Mw(h.f,{r:m,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Wf(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Hf(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function f(h,p){p.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*Vf(m.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function d(h,p){var m=["ID;PWXL;N;E"],g=[],y=Qe(h["!ref"]),v,b=Array.isArray(h),x=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&f(m,h["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var _=y.s.r;_<=y.e.r;++_)for(var w=y.s.c;w<=y.e.c;++w){var S=Fe({r:_,c:w});v=b?(h[_]||[])[w]:h[S],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,h,_,w))}return m.join(x)+x+g.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:d}}(),n5=function(){function e(i,s){switch(s.type){case"base64":return t($n(i),s);case"binary":return t(i,s);case"buffer":return t(Ve&&Buffer.isBuffer(i)?i.toString("binary"):Ss(i),s);case"array":return t(mo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var h=o[f].trim().split(","),p=h[0],m=h[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+p){case-1:if(g==="BOT"){d[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[c][u]=!0:g==="FALSE"?d[c][u]=!1:isNaN(Ca(m))?isNaN(ac(m).getDate())?d[c][u]=m:d[c][u]=St(m):d[c][u]=Ca(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(i,s){return Ac(e(i,s),s)}function n(i,s){return _s(r(i,s),s)}var a=function(){var i=function(c,u,f,d,h){c.push(u),c.push(f+","+d),c.push('"'+h.replace(/"/g,'""')+'"')},s=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=Qe(c["!ref"]),d,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,f.e.r-f.s.r+1,""),i(u,"TUPLES",0,f.e.c-f.s.c+1,""),i(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){s(u,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var g=Fe({r:p,c:m});if(d=h?(c[p]||[])[m]:c[g],!d){s(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,y,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ua(d.z||Me[14],fr(St(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var v=`\r
`,b=u.join(v);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),a5=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),m=-1,g=-1,y=0,v=[];y!==p.length;++y){var b=p[y].trim().split(":");if(b[0]==="cell"){var x=Mt(b[1]);if(v.length<=x.r)for(m=v.length;m<=x.r;++m)v[m]||(v[m]=[]);switch(m=x.r,g=x.c,b[2]){case"t":v[m][g]=e(b[3]);break;case"v":v[m][g]=+b[3];break;case"vtf":var _=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[m][g]=!!+b[4];break;default:v[m][g]=+b[4];break}b[2]=="vtf"&&(v[m][g]=[v[m][g],_])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(d,h){return Ac(r(d,h),h)}function a(d,h){return _s(n(d,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],m,g="",y=vn(d["!ref"]),v=Array.isArray(d),b=y.s.r;b<=y.e.r;++b)for(var x=y.s.c;x<=y.e.c;++x)if(g=Fe({r:b,c:x}),m=v?(d[b]||[])[x]:d[g],!(!m||m.v==null||m.t==="z")){switch(p=["cell",g,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var _=fr(St(m.v));p[2]="vtc",p[3]="nd",p[4]=""+_,p[5]=m.w||ua(m.z||Me[14],_);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[i,s,o,s,u(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),ic=function(){function e(f,d,h,p,m){m.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Ca(f))?isNaN(ac(f).getDate())?d[h][p]=f:d[h][p]=St(f):d[h][p]=Ca(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var m=f.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,v=0,b=0;b<=g;++b)v=m[b].indexOf(" "),v==-1?v=m[b].length:v++,y=Math.max(y,v);for(b=0;b<=g;++b){p[b]=[];var x=0;for(e(m[b].slice(0,y).trim(),p,b,x,h),x=1;x<=(m[b].length-y)/10+1;++x)e(m[b].slice(y+(x-1)*10,y+x*10).trim(),p,b,x,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,p=0,m=0;p<f.length;++p)(m=f.charCodeAt(p))==34?h=!h:!h&&m in r&&(d[m]=(d[m]||0)+1);m=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p]);if(!m.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&m.push([d[p],p])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function i(f,d){var h=d||{},p="",m=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=a(f.slice(0,1024)):h&&h.FS?p=h.FS:p=a(f.slice(0,1024));var y=0,v=0,b=0,x=0,_=0,w=p.charCodeAt(0),S=!1,k=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=h.dateNF!=null?cce(h.dateNF):null;function E(){var A=f.slice(x,_),T={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)T.t="z";else if(h.raw)T.t="s",T.v=A;else if(A.trim().length===0)T.t="s",T.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(T.t="s",T.v=A.slice(2,-1).replace(/""/g,'"')):$he(A)?(T.t="n",T.f=A.slice(1)):(T.t="s",T.v=A);else if(A=="TRUE")T.t="b",T.v=!0;else if(A=="FALSE")T.t="b",T.v=!1;else if(!isNaN(b=Ca(A)))T.t="n",h.cellText!==!1&&(T.w=A),T.v=b;else if(!isNaN(ac(A).getDate())||j&&A.match(j)){T.z=h.dateNF||Me[14];var F=0;j&&A.match(j)&&(A=uce(A,h.dateNF,A.match(j)||[]),F=1),h.cellDates?(T.t="d",T.v=St(A,F)):(T.t="n",T.v=fr(St(A,F))),h.cellText!==!1&&(T.w=ua(T.z,T.v instanceof Date?fr(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=A;if(T.t=="z"||(h.dense?(m[y]||(m[y]=[]),m[y][v]=T):m[Fe({c:v,r:y})]=T),x=_+1,N=f.charCodeAt(x),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),k==w)++v;else if(v=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;_<f.length;++_)switch(k=f.charCodeAt(_)){case 34:N===34&&(S=!S);break;case w:case 10:case 13:if(!S&&E())break e;break}return _-x>0&&E(),m["!ref"]=Be(g),m}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):Ac(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:Uw(f,d);switch(d.type){case"base64":h=$n(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Df<"u"||(h=Ve&&Buffer.isBuffer(f)?f.toString("binary"):Ss(f));break;case"array":h=mo(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=ct(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ct(h):d.type=="binary"&&typeof Df<"u",h.slice(0,19)=="socialcalc:version:"?a5.to_sheet(d.type=="string"?h:ct(h),d):s(h,d)}function c(f,d){return _s(o(f,d),d)}function u(f){for(var d=[],h=Qe(f["!ref"]),p,m=Array.isArray(f),g=h.s.r;g<=h.e.r;++g){for(var y=[],v=h.s.c;v<=h.e.c;++v){var b=Fe({r:g,c:v});if(p=m?(f[g]||[])[v]:f[b],!p||p.v==null){y.push("          ");continue}for(var x=(p.w||(Ei(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";y.push(x+(v===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function k0e(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=r5.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return ic.to_workbook(e,t)}}var to=function(){function e(O,L,R){if(O){Tr(O,O.l||0);for(var X=R.Enum||Z;O.l<O.length;){var J=O.read_shift(2),le=X[J]||X[65535],se=O.read_shift(2),Q=O.l+se,te=le.f&&le.f(O,se,R);if(O.l=Q,L(te,le,J))return}}}function t(O,L){switch(L.type){case"base64":return r(Tn($n(O)),L);case"binary":return r(Tn(O),L);case"buffer":case"array":return r(O,L)}throw"Unsupported type "+L.type}function r(O,L){if(!O)return O;var R=L||{},X=R.dense?[]:{},J="Sheet1",le="",se=0,Q={},te=[],fe=[],P={s:{r:0,c:0},e:{r:0,c:0}},ke=R.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)R.Enum=Z,e(O,function(he,We,xt){switch(xt){case 0:R.vers=he,he>=4096&&(R.qpro=!0);break;case 6:P=he;break;case 204:he&&(le=he);break;case 222:le=he;break;case 15:case 51:R.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:xt==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=R.dateNF||Me[14],R.cellDates&&(he[1].t="d",he[1].v=qx(he[1].v))),R.qpro&&he[3]>se&&(X["!ref"]=Be(P),Q[J]=X,te.push(J),X=R.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},se=he[3],J=le||"Sheet"+(se+1),le="");var tr=R.dense?(X[he[0].r]||[])[he[0].c]:X[Fe(he[0])];if(tr){tr.t=he[1].t,tr.v=he[1].v,he[1].z!=null&&(tr.z=he[1].z),he[1].f!=null&&(tr.f=he[1].f);break}R.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[Fe(he[0])]=he[1];break}},R);else if(O[2]==26||O[2]==14)R.Enum=ee,O[2]==14&&(R.qpro=!0,O.l=0),e(O,function(he,We,xt){switch(xt){case 204:J=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>se&&(X["!ref"]=Be(P),Q[J]=X,te.push(J),X=R.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},se=he[3],J="Sheet"+(se+1)),ke>0&&he[0].r>=ke)break;R.dense?(X[he[0].r]||(X[he[0].r]=[]),X[he[0].r][he[0].c]=he[1]):X[Fe(he[0])]=he[1],P.e.c<he[0].c&&(P.e.c=he[0].c),P.e.r<he[0].r&&(P.e.r=he[0].r);break;case 27:he[14e3]&&(fe[he[14e3][0]]=he[14e3][1]);break;case 1537:fe[he[0]]=he[1],he[0]==se&&(J=he[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(X["!ref"]=Be(P),Q[le||J]=X,te.push(le||J),!fe.length)return{SheetNames:te,Sheets:Q};for(var be={},Te=[],Ae=0;Ae<fe.length;++Ae)Q[te[Ae]]?(Te.push(fe[Ae]||te[Ae]),be[fe[Ae]]=Q[fe[Ae]]||Q[te[Ae]]):(Te.push(fe[Ae]),be[fe[Ae]]={"!ref":"A1"});return{SheetNames:Te,Sheets:be}}function n(O,L){var R=L||{};if(+R.codepage>=0&&ja(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var X=gn(),J=Qe(O["!ref"]),le=Array.isArray(O),se=[];ye(X,0,i(1030)),ye(X,6,c(J));for(var Q=Math.min(J.e.r,8191),te=J.s.r;te<=Q;++te)for(var fe=Vt(te),P=J.s.c;P<=J.e.c;++P){te===J.s.r&&(se[P]=Pt(P));var ke=se[P]+fe,be=le?(O[te]||[])[P]:O[ke];if(!(!be||be.t=="z"))if(be.t=="n")(be.v|0)==be.v&&be.v>=-32768&&be.v<=32767?ye(X,13,p(te,P,be.v)):ye(X,14,g(te,P,be.v));else{var Te=Ei(be);ye(X,15,d(te,P,Te.slice(0,239)))}}return ye(X,1),X.end()}function a(O,L){var R=L||{};if(+R.codepage>=0&&ja(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var X=gn();ye(X,0,s(O));for(var J=0,le=0;J<O.SheetNames.length;++J)(O.Sheets[O.SheetNames[J]]||{})["!ref"]&&ye(X,27,D(O.SheetNames[J],le++));var se=0;for(J=0;J<O.SheetNames.length;++J){var Q=O.Sheets[O.SheetNames[J]];if(!(!Q||!Q["!ref"])){for(var te=Qe(Q["!ref"]),fe=Array.isArray(Q),P=[],ke=Math.min(te.e.r,8191),be=te.s.r;be<=ke;++be)for(var Te=Vt(be),Ae=te.s.c;Ae<=te.e.c;++Ae){be===te.s.r&&(P[Ae]=Pt(Ae));var he=P[Ae]+Te,We=fe?(Q[be]||[])[Ae]:Q[he];if(!(!We||We.t=="z"))if(We.t=="n")ye(X,23,E(be,Ae,se,We.v));else{var xt=Ei(We);ye(X,22,k(be,Ae,se,xt.slice(0,239)))}}++se}}return ye(X,1),X.end()}function i(O){var L=oe(2);return L.write_shift(2,O),L}function s(O){var L=oe(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var R=0,X=0,J=0,le=0;le<O.SheetNames.length;++le){var se=O.SheetNames[le],Q=O.Sheets[se];if(!(!Q||!Q["!ref"])){++J;var te=vn(Q["!ref"]);R<te.e.r&&(R=te.e.r),X<te.e.c&&(X=te.e.c)}}return R>8191&&(R=8191),L.write_shift(2,R),L.write_shift(1,J),L.write_shift(1,X),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(O,L,R){var X={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&R.qpro?(X.s.c=O.read_shift(1),O.l++,X.s.r=O.read_shift(2),X.e.c=O.read_shift(1),O.l++,X.e.r=O.read_shift(2),X):(X.s.c=O.read_shift(2),X.s.r=O.read_shift(2),L==12&&R.qpro&&(O.l+=2),X.e.c=O.read_shift(2),X.e.r=O.read_shift(2),L==12&&R.qpro&&(O.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function c(O){var L=oe(8);return L.write_shift(2,O.s.c),L.write_shift(2,O.s.r),L.write_shift(2,O.e.c),L.write_shift(2,O.e.r),L}function u(O,L,R){var X=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(X[0].c=O.read_shift(1),X[3]=O.read_shift(1),X[0].r=O.read_shift(2),O.l+=2):(X[2]=O.read_shift(1),X[0].c=O.read_shift(2),X[0].r=O.read_shift(2)),X}function f(O,L,R){var X=O.l+L,J=u(O,L,R);if(J[1].t="s",R.vers==20768){O.l++;var le=O.read_shift(1);return J[1].v=O.read_shift(le,"utf8"),J}return R.qpro&&O.l++,J[1].v=O.read_shift(X-O.l,"cstr"),J}function d(O,L,R){var X=oe(7+R.length);X.write_shift(1,255),X.write_shift(2,L),X.write_shift(2,O),X.write_shift(1,39);for(var J=0;J<X.length;++J){var le=R.charCodeAt(J);X.write_shift(1,le>=128?95:le)}return X.write_shift(1,0),X}function h(O,L,R){var X=u(O,L,R);return X[1].v=O.read_shift(2,"i"),X}function p(O,L,R){var X=oe(7);return X.write_shift(1,255),X.write_shift(2,L),X.write_shift(2,O),X.write_shift(2,R,"i"),X}function m(O,L,R){var X=u(O,L,R);return X[1].v=O.read_shift(8,"f"),X}function g(O,L,R){var X=oe(13);return X.write_shift(1,255),X.write_shift(2,L),X.write_shift(2,O),X.write_shift(8,R,"f"),X}function y(O,L,R){var X=O.l+L,J=u(O,L,R);if(J[1].v=O.read_shift(8,"f"),R.qpro)O.l=X;else{var le=O.read_shift(2);_(O.slice(O.l,O.l+le),J),O.l+=le}return J}function v(O,L,R){var X=L&32768;return L&=-32769,L=(X?O:0)+(L>=8192?L-16384:L),(X?"":"$")+(R?Pt(L):Vt(L))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(O,L){Tr(O,0);for(var R=[],X=0,J="",le="",se="",Q="";O.l<O.length;){var te=O[O.l++];switch(te){case 0:R.push(O.read_shift(8,"f"));break;case 1:le=v(L[0].c,O.read_shift(2),!0),J=v(L[0].r,O.read_shift(2),!1),R.push(le+J);break;case 2:{var fe=v(L[0].c,O.read_shift(2),!0),P=v(L[0].r,O.read_shift(2),!1);le=v(L[0].c,O.read_shift(2),!0),J=v(L[0].r,O.read_shift(2),!1),R.push(fe+P+":"+le+J)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(O.read_shift(2));break;case 6:{for(var ke="";te=O[O.l++];)ke+=String.fromCharCode(te);R.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:Q=R.pop(),se=R.pop(),R.push(["AND","OR"][te-20]+"("+se+","+Q+")");break;default:if(te<32&&x[te])Q=R.pop(),se=R.pop(),R.push(se+x[te]+Q);else if(b[te]){if(X=b[te][1],X==69&&(X=O[O.l++]),X>R.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+R.join("|")+"|");return}var be=R.slice(-X);R.length-=X,R.push(b[te][0]+"("+be.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}R.length==1?L[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function w(O){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=O.read_shift(2),L[3]=O[O.l++],L[0].c=O[O.l++],L}function S(O,L){var R=w(O);return R[1].t="s",R[1].v=O.read_shift(L-4,"cstr"),R}function k(O,L,R,X){var J=oe(6+X.length);J.write_shift(2,O),J.write_shift(1,R),J.write_shift(1,L),J.write_shift(1,39);for(var le=0;le<X.length;++le){var se=X.charCodeAt(le);J.write_shift(1,se>=128?95:se)}return J.write_shift(1,0),J}function N(O,L){var R=w(O);R[1].v=O.read_shift(2);var X=R[1].v>>1;if(R[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return R[1].v=X,R}function j(O,L){var R=w(O),X=O.read_shift(4),J=O.read_shift(4),le=O.read_shift(2);if(le==65535)return X===0&&J===3221225472?(R[1].t="e",R[1].v=15):X===0&&J===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var se=le&32768;return le=(le&32767)-16446,R[1].v=(1-se*2)*(J*Math.pow(2,le+32)+X*Math.pow(2,le)),R}function E(O,L,R,X){var J=oe(14);if(J.write_shift(2,O),J.write_shift(1,R),J.write_shift(1,L),X==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var le=0,se=0,Q=0,te=0;return X<0&&(le=1,X=-X),se=Math.log2(X)|0,X/=Math.pow(2,se-31),te=X>>>0,te&2147483648||(X/=2,++se,te=X>>>0),X-=te,te|=2147483648,te>>>=0,X*=Math.pow(2,32),Q=X>>>0,J.write_shift(4,Q),J.write_shift(4,te),se+=16383+(le?32768:0),J.write_shift(2,se),J}function A(O,L){var R=j(O);return O.l+=L-14,R}function T(O,L){var R=w(O),X=O.read_shift(4);return R[1].v=X>>6,R}function F(O,L){var R=w(O),X=O.read_shift(8,"f");return R[1].v=X,R}function G(O,L){var R=F(O);return O.l+=L-10,R}function M(O,L){return O[O.l+L-1]==0?O.read_shift(L,"cstr"):""}function W(O,L){var R=O[O.l++];R>L-1&&(R=L-1);for(var X="";X.length<R;)X+=String.fromCharCode(O[O.l++]);return X}function Y(O,L,R){if(!(!R.qpro||L<21)){var X=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var J=O.read_shift(L-21,"cstr");return[X,J]}}function K(O,L){for(var R={},X=O.l+L;O.l<X;){var J=O.read_shift(2);if(J==14e3){for(R[J]=[0,""],R[J][0]=O.read_shift(2);O[O.l];)R[J][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return R}function D(O,L){var R=oe(5+O.length);R.write_shift(2,14e3),R.write_shift(2,L);for(var X=0;X<O.length;++X){var J=O.charCodeAt(X);R[R.l++]=J>127?95:J}return R[R.l++]=0,R}var Z={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function N0e(e){var t={},r=e.match(Qr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=De(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=aw[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var j0e=function(){var e=$f("t"),t=$f("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Ye(s[1])},c=i.match(t);return c&&(o.s=N0e(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),E0e=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),T0e=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,A0e=/<(?:\w+:)?r>/,O0e=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Tw(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ye(ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ct(e),r&&(n.h=pw(n.t))):e.match(A0e)&&(n.r=ct(e),n.t=Ye(ct((e.replace(O0e,"").match(T0e)||[]).join("").replace(Qr,""))),r&&(n.h=E0e(j0e(n.r)))),n):{t:""}}var C0e=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,P0e=/<(?:\w+:)?(?:si|sstItem)>/g,M0e=/<\/(?:\w+:)?(?:si|sstItem)>/;function F0e(e,t){var r=[],n="";if(!e)return r;var a=e.match(C0e);if(a){n=a[2].replace(P0e,"").split(M0e);for(var i=0;i!=n.length;++i){var s=Tw(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=De(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var D0e=/^\s|\s$|[\t\n\r]/;function i5(e,t){if(!t.bookSST)return"";var r=[Gt];r[r.length]=ve("sst",null,{xmlns:Ao[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(D0e)&&(i+=' xml:space="preserve"'),i+=">"+at(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function I0e(e){return[e.read_shift(4),e.read_shift(4)]}function R0e(e,t){var r=[],n=!1;return Fi(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function $0e(e,t){return t||(t=oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var L0e=qce;function B0e(e){var t=gn();de(t,159,$0e(e));for(var r=0;r<e.length;++r)de(t,19,L0e(e[r]));return de(t,160),t.end()}function s5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function yi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function U0e(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=yi(e,4),t.U=yi(e,4),t.W=yi(e,4),t}function z0e(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function W0e(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(z0e(e));return t}function H0e(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function V0e(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=yi(e,4),t.U=yi(e,4),t.W=yi(e,4),t}function G0e(e){var t=V0e(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function o5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function l5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function X0e(e){var t=yi(e);switch(t.Minor){case 2:return[t.Minor,K0e(e)];case 3:return[t.Minor,q0e()];case 4:return[t.Minor,Y0e(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function K0e(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=o5(e,r),a=l5(e,e.length-e.l);return{t:"Std",h:n,v:a}}function q0e(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Y0e(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Qr,function(i){var s=De(i);switch(ti(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Q0e(e,t){var r={},n=r.EncryptionVersionInfo=yi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=o5(e,a),t-=a,r.EncryptionVerifier=l5(e,t),r}function Z0e(e){var t={},r=t.EncryptionVersionInfo=yi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Aw(e){var t=0,r,n=s5(e),a=n.length+1,i,s,o,c,u;for(r=ss(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var c5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var f=s[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(s){for(var o=s5(s),c=i(o),u=o.length,f=ss(16),d=0;d!=16;++d)f[d]=0;var h,p,m;for((u&1)===1&&(h=c>>8,f[u]=a(e[0],h),--u,h=c&255,p=o[o.length-1],f[u]=a(p,h));u>0;)--u,h=c>>8,f[u]=a(o[u],h),--u,h=c&255,f[u]=a(o[u],h);for(u=15,m=15-o.length;m>0;)h=c>>8,f[u]=a(e[m],h),--u,--m,h=c&255,f[u]=a(o[u],h),--u,--m;return f}}(),J0e=function(e,t,r,n,a){a||(a=t),n||(n=c5(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},ede=function(e){var t=0,r=c5(e);return function(n){var a=J0e("",n,t,r);return t=a[1],a[0]}};function tde(e,t,r,n){var a={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(a.verifier=Aw(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=ede(r.password)),a}function rde(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Z0e(e):n.Data=Q0e(e,t),n}function nde(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?rde(e,t-2,n):tde(e,r.biff>=8?t:t-2,r,n),n}var u5=function(){function e(a,i){switch(i.type){case"base64":return t($n(a),i);case"binary":return t(a,i);case"buffer":return t(Ve&&Buffer.isBuffer(a)?a.toString("binary"):Ss(a),i);case"array":return t(mo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,m,g=-1;m=h.exec(f);){switch(m[0]){case"\\cell":var y=f.slice(p,h.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[d][g]=v:o[Fe({r:d,c:g})]=v}break}p=h.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=Be(u),o}function r(a,i){return _s(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Qe(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=Fe({r:u,c:f});o=c?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ei(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function ade(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function zf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function ide(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function sde(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function wp(e,t){if(t===0)return e;var r=ide(ade(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),zf(sde(r))}var f5=6,ode=15,lde=1,Vr=f5;function Wf(e){return Math.floor((e+Math.round(128/Vr)/256)*Vr)}function Hf(e){return Math.floor((e-5)/Vr*100+.5)/100}function Sp(e){return Math.round((e*Vr+5)/Vr*256)/256}function fg(e){return Sp(Hf(Wf(e)))}function Ow(e){var t=Math.abs(e-fg(e)),r=Vr;if(t>.005)for(Vr=lde;Vr<ode;++Vr)Math.abs(e-fg(e))<=t&&(t=Math.abs(e-fg(e)),r=Vr);Vr=r}function os(e){e.width?(e.wpx=Wf(e.width),e.wch=Hf(e.wpx),e.MDW=Vr):e.wpx?(e.wch=Hf(e.wpx),e.width=Sp(e.wch),e.MDW=Vr):typeof e.wch=="number"&&(e.width=Sp(e.wch),e.wpx=Wf(e.width),e.MDW=Vr),e.customWidth&&delete e.customWidth}var cde=96,d5=cde;function Vf(e){return e*96/d5}function sc(e){return e*d5/96}var ude={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function fde(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Qr)||[]).forEach(function(s){var o=De(s);switch(ti(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=bt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function dde(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Qr)||[]).forEach(function(s){var o=De(s);switch(ti(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function hde(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Qr)||[]).forEach(function(s){var o=De(s);switch(ti(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ct(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?bt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?bt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?bt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?bt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?bt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?bt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?bt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=aw[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=bt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Js[a.color.index];a.color.index==81&&(c=Js[1]),c||(c=Js[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=wp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function pde(e,t,r){t.NumberFmt=[];for(var n=Ut(Me),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Me[n[a]];var i=e[0].match(Qr);if(i)for(a=0;a<i.length;++a){var s=De(i[a]);switch(ti(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ye(ct(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}vi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function xde(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ve("numFmt",null,{numFmtId:n,formatCode:at(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ve("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var md=["numFmtId","fillId","fontId","borderId","xfId"],gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function mde(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Qr)||[]).forEach(function(i){var s=De(i),o=0;switch(ti(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<md.length;++o)n[md[o]]&&(n[md[o]]=parseInt(n[md[o]],10));for(o=0;o<gd.length;++o)n[gd[o]]&&(n[gd[o]]=bt(n[gd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=bt(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function gde(e){var t=[];return t[t.length]=ve("cellXfs",null),e.forEach(function(r){t[t.length]=ve("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ve("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var vde=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&pde(d,f,u),(d=o.match(a))&&hde(d,f,c,u),(d=o.match(n))&&dde(d,f,c,u),(d=o.match(i))&&fde(d,f,c,u),(d=o.match(r))&&mde(d,f,u),f}}();function h5(e,t){var r=[Gt,ve("styleSheet",null,{xmlns:Ao[0],"xmlns:vt":or.vt})],n;return e.SSF&&(n=xde(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=gde(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function yde(e,t){var r=e.read_shift(2),n=Kr(e);return[r,n]}function bde(e,t,r){r||(r=oe(6+4*t.length)),r.write_shift(2,e),wr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function wde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=rue(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=tue(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Kr(e),n}function Sde(e,t){t||(t=oe(25+4*32)),t.write_shift(2,e.sz*20),nue(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),vp(e.color,t);var n=0;return n=2,t.write_shift(1,n),wr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _de=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],dg,kde=Yr;function Qj(e,t){t||(t=oe(4*3+8*7+16*1)),dg||(dg=Xx(_de));var r=dg[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(vp({auto:1},t),vp({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Nde(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function p5(e,t,r){r||(r=oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ru(e,t){return t||(t=oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var jde=Yr;function Ede(e,t){return t||(t=oe(51)),t.write_shift(1,0),ru(null,t),ru(null,t),ru(null,t),ru(null,t),ru(null,t),t.length>t.l?t.slice(0,t.l):t}function Tde(e,t){return t||(t=oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),gp(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Ade(e,t,r){var n=oe(2052);return n.write_shift(4,e),gp(t,n),gp(r,n),n.length>n.l?n.slice(0,n.l):n}function Ode(e,t,r){var n={};n.NumberFmt=[];for(var a in Me)n.NumberFmt[a]=Me[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Fi(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],vi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=wp(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(f);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function Cde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(de(e,615,Pa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&de(e,44,bde(a,t[a]))}),de(e,616))}}function Pde(e){var t=1;de(e,611,Pa(t)),de(e,43,Sde({sz:12,color:{theme:1},name:"Calibri",family:2})),de(e,612)}function Mde(e){var t=2;de(e,603,Pa(t)),de(e,45,Qj({patternType:"none"})),de(e,45,Qj({patternType:"gray125"})),de(e,604)}function Fde(e){var t=1;de(e,613,Pa(t)),de(e,46,Ede()),de(e,614)}function Dde(e){var t=1;de(e,626,Pa(t)),de(e,47,p5({numFmtId:0},65535)),de(e,627)}function Ide(e,t){de(e,617,Pa(t.length)),t.forEach(function(r){de(e,47,p5(r,0))}),de(e,618)}function Rde(e){var t=1;de(e,619,Pa(t)),de(e,48,Tde({xfId:0,name:"Normal"})),de(e,620)}function $de(e){var t=0;de(e,505,Pa(t)),de(e,506)}function Lde(e){var t=0;de(e,508,Ade(t,"TableStyleMedium9","PivotStyleMedium4")),de(e,509)}function Bde(e,t){var r=gn();return de(r,278),Cde(r,e.SSF),Pde(r),Mde(r),Fde(r),Dde(r),Ide(r,t.cellXfs),Rde(r),$de(r),Lde(r),de(r,279),r.end()}var Ude=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function zde(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Qr)||[]).forEach(function(a){var i=De(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ude.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Wde(){}function Hde(){}var Vde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Gde=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xde=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Kde(e,t,r){t.themeElements={};var n;[["clrScheme",Vde,zde],["fontScheme",Gde,Wde],["fmtScheme",Xde,Hde]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var qde=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function x5(e,t){(!e||e.length===0)&&(e=Cw());var r,n={};if(!(r=e.match(qde)))throw new Error("themeElements not found in theme");return Kde(r[0],n,t),n.raw=e,n}function Cw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Gt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Yde(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=oP(i,{type:"array"})}catch{return}var o=An(s,"theme/theme/theme1.xml",!0);if(o)return x5(o,r)}}function Qde(e){return e.read_shift(4)}function Zde(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Jde(e,4);break;case 2:t.xclrValue=KP(e);break;case 3:t.xclrValue=Qde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Jde(e,t){return Yr(e,t)}function ehe(e,t){return Yr(e,t)}function the(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Zde(e);break;case 6:n[1]=ehe(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function rhe(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(the(e,r-e.l));return{ixfe:n,ext:i}}function nhe(e,t){t.forEach(function(r){switch(r[0]){}})}function ahe(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Kr(e)}}function ihe(e){var t=oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),wr(e.name,t),t.slice(0,t.l)}function she(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ohe(e){var t=oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function lhe(e,t){var r=oe(8+2*t.length);return r.write_shift(4,e),wr(t,r),r.slice(0,r.l)}function che(e){return e.l+=4,e.read_shift(4)!=0}function uhe(e,t){var r=oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fhe(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return Fi(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function dhe(){var e=gn();return de(e,332),de(e,334,Pa(1)),de(e,335,ihe({name:"XLDAPR",version:12e4,flags:3496657072})),de(e,336),de(e,339,lhe(1,"XLDAPR")),de(e,52),de(e,35,Pa(514)),de(e,4096,Pa(0)),de(e,4097,qn(1)),de(e,36),de(e,53),de(e,340),de(e,337,uhe(1)),de(e,51,ohe([[1,0]])),de(e,338),de(e,333),e.end()}function hhe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Qr,function(o){var c=De(o);switch(ti(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function m5(){var e=[Gt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function phe(e){var t=[];if(!e)return t;var r=1;return(e.match(Qr)||[]).forEach(function(n){var a=De(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function xhe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Fe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function mhe(e,t,r){var n=[];return Fi(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function ghe(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Fi(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function vhe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var dl=1024;function g5(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ve("xml",null,{"xmlns:v":Nn.v,"xmlns:o":Nn.o,"xmlns:x":Nn.x,"xmlns:mv":Nn.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];dl<e*1e3;)dl+=1e3;return t.forEach(function(i){var s=Mt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ve("v:fill",c,o),f={on:"t",obscured:"t"};++dl,a=a.concat(["<v:shape"+Lf({id:"_x0000_s"+dl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ve("v:shadow",null,f),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ar("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Ar("x:AutoFill","False"),Ar("x:Row",String(s.r)),Ar("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Zj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Mt(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=Qe(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Be(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:r};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}i.c.push(f)})}function yhe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=De(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Mt(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Tw(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function v5(e){var t=[Gt,ve("comments",null,{xmlns:Ao[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=at(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(at(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Ar("t",at(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Ar("t",at(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function bhe(e,t){var r=[],n=!1,a={},i=0;return e.replace(Qr,function(o,c){var u=De(o);switch(ti(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function whe(e,t,r){var n=[Gt,ve("ThreadedComments",null,{xmlns:or.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(ve("threadedComment",Ar("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function She(e,t){var r=[],n=!1;return e.replace(Qr,function(i){var s=De(i);switch(ti(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function _he(e){var t=[Gt,ve("personList",null,{xmlns:or.TCMNT,"xmlns:x":Ao[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function khe(e){var t={};t.iauthor=e.read_shift(4);var r=Mo(e);return t.rfx=r.s,t.ref=Fe(r.s),e.l+=16,t}function Nhe(e,t){return t==null&&(t=oe(36)),t.write_shift(4,e[1].iauthor),Oc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var jhe=Kr;function Ehe(e){return wr(e.slice(0,54))}function The(e,t){var r=[],n=[],a={},i=!1;return Fi(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Ahe(e){var t=gn(),r=[];return de(t,628),de(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),de(t,632,Ehe(a.a)))})}),de(t,631),de(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Mt(n[0]),e:Mt(n[0])};de(t,635,Nhe([i,a])),a.t&&a.t.length>0&&de(t,637,Qce(a)),de(t,636),delete a.iauthor})}),de(t,634),de(t,629),t.end()}var Ohe="application/vnd.ms-office.vbaProject";function Che(e){var t=Oe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Oe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Oe.write(t)}function Phe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Oe.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var y5=["xlsb","xlsm","xlam","biff8","xla"];function Mhe(){return{"!type":"dialog"}}function Fhe(){return{"!type":"dialog"}}function Dhe(){return{"!type":"macro"}}function Ihe(){return{"!type":"macro"}}var kl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,a+(o?"":"$")+Pt(f)+(c?"":"$")+Vt(u)}return function(a,i){return t=i,a.replace(e,r)}}(),Pw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Mw=function(){return function(t,r){return t.replace(Pw,function(n,a,i,s,o,c){var u=yw(s)-(i?0:r.c),f=vw(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+d+"C"+h})}}();function b5(e,t){return e.replace(Pw,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Pt(yw(i)+t.c))+(s=="$"?s+o:Vt(vw(o)+t.r))})}function Rhe(e,t,r){var n=vn(t),a=n.s,i=Mt(r),s={r:i.r-a.r,c:i.c-a.c};return b5(e,s)}function $he(e){return e.length!=1}function Jj(e){return e.replace(/_xlfn\./g,"")}function qt(e){e.l+=1}function ls(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function w5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return S5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=ls(e),o=ls(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function S5(e){var t=ls(e),r=ls(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Lhe(e,t,r){if(r.biff<8)return S5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=ls(e),s=ls(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function _5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Bhe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ls(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Bhe(e){var t=ls(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Uhe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function zhe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Whe(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Whe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Hhe(e,t,r){var n=(e[e.l++]&96)>>5,a=w5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Vhe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=w5(e,i,r);return[n,a,s]}function Ghe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Xhe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Khe(e,t,r){var n=(e[e.l++]&96)>>5,a=Lhe(e,t-1,r);return[n,a]}function qhe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function e4(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Yhe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Qhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Zhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Jhe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function epe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function k5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function tpe(e){return e.read_shift(2),k5(e)}function rpe(e){return e.read_shift(2),k5(e)}function npe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=_5(e,0,r);return[n,a]}function ape(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=zhe(e,0,r);return[n,a]}function ipe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=_5(e,0,r);return[n,a,i]}function spe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[cxe[a],E5[a],n]}function ope(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:lpe(e);return[a,(i[0]===0?E5:lxe)[i[1]]]}function lpe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function cpe(e,t,r){e.l+=r&&r.biff==2?3:4}function upe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fpe(e){return e.l++,Di[e.read_shift(1)]}function dpe(e){return e.l++,e.read_shift(2)}function hpe(e){return e.l++,e.read_shift(1)!==0}function ppe(e){return e.l++,Gr(e)}function xpe(e,t,r){return e.l++,w0(e,t-1,r)}function mpe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Di[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Gr(e);break;case 2:r[1]=Fo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function gpe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Mo:Yx)(e));return a}function vpe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=mpe(e,r.biff);return s}function ype(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function bpe(e,t,r){if(r.biff==5)return wpe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function wpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Spe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _pe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kpe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Npe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var jpe=Yr,Epe=Yr,Tpe=Yr;function _0(e,t,r){return e.l+=2,[Uhe(e)]}function Fw(e){return e.l+=6,[]}var Ape=_0,Ope=Fw,Cpe=Fw,Ppe=_0;function N5(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var Mpe=_0,Fpe=N5,Dpe=Fw,Ipe=_0,Rpe=_0,$pe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Lpe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=$pe[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Bpe(e){return e.l+=2,[e.read_shift(4)]}function Upe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function zpe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Wpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Hpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Vpe(e){return e.l+=4,[0,0]}var t4={1:{n:"PtgExp",f:upe},2:{n:"PtgTbl",f:Tpe},3:{n:"PtgAdd",f:qt},4:{n:"PtgSub",f:qt},5:{n:"PtgMul",f:qt},6:{n:"PtgDiv",f:qt},7:{n:"PtgPower",f:qt},8:{n:"PtgConcat",f:qt},9:{n:"PtgLt",f:qt},10:{n:"PtgLe",f:qt},11:{n:"PtgEq",f:qt},12:{n:"PtgGe",f:qt},13:{n:"PtgGt",f:qt},14:{n:"PtgNe",f:qt},15:{n:"PtgIsect",f:qt},16:{n:"PtgUnion",f:qt},17:{n:"PtgRange",f:qt},18:{n:"PtgUplus",f:qt},19:{n:"PtgUminus",f:qt},20:{n:"PtgPercent",f:qt},21:{n:"PtgParen",f:qt},22:{n:"PtgMissArg",f:qt},23:{n:"PtgStr",f:xpe},26:{n:"PtgSheet",f:Upe},27:{n:"PtgEndSheet",f:zpe},28:{n:"PtgErr",f:fpe},29:{n:"PtgBool",f:hpe},30:{n:"PtgInt",f:dpe},31:{n:"PtgNum",f:ppe},32:{n:"PtgArray",f:qhe},33:{n:"PtgFunc",f:spe},34:{n:"PtgFuncVar",f:ope},35:{n:"PtgName",f:ype},36:{n:"PtgRef",f:npe},37:{n:"PtgArea",f:Hhe},38:{n:"PtgMemArea",f:Spe},39:{n:"PtgMemErr",f:jpe},40:{n:"PtgMemNoMem",f:Epe},41:{n:"PtgMemFunc",f:_pe},42:{n:"PtgRefErr",f:kpe},43:{n:"PtgAreaErr",f:Ghe},44:{n:"PtgRefN",f:ape},45:{n:"PtgAreaN",f:Khe},46:{n:"PtgMemAreaN",f:Wpe},47:{n:"PtgMemNoMemN",f:Hpe},57:{n:"PtgNameX",f:bpe},58:{n:"PtgRef3d",f:ipe},59:{n:"PtgArea3d",f:Vhe},60:{n:"PtgRefErr3d",f:Npe},61:{n:"PtgAreaErr3d",f:Xhe},255:{}},Gpe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Xpe={1:{n:"PtgElfLel",f:N5},2:{n:"PtgElfRw",f:Ipe},3:{n:"PtgElfCol",f:Ape},6:{n:"PtgElfRwV",f:Rpe},7:{n:"PtgElfColV",f:Ppe},10:{n:"PtgElfRadical",f:Mpe},11:{n:"PtgElfRadicalS",f:Dpe},13:{n:"PtgElfColS",f:Ope},15:{n:"PtgElfColSV",f:Cpe},16:{n:"PtgElfRadicalLel",f:Fpe},25:{n:"PtgList",f:Lpe},29:{n:"PtgSxName",f:Bpe},255:{}},Kpe={0:{n:"PtgAttrNoop",f:Vpe},1:{n:"PtgAttrSemi",f:epe},2:{n:"PtgAttrIf",f:Zhe},4:{n:"PtgAttrChoose",f:Yhe},8:{n:"PtgAttrGoto",f:Qhe},16:{n:"PtgAttrSum",f:cpe},32:{n:"PtgAttrBaxcel",f:e4},33:{n:"PtgAttrBaxcel",f:e4},64:{n:"PtgAttrSpace",f:tpe},65:{n:"PtgAttrSpaceSemi",f:rpe},128:{n:"PtgAttrIfError",f:Jhe},255:{}};function k0(e,t,r,n){if(n.biff<8)return Yr(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=vpe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=gpe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Yr(e,t)),i}function N0(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=t4[i]||t4[Gpe[i]],(i===24||i===25)&&(a=(i===24?Xpe:Kpe)[e[e.l+1]]),!a||!a.f?Yr(e,t):s.push([a.n,a.f(e,t,r)]);return s}function qpe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Ype={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Qpe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function j5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function r4(e,t,r){var n=j5(e,t,r);return n=="#REF"?n:Qpe(n,r)}function zr(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,u,f,d=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,b=e[0].length;v<b;++v){var x=e[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=Lt(" ",e[0][g][1][1]);break;case 1:y=Lt("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+Ype[x[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Tu(x[1][1],s,a),o.push(Au(f,i));break;case"PtgRefN":f=r?Tu(x[1][1],r,a):x[1][1],o.push(Au(f,i));break;case"PtgRef3d":d=x[1][1],f=Tu(x[1][2],s,a),m=r4(n,d,a),o.push(m+"!"+Au(f,i));break;case"PtgFunc":case"PtgFuncVar":var _=x[1][0],w=x[1][1];_||(_=0),_&=127;var S=_==0?[]:o.slice(-_);o.length-=_,w==="User"&&(w=S.shift()),o.push(w+"("+S.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Cj(x[1][1],r?{s:r}:s,a),o.push(lg(p,a));break;case"PtgArea":p=Cj(x[1][1],s,a),o.push(lg(p,a));break;case"PtgArea3d":d=x[1][1],p=x[1][2],m=r4(n,d,a),o.push(m+"!"+lg(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],N=k?k.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var j=x[1][1];h=x[1][2];var E;if(a.biff<=5)j<0&&(j=-j),n[j]&&(E=n[j][h]);else{var A="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][h]&&n[j][h].itab>0&&(A=n.SheetNames[n[j][h].itab-1]+"!"):A=n.SheetNames[h-1]+"!"),n[j]&&n[j][h])A+=n[j][h].Name;else if(n[0]&&n[0][h])A+=n[0][h].Name;else{var T=(j5(n,j,a)||"").split(";;");T[h-1]?A=T[h-1]:A+="SH33TJSERRX"}o.push(A);break}E||(E={Name:"SH33TJSERRY"}),o.push(E.Name);break;case"PtgParen":var F="(",G=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:F=Lt(" ",e[0][g][1][1])+F;break;case 3:F=Lt("\r",e[0][g][1][1])+F;break;case 4:G=Lt(" ",e[0][g][1][1])+G;break;case 5:G=Lt("\r",e[0][g][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(F+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var M={c:r.c,r:r.r};if(n.sharedf[Fe(f)]){var W=n.sharedf[Fe(f)];o.push(zr(W,s,M,n,a))}else{var Y=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(zr(u[1],s,M,n,a)),Y=!0;break}Y||o.push(x[1])}break;case"PtgArray":o.push("{"+qpe(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&K.indexOf(e[0][v][0])==-1){x=e[0][g];var D=!0;switch(x[1][0]){case 4:D=!1;case 0:y=Lt(" ",x[1][1]);break;case 5:D=!1;case 1:y=Lt("\r",x[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((D?y:"")+o.pop()+(D?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Zpe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Yr(e,t-2)];var o=N0(e,s,r);return t!==s+a&&(i=k0(e,t-s-a,o,r)),e.l=n,[o,i]}function Jpe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Yr(e,t-2)];var o=N0(e,s,r);return t!==s+a&&(i=k0(e,t-s-a,o,r)),e.l=n,[o,i]}function exe(e,t,r,n){var a=e.l+t,i=N0(e,n,r),s;return a!==e.l&&(s=k0(e,a-e.l,i,r)),[i,s]}function txe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=N0(e,i,r);return i==65535?[[],Yr(e,t-2)]:(t!==i+2&&(a=k0(e,n-i-2,s,r)),[s,a])}function rxe(e){var t;if(hi(e,e.l+6)!==65535)return[Gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function nxe(e){if(e==null){var t=oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return go(e);return go(0)}function hg(e,t,r){var n=e.l+t,a=ri(e);r.biff==2&&++e.l;var i=rxe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Jpe(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function axe(e,t,r,n,a){var i=yo(t,r,a),s=nxe(e.v),o=oe(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=oe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=yr([i,s,o,u]);return d}function Qx(e,t,r){var n=e.read_shift(4),a=N0(e,n,r),i=e.read_shift(4),s=i>0?k0(e,i,a,r):null;return[a,s]}var ixe=Qx,Zx=Qx,sxe=Qx,oxe=Qx,lxe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},E5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cxe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function n4(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function uxe(e){var t="of:="+e.replace(Pw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function pg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function fxe(e){return e.replace(/\./,"!")}var Cu={},Nl={},Pu=typeof Map<"u";function Dw(e,t,r){var n=0,a=e.length;if(r){if(Pu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Pu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Pu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Jx(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Vr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Hf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Sp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ro(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ks(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){vi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function T5(e,t,r,n,a,i){try{n.cellNF&&(e.z=Me[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=St(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Me[t]==null&&vi(lce[t]||"General",t),e.t==="e")e.w=e.w||Di[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v);else if(e.t==="d"){var s=fr(e.v);(s|0)===s?e.w=s.toString(10):e.w=Rf(s)}else{if(e.v===void 0)return"";e.w=xo(e.v,Nl)}else e.t==="d"?e.w=ua(t,fr(e.v),Nl):e.w=ua(t,e.v,Nl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=wp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=wp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function dxe(e,t,r){if(e&&e["!ref"]){var n=Qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function hxe(e,t){var r=Qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var pxe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,xxe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,mxe=/<(?:\w:)?hyperlink [^>]*>/mg,gxe=/"(\w*:\w*)"/,vxe=/<(?:\w:)?col\b[^>]*[\/]?>/g,yxe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bxe=/<(?:\w:)?pageMargins[^>]*\/>/g,A5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,wxe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Sxe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _xe(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(xxe);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(A5);h?Iw(h[0],o,a,r):(h=u.match(wxe))&&Nxe(h[0],h[1]||"",o,a,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=u.slice(p,p+50).match(gxe);m&&hxe(o,m[1])}var g=u.match(Sxe);g&&g[1]&&$xe(g[1],a);var y=[];if(t.cellStyles){var v=u.match(vxe);v&&Mxe(y,v)}d&&Uxe(d[1],o,t,c,i,s);var b=f.match(yxe);b&&(o["!autofilter"]=Dxe(b[0]));var x=[],_=f.match(pxe);if(_)for(p=0;p!=_.length;++p)x[p]=Qe(_[p].slice(_[p].indexOf('"')+1));var w=f.match(mxe);w&&Oxe(o,w,n);var S=f.match(bxe);if(S&&(o["!margins"]=Cxe(De(S[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),t.sheetRows>0&&o["!ref"]){var k=Qe(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(k))}return y.length>0&&(o["!cols"]=y),x.length>0&&(o["!merges"]=x),o}function kxe(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Be(e[r])+'"/>';return t+"</mergeCells>"}function Iw(e,t,r,n){var a=De(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ye(ct(a.codeName)))}function Nxe(e,t,r,n,a){Iw(e.slice(0,e.indexOf(">")),r,n,a)}function jxe(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=Ha(at(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ve("outlinePr",null,u)}!i&&!o||(a[a.length]=ve("sheetPr",o,s))}var Exe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Txe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Axe(e){var t={sheet:1};return Exe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Txe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Aw(e.password).toString(16).toUpperCase()),ve("sheetProtection",null,t)}function Oxe(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=De(ct(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Ye(i.location))):(i.Target="#"+Ye(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Qe(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=Fe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function Cxe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Pxe(e){return ro(e),ve("pageMargins",null,e)}function Mxe(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=De(t[n],!0);a.hidden&&(a.hidden=bt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Ow(a.width)),os(a);i<=s;)e[i++]=_t(a)}}function Fxe(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ve("col",null,Jx(a,n)));return r[r.length]="</cols>",r.join("")}function Dxe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Ixe(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Be(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=vn(a);s.s.r==s.e.r&&(s.e.r=vn(t["!ref"]).e.r,a=Be(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ve("autoFilter",null,{ref:a})}var Rxe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function $xe(e,t){t.Views||(t.Views=[{}]),(e.match(Rxe)||[]).forEach(function(r,n){var a=De(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),bt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Lxe(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,a),{})}function Bxe(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Di[e.v];break;case"d":n&&n.cellDates?a=St(e.v,-1).toISOString():(e=_t(e),e.t="n",a=""+(e.v=fr(St(e.v)))),typeof e.z>"u"&&(e.z=Me[14]);break;default:a=e.v;break}var o=Ar("v",at(a)),c={r:t},u=ks(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ar("v",""+Dw(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ve("f",at(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ve("c",o,c)}var Uxe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=$f("v"),s=$f("f");return function(c,u,f,d,h,p){for(var m=0,g="",y=[],v=[],b=0,x=0,_=0,w="",S,k,N=0,j=0,E,A,T=0,F=0,G=Array.isArray(p.CellXf),M,W=[],Y=[],K=Array.isArray(u),D=[],Z={},ee=!1,O=!!f.sheetStubs,L=c.split(t),R=0,X=L.length;R!=X;++R){g=L[R].trim();var J=g.length;if(J!==0){var le=0;e:for(m=0;m<J;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(k=De(g.slice(le,m),!0),N=k.r!=null?parseInt(k.r,10):N+1,j=-1,f.sheetRows&&f.sheetRows<N)continue;Z={},ee=!1,k.ht&&(ee=!0,Z.hpt=parseFloat(k.ht),Z.hpx=sc(Z.hpt)),k.hidden=="1"&&(ee=!0,Z.hidden=!0),k.outlineLevel!=null&&(ee=!0,Z.level=+k.outlineLevel),ee&&(D[N-1]=Z)}break;case"<":le=m;break}if(le>=m)break;if(k=De(g.slice(le,m),!0),N=k.r!=null?parseInt(k.r,10):N+1,j=-1,!(f.sheetRows&&f.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),f&&f.cellStyles&&(Z={},ee=!1,k.ht&&(ee=!0,Z.hpt=parseFloat(k.ht),Z.hpx=sc(Z.hpt)),k.hidden=="1"&&(ee=!0,Z.hidden=!0),k.outlineLevel!=null&&(ee=!0,Z.level=+k.outlineLevel),ee&&(D[N-1]=Z)),y=g.slice(m).split(e);for(var se=0;se!=y.length&&y[se].trim().charAt(0)=="<";++se);for(y=y.slice(se),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(v=g.match(r),b=m,x=0,_=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(b=0,w=v[1],x=0;x!=w.length&&!((_=w.charCodeAt(x)-64)<1||_>26);++x)b=26*b+_;--b,j=b}else++j;for(x=0;x!=g.length&&g.charCodeAt(x)!==62;++x);if(++x,k=De(g.slice(0,x),!0),k.r||(k.r=Fe({r:N-1,c:j})),w=g.slice(x),S={t:""},(v=w.match(i))!=null&&v[1]!==""&&(S.v=Ye(v[1])),f.cellFormula){if((v=w.match(s))!=null&&v[1]!==""){if(S.f=Ye(ct(v[1])).replace(/\r\n/g,`
`),f.xlfn||(S.f=Jj(S.f)),v[0].indexOf('t="array"')>-1)S.F=(w.match(a)||[])[1],S.F.indexOf(":")>-1&&W.push([Qe(S.F),S.F]);else if(v[0].indexOf('t="shared"')>-1){A=De(v[0]);var Q=Ye(ct(v[1]));f.xlfn||(Q=Jj(Q)),Y[parseInt(A.si,10)]=[A,Q,k.r]}}else(v=w.match(/<f[^>]*\/>/))&&(A=De(v[0]),Y[A.si]&&(S.f=Rhe(Y[A.si][1],Y[A.si][2],k.r)));var te=Mt(k.r);for(x=0;x<W.length;++x)te.r>=W[x][0].s.r&&te.r<=W[x][0].e.r&&te.c>=W[x][0].s.c&&te.c<=W[x][0].e.c&&(S.F=W[x][1])}if(k.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(O)S.t="z";else continue;else S.t=k.t||"n";switch(d.s.c>j&&(d.s.c=j),d.e.c<j&&(d.e.c=j),S.t){case"n":if(S.v==""||S.v==null){if(!O)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!O)continue;S.t="z"}else E=Cu[parseInt(S.v,10)],S.v=E.t,S.r=E.r,f.cellHTML&&(S.h=E.h);break;case"str":S.t="s",S.v=S.v!=null?ct(S.v):"",f.cellHTML&&(S.h=pw(S.v));break;case"inlineStr":v=w.match(n),S.t="s",v!=null&&(E=Tw(v[1]))?(S.v=E.t,f.cellHTML&&(S.h=E.h)):S.v="";break;case"b":S.v=bt(S.v);break;case"d":f.cellDates?S.v=St(S.v,1):(S.v=fr(St(S.v,1)),S.t="n");break;case"e":(!f||f.cellText!==!1)&&(S.w=S.v),S.v=CP[S.v];break}if(T=F=0,M=null,G&&k.s!==void 0&&(M=p.CellXf[k.s],M!=null&&(M.numFmtId!=null&&(T=M.numFmtId),f.cellStyles&&M.fillId!=null&&(F=M.fillId))),T5(S,T,F,f,h,p),f.cellDates&&G&&S.t=="n"&&Ec(Me[T])&&(S.t="d",S.v=qx(S.v)),k.cm&&f.xlmeta){var fe=(f.xlmeta.Cell||[])[+k.cm-1];fe&&fe.type=="XLDAPR"&&(S.D=!0)}if(K){var P=Mt(k.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=S}else u[k.r]=S}}}}D.length>0&&(u["!rows"]=D)}}();function zxe(e,t,r,n){var a=[],i=[],s=Qe(e["!ref"]),o="",c,u="",f=[],d=0,h=0,p=e["!rows"],m=Array.isArray(e),g={r:u},y,v=-1;for(h=s.s.c;h<=s.e.c;++h)f[h]=Pt(h);for(d=s.s.r;d<=s.e.r;++d){for(i=[],u=Vt(d),h=s.s.c;h<=s.e.c;++h){c=f[h]+u;var b=m?(e[d]||[])[h]:e[c];b!==void 0&&(o=Bxe(b,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[d])&&(g={r:u},p&&p[d]&&(y=p[d],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=Vf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=ve("row",i.join(""),g))}if(p)for(;d<p.length;++d)p&&p[d]&&(g={r:d+1},y=p[d],y.hidden&&(g.hidden=1),v=-1,y.hpx?v=Vf(y.hpx):y.hpt&&(v=y.hpt),v>-1&&(g.ht=v,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=ve("row","",g));return a.join("")}function O5(e,t,r,n){var a=[Gt,ve("worksheet",null,{xmlns:Ao[0],"xmlns:r":or.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",f=Qe(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Be(f)}n||(n={}),c["!comments"]=[];var d=[];jxe(c,r,e,t,a),a[a.length]=ve("dimension",null,{ref:u}),a[a.length]=Lxe(c,t,e,r),t.sheetFormat&&(a[a.length]=ve("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Fxe(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=zxe(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=Axe(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Ixe(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=kxe(c["!merges"]));var h=-1,p,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=nt(n,-1,at(g[1].Target).replace(/#.*$/,""),Ge.HLINK),p["r:id"]="rId"+m),(h=g[1].Target.indexOf("#"))>-1&&(p.location=at(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=at(g[1].Tooltip)),a[a.length]=ve("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Pxe(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Ar("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(m=nt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ge.DRAW),a[a.length]=ve("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=d),c["!comments"].length>0&&(m=nt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML),a[a.length]=ve("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Wxe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Hxe(e,t,r){var n=oe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Vf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Fe(u)];m&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Vxe(e,t,r,n){var a=Hxe(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&de(e,0,a)}var Gxe=Mo,Xxe=Oc;function Kxe(){}function qxe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Zce(e),r}function Yxe(e,t,r){r==null&&(r=oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return vp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),jP(e,r),r.slice(0,r.l)}function Qxe(e){var t=xa(e);return[t]}function Zxe(e,t,r){return r==null&&(r=oe(8)),Oo(t,r)}function Jxe(e){var t=Co(e);return[t]}function eme(e,t,r){return r==null&&(r=oe(4)),Po(t,r)}function tme(e){var t=xa(e),r=e.read_shift(1);return[t,r,"b"]}function rme(e,t,r){return r==null&&(r=oe(9)),Oo(t,r),r.write_shift(1,e.v?1:0),r}function nme(e){var t=Co(e),r=e.read_shift(1);return[t,r,"b"]}function ame(e,t,r){return r==null&&(r=oe(5)),Po(t,r),r.write_shift(1,e.v?1:0),r}function ime(e){var t=xa(e),r=e.read_shift(1);return[t,r,"e"]}function sme(e,t,r){return r==null&&(r=oe(9)),Oo(t,r),r.write_shift(1,e.v),r}function ome(e){var t=Co(e),r=e.read_shift(1);return[t,r,"e"]}function lme(e,t,r){return r==null&&(r=oe(8)),Po(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function cme(e){var t=xa(e),r=e.read_shift(4);return[t,r,"s"]}function ume(e,t,r){return r==null&&(r=oe(12)),Oo(t,r),r.write_shift(4,t.v),r}function fme(e){var t=Co(e),r=e.read_shift(4);return[t,r,"s"]}function dme(e,t,r){return r==null&&(r=oe(8)),Po(t,r),r.write_shift(4,t.v),r}function hme(e){var t=xa(e),r=Gr(e);return[t,r,"n"]}function pme(e,t,r){return r==null&&(r=oe(16)),Oo(t,r),go(e.v,r),r}function C5(e){var t=Co(e),r=Gr(e);return[t,r,"n"]}function xme(e,t,r){return r==null&&(r=oe(12)),Po(t,r),go(e.v,r),r}function mme(e){var t=xa(e),r=_w(e);return[t,r,"n"]}function gme(e,t,r){return r==null&&(r=oe(12)),Oo(t,r),EP(e.v,r),r}function vme(e){var t=Co(e),r=_w(e);return[t,r,"n"]}function yme(e,t,r){return r==null&&(r=oe(8)),Po(t,r),EP(e.v,r),r}function bme(e){var t=xa(e),r=bw(e);return[t,r,"is"]}function wme(e){var t=xa(e),r=Kr(e);return[t,r,"str"]}function Sme(e,t,r){return r==null&&(r=oe(12+4*e.v.length)),Oo(t,r),wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _me(e){var t=Co(e),r=Kr(e);return[t,r,"str"]}function kme(e,t,r){return r==null&&(r=oe(8+4*e.v.length)),Po(t,r),wr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Nme(e,t,r){var n=e.l+t,a=xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Zx(e,n-e.l,r);s[3]=zr(o,null,a,r.supbooks,r)}else e.l=n;return s}function jme(e,t,r){var n=e.l+t,a=xa(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Zx(e,n-e.l,r);s[3]=zr(o,null,a,r.supbooks,r)}else e.l=n;return s}function Eme(e,t,r){var n=e.l+t,a=xa(e);a.r=r["!row"];var i=Gr(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Zx(e,n-e.l,r);s[3]=zr(o,null,a,r.supbooks,r)}else e.l=n;return s}function Tme(e,t,r){var n=e.l+t,a=xa(e);a.r=r["!row"];var i=Kr(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Zx(e,n-e.l,r);s[3]=zr(o,null,a,r.supbooks,r)}else e.l=n;return s}var Ame=Mo,Ome=Oc;function Cme(e,t){return t==null&&(t=oe(4)),t.write_shift(4,e),t}function Pme(e,t){var r=e.l+t,n=Mo(e),a=ww(e),i=Kr(e),s=Kr(e),o=Kr(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function Mme(e,t){var r=oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Oc({s:Mt(e[0]),e:Mt(e[0])},r),Sw("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return wr(a||"",r),wr(e[1].Tooltip||"",r),wr("",r),r.slice(0,r.l)}function Fme(){}function Dme(e,t,r){var n=e.l+t,a=TP(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=ixe(e,n-e.l,r);s[1]=o}else e.l=n;return s}function Ime(e,t,r){var n=e.l+t,a=Mo(e),i=[a];if(r.cellFormula){var s=oxe(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function Rme(e,t,r){r==null&&(r=oe(18));var n=Jx(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var P5=["left","right","top","bottom","header","footer"];function $me(e){var t={};return P5.forEach(function(r){t[r]=Gr(e)}),t}function Lme(e,t){return t==null&&(t=oe(6*8)),ro(e),P5.forEach(function(r){go(e[r],t)}),t}function Bme(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Ume(e,t,r){r==null&&(r=oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function zme(e){var t=oe(24);return t.write_shift(4,4),t.write_shift(4,1),Oc(e,t),t}function Wme(e,t){return t==null&&(t=oe(16*4+2)),t.write_shift(2,e.password?Aw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Hme(){}function Vme(){}function Gme(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,m,g,y,v,b,x,_,w,S=[];o.biff=12,o["!row"]=0;var k=0,N=!1,j=[],E={},A=o.supbooks||a.supbooks||[[]];if(A.sharedf=E,A.arrayf=j,A.SheetNames=a.SheetNames||a.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=A,a.Names))for(var T=0;T<a.Names.length;++T)A[0][T+1]=a.Names[T];var F=[],G=[],M=!1;Gf[16]={n:"BrtShortReal",f:C5};var W;if(Fi(e,function(D,Z,ee){if(!h)switch(ee){case 148:u=D;break;case 0:p=D,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),_=Vt(y=p.r),o["!row"]=p.r,(D.hidden||D.hpt||D.level!=null)&&(D.hpt&&(D.hpx=sc(D.hpt)),G[D.r]=D);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:D[2]},D[2]){case"n":m.v=D[1];break;case"s":x=Cu[D[1]],m.v=x.t,m.r=x.r;break;case"b":m.v=!!D[1];break;case"e":m.v=D[1],o.cellText!==!1&&(m.w=Di[m.v]);break;case"str":m.t="s",m.v=D[1];break;case"is":m.t="s",m.v=D[1].t;break}if((g=s.CellXf[D[0].iStyleRef])&&T5(m,g.numFmtId,null,o,i,s),v=D[0].c==-1?v+1:D[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=m):c[Pt(v)+_]=m,o.cellFormula){for(N=!1,k=0;k<j.length;++k){var O=j[k];p.r>=O[0].s.r&&p.r<=O[0].e.r&&v>=O[0].s.c&&v<=O[0].e.c&&(m.F=Be(O[0]),N=!0)}!N&&D.length>3&&(m.f=D[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>v&&(f.s.c=v),f.e.r<p.r&&(f.e.r=p.r),f.e.c<v&&(f.e.c=v),o.cellDates&&g&&m.t=="n"&&Ec(Me[g.numFmtId])){var L=Ks(m.v);L&&(m.t="d",m.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}W&&(W.type=="XLDAPR"&&(m.D=!0),W=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;m={t:"z",v:void 0},v=D[0].c==-1?v+1:D[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=m):c[Pt(v)+_]=m,f.s.r>p.r&&(f.s.r=p.r),f.s.c>v&&(f.s.c=v),f.e.r<p.r&&(f.e.r=p.r),f.e.c<v&&(f.e.c=v),W&&(W.type=="XLDAPR"&&(m.D=!0),W=void 0);break;case 176:S.push(D);break;case 49:W=((o.xlmeta||{}).Cell||[])[D-1];break;case 494:var R=n["!id"][D.relId];for(R?(D.Target=R.Target,D.loc&&(D.Target+="#"+D.loc),D.Rel=R):D.relId==""&&(D.Target="#"+D.loc),y=D.rfx.s.r;y<=D.rfx.e.r;++y)for(v=D.rfx.s.c;v<=D.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=D):(b=Fe({c:v,r:y}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=D);break;case 426:if(!o.cellFormula)break;j.push(D),w=o.dense?c[y][v]:c[Pt(v)+_],w.f=zr(D[1],f,{r:p.r,c:v},A,o),w.F=Be(D[0]);break;case 427:if(!o.cellFormula)break;E[Fe(D[0].s)]=D[1],w=o.dense?c[y][v]:c[Pt(v)+_],w.f=zr(D[1],f,{r:p.r,c:v},A,o);break;case 60:if(!o.cellStyles)break;for(;D.e>=D.s;)F[D.e--]={width:D.w/256,hidden:!!(D.flags&1),level:D.level},M||(M=!0,Ow(D.w/256)),os(F[D.e+1]);break;case 161:c["!autofilter"]={ref:Be(D)};break;case 476:c["!margins"]=D;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),D.name&&(a.Sheets[r].CodeName=D.name),(D.above||D.left)&&(c["!outline"]={above:D.above,left:D.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),D.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Z.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Be(u||f)),o.sheetRows&&c["!ref"]){var Y=Qe(c["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>f.e.r&&(Y.e.r=f.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>f.e.c&&(Y.e.c=f.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(Y))}return S.length>0&&(c["!merges"]=S),F.length>0&&(c["!cols"]=F),G.length>0&&(c["!rows"]=G),c}function Xme(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=_t(t),t.z=t.z||Me[14],t.v=fr(St(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=ks(a.cellXfs,t,a),t.l&&i["!links"].push([Fe(c),t.l]),t.c&&i["!comments"].push([Fe(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Dw(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?de(e,18,dme(t,c)):de(e,7,ume(t,c))):(c.t="str",s?de(e,17,kme(t,c)):de(e,6,Sme(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?de(e,13,yme(t,c)):de(e,2,gme(t,c)):s?de(e,16,xme(t,c)):de(e,5,pme(t,c)),!0;case"b":return c.t="b",s?de(e,15,ame(t,c)):de(e,4,rme(t,c)),!0;case"e":return c.t="e",s?de(e,14,lme(t,c)):de(e,3,sme(t,c)),!0}return s?de(e,12,eme(t,c)):de(e,1,Zxe(t,c)),!0}function Kme(e,t,r,n){var a=Qe(t["!ref"]||"A1"),i,s="",o=[];de(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){s=Vt(f),Vxe(e,t,a,f);var d=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(o[h]=Pt(h)),i=o[h]+s;var p=c?(t[f]||[])[h]:t[i];if(!p){d=!1;continue}d=Xme(e,p,f,h,n,t,d)}}de(e,146)}function qme(e,t){!t||!t["!merges"]||(de(e,177,Cme(t["!merges"].length)),t["!merges"].forEach(function(r){de(e,176,Ome(r))}),de(e,178))}function Yme(e,t){!t||!t["!cols"]||(de(e,390),t["!cols"].forEach(function(r,n){r&&de(e,60,Rme(n,r))}),de(e,391))}function Qme(e,t){!t||!t["!ref"]||(de(e,648),de(e,649,zme(Qe(t["!ref"]))),de(e,650))}function Zme(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=nt(r,-1,n[1].Target.replace(/#.*$/,""),Ge.HLINK);de(e,494,Mme(n,a))}}),delete t["!links"]}function Jme(e,t,r,n){if(t["!comments"].length>0){var a=nt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);de(e,551,Sw("rId"+a)),t["!legacy"]=a}}function ege(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Be(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=vn(i);o.s.r==o.e.r&&(o.e.r=vn(t["!ref"]).e.r,i=Be(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),de(e,161,Oc(Qe(i))),de(e,162)}}function tge(e,t,r){de(e,133),de(e,137,Ume(t,r)),de(e,138),de(e,134)}function rge(e,t){t["!protect"]&&de(e,535,Wme(t["!protect"]))}function nge(e,t,r,n){var a=gn(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Qe(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],de(a,129),(r.vbaraw||s["!outline"])&&de(a,147,Yxe(o,s["!outline"])),de(a,148,Xxe(c)),tge(a,s,r.Workbook),Yme(a,s),Kme(a,s,e,t),rge(a,s),ege(a,s,r,e),qme(a,s),Zme(a,s,n),s["!margins"]&&de(a,476,Lme(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Qme(a,s),Jme(a,s,e,n),de(a,130),a.end()}function age(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Ye((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function ige(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=age(d);f.s.r=f.s.c=0,f.e.c=o,u=Pt(o),h[0].forEach(function(p,m){s[u+Vt(m)]={t:"n",v:p,z:h[1]},c=m}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Be(f)),s}function sge(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(A5);return o&&Iw(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function oge(e,t){e.l+=10;var r=Kr(e);return{name:r}}function lge(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Fi(e,function(c,u,f){switch(f){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Rw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uge=[],fge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function a4(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=bt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function i4(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function M5(e){i4(e.WBProps,Rw),i4(e.CalcPr,fge),a4(e.WBView,cge),a4(e.Sheets,uge),Nl.date1904=bt(e.WBProps.date1904)}function dge(e){return!e.Workbook||!e.Workbook.WBProps?"false":bt(e.Workbook.WBProps.date1904)?"true":"false"}var hge="][*?/\\".split("");function F5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hge.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pge(e,t,r){e.forEach(function(n,a){F5(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function xge(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];pge(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)dxe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var mge=/<\w+:workbook/;function gge(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Qr,function(c,u){var f=De(c);switch(ti(f[0])){case"<?xml":break;case"<workbook":c.match(mge)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Rw.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=bt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=ct(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ye(ct(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ct(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),bt(f.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=Ye(ct(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Ao.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return M5(r),r}function D5(e){var t=[Gt];t[t.length]=ve("workbook",null,{xmlns:Ao[0],"xmlns:r":or.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Rw.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ve("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:at(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=ve("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ve("definedName",at(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function vge(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=V1(e),r.name=Kr(e),r}function yge(e,t){return t||(t=oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Sw(e.strRelID,t),wr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function bge(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Kr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function wge(e,t){t||(t=oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),jP(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Sge(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function _ge(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Jce(e),s=sxe(e,0,r),o=ww(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function kge(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Gf[16]={n:"BrtFRTArchID$",f:Sge},Fi(e,function(c,u,f){switch(f){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=zr(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),M5(r),r.Names=i,r.supbooks=s,r}function Nge(e,t){de(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};de(e,156,yge(a))}de(e,144)}function jge(e,t){t||(t=oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return wr("SheetJS",t),wr(fp.version,t),wr(fp.version,t),wr("7262",t),t.length>t.l?t.slice(0,t.l):t}function Ege(e,t){t||(t=oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Tge(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(de(e,135),de(e,158,Ege(a)),de(e,136))}}function Age(e,t){var r=gn();return de(r,131),de(r,128,jge()),de(r,153,wge(e.Workbook&&e.Workbook.WBProps||null)),Tge(r,e),Nge(r,e),de(r,132),r.end()}function Oge(e,t,r){return t.slice(-4)===".bin"?kge(e,r):gge(e,r)}function Cge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Gme(e,n,r,a,i,s,o):_xe(e,n,r,a,i,s,o)}function Pge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?lge(e,n,r,a,i):sge(e,n,r,a,i)}function Mge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Dhe():Ihe()}function Fge(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Mhe():Fhe()}function Dge(e,t,r,n){return t.slice(-4)===".bin"?Ode(e,r,n):vde(e,r,n)}function Ige(e,t,r){return x5(e,r)}function Rge(e,t,r){return t.slice(-4)===".bin"?R0e(e,r):F0e(e,r)}function $ge(e,t,r){return t.slice(-4)===".bin"?The(e,r):yhe(e,r)}function Lge(e,t,r){return t.slice(-4)===".bin"?mhe(e):phe(e)}function Bge(e,t,r,n){return r.slice(-4)===".bin"?ghe(e,t,r,n):void 0}function Uge(e,t,r){return t.slice(-4)===".bin"?fhe(e,t,r):hhe(e,t,r)}function zge(e,t,r){return(t.slice(-4)===".bin"?Age:D5)(e)}function Wge(e,t,r,n,a){return(t.slice(-4)===".bin"?nge:O5)(e,r,n,a)}function Hge(e,t,r){return(t.slice(-4)===".bin"?Bde:h5)(e,r)}function Vge(e,t,r){return(t.slice(-4)===".bin"?B0e:i5)(e,r)}function Gge(e,t,r){return(t.slice(-4)===".bin"?Ahe:v5)(e)}function Xge(e){return(e.slice(-4)===".bin"?dhe:m5)()}var I5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,R5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ya(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(I5),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(R5),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Kge(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(I5),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(R5),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Mu;function qge(e,t){var r=Mu[e]||Ye(e);return r==="General"?xo(t):ua(r,t)}function Yge(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=bt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=St(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ye(t)]=a}function Qge(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Di[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v):e.w=xo(e.v):e.w=qge(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Mu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ec(n)){var a=Ks(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Zge(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=ude[n.Pattern]||n.Pattern)}e[t.ID]=t}function Jge(e,t,r,n,a,i,s,o,c,u){var f="General",d=n.StyleID,h={};u=u||{};var p=[],m=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(f=i[d].nf),i[d].Interior&&p.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=Sj(Ye(e)),n.v=e.indexOf("<")>-1?Ye(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(St(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ye(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=CP[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Sj(t||e));break}if(Qge(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=Ye(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=kl(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=kl("RC:RC",a):n.ArrayRange&&(n.F=kl(n.ArrayRange,a),c.push([Qe(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function eve(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function xg(e,t){var r=t||{};Tc();var n=lu(xw(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ct(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=_t(r);return s.type="string",ic.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){a.indexOf("<"+We)>=0&&(i=!0)}),i)return Lve(n,r);Mu={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],h=r.dense?[]:{},p="",m={},g={},y=ya('<Data ss:Type="String">'),v=0,b=0,x=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},S={},k="",N=0,j=[],E={},A={},T=0,F=[],G=[],M={},W=[],Y,K=!1,D=[],Z=[],ee={},O=0,L=0,R={Sheets:[],WBProps:{date1904:!1}},X={};Bf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Bf.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Jge(n.slice(v,o.index),k,y,c[c.length-1][0]=="comment"?M:m,{c:b,r:x},w,W[b],g,D,r):(k="",y=ya(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>x)&&m.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][b]=m):h[Pt(b)+Vt(x)]=m),m.HRef&&(m.l={Target:Ye(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(O=b+(parseInt(m.MergeAcross,10)|0),L=x+(parseInt(m.MergeDown,10)|0),j.push({s:{c:b,r:x},e:{c:O,r:L}})),!r.sheetStubs)m.MergeAcross?b=O+1:++b;else if(m.MergeAcross||m.MergeDown){for(var le=b;le<=O;++le)for(var se=x;se<=L;++se)(le>b||se>x)&&(r.dense?(h[se]||(h[se]=[]),h[se][le]={t:"z"}):h[Pt(le)+Vt(se)]={t:"z"});b=O+1}else++b;else m=Kge(o[0]),m.Index&&(b=+m.Index-1),b<_.s.c&&(_.s.c=b),b>_.e.c&&(_.e.c=b),o[0].slice(-2)==="/>"&&++b,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<_.s.r&&(_.s.r=x),x>_.e.r&&(_.e.r=x),o[0].slice(-2)==="/>"&&(g=ya(o[0]),g.Index&&(x=+g.Index-1)),b=0,++x):(g=ya(o[0]),g.Index&&(x=+g.Index-1),ee={},(g.AutoFitHeight=="0"||g.Height)&&(ee.hpx=parseInt(g.Height,10),ee.hpt=Vf(ee.hpx),Z[x]=ee),g.Hidden=="1"&&(ee.hidden=!0,Z[x]=ee));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Be(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Be(_))),j.length&&(h["!merges"]=j),W.length>0&&(h["!cols"]=W),Z.length>0&&(h["!rows"]=Z),f[p]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=b=0,c.push([o[3],!1]),u=ya(o[0]),p=Ye(u.Name),h=r.dense?[]:{},j=[],D=[],Z=[],X={name:p,Hidden:0},R.Sheets.push(X);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),W=[],K=!1}break;case"style":o[1]==="/"?Zge(w,S,r):S=ya(o[0]);break;case"numberformat":S.nf=Ye(ya(o[0]).Format||"General"),Mu[S.nf]&&(S.nf=Mu[S.nf]);for(var Q=0;Q!=392&&Me[Q]!=S.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Me[Q]==null){vi(S.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Y=ya(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!K&&Y.wpx>10){K=!0,Vr=f5;for(var te=0;te<W.length;++te)W[te]&&os(W[te])}K&&os(Y),W[Y.Index-1||W.length]=Y;for(var fe=0;fe<+Y.Span;++fe)W[W.length]=_t(Y);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var P=De(o[0]),ke={Name:P.Name,Ref:kl(P.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(ke.Sheet=R.Sheets.length-1),R.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=ya(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?kue(E,J,n.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));eve(M),G.push(M)}else c.push([o[3],!1]),u=ya(o[0]),M={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var be=ya(o[0]);h["!autofilter"]={ref:kl(be.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return u4(n,r);var Te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(T,o.index)){case"SheetHidden":X.Hidden=1;break;case"SheetVeryHidden":X.Hidden=2;break}else T=o.index+o[0].length;break;case"header":h["!margins"]||ro(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].header=+De(o[0]).Margin);break;case"footer":h["!margins"]||ro(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var Ae=De(o[0]);h["!margins"]||ro(h["!margins"]={},"xlml"),isNaN(+Ae.Top)||(h["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(h["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(h["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(h["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Yge(A,J,F,n.slice(T,o.index)):(F=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=f),he.SheetNames=d,he.Workbook=R,he.SSF=_t(Me),he.Props=E,he.Custprops=A,he}function Z1(e,t){switch(Lw(t=t||{}),t.type||"base64"){case"base64":return xg($n(e),t);case"binary":case"buffer":case"file":return xg(e,t);case"array":return xg(Ss(e),t)}}function tve(e,t){var r=[];return e.Props&&r.push(Nue(e.Props,t)),e.Custprops&&r.push(jue(e.Props,e.Custprops)),r.join("")}function rve(){return""}function nve(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(ve("NumberFormat",null,{"ss:Format":at(Me[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(ve("Style",i.join(""),s))}),ve("Styles",r.join(""))}function $5(e){return ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Mw(e.Ref,{r:0,c:0})})}function ave(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push($5(a)))}return ve("Names",r.join(""))}function ive(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push($5(o)))}return i.join("")}function sve(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ve("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Ar("ProtectContents","True")),e["!protect"].objects&&a.push(Ar("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Ar("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Ar("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Ar("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":ve("WorksheetOptions",a.join(""),{xmlns:Nn.x})}function ove(e){return e.map(function(t){var r=Tce(t.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":t.a})}).join("")}function lve(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+at(Mw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=Mt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=at(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=at(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=s.c||u[f].s.r!=s.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Di[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Me[14]);break;case"s":d="String",h=Ece(e.v||"");break}var p=ks(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var m=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+d+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=ove(e.c)),ve("Cell",g,o)}function cve(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=sc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uve(e,t,r,n){if(!e["!ref"])return"";var a=Qe(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,v){os(y);var b=!!y.width,x=Jx(v,y),_={"ss:Index":v+1};b&&(_["ss:Width"]=Wf(x.width)),y.hidden&&(_["ss:Hidden"]="1"),o.push(ve("Column",null,_))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[cve(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>u)&&!(i[s].e.c<d)&&!(i[s].e.r<u)){(i[s].s.c!=d||i[s].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:d},m=Fe(p),g=c?(e[u]||[])[d]:e[m];f.push(lve(g,m,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function fve(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?ive(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?uve(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(sve(i,t,e,r)),n.join("")}function dve(e,t){t||(t={}),e.SSF||(e.SSF=_t(Me)),e.SSF&&(Tc(),Gx(e.SSF),t.revssf=Kx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ks(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(tve(e,t)),r.push(rve()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ve("Worksheet",fve(n,t,e),{"ss:Name":at(e.SheetNames[n])}));return r[2]=nve(e,t),r[3]=ave(e),Gt+ve("Workbook",r.join(""),{xmlns:Nn.ss,"xmlns:o":Nn.o,"xmlns:x":Nn.x,"xmlns:ss":Nn.ss,"xmlns:dt":Nn.dt,"xmlns:html":Nn.html})}function hve(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=aue(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=iue(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pve=[60,1084,2066,2165,2175];function xve(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=hi(r,r.l),u=J1[c],f=0;u!=null&&pve.indexOf(c)>-1;)i=hi(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),s.push(o),r.l+=4+i,u=J1[c=hi(r,r.l)];var d=yr(s);Tr(d,0);var h=0;d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(h),h+=s[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function $a(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Me[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Di[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v):e.w=xo(e.v):e.w=ua(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Ec(Me[n]||String(n))){var a=Ks(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function vd(e,t,r){return{v:e,ixfe:t,t:r}}function mve(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",f={},d,h="",p,m,g,y,v={},b=[],x,_,w=[],S=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},j=function(Re){return Re<8?Js[Re]:Re<64&&S[Re-8]||Js[Re]},E=function(Re,mt,He){var Ke=mt.XF.data;if(!(!Ke||!Ke.patternType||!He||!He.cellStyles)){mt.s={},mt.s.patternType=Ke.patternType;var Tt;(Tt=zf(j(Ke.icvFore)))&&(mt.s.fgColor={rgb:Tt}),(Tt=zf(j(Ke.icvBack)))&&(mt.s.bgColor={rgb:Tt})}},A=function(Re,mt,He){if(!(ee>1)&&!(He.sheetRows&&Re.r>=He.sheetRows)){if(He.cellStyles&&mt.XF&&mt.XF.data&&E(Re,mt,He),delete mt.ixfe,delete mt.XF,d=Re,h=Fe(Re),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<s.s.r&&(s.s.r=Re.r),Re.c<s.s.c&&(s.s.c=Re.c),Re.r+1>s.e.r&&(s.e.r=Re.r+1),Re.c+1>s.e.c&&(s.e.c=Re.c+1),He.cellFormula&&mt.f){for(var Ke=0;Ke<b.length;++Ke)if(!(b[Ke][0].s.c>Re.c||b[Ke][0].s.r>Re.r)&&!(b[Ke][0].e.c<Re.c||b[Ke][0].e.r<Re.r)){mt.F=Be(b[Ke][0]),(b[Ke][0].s.c!=Re.c||b[Ke][0].s.r!=Re.r)&&delete mt.f,mt.f&&(mt.f=""+zr(b[Ke][1],s,Re,D,T));break}}He.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=mt):a[h]=mt}},T={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var F,G=[],M=[],W=[],Y=[],K=!1,D=[];D.SheetNames=T.snames,D.sharedf=T.sharedf,D.arrayf=T.arrayf,D.names=[],D.XTI=[];var Z=0,ee=0,O=0,L=[],R=[],X;T.codepage=1200,ja(1200);for(var J=!1;e.l<e.length-1;){var le=e.l,se=e.read_shift(2);if(se===0&&Z===10)break;var Q=e.l===e.length?0:e.read_shift(2),te=J1[se];if(te&&te.f){if(t.bookSheets&&Z===133&&se!==133)break;if(Z=se,te.r===2||te.r==12){var fe=e.read_shift(2);if(Q-=2,!T.enc&&fe!==se&&((fe&255)<<8|fe>>8)!==se)throw new Error("rt mismatch: "+fe+"!="+se);te.r==12&&(e.l+=10,Q-=10)}var P={};if(se===10?P=te.f(e,Q,T):P=xve(se,te,e,Q,T),ee==0&&[9,521,1033,2057].indexOf(Z)===-1)continue;switch(se){case 34:r.opts.Date1904=k.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=P;break;case 66:var ke=Number(P);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}ja(T.codepage=ke),J=!0;break;case 317:T.rrtabid=P;break;case 25:T.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:T.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(a["!type"]="dialog"),P.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),P.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:w.push(P);break;case 430:D.push([P]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(P);break;case 24:case 536:X={Name:P.Name,Ref:zr(P.rgce,s,null,D,T)},P.itab>0&&(X.Sheet=P.itab-1),D.names.push(X),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(R[P.itab-1]={ref:Be(P.rgce[0][0][1][2])});break;case 22:T.ExternCount=P;break;case 23:D.length==0&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(P),D.XTI=D.XTI.concat(P);break;case 2196:if(T.biff<8)break;X!=null&&(X.Comment=P[1]);break;case 18:a["!protect"]=P;break;case 19:P!==0&&T.WTF&&console.error("Password verifier: "+P);break;case 133:i[P.pos]=P,T.snames.push(P.name);break;case 10:{if(--ee)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Be(s),t.sheetRows&&t.sheetRows<=s.e.r){var be=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(s),s.e.r=be}s.e.r++,s.e.c++}G.length>0&&(a["!merges"]=G),M.length>0&&(a["!objects"]=M),W.length>0&&(a["!cols"]=W),Y.length>0&&(a["!rows"]=Y),k.Sheets.push(N)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),T.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(T.biff=5,J=!0,ja(T.codepage=28591)),T.biff==8&&P.BIFFVer==0&&P.dt==16&&(T.biff=2),ee++)break;if(a=t.dense?[]:{},T.biff<8&&!J&&(J=!0,ja(T.codepage=t.codepage||1252)),T.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-Q,name:u};i[Te.pos]=Te,T.snames.push(u)}else u=(i[le]||{name:""}).name;P.dt==32&&(a["!type"]="chart"),P.dt==64&&(a["!type"]="macro"),G=[],M=[],T.arrayf=b=[],W=[],Y=[],K=!1,N={Hidden:(i[le]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[P.r]||[])[P.c]:a[Fe({c:P.c,r:P.r})])&&++P.c,x={ixfe:P.ixfe,XF:w[P.ixfe]||{},v:P.val,t:"n"},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t);break;case 5:case 517:x={ixfe:P.ixfe,XF:w[P.ixfe],v:P.val,t:P.t},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t);break;case 638:x={ixfe:P.ixfe,XF:w[P.ixfe],v:P.rknum,t:"n"},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t);break;case 189:for(var Ae=P.c;Ae<=P.C;++Ae){var he=P.rkrec[Ae-P.c][0];x={ixfe:he,XF:w[he],v:P.rkrec[Ae-P.c][1],t:"n"},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:Ae,r:P.r},x,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){o=P;break}if(x=vd(P.val,P.cell.ixfe,P.tt),x.XF=w[x.ixfe],t.cellFormula){var We=P.formula;if(We&&We[0]&&We[0][0]&&We[0][0][0]=="PtgExp"){var xt=We[0][0][1][0],tr=We[0][0][1][1],zt=Fe({r:xt,c:tr});v[zt]?x.f=""+zr(P.formula,s,P.cell,D,T):x.F=((t.dense?(a[xt]||[])[tr]:a[zt])||{}).F}else x.f=""+zr(P.formula,s,P.cell,D,T)}O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A(P.cell,x,t),o=P}break;case 7:case 519:if(o)o.val=P,x=vd(P,o.cell.ixfe,"s"),x.XF=w[x.ixfe],t.cellFormula&&(x.f=""+zr(o.formula,s,o.cell,D,T)),O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(P);var kr=Fe(P[0].s);if(p=t.dense?(a[P[0].s.r]||[])[P[0].s.c]:a[kr],t.cellFormula&&p){if(!o||!kr||!p)break;p.f=""+zr(P[1],s,P[0],D,T),p.F=Be(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[Fe(o.cell)]=P[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Fe(o.cell)],(p||{}).f=""+zr(P[0],s,d,D,T)}}break;case 253:x=vd(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(x.h=c[P.isst].h),x.XF=w[x.ixfe],O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:P.ixfe,XF:w[P.ixfe],t:"z"},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t));break;case 190:if(t.sheetStubs)for(var Xt=P.c;Xt<=P.C;++Xt){var It=P.ixfe[Xt-P.c];x={ixfe:It,XF:w[It],t:"z"},O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:Xt,r:P.r},x,t)}break;case 214:case 516:case 4:x=vd(P.val,P.ixfe,"s"),x.XF=w[x.ixfe],O>0&&(x.z=L[x.ixfe>>8&63]),$a(x,t,r.opts.Date1904),A({c:P.c,r:P.r},x,t);break;case 0:case 512:ee===1&&(s=P);break;case 252:c=P;break;case 1054:if(T.biff==4){L[O++]=P[1];for(var Kt=0;Kt<O+163&&Me[Kt]!=P[1];++Kt);Kt>=163&&vi(P[1],O+163)}else vi(P[1],P[0]);break;case 30:{L[O++]=P;for(var Dr=0;Dr<O+163&&Me[Dr]!=P;++Dr);Dr>=163&&vi(P,O+163)}break;case 229:G=G.concat(P);break;case 93:M[P.cmo[0]]=T.lastobj=P;break;case 438:T.lastobj.TxO=P;break;case 127:T.lastobj.ImData=P;break;case 440:for(y=P[0].s.r;y<=P[0].e.r;++y)for(g=P[0].s.c;g<=P[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[Fe({c:g,r:y})],p&&(p.l=P[1]);break;case 2048:for(y=P[0].s.r;y<=P[0].e.r;++y)for(g=P[0].s.c;g<=P[0].e.c;++g)p=t.dense?(a[y]||[])[g]:a[Fe({c:g,r:y})],p&&p.l&&(p.l.Tooltip=P[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(a[P[0].r]||[])[P[0].c]:a[Fe(P[0])];var ma=M[P[2]];p||(t.dense?(a[P[0].r]||(a[P[0].r]=[]),p=a[P[0].r][P[0].c]={t:"z"}):p=a[Fe(P[0])]={t:"z"},s.e.r=Math.max(s.e.r,P[0].r),s.s.r=Math.min(s.s.r,P[0].r),s.e.c=Math.max(s.e.c,P[0].c),s.s.c=Math.min(s.s.c,P[0].c)),p.c||(p.c=[]),m={a:P[1],t:ma.TxO.t},p.c.push(m)}break;case 2173:nhe(w[P.ixfe],P.ext);break;case 125:{if(!T.cellStyles)break;for(;P.e>=P.s;)W[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},K||(K=!0,Ow(P.w/256)),os(W[P.e+1])}break;case 520:{var Et={};P.level!=null&&(Y[P.r]=Et,Et.level=P.level),P.hidden&&(Y[P.r]=Et,Et.hidden=!0),P.hpt&&(Y[P.r]=Et,Et.hpt=P.hpt,Et.hpx=sc(P.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||ro(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=P;break;case 161:a["!margins"]||ro(a["!margins"]={}),a["!margins"].header=P.header,a["!margins"].footer=P.footer;break;case 574:P.RTL&&(k.Views[0].RTL=!0);break;case 146:S=P;break;case 2198:F=P;break;case 140:_=P;break;case 442:u?N.CodeName=P||N.name:k.WBProps.CodeName=P||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=Q}return r.SheetNames=Ut(i).sort(function(hr,Re){return Number(hr)-Number(Re)}).map(function(hr){return i[hr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&R.forEach(function(hr,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=hr}),r.Strings=c,r.SSF=_t(Me),T.enc&&(r.Encryption=T.enc),F&&(r.Themes=F),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),D.names.length>0&&(k.Names=D.names),r.Workbook=k,r}var Fu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gve(e,t,r){var n=Oe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Bj(n,G1,Fu.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=Oe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Bj(s,X1,Fu.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(RP(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function vve(e,t){var r=[],n=[],a=[],i=0,s,o=mj(G1,"n"),c=mj(X1,"n");if(e.Props)for(s=Ut(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Ut(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)HP.indexOf(a[i][0])>-1||IP.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Oe.utils.cfb_add(t,"/SummaryInformation",Uj(n,Fu.SI,c,X1)),(r.length||u.length)&&Oe.utils.cfb_add(t,"/DocumentSummaryInformation",Uj(r,Fu.DSI,o,G1,u.length?u:null,Fu.UDI))}function L5(e,t){t||(t={}),Lw(t),sw(),t.codepage&&iw(t.codepage);var r,n;if(e.FullPaths){if(Oe.find(e,"/encryption"))throw new Error("File is password-protected");r=Oe.find(e,"!CompObj"),n=Oe.find(e,"/Workbook")||Oe.find(e,"/Book")}else{switch(t.type){case"base64":e=Tn($n(e));break;case"binary":e=Tn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Tr(e,0),n={content:e}}var a,i;if(r&&hve(r),t.bookProps&&!t.bookSheets)a={};else{var s=Ve?"buffer":"array";if(n&&n.content)a=mve(n.content,t);else if((i=Oe.find(e,"PerfectOffice_MAIN"))&&i.content)a=to.to_workbook(i.content,(t.type=s,t));else if((i=Oe.find(e,"NativeContent_MAIN"))&&i.content)a=to.to_workbook(i.content,(t.type=s,t));else throw(i=Oe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Oe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Che(e))}var o={};return e.FullPaths&&gve(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function yve(e,t){var r=t||{},n=Oe.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Oe.utils.cfb_add(n,a,B5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&vve(e,n),r.biff==8&&e.vbaraw&&Phe(n,Oe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Gf={0:{f:Wxe},1:{f:Qxe},2:{f:mme},3:{f:ime},4:{f:tme},5:{f:hme},6:{f:wme},7:{f:cme},8:{f:Tme},9:{f:Eme},10:{f:Nme},11:{f:jme},12:{f:Jxe},13:{f:vme},14:{f:ome},15:{f:nme},16:{f:C5},17:{f:_me},18:{f:fme},19:{f:bw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_ge},40:{},42:{},43:{f:wde},44:{f:yde},45:{f:kde},46:{f:jde},47:{f:Nde},48:{},49:{f:Gce},50:{},51:{f:she},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:t5},62:{f:bme},63:{f:xhe},64:{f:Hme},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Yr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Bme},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qxe},148:{f:Gxe,p:16},151:{f:Fme},152:{},153:{f:bge},154:{},155:{},156:{f:vge},157:{},158:{},159:{T:1,f:I0e},160:{T:-1},161:{T:1,f:Mo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ame},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ahe},336:{T:-1},337:{f:che,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:V1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:e5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Dme},427:{f:Ime},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:$me},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Kxe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Pme},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:V1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:jhe},633:{T:1},634:{T:-1},635:{T:1,f:khe},636:{T:-1},637:{f:Yce},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Vme},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},J1={6:{f:hg},10:{f:Ri},12:{f:Zt},13:{f:Zt},14:{f:Wt},15:{f:Wt},16:{f:Gr},17:{f:Wt},18:{f:Wt},19:{f:Zt},20:{f:Xj},21:{f:Xj},23:{f:e5},24:{f:qj},25:{f:Wt},26:{},27:{},28:{f:Vfe},29:{},34:{f:Wt},35:{f:Kj},38:{f:Gr},39:{f:Gr},40:{f:Gr},41:{f:Gr},42:{f:Wt},43:{f:Wt},47:{f:nde},49:{f:vfe},51:{f:Zt},60:{},61:{f:hfe},64:{f:Wt},65:{f:gfe},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:rfe},93:{f:Kfe},94:{},95:{f:Wt},96:{},97:{},99:{f:Wt},125:{f:t5},128:{f:Mfe},129:{f:afe},130:{f:Zt},131:{f:Wt},132:{f:Wt},133:{f:ife},134:{},140:{f:r0e},141:{f:Zt},144:{},146:{f:i0e},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:d0e},161:{f:l0e},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Afe},190:{f:Ofe},193:{f:Ri},197:{},198:{},199:{},200:{},201:{},202:{f:Wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Wt},222:{},224:{f:Pfe},225:{f:tfe},226:{f:Ri},227:{},229:{f:Gfe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ofe},253:{f:bfe},255:{f:cfe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:VP},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wt},353:{f:Ri},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:$fe},431:{f:Wt},432:{},433:{},434:{},437:{},438:{f:Qfe},439:{f:Wt},440:{f:Zfe},441:{},442:{f:S0},443:{},444:{f:Zt},445:{},446:{},448:{f:Ri},449:{f:dfe,r:2},450:{f:Ri},512:{f:Hj},513:{f:f0e},515:{f:Ife},516:{f:Sfe},517:{f:Gj},519:{f:h0e},520:{f:ufe},523:{},545:{f:Yj},549:{f:Wj},566:{},574:{f:xfe},638:{f:Tfe},659:{},1048:{},1054:{f:kfe},1084:{},1212:{f:zfe},2048:{f:e0e},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ri},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:s0e,r:12},2173:{f:rhe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Ufe,r:12},2197:{},2198:{f:Yde,r:12},2199:{},2200:{},2201:{},2202:{f:Wfe,r:12},2203:{f:Ri},2204:{},2205:{},2206:{},2207:{},2211:{f:ffe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:c0e},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:a0e},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Hj},1:{},2:{f:v0e},3:{f:m0e},4:{f:x0e},5:{f:Gj},7:{f:b0e},8:{},9:{f:xd},11:{},22:{f:Zt},30:{f:jfe},31:{},32:{},33:{f:Yj},36:{},37:{f:Wj},50:{f:w0e},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:p0e},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:S0e},223:{},234:{},354:{},421:{},518:{f:hg},521:{f:xd},536:{f:qj},547:{f:Kj},561:{},579:{},1030:{f:hg},1033:{f:xd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&gw(r)&&e.push(r)}}function bve(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ye(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function j0(e,t,r){return e||(e=oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function wve(e,t,r,n){var a=oe(9);return j0(a,e,t),GP(r,n||"b",a),a}function Sve(e,t,r){var n=oe(8+2*r.length);return j0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function _ve(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?fr(St(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ye(e,2,y0e(r,n,a)):ye(e,3,g0e(r,n,a));return;case"b":case"e":ye(e,5,wve(r,n,t.v,t.t));return;case"s":case"str":ye(e,4,Sve(r,n,(t.v||"").slice(0,255)));return}ye(e,1,j0(null,r,n))}function kve(e,t,r,n){var a=Array.isArray(t),i=Qe(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Be(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Vt(u);for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(c[f]=Pt(f)),s=c[f]+o;var d=a?(t[u]||[])[f]:t[s];d&&_ve(e,d,u,f)}}}function Nve(e,t){for(var r=t||{},n=gn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,Ew(e,16,r)),kve(n,e.Sheets[e.SheetNames[a]],a,r),ye(n,10),n.end()}function jve(e,t,r){ye(e,49,yfe({sz:12,name:"Arial"},r))}function Eve(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,1054,Nfe(a,t[a],r))})}function Tve(e,t){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(e,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),QP(Qe(t["!ref"]||"A1"),r),r.write_shift(4,4),ye(e,2152,r)}function Ave(e,t){for(var r=0;r<16;++r)ye(e,224,Vj({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ye(e,224,Vj(n,0,t))})}function Ove(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ye(e,440,Jfe(n)),n[1].Tooltip&&ye(e,2048,t0e(n))}delete t["!links"]}function Cve(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ye(e,125,o0e(Jx(a,n),a))})}}function Pve(e,t,r,n,a){var i=16+ks(a.cellXfs,t,a);if(t.v==null&&!t.bf){ye(e,513,yo(r,n,i));return}if(t.bf)ye(e,6,axe(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?fr(St(t.v)):t.v;ye(e,515,Rfe(r,n,s,i));break;case"b":case"e":ye(e,517,Dfe(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Dw(a.Strings,t.v,a.revStrings);ye(e,253,wfe(r,n,o,i))}else ye(e,516,_fe(r,n,(t.v||"").slice(0,255),i,a));break;default:ye(e,513,yo(r,n,i))}}function Mve(e,t,r){var n=gn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,f,d="",h=[],p=Qe(i["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}ye(n,2057,Ew(r,16,t)),ye(n,13,qn(1)),ye(n,12,qn(100)),ye(n,15,en(!0)),ye(n,17,en(!1)),ye(n,16,go(.001)),ye(n,95,en(!0)),ye(n,42,en(!1)),ye(n,43,en(!1)),ye(n,130,qn(1)),ye(n,128,Ffe()),ye(n,131,en(!1)),ye(n,132,en(!1)),u&&Cve(n,i["!cols"]),ye(n,512,Efe(p,t)),u&&(i["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){d=Vt(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(h[y]=Pt(y)),f=h[y]+d;var v=c?(i[g]||[])[y]:i[f];v&&(Pve(n,v,g,y,t),u&&v.l&&i["!links"].push([f,v.l]))}}var b=o.CodeName||o.name||a;return u&&ye(n,574,mfe((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&ye(n,229,Xfe(i["!merges"])),u&&Ove(n,i),ye(n,442,XP(b)),u&&Tve(n,i),ye(n,10),n.end()}function Fve(e,t,r){var n=gn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(ye(n,2057,Ew(e,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?qn(1200):null),ye(n,193,Due(2)),c&&ye(n,191),c&&ye(n,192),ye(n,226),ye(n,92,nfe("SheetJS",r)),ye(n,66,qn(o?1200:1252)),o&&ye(n,353,qn(0)),o&&ye(n,448),ye(n,317,u0e(e.SheetNames.length)),o&&e.vbaraw&&ye(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";ye(n,442,XP(u))}ye(n,156,qn(17)),ye(n,25,en(!1)),ye(n,18,en(!1)),ye(n,19,qn(0)),o&&ye(n,431,en(!1)),o&&ye(n,444,qn(0)),ye(n,61,pfe()),ye(n,64,en(!1)),ye(n,141,qn(0)),ye(n,34,en(dge(e)=="true")),ye(n,14,en(!0)),o&&ye(n,439,en(!1)),ye(n,218,qn(0)),jve(n,e,r),Eve(n,e.SSF,r),Ave(n,r),o&&ye(n,352,en(!1));var f=n.end(),d=gn();o&&ye(d,140,n0e()),o&&r.Strings&&bve(d,252,lfe(r.Strings)),ye(d,10);var h=d.end(),p=gn(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=f.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){var v=i[g]||{};ye(p,133,sfe({pos:y,hs:v.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var b=p.end();if(m!=b.length)throw new Error("BS8 "+m+" != "+b.length);var x=[];return f.length&&x.push(f),b.length&&x.push(b),h.length&&x.push(h),yr(x)}function Dve(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=_t(Me)),e&&e.SSF&&(Tc(),Gx(e.SSF),r.revssf=Kx(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Bw(r),r.cellXfs=[],ks(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Mve(a,r,e);return n.unshift(Fve(e,n,r)),yr(n)}function B5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=vn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return Dve(e,t);case 4:case 3:case 2:return Nve(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function s4(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=yce(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(s=0;s<c.length;++s){var g=c[s].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){for(var x=b,_=0;x.charAt(0)=="<"&&(_=x.indexOf(">"))>-1;)x=x.slice(_+1);for(var w=0;w<m.length;++w){var S=m[w];S.s.c==f&&S.s.r<u&&u<=S.e.r&&(f=S.e.c+1,w=-1)}var k=De(b.slice(0,b.indexOf(">")));h=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||h>1)&&m.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var N=k.t||k["data-t"]||"";if(!x.length){f+=h;continue}if(x=uP(x),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=h;continue}var j={t:"s",v:x};r.raw||!x.trim().length||N=="s"||(x==="TRUE"?j={t:"b",v:!0}:x==="FALSE"?j={t:"b",v:!1}:isNaN(Ca(x))?isNaN(ac(x).getDate())||(j={t:"d",v:St(x)},r.cellDates||(j={t:"n",v:fr(j.v)}),j.z=r.dateNF||Me[14]):j={t:"n",v:Ca(x)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=j):n[Fe({r:u,c:f})]=j,f+=h}}}}return n["!ref"]=Be(p),m.length&&(n["!merges"]=m),n}function Ive(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Fe({r,c:s}),d=n.dense?(e[r]||[])[s]:e[f],h=d&&d.v!=null&&(d.h||pw(d.w||(Ei(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,i.push(ve("td",h,p))}}var m="<tr>";return m+i.join("")+"</tr>"}var Rve='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$ve="</body></html>";function Lve(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _s(s4(r[0],t),t);var n=Ww();return r.forEach(function(a,i){Hw(n,s4(a,t),"Sheet"+(i+1))}),n}function Bve(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function U5(e,t){var r=t||{},n=r.header!=null?r.header:Rve,a=r.footer!=null?r.footer:$ve,i=[n],s=vn(e["!ref"]);r.dense=Array.isArray(e),i.push(Bve(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(Ive(e,s,o,r));return i.push("</table>"+a),i.join("")}function z5(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Mt(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=vn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,v=0,b=0,x=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<c;++m){var _=o[m];if(o4(_)){if(n.display)continue;p[g]={hidden:!0}}var w=_.children;for(y=v=0;y<w.length;++y){var S=w[y];if(!(n.display&&o4(S))){var k=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):uP(S.innerHTML),N=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var j=d[h];j.s.c==v+i&&j.s.r<g+a&&g+a<=j.e.r&&(v=j.e.c+1-i,h=-1)}x=+S.getAttribute("colspan")||1,((b=+S.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:g+a,c:v+i},e:{r:g+a+(b||1)-1,c:v+i+(x||1)-1}});var E={t:"s",v:k},A=S.getAttribute("data-t")||S.getAttribute("t")||"";k!=null&&(k.length==0?E.t=A||"z":n.raw||k.trim().length==0||A=="s"||(k==="TRUE"?E={t:"b",v:!0}:k==="FALSE"?E={t:"b",v:!1}:isNaN(Ca(k))?isNaN(ac(k).getDate())||(E={t:"d",v:St(k)},n.cellDates||(E={t:"n",v:fr(E.v)}),E.z=n.dateNF||Me[14]):E={t:"n",v:Ca(k)})),E.z===void 0&&N!=null&&(E.z=N);var T="",F=S.getElementsByTagName("A");if(F&&F.length)for(var G=0;G<F.length&&!(F[G].hasAttribute("href")&&(T=F[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(E.l={Target:T}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][v+i]=E):e[Fe({c:v+i,r:g+a})]=E,u.e.c<v+i&&(u.e.c=v+i),v+=x}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=Be(u),g>=c&&(e["!fullref"]=Be((u.e.r=o.length-m+g-1+a,u))),e}function W5(e,t){var r=t||{},n=r.dense?[]:{};return z5(n,e,t)}function Uve(e,t){return _s(W5(e,t),t)}function o4(e){var t="",r=zve(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function zve(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Wve(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ye(t.replace(/<[^>]*>/g,""));return[r]}var l4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function H5(e,t){var r=t||{},n=xw(e),a=[],i,s,o={name:""},c="",u=0,f,d,h={},p=[],m=r.dense?[]:{},g,y,v={value:""},b="",x=0,_=[],w=-1,S=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,j={},E=[],A={},T=0,F=0,G=[],M=1,W=1,Y=[],K={Names:[]},D={},Z=["",""],ee=[],O={},L="",R=0,X=!1,J=!1,le=0;for(Bf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Bf.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?m["!ref"]=Be(k):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=Be(k)),E.length&&(m["!merges"]=E),G.length&&(m["!rows"]=G),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=m,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=De(g[0],!1),w=S=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,m=r.dense?[]:{},E=[],G=[],J=!0);break;case"table-row-group":g[1]==="/"?--N:++N;break;case"table-row":case"":if(g[1]==="/"){w+=M,M=1;break}if(d=De(g[0],!1),d.?w=d.-1:w==-1&&(w=0),M=+d["number-rows-repeated"]||1,M<10)for(le=0;le<M;++le)N>0&&(G[w+le]={level:N});S=-1;break;case"covered-table-cell":g[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(m[w]||(m[w]=[]),m[w][S]={t:"z"}):m[Fe({r:w,c:S})]={t:"z"}),b="",_=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++S,v=De(g[0],!1),W=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=n4(Ye(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=Ye(v["string-value"]||""),r.dense?(m[w]||(m[w]=[]),m[w][S]=y):m[Fe({r:w,c:S})]=y),S+=W-1;else if(g[1]!=="/"){++S,b="",x=0,_=[],W=1;var se=M?w+M-1:w;if(S>k.e.c&&(k.e.c=S),S<k.s.c&&(k.s.c=S),w<k.s.r&&(k.s.r=w),se>k.e.r&&(k.e.r=se),v=De(g[0],!1),ee=[],O={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ye(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(T=parseInt(v["number-matrix-rows-spanned"],10)||0,F=parseInt(v["number-matrix-columns-spanned"],10)||0,A={s:{r:w,c:S},e:{r:w+T-1,c:S+F-1}},y.F=Be(A),Y.push([A,y.F])),v.formula)y.f=n4(v.formula);else for(le=0;le<Y.length;++le)w>=Y[le][0].s.r&&w<=Y[le][0].e.r&&S>=Y[le][0].s.c&&S<=Y[le][0].e.c&&(y.F=Y[le][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(T=parseInt(v["number-rows-spanned"],10)||0,F=parseInt(v["number-columns-spanned"],10)||0,A={s:{r:w,c:S},e:{r:w+T-1,c:S+F-1}},E.push(A)),v["number-columns-repeated"]&&(W=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=bt(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=St(v["date-value"]),r.cellDates||(y.t="n",y.v=fr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=mce(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=qx(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(b=Ye(v["string-value"]),_=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(X=!1,y.t==="s"&&(y.v=b||"",_.length&&(y.R=_),X=x==0),D.Target&&(y.l=D),ee.length>0&&(y.c=ee,ee=[]),b&&r.cellText!==!1&&(y.w=b),X&&(y.t="z",delete y.v),(!X||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var Q=0;Q<M;++Q){if(W=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[w+Q]||(m[w+Q]=[]),m[w+Q][S]=Q==0?y:_t(y);--W>0;)m[w+Q][S+W]=_t(y);else for(m[Fe({r:w+Q,c:S})]=y;--W>0;)m[Fe({r:w+Q,c:S+W})]=_t(y);k.e.c<=S&&(k.e.c=S)}W=parseInt(v["number-columns-repeated"]||"1",10),S+=W-1,W=0,y={},b="",_=[]}D={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i;O.t=b,_.length&&(O.R=_),O.a=L,ee.push(O)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);L="",R=0,b="",x=0,_=[];break;case"creator":g[1]==="/"?L=n.slice(R,g.index):R=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);b="",x=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(j[o.name]=c,(i=a.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=De(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(g[0],!1),c+=l4[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(g[0],!1),c+=l4[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":s=De(g[0],!1),Z=pg(s["cell-range-address"]);var te={Name:s.name,Ref:Z[0]+"!"+Z[1]};J&&(te.Sheet=p.length),K.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var fe=Wve(n.slice(x,g.index));b=(b.length>0?b+`
`:"")+fe[0]}else De(g[0],!1),x=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{Z=pg(De(g[0])["target-range-address"]),h[Z[0]]["!autofilter"]={ref:Z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(D=De(g[0],!1),!D.href)break;D.Target=Ye(D.href),delete D.href,D.Target.charAt(0)=="#"&&D.Target.indexOf(".")>-1?(Z=pg(D.Target.slice(1)),D.Target="#"+Z[0]+"!"+Z[1]):D.Target.match(/^\.\.[\\\/]/)&&(D.Target=D.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var P={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete P.Sheets,P}function c4(e,t){t=t||{},Kn(e,"META-INF/manifest.xml")&&mue(Qt(e,"META-INF/manifest.xml"),t);var r=An(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=H5(ct(r),t);return Kn(e,"meta.xml")&&(n.Props=FP(Qt(e,"meta.xml"))),n}function u4(e,t){return H5(e,t)}var Hve=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Gt+t}}(),f4=function(){var e=function(i){return at(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+at(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=vn(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,m=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<d.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=d.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var v=!1,b={},x="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>u)&&!(h[p].e.c<f)&&!(h[p].e.r<u)){(h[p].s.c!=f||h[p].s.r!=u)&&(v=!0),b["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,b["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){c.push(r);continue}var _=Fe({r:u,c:f}),w=m?(i[u]||[])[f]:i[_];if(w&&w.f&&(b["table:formula"]=at(uxe(w.f)),w.F&&w.F.slice(0,_.length)==_)){var S=vn(w.F);b["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,b["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!w){c.push(t);continue}switch(w.t){case"b":x=w.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=w.v?"true":"false";break;case"n":x=w.w||String(w.v||0),b["office:value-type"]="float",b["office:value"]=w.v||0;break;case"s":case"str":x=w.v==null?"":w.v,b["office:value-type"]="string";break;case"d":x=w.w||St(w.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=St(w.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(x);if(w.l&&w.l.Target){var N=w.l.Target;N=N.charAt(0)=="#"?"#"+fxe(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),k=ve("text:a",k,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+ve("table:table-cell",ve("text:p",k,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;os(d),d.ods=o;var h=u["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[Gt],u=Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(MP().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(n(s.Sheets[s.SheetNames[d]],s,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function V5(e,t){if(t.bookType=="fods")return f4(e,t);var r=fw(),n="",a=[],i=[];return n="mimetype",Ue(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ue(r,n,f4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ue(r,n,Hve(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ue(r,n,Gt+MP()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ue(r,n,yue(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ue(r,n,gue(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ey(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ct(Ss(e))}function Vve(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Tn(Ha(e))}function Gve(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function cs(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function d4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Xve(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Kve(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Xf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function rt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Bt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ze(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Xf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Xf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Nr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(rt(n*8+a.type)),a.type==2&&t.push(rt(a.data.length)),t.push(a.data))})}),cs(t)}function $w(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Gn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Xf(e,n),i=Ze(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Bt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Ze(o.data),u=Bt(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Bt(i[3][0].data)>>>0>0),r.push(s)}return r}function zo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:rt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:rt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:rt(s.data.length)}],n[2].push({data:Nr(s.meta),type:2})});var i=Nr(n);t.push(rt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),cs(t)}function qve(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Xf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[cs(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var f=cs(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Xn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(qve(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return cs(t)}function Wo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=rt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return cs(t)}function Yve(e,t,r,n){var a=bo(e),i=a.getUint32(4,!0),s=(n>1?12:8)+d4(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=d4(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function Qve(e,t,r){var n=bo(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(c=Xve(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function mg(e,t){var r=new Uint8Array(32),n=bo(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Kve(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function gg(e,t){var r=new Uint8Array(32),n=bo(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Zve(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Yve(e,t,r,e[0]);case 5:return Qve(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ur(e){var t=Ze(e);return Xf(t[1][0].data)}function h4(e,t){var r=Ze(t.data),n=Bt(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=Ze(s.data),c=Bt(o[1][0].data)>>>0;switch(n){case 1:i[c]=ey(o[3][0].data);break;case 8:{var u=e[Ur(o[9][0].data)][0],f=Ze(u.data),d=e[Ur(f[1][0].data)][0],h=Bt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Ze(d.data);i[c]=p[3].map(function(m){return ey(m.data)}).join("")}break}}),i}function Jve(e,t){var r,n,a,i,s,o,c,u,f,d,h,p,m,g,y=Ze(e),v=Bt(y[1][0].data)>>>0,b=Bt(y[2][0].data)>>>0,x=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Bt(y[8][0].data)>0||!1,_,w;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)_=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,w=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=y[4])==null?void 0:f[0])!=null&&d.data&&t!=1)_=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,w=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=x?4:1,k=bo(_),N=[],j=0;j<_.length/2;++j){var E=k.getUint16(j*2,!0);E<65535&&N.push([j,E])}if(N.length!=b)throw"Expected ".concat(b," cells, found ").concat(N.length);var A=[];for(j=0;j<N.length-1;++j)A[N[j][0]]=w.subarray(N[j][1]*S,N[j+1][1]*S);return N.length>=1&&(A[N[N.length-1][0]]=w.subarray(N[N.length-1][1]*S)),{R:v,cells:A}}function e1e(e,t){var r,n=Ze(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Bt(n[7][0].data)>>>0>0?1:0:-1,i=$w(n[5],function(s){return Jve(s,a)});return{nrows:Bt(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function t1e(e,t,r){var n,a=Ze(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Bt(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Bt(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Be(i);var s=Ze(a[4][0].data),o=h4(e,e[Ur(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?h4(e,e[Ur(s[17][0].data)][0]):[],u=Ze(s[3][0].data),f=0;u[1].forEach(function(d){var h=Ze(d.data),p=e[Ur(h[2][0].data)][0],m=Bt(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=e1e(e,p);g.data.forEach(function(y,v){y.forEach(function(b,x){var _=Fe({r:f+v,c:x}),w=Zve(b,o,c);w&&(r[_]=w)})}),f+=g.nrows})}function r1e(e,t){var r=Ze(t.data),n={"!ref":"A1"},a=e[Ur(r[2][0].data)],i=Bt(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return t1e(e,a[0],n),n}function n1e(e,t){var r,n=Ze(t.data),a={name:(r=n[1])!=null&&r[0]?ey(n[1][0].data):"",sheets:[]},i=$w(n[2],Ur);return i.forEach(function(s){e[s].forEach(function(o){var c=Bt(o.meta[1][0].data);c==6e3&&a.sheets.push(r1e(e,o))})}),a}function a1e(e,t){var r=Ww(),n=Ze(t.data),a=$w(n[1],Ur);if(a.forEach(function(i){e[i].forEach(function(s){var o=Bt(s.meta[1][0].data);if(o==2){var c=n1e(e,s);c.sheets.forEach(function(u,f){Hw(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function vg(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Xn(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=Gn(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Bt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var f=Bt(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return a1e(i,o)}function i1e(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Bt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=bo(e[7][0].data),f=0,d=[],h=bo(e[4][0].data),p=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}u.setUint16(g*2,f,!0),h.setUint16(g*2,p,!0);var y,v;switch(typeof t[g]){case"string":y=mg({t:"s",v:t[g]},r),v=gg({t:"s",v:t[g]},r);break;case"number":y=mg({t:"n",v:t[g]},r),v=gg({t:"n",v:t[g]},r);break;case"boolean":y=mg({t:"b",v:t[g]},r),v=gg({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}d.push(y),f+=y.length,m.push(v),p+=v.length,++c}for(e[2][0].data=rt(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=cs(d),e[3][0].data=cs(m),c}function s1e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=vn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Be(n)));var i=kp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(R){typeof R=="string"&&s.push(R)})});var o={},c=[],u=Oe.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,R){return[L,u.FullPaths[R]]}).forEach(function(L){var R=L[0],X=L[1];if(R.type==2&&R.name.match(/\.iwa/)){var J=R.content,le=Xn(J),se=Gn(le);se.forEach(function(Q){c.push(Q.id),o[Q.id]={deps:[],location:X,type:Bt(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(L,R){return L-R});var f=c.filter(function(L){return L>1}).map(function(L){return[L,rt(L)]});u.FileIndex.map(function(L,R){return[L,u.FullPaths[R]]}).forEach(function(L){var R=L[0];if(L[1],!!R.name.match(/\.iwa/)){var X=Gn(Xn(R.content));X.forEach(function(J){J.messages.forEach(function(le){f.forEach(function(se){J.messages.some(function(Q){return Bt(Q.meta[1][0].data)!=11006&&Gve(Q.data,se[1])})&&o[se[0]].deps.push(J.id)})})})}});for(var d=Oe.find(u,o[1].location),h=Gn(Xn(d.content)),p,m=0;m<h.length;++m){var g=h[m];g.id==1&&(p=g)}var y=Ur(Ze(p.messages[0].data)[1][0].data);for(d=Oe.find(u,o[y].location),h=Gn(Xn(d.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Ur(Ze(p.messages[0].data)[2][0].data),d=Oe.find(u,o[y].location),h=Gn(Xn(d.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Ur(Ze(p.messages[0].data)[2][0].data),d=Oe.find(u,o[y].location),h=Gn(Xn(d.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);var v=Ze(p.messages[0].data);{v[6][0].data=rt(n.e.r+1),v[7][0].data=rt(n.e.c+1);var b=Ur(v[46][0].data),x=Oe.find(u,o[b].location),_=Gn(Xn(x.content));{for(var w=0;w<_.length&&_[w].id!=b;++w);if(_[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var S=Ze(_[w].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var k=0;k<=n.e.c;++k){var N=[];N[1]=N[2]=[{type:0,data:rt(k+420690)}],S[1].push({type:2,data:Nr(N)}),S[2].push({type:0,data:rt(k)}),S[3].push({type:0,data:rt(k)})}S[4]=[],S[5]=[],S[6]=[];for(var j=0;j<=n.e.r;++j)N=[],N[1]=N[2]=[{type:0,data:rt(j+726270)}],S[4].push({type:2,data:Nr(N)}),S[5].push({type:0,data:rt(j)}),S[6].push({type:0,data:rt(j)});_[w].messages[0].data=Nr(S)}x.content=Wo(zo(_)),x.size=x.content.length,delete v[46];var E=Ze(v[4][0].data);{E[7][0].data=rt(n.e.r+1);var A=Ze(E[1][0].data),T=Ur(A[2][0].data);x=Oe.find(u,o[T].location),_=Gn(Xn(x.content));{if(_[0].id!=T)throw"Bad HeaderStorageBucket";var F=Ze(_[0].messages[0].data);for(j=0;j<i.length;++j){var G=Ze(F[2][0].data);G[1][0].data=rt(j),G[4][0].data=rt(i[j].length),F[2][j]={type:F[2][0].type,data:Nr(G)}}_[0].messages[0].data=Nr(F)}x.content=Wo(zo(_)),x.size=x.content.length;var M=Ur(E[2][0].data);x=Oe.find(u,o[M].location),_=Gn(Xn(x.content));{if(_[0].id!=M)throw"Bad HeaderStorageBucket";for(F=Ze(_[0].messages[0].data),k=0;k<=n.e.c;++k)G=Ze(F[2][0].data),G[1][0].data=rt(k),G[4][0].data=rt(n.e.r+1),F[2][k]={type:F[2][0].type,data:Nr(G)};_[0].messages[0].data=Nr(F)}x.content=Wo(zo(_)),x.size=x.content.length;var W=Ur(E[4][0].data);(function(){for(var L=Oe.find(u,o[W].location),R=Gn(Xn(L.content)),X,J=0;J<R.length;++J){var le=R[J];le.id==W&&(X=le)}var se=Ze(X.messages[0].data);{se[3]=[];var Q=[];s.forEach(function(P,ke){Q[1]=[{type:0,data:rt(ke)}],Q[2]=[{type:0,data:rt(1)}],Q[3]=[{type:2,data:Vve(P)}],se[3].push({type:2,data:Nr(Q)})})}X.messages[0].data=Nr(se);var te=zo(R),fe=Wo(te);L.content=fe,L.size=L.content.length})();var Y=Ze(E[3][0].data);{var K=Y[1][0];delete Y[2];var D=Ze(K.data);{var Z=Ur(D[2][0].data);(function(){for(var L=Oe.find(u,o[Z].location),R=Gn(Xn(L.content)),X,J=0;J<R.length;++J){var le=R[J];le.id==Z&&(X=le)}var se=Ze(X.messages[0].data);{delete se[6],delete Y[7];var Q=new Uint8Array(se[5][0].data);se[5]=[];for(var te=0,fe=0;fe<=n.e.r;++fe){var P=Ze(Q);te+=i1e(P,i[fe],s),P[1][0].data=rt(fe),se[5].push({data:Nr(P),type:2})}se[1]=[{type:0,data:rt(n.e.c+1)}],se[2]=[{type:0,data:rt(n.e.r+1)}],se[3]=[{type:0,data:rt(te)}],se[4]=[{type:0,data:rt(n.e.r+1)}]}X.messages[0].data=Nr(se);var ke=zo(R),be=Wo(ke);L.content=be,L.size=L.content.length})()}K.data=Nr(D)}E[3][0].data=Nr(Y)}v[4][0].data=Nr(E)}p.messages[0].data=Nr(v);var ee=zo(h),O=Wo(ee);return d.content=O,d.size=d.content.length,u}function G5(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Lw(e){G5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Bw(e){G5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function o1e(e){return Ge.WS.indexOf(e)>-1?"sheet":e==Ge.CS?"chart":e==Ge.DS?"dialog":e==Ge.MS?"macro":e&&e.length?e:"sheet"}function l1e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,o1e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function c1e(e,t,r,n,a,i,s,o,c,u,f,d){try{i[n]=Ou(An(e,r,!0),t);var h=Qt(e,t),p;switch(o){case"sheet":p=Cge(h,t,a,c,i[n],u,f,d);break;case"chart":if(p=Pge(h,t,a,c,i[n],u,f,d),!p||!p["!drawel"])break;var m=uu(p["!drawel"].Target,t),g=Uf(m),y=vhe(An(e,m,!0),Ou(An(e,g,!0),m)),v=uu(y,m),b=Uf(v);p=ige(An(e,v,!0),v,c,Ou(An(e,b,!0),v),u,p);break;case"macro":p=Mge(h,t,a,c,i[n],u,f,d);break;case"dialog":p=Fge(h,t,a,c,i[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var x=[];i&&i[n]&&Ut(i[n]).forEach(function(_){var w="";if(i[n][_].Type==Ge.CMNT){w=uu(i[n][_].Target,t);var S=$ge(Qt(e,w,!0),w,c);if(!S||!S.length)return;Zj(p,S,!1)}i[n][_].Type==Ge.TCMNT&&(w=uu(i[n][_].Target,t),x=x.concat(bhe(Qt(e,w,!0),c)))}),x&&x.length&&Zj(p,x,!0,c.people||[])}catch(_){if(c.WTF)throw _}}function Hn(e){return e.charAt(0)=="/"?e.slice(1):e}function u1e(e,t){if(Tc(),t=t||{},Lw(t),Kn(e,"META-INF/manifest.xml")||Kn(e,"objectdata.xml"))return c4(e,t);if(Kn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vg<"u"){if(e.FileIndex)return vg(e);var r=Oe.utils.cfb_new();return yj(e).forEach(function(G){Ue(r,G,wce(e,G))}),vg(r)}throw new Error("Unsupported NUMBERS file")}if(!Kn(e,"[Content_Types].xml"))throw Kn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Kn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=yj(e),a=pue(An(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Qt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Qt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Cu=[],a.sst)try{Cu=Rge(Qt(e,Hn(a.sst)),a.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&a.themes.length&&(c=Ige(An(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Dge(Qt(e,Hn(a.style)),a.style,c,t))}a.links.map(function(G){try{var M=Ou(An(e,Uf(Hn(G))),G);return Bge(Qt(e,Hn(G)),M,G,t)}catch{}});var f=Oge(Qt(e,Hn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Qt(e,Hn(a.coreprops[0]),!0),h&&(d=FP(h)),a.extprops.length!==0&&(h=Qt(e,Hn(a.extprops[0]),!0),h&&wue(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=An(e,Hn(a.custprops[0]),!0),h&&(p=_ue(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(f.Sheets?s=f.Sheets.map(function(M){return M.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),t.bookProps&&(m.Props=d,m.Custprops=p),t.bookSheets&&typeof s<"u"&&(m.SheetNames=s),t.bookSheets?m.SheetNames:t.bookProps))return m;s={};var g={};t.bookDeps&&a.calcchain&&(g=Lge(Qt(e,Hn(a.calcchain)),a.calcchain));var y=0,v={},b,x;{var _=f.Sheets;d.Worksheets=_.length,d.SheetNames=[];for(var w=0;w!=_.length;++w)d.SheetNames[w]=_[w].name}var S=i?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Kn(e,N)||(N="xl/_rels/workbook."+S+".rels");var j=Ou(An(e,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Uge(Qt(e,Hn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=She(Qt(e,Hn(a.people[0])),t)),j&&(j=l1e(j,f.Sheets));var E=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var A="sheet";if(j&&j[y]?(b="xl/"+j[y][1].replace(/[\/]?xl\//,""),Kn(e,b)||(b=j[y][1]),Kn(e,b)||(b=N.replace(/_rels\/.*$/,"")+j[y][1]),A=j[y][2]):(b="xl/worksheets/sheet"+(y+1-E)+"."+S,b=b.replace(/sheet0\./,"sheet.")),x=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,F=0;F!=t.sheets.length;++F)typeof t.sheets[F]=="number"&&t.sheets[F]==y&&(T=1),typeof t.sheets[F]=="string"&&t.sheets[F].toLowerCase()==d.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}c1e(e,b,x,d.SheetNames[y],y,v,s,A,t,f,c,u)}return m={Directory:a,Workbook:f,Props:d,Custprops:p,Deps:g,Sheets:s,SheetNames:d.SheetNames,Strings:Cu,Styles:u,Themes:c,SSF:_t(Me)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(G,M){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=e.FileIndex[M]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=Qt(e,Hn(a.vba[0]),!0):a.defaults&&a.defaults.bin===Ohe&&(m.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),m}function f1e(e,t){var r=t||{},n="Workbook",a=Oe.find(e,n);try{if(n="/!DataSpaces/Version",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(U0e(a.content),n="/!DataSpaces/DataSpaceMap",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=W0e(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=H0e(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);G0e(a.content)}catch{}if(n="/EncryptionInfo",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=X0e(a.content);if(n="/EncryptedPackage",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function d1e(e,t){return t.bookType=="ods"?V5(e,t):t.bookType=="numbers"?s1e(e,t):t.bookType=="xlsb"?h1e(e,t):p1e(e,t)}function h1e(e,t){dl=1024,e&&!e.SSF&&(e.SSF=_t(Me)),e&&e.SSF&&(Tc(),Gx(e.SSF),t.revssf=Kx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=y5.indexOf(t.bookType)>-1,a=Nw();Bw(t=t||{});var i=fw(),s="",o=0;if(t.cellXfs=[],ks(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ue(i,s,DP(e.Props,t)),a.coreprops.push(s),nt(t.rels,2,s,Ge.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ue(i,s,$P(e.Props)),a.extprops.push(s),nt(t.rels,3,s,Ge.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ue(i,s,LP(e.Custprops)),a.custprops.push(s),nt(t.rels,4,s,Ge.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ue(i,s,Wge(o-1,s,t,e,f)),a.sheets.push(s),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(d){var p=d["!comments"],m=!1,g="";p&&p.length>0&&(g="xl/comments"+o+"."+r,Ue(i,g,Gge(p,g)),a.comments.push(g),nt(f,-1,"../comments"+o+"."+r,Ge.CMNT),m=!0),d["!legacy"]&&m&&Ue(i,"xl/drawings/vmlDrawing"+o+".vml",g5(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ue(i,Uf(s),_l(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ue(i,s,Vge(t.Strings,s,t)),a.strs.push(s),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),s="xl/workbook."+r,Ue(i,s,zge(e,s)),a.workbooks.push(s),nt(t.rels,1,s,Ge.WB),s="xl/theme/theme1.xml",Ue(i,s,Cw(e.Themes,t)),a.themes.push(s),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),s="xl/styles."+r,Ue(i,s,Hge(e,s,t)),a.styles.push(s),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ue(i,s,e.vbaraw),a.vba.push(s),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),s="xl/metadata."+r,Ue(i,s,Xge(s)),a.metadata.push(s),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),Ue(i,"[Content_Types].xml",PP(a,t)),Ue(i,"_rels/.rels",_l(t.rels)),Ue(i,"xl/_rels/workbook."+r+".rels",_l(t.wbrels)),delete t.revssf,delete t.ssf,i}function p1e(e,t){dl=1024,e&&!e.SSF&&(e.SSF=_t(Me)),e&&e.SSF&&(Tc(),Gx(e.SSF),t.revssf=Kx(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=y5.indexOf(t.bookType)>-1,a=Nw();Bw(t=t||{});var i=fw(),s="",o=0;if(t.cellXfs=[],ks(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ue(i,s,DP(e.Props,t)),a.coreprops.push(s),nt(t.rels,2,s,Ge.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ue(i,s,$P(e.Props)),a.extprops.push(s),nt(t.rels,3,s,Ge.EXT_PROPS),e.Custprops!==e.Props&&Ut(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ue(i,s,LP(e.Custprops)),a.custprops.push(s),nt(t.rels,4,s,Ge.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ue(i,s,O5(o-1,t,e,d)),a.sheets.push(s),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var m=h["!comments"],g=!1,y="";if(m&&m.length>0){var v=!1;m.forEach(function(b){b[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(y="xl/threadedComments/threadedComment"+o+"."+r,Ue(i,y,whe(m,f,t)),a.threadedcomments.push(y),nt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),y="xl/comments"+o+"."+r,Ue(i,y,v5(m)),a.comments.push(y),nt(d,-1,"../comments"+o+"."+r,Ge.CMNT),g=!0}h["!legacy"]&&g&&Ue(i,"xl/drawings/vmlDrawing"+o+".vml",g5(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ue(i,Uf(s),_l(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ue(i,s,i5(t.Strings,t)),a.strs.push(s),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),s="xl/workbook."+r,Ue(i,s,D5(e)),a.workbooks.push(s),nt(t.rels,1,s,Ge.WB),s="xl/theme/theme1.xml",Ue(i,s,Cw(e.Themes,t)),a.themes.push(s),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),s="xl/styles."+r,Ue(i,s,h5(e,t)),a.styles.push(s),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ue(i,s,e.vbaraw),a.vba.push(s),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),s="xl/metadata."+r,Ue(i,s,m5()),a.metadata.push(s),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),f.length>1&&(s="xl/persons/person.xml",Ue(i,s,_he(f)),a.people.push(s),nt(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),Ue(i,"[Content_Types].xml",PP(a,t)),Ue(i,"_rels/.rels",_l(t.rels)),Ue(i,"xl/_rels/workbook."+r+".rels",_l(t.wbrels)),delete t.revssf,delete t.ssf,i}function Uw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$n(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function x1e(e,t){return Oe.find(e,"EncryptedPackage")?f1e(e,t):L5(e,t)}function m1e(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r=oP(n,a),u1e(r,a)}function X5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Z1(e.slice(r),t);default:break e}return ic.to_workbook(e,t)}function g1e(e,t){var r="",n=Uw(e,t);switch(t.type){case"base64":r=$n(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=mo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ct(r)),t.type="binary",X5(r,t)}function v1e(e,t){var r=e;return t.type=="base64"&&(r=$n(r)),r=Df.utils.decode(1200,r.slice(2),"str"),t.type="binary",X5(r,t)}function y1e(e){return e.match(/[^\x00-\x7F]/)?Ha(e):e}function yg(e,t,r,n){return n?(r.type="string",ic.to_workbook(e,r)):ic.to_workbook(t,r)}function _p(e,t){sw();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return _p(new Uint8Array(e),(r=_t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Nl={},r.dateNF&&(Nl.dateNF=r.dateNF),r.type||(r.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ve?"buffer":"binary",n=hce(e),typeof Uint8Array<"u"&&!Ve&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=y1e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=_t(r),r.type="array",_p(ow(n),r)}switch((a=Uw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return x1e(Oe.read(n,r),r);break;case 9:if(a[1]<=8)return L5(n,r);break;case 60:return Z1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return k0e(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return n5.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?m1e(n,r):yg(e,n,r,i);case 239:return a[3]===60?Z1(n,r):yg(e,n,r,i);case 255:if(a[1]===254)return v1e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return to.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return to.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Q1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return u5.to_workbook(n,r);break;case 10:case 13:case 32:return g1e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _0e.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Q1.to_workbook(n,r):yg(e,n,r,i)}function K5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return y0(t.file,Oe.write(e,{type:Ve?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Oe.write(e,t)}function b1e(e,t){var r=_t(t||{}),n=d1e(e,r);return w1e(n,r)}function w1e(e,t){var r={},n=Ve?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Oe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Vx(a))}return t.password&&typeof encrypt_agile<"u"?K5(encrypt_agile(a,t.password),t):t.type==="file"?y0(t.file,a):t.type=="string"?ct(a):a}function S1e(e,t){var r=t||{},n=yve(e,r);return K5(n,r)}function Ba(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return If(Ha(n));case"binary":return Ha(n);case"string":return e;case"file":return y0(t.file,n,"utf8");case"buffer":return Ve?Mi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ba(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _1e(e,t){switch(t.type){case"base64":return If(e);case"binary":return e;case"string":return e;case"file":return y0(t.file,e,"binary");case"buffer":return Ve?Mi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?If(r):t.type=="string"?ct(r):r;case"file":return y0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function q5(e,t){sw(),xge(e);var r=_t(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=q5(e,r);return r.type="array",Vx(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ba(dve(e,r),r);case"slk":case"sylk":return Ba(r5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ba(U5(e.Sheets[e.SheetNames[a]],r),r);case"txt":return _1e(Y5(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ba(zw(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ba(n5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return yd(Q1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ba(ic.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ba(u5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ba(a5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ba(V5(e,r),r);case"wk1":return yd(to.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return yd(to.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),yd(B5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),S1e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return b1e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function k1e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function em(e,t,r){var n={};return n.type="file",n.file=t,k1e(n),q5(e,n)}function N1e(e,t,r,n,a,i,s,o){var c=Vt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=s?e[r][p]:e[n[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;i[p]!=null&&(h[i[p]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[p]!=null){if(g==null)if(m.t=="e"&&g===null)h[i[p]]=null;else if(u!==void 0)h[i[p]]=u;else if(f&&g===null)h[i[p]]=null;else continue;else h[i[p]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:Ei(m,g,o);g!=null&&(d=!1)}}return{row:h,isempty:d}}function kp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=Qe(f);break;case"number":c=Qe(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=Vt(c.s.r),h=[],p=[],m=0,g=0,y=Array.isArray(e),v=c.s.r,b=0,x={};y&&!e[v]&&(e[v]=[]);var _=u.skipHidden&&e["!cols"]||[],w=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(_[b]||{}).hidden)switch(h[b]=Pt(b),r=y?e[v][b]:e[h[b]+d],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Ei(r,null,u),g=x[s]||0,!g)x[s]=1;else{do o=s+"_"+g++;while(x[o]);x[s]=g,x[o]=1}i[b]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(w[v]||{}).hidden){var S=N1e(e,c,v,h,n,i,y,u);(S.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=S.row)}return p.length=m,p}var p4=/"/g;function j1e(e,t,r,n,a,i,s,o){for(var c=!0,u=[],f="",d=Vt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Ei(p,null,o));for(var m=0,g=0;m!==f.length;++m)if((g=f.charCodeAt(m))===a||g===i||g===34||o.forceQuotes){f='"'+f.replace(p4,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(p4,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(s)}function zw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(d[m]=Pt(m));for(var g=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(f=j1e(e,a,y,d,s,c,i,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function Y5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=zw(e,t);return r}function E1e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Pt(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=Vt(f),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Q5(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Mt(n.origin):n.origin;s=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var d=Qe(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+t.length-1+a)}else s==-1&&(s=0,f.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(g,y){Ut(g).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var b=g[v],x="z",_="",w=Fe({c:o+p,r:s+y+a});u=Kf(i,w),b&&typeof b=="object"&&!(b instanceof Date)?i[w]=b:(typeof b=="number"?x="n":typeof b=="boolean"?x="b":typeof b=="string"?x="s":b instanceof Date?(x="d",n.cellDates||(x="n",b=fr(b)),_=n.dateNF||Me[14]):b===null&&n.nullError&&(x="e",b=0),u?(u.t=x,u.v=b,delete u.w,delete u.R,_&&(u.z=_)):i[w]=u={t:x,v:b},_&&(u.z=_))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var m=Vt(s);if(a)for(p=0;p<h.length;++p)i[Pt(p+o)+m]={t:"s",v:h[p]};return i["!ref"]=Be(f),i}function T1e(e,t){return Q5(null,e,t)}function Kf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Mt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Kf(e,Fe(t)):Kf(e,Fe({r:t,c:r||0}))}function A1e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ww(){return{SheetNames:[],Sheets:{}}}function Hw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(F5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function O1e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=A1e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function C1e(e,t){return e.z=t,e}function Z5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function P1e(e,t,r){return Z5(e,"#"+t,r)}function M1e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function F1e(e,t,r,n){for(var a=typeof t!="string"?t:Qe(t),i=typeof t=="string"?t:Be(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Kf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var br={encode_col:Pt,encode_row:Vt,encode_cell:Fe,encode_range:Be,decode_col:yw,decode_row:vw,split_cell:Vce,decode_cell:Mt,decode_range:vn,format_cell:Ei,sheet_add_aoa:NP,sheet_add_json:Q5,sheet_add_dom:z5,aoa_to_sheet:Ac,json_to_sheet:T1e,table_to_sheet:W5,table_to_book:Uve,sheet_to_csv:zw,sheet_to_txt:Y5,sheet_to_json:kp,sheet_to_html:U5,sheet_to_formulae:E1e,sheet_to_row_object_array:kp,sheet_get_cell:Kf,book_new:Ww,book_append_sheet:Hw,book_set_sheet_visibility:O1e,cell_set_number_format:C1e,cell_set_hyperlink:Z5,cell_set_internal_link:P1e,cell_add_comment:M1e,sheet_set_array_formula:F1e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const J5=[{key:"floor",label:"Level / Floor",required:!0},{key:"roomName",label:"Room Name",required:!0},{key:"roomType",label:"Space Type",required:!0},{key:"capacity",label:"Capacity (Marker)",required:!1},{key:"week",label:"Week",required:!1},{key:"day",label:"Day",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status",required:!0},{key:"attendeeCount",label:"Occupancy (Count)",required:!1}],D1e=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var i;try{const s=(i=a.target)==null?void 0:i.result,o=_p(s,{type:"binary"}),c=o.SheetNames[0],u=o.Sheets[c],f=br.sheet_to_json(u,{header:1});t(f)}catch(s){r(s)}},n.onerror=a=>r(a),n.readAsBinaryString(e)}),I1e=(e,t)=>{const r=e.map(i=>String(i).toLowerCase().trim()),n={},a=i=>r.findIndex(s=>i.some(o=>s.includes(o)));return n.date=a(["date","timestamp"]),n.timeSlot=a(["time","slot","hour","start","period"]),n.floor=a(["floor","level","zone","lvl"]),n.week=a(["week","wk"]),n.day=a(["day"]),n.roomName=a(["room","name","id","department","dept"]),n.roomType=a(["type","category","kind"]),n.capacity=a(["cap","seat","pax"]),n.isOccupied=a(["status","state"]),n.attendeeCount=a(["occupancy","actual","pax","people","count"]),Object.keys(n).forEach(i=>{n[i]===-1&&delete n[i]}),n},R1e=(e,t,r)=>{const a=J5.filter(o=>o.required&&t[o.key]===void 0),i=[],s=e.slice(1,11);if(s.length>0&&t.isOccupied!==void 0){const o=t.isOccupied;s.some(u=>{const f=String(u[o]).toLowerCase();return f.includes("occ")||f==="1"||f==="0"||f==="yes"||f==="no"||f==="true"||f==="false"})||i.push("Status column values don't look standard (e.g. 'Occupied', '1', 'Yes').")}if(s.length>0&&t.timeSlot!==void 0){const o=t.timeSlot;s.some(u=>{const f=String(u[o]);return f.includes(":")||!isNaN(parseFloat(f))})||i.push("Time column doesn't appear to contain time formats.")}return{isValid:a.length===0,missingFields:a.map(o=>o.label),warnings:i}},$1e=e=>{if(e===1||e==="1")return!0;if(typeof e=="string"){const t=e.toLowerCase().trim();if(t.includes("unoccupied"))return!1;if(t.includes("occupied")||t==="yes"||t==="y"||t==="occ")return!0}return!1},x4=(e,t,r)=>{const n=[],a=i=>{const s=String(i).toLowerCase().trim();return["level","floor","department","room","type","capacity","status","occupancy","week","day","time"].includes(s)};for(let i=1;i<e.length;i++){const s=e[i];if(!s||s.length===0)continue;const o=g=>{const y=t[g];return y!==void 0?s[y]:void 0},c=String(o("date")||""),u=String(o("timeSlot")||""),f=String(o("floor")||"Unknown").trim(),d=o("week"),h=o("day"),p=parseInt(d)||void 0,m=parseInt(h)||void 0;if(!a(f)&&!(f==="Unknown"&&!u&&!c)){const g=$1e(o("isOccupied")),y=o("attendeeCount");let v=0;if(g){const b=parseInt(y);!isNaN(b)&&b>0?v=b:v=1}(u||m||p||f!=="Unknown")&&n.push({id:`mtg-${i}`,date:c,timeSlot:u||"Unknown Time",floor:f,roomName:String(o("roomName")||`Room ${i}`),roomType:String(o("roomType")||"Meeting Room"),capacity:1,attendeeCount:v,isOccupied:g,week:p,day:m})}}return n},L1e=e=>e===1?"1p":e===2?"2p":e>=3&&e<=4?"3-4p":e>=5&&e<=7?"5-7p":e>=8&&e<=11?"8-11p":e>=12?"12p+":"0p",e6=e=>{const t=new Map,r=new Set;e.forEach(s=>{if(s.roomName&&r.add(s.roomName),!s.timeSlot)return;const o=s.week||1,c=s.day||1,u=s.timeSlot.trim(),f=`W${o}-D${c}-${u}`;t.has(f)||t.set(f,{week:o,day:c,timeStr:u,allRooms:new Set,occupiedRooms:new Set});const d=t.get(f),h=s.roomName||"Unknown";d.allRooms.add(h),s.isOccupied&&d.occupiedRooms.add(h)});const n=Array.from(t.values()).map(s=>{const o=s.allRooms.size,c=s.occupiedRooms.size,u=o>0?c/o*100:0;let f=0;if(s.timeStr.includes(":")){const h=s.timeStr.split(":");f=(parseInt(h[0])||0)*60+(parseInt(h[1])||0)}else{const h=parseFloat(s.timeStr);isNaN(h)||(h<1?f=h*1440:f=h)}const d=s.week*1e5+s.day*2e3+f;return{time:`W${s.week} D${s.day} ${s.timeStr}`,sortKey:d,occupied:c,total:o,pct:u}}).sort((s,o)=>s.sortKey-o.sortKey).map(({time:s,occupied:o,total:c,pct:u})=>({time:s,occupied:o,total:c,pct:u})),a=n.length>0?n.reduce((s,o)=>s+o.pct,0)/n.length:0,i=n.length>0?Math.max(...n.map(s=>s.pct)):0;return{avgPct:a,maxPct:i,timeline:n,uniqueRoomsCount:r.size}},B1e=(e,t={})=>{const r=new Map;e.forEach(v=>{const b=`${v.floor}::${v.roomName}::${v.week}::${v.day}::${v.timeSlot}`;r.has(b)||r.set(b,{eventId:b,floor:v.floor,roomName:v.roomName||"Unknown",roomType:v.roomType||"General",week:v.week||0,day:v.day||0,time:v.timeSlot,attendees:0,occupied:!1,rawRowIds:[]});const x=r.get(b);x.rawRowIds.push(v.id),v.isOccupied&&(x.occupied=!0,x.attendees+=v.attendeeCount||1)});const n=new Map,a={},i=["1p","2p","3-4p","5-7p","8-11p","12p+"];i.forEach(v=>a[v]=0);let s=0,o=0;r.forEach(v=>{const b=`${v.floor}::${v.roomName}`;n.has(b)||n.set(b,{floor:v.floor,name:v.roomName,type:v.roomType,totalMeetings:0,occupiedMeetings:0,totalAttendees:0,sizeCounts:{},binCounts:{},eventsBySize:{},fitBuckets:{low:[],mid:[],fit:[],over:[]}});const x=n.get(b);if(x.totalMeetings++,v.occupied&&v.attendees>0){x.occupiedMeetings++,x.totalAttendees+=v.attendees,s++,o+=v.attendees;const _=v.attendees;x.sizeCounts[_]=(x.sizeCounts[_]||0)+1;const w={week:v.week,day:v.day,time:v.time,attendees:v.attendees,eventId:v.eventId,floor:v.floor,roomName:v.roomName,roomType:v.roomType,rawRowIds:v.rawRowIds};x.eventsBySize[_]||(x.eventsBySize[_]=[]),x.eventsBySize[_].push(w);const S=L1e(_);x.binCounts[S]=(x.binCounts[S]||0)+1,a[S]=(a[S]||0)+1;const k=t[b]||0;if(k>0){const N=v.attendees/k;N<.4?x.fitBuckets.low.push(w):N<.7?x.fitBuckets.mid.push(w):N<=1?x.fitBuckets.fit.push(w):x.fitBuckets.over.push(w)}}});const c=[];n.forEach((v,b)=>{const x=Object.keys(v.sizeCounts).map(J=>{const le=parseInt(J),se=v.sizeCounts[le],Q=v.occupiedMeetings>0?se/v.occupiedMeetings*100:0,te=(v.eventsBySize[le]||[]).sort((fe,P)=>fe.day!==P.day?fe.day-P.day:fe.time.localeCompare(P.time));return{floor:v.floor,roomName:v.name,size:le,count:se,occupancyPct:Q,events:te}}).sort((J,le)=>J.size-le.size);let _=0,w=0;x.forEach(J=>{J.count>w&&(w=J.count,_=J.size)});const S=v.occupiedMeetings>0?w/v.occupiedMeetings*100:0,k=_>0?`${_}p (${S.toFixed(0)}%)`:"-",N=t[b]||0,j=v.occupiedMeetings>0?v.totalAttendees/v.occupiedMeetings:0,E=N>0?j/N:0;let A="Mixed Pattern / Review Required";if(N===0||v.occupiedMeetings===0)A="Unclassified";else{const J=Math.round(N),le=Math.round(_),se=Math.round(j),Q=Math.round(.5*J),te=Math.round(.7*J),fe=Math.round(.8*J);le<Q&&se<Q?A="Underutilized / Size Mismatch":le>=Q&&le<=te||se>=Q&&se<=te?A="Reasonably Utilized":le>=fe&&se>=fe?A="Over Utilized":A="Mixed Pattern / Review Required"}const T=v.fitBuckets.low.length,F=v.fitBuckets.mid.length,G=v.fitBuckets.fit.length,M=v.fitBuckets.over.length,W=v.occupiedMeetings>0?T/v.occupiedMeetings:0,Y=v.occupiedMeetings>0?F/v.occupiedMeetings:0,K=v.occupiedMeetings>0?G/v.occupiedMeetings:0,D=v.occupiedMeetings>0?M/v.occupiedMeetings:0,Z=Math.round(j),ee=E,O=_,L=Math.round(O),R=N>0?O/N:0,X=k;c.push({floor:v.floor,roomName:v.name,roomType:v.type,capacity:N,observedSlots:v.totalMeetings,occupiedSlots:v.occupiedMeetings,utilizationPct:v.totalMeetings>0?v.occupiedMeetings/v.totalMeetings*100:0,avgOccupancy:j,meetingSizeDistribution:v.binCounts,sizeBreakdown:x,topMeetingSize:k,avgCapRatio:E,classification:A,analysis:{avgOccRaw:j,avgOccRounded:Z,avgRatio:ee,typicalBin:X,typicalTypeVal:O,typicalRounded:L,typicalRatio:R,statusRule:A},capacityFit:{low:{count:T,pct:W*100,events:v.fitBuckets.low},mid:{count:F,pct:Y*100,events:v.fitBuckets.mid},fit:{count:G,pct:K*100,events:v.fitBuckets.fit},over:{count:M,pct:D*100,events:v.fitBuckets.over}}})});const u=c.reduce((v,b)=>v+b.observedSlots,0),f=i.map(v=>({label:v,count:a[v],occupancyPct:s>0?a[v]/s*100:0})),d=[],h=a["1p"]||0,p=a["2p"]||0,m=a["8-11p"]||0,g=a["12p+"]||0;if(s>0){const v=(h+p)/s*100,b=(m+g)/s*100;v>60&&d.push("Most interactions are small-format (1-2p), suggesting high demand for focus or dyad rooms."),b>15&&d.push("Notable volume of mid-to-large meetings indicates valid need for formal conference spaces."),b<5&&d.push("Large meetings (8p+) are infrequent; consider repurposing large boardrooms."),a["3-4p"]>a["1p"]&&d.push("Small group collaboration (3-4p) is a dominant behavior.")}else d.push("Insufficient data to generate behavioral insights.");const y=e6(e);return{avgOccupancy:0,peakOccupancy:0,occupancyByTime:[],occupancyByFloor:[],roomMetrics:c,totalObservations:u,totalRooms:n.size,overallUtilization:u>0?s/u*100:0,overallAvgAttendees:s>0?o/s:0,globalSizeBins:f,globalInsights:d,concurrencyStats:y}},U1e=e=>{const t=[],r=["L10","L11","L12"],n=["09:00","10:00","11:00","13:00","14:00","15:00","16:00"];{const a=[{name:"Focus 01",type:"Focus Room"},{name:"Meet 01",type:"Meeting Room"},{name:"Meet 02",type:"Meeting Room"},{name:"Boardroom",type:"Boardroom"}];for(let i=0;i<500;i++){const s=a[Math.floor(Math.random()*a.length)],o=n[Math.floor(Math.random()*n.length)],c=r[Math.floor(Math.random()*r.length)],u=Math.floor(Math.random()*5)+1;if(!(Math.random()>.3))t.push({id:`sim-empty-${i}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!1,date:""});else{const d=Math.floor(Math.random()*8)+1;for(let h=0;h<d;h++)t.push({id:`sim-occ-${i}-${h}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!0,attendeeCount:1,date:""})}}}return t},z1e=()=>{const[e,t]=H.useState("import"),[r,n]=H.useState("meeting"),[a,i]=H.useState([]),[s,o]=H.useState([]),[c,u]=H.useState({}),[f,d]=H.useState([]),[h,p]=H.useState(null),[m,g]=H.useState(!1),[y,v]=H.useState(1),[b,x]=H.useState(""),[_,w]=H.useState(null),[S,k]=H.useState(!1),N=(A,T)=>{k(!0),i(A),x(T);const F=A[0];o(F);const G=I1e(F);u(G);const M=x4(A,G);d(M);const W=R1e(A,G);!W.isValid||W.warnings.length>0?(p({missing:W.missingFields,warnings:W.warnings}),g(!0)):(p(null),g(!1)),setTimeout(()=>{k(!1),t("results")},800)},j=async A=>{var F;const T=(F=A.target.files)==null?void 0:F[0];if(T)try{const G=await D1e(T);G&&G.length>0?(N(G,T.name),w(null)):w("File appears empty.")}catch{w("Failed to parse Excel.")}},E=()=>{const A=U1e();d(A),x("Sample_Data.xlsx"),g(!1),t("results")};return e==="results"?l.jsx(W1e,{records:f,type:r,onBack:()=>{t("import"),v(1)},headers:s,rawData:a,currentMappings:c,initialShowMapping:m,onUpdateMappings:A=>{u(A);const T=x4(a,A);d(T)}}):l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 overflow-hidden",children:[l.jsx("div",{className:"p-6 border-b border-slate-200 bg-white flex justify-between items-center",children:l.jsxs("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(fc,{className:"w-6 h-6 text-orange-500"})," Utilization Study"]})}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[500px] flex flex-col justify-center",children:[y===1&&l.jsxs("div",{className:"p-10 text-center animate-in fade-in",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Study Type"}),l.jsx("p",{className:"text-slate-500 mb-8",children:"Choose the analytical lens for your observation data."}),l.jsx("div",{className:"flex justify-center max-w-2xl mx-auto",children:l.jsxs("button",{onClick:()=>{n("meeting"),v(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden w-full max-w-sm",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(Fr,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(Fr,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Meeting Utilization"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Evaluate room capacity sizing and frequency of use."})]})})]}),y===2&&l.jsx("div",{className:"p-10 text-center animate-in fade-in",children:S?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-600 rounded-full animate-spin mb-6"}),l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Processing Data..."}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Auto-detecting columns and calculating metrics."})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:l.jsx(ZT,{className:"w-10 h-10 text-slate-400"})}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Upload Data Source"}),l.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:"Upload your Excel observation log. The system will automatically detect fields like Date, Time, Floor, and Occupancy."}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("label",{className:"cursor-pointer bg-slate-900 hover:bg-slate-800 text-white px-8 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3",children:[l.jsx(qy,{className:"w-5 h-5"}),"Select Excel File",l.jsx("input",{type:"file",className:"hidden",accept:".xlsx, .xls",onChange:j})]}),l.jsx("button",{onClick:E,className:"text-sm font-bold text-slate-400 hover:text-orange-600 transition-colors py-2",children:"Use Sample Dataset"})]}),_&&l.jsxs("div",{className:"mt-6 bg-rose-50 text-rose-600 px-4 py-3 rounded-lg inline-flex items-center gap-2 text-sm font-medium",children:[l.jsx(ur,{className:"w-4 h-4"})," ",_]}),l.jsx("button",{onClick:()=>v(1),className:"mt-12 text-xs font-bold text-slate-400 hover:text-slate-600",children:" Back to Study Type"})]})})]})})]})},W1e=({records:e,type:t,onBack:r,headers:n,rawData:a,currentMappings:i,initialShowMapping:s,onUpdateMappings:o})=>{const[c,u]=H.useState(!1),[f,d]=H.useState(null),[h,p]=H.useState(null),[m,g]=H.useState({});H.useEffect(()=>{c&&g({...i})},[c,i]),H.useEffect(()=>{s&&u(!0)},[s]);const y=()=>{o(m),u(!1)},[v,b]=H.useState({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),[x,_]=H.useState({});H.useMemo(()=>{const T=new Set,F=new Set,G=new Set,M=new Set,W=new Set,Y=new Set,K=new Set,D=new Set,Z=ee=>["level","floor","department","room","type","capacity","week","day","time"].includes(String(ee).toLowerCase().trim());return e.forEach(ee=>{ee.floor&&!Z(ee.floor)&&T.add(ee.floor),ee.roomName&&!Z(ee.roomName)&&F.add(ee.roomName),ee.roomType&&!Z(ee.roomType)&&G.add(ee.roomType),ee.week!==void 0&&M.add(ee.week.toString()),ee.day!==void 0&&W.add(ee.day),ee.timeSlot&&!Z(ee.timeSlot)&&Y.add(ee.timeSlot),ee.department&&!Z(ee.department)&&K.add(ee.department),ee.date&&D.add(ee.date)}),{floors:Array.from(T).sort(),rooms:Array.from(F).sort(),types:Array.from(G).sort(),weeks:Array.from(M).sort((ee,O)=>parseInt(ee)-parseInt(O)),days:Array.from(W).sort((ee,O)=>ee-O).map(String),timeSlots:Array.from(Y).sort(),depts:Array.from(K).sort(),dates:Array.from(D).sort()}},[e]);const w=H.useMemo(()=>e.filter(T=>{if(v.floors.length&&!v.floors.includes(T.floor)||v.timeSlots.length&&!v.timeSlots.includes(T.timeSlot))return!1;if(t==="meeting"){if(v.rooms.length&&T.roomName&&!v.rooms.includes(T.roomName)||v.types.length&&T.roomType&&!v.types.includes(T.roomType)||v.weeks.length&&T.week!==void 0&&!v.weeks.includes(T.week.toString())||v.days.length&&T.day!==void 0&&!v.days.includes(T.day.toString()))return!1}else if(v.depts.length&&T.department&&!v.depts.includes(T.department)||v.dates.length&&T.date&&!v.dates.includes(T.date))return!1;return!0}),[e,v,t]),S=H.useMemo(()=>B1e(w,x),[w,t,x]),k=J5,N=k.filter(T=>T.required&&i[T.key]===void 0),j=N.length>0,E=(T,F,G)=>{const M=`${T}::${F}`;_(W=>({...W,[M]:G}))},A=()=>{const T=br.book_new(),F=br.json_to_sheet(w);if(br.book_append_sheet(T,F,"Raw Data"),t==="meeting"&&S.roomMetrics){const G=S.roomMetrics.map(W=>({Floor:W.floor,"Room Name":W.roomName,Type:W.roomType,"Room Capacity (User)":W.capacity,"Observed Slots":W.observedSlots,"Occupied Slots":W.occupiedSlots,"Utilization %":(W.utilizationPct/100).toFixed(2),"Avg Occupancy":W.avgOccupancy.toFixed(1),"Top Meeting Size":W.topMeetingSize,Classification:W.classification})),M=br.json_to_sheet(G);br.book_append_sheet(T,M,"Room Performance")}em(T,"Utilization_Analysis.xlsx")};return l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 relative",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm z-20",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 transition-colors",children:l.jsx(Pr,{className:"w-5 h-5 rotate-180"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:["Meeting Utilization",j&&l.jsxs("span",{title:"Mapping Incomplete",className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-200",children:[l.jsx(ur,{className:"w-3 h-3"})," Fix Mapping"]})]}),l.jsxs("p",{className:"text-xs text-slate-500",children:[w.length," Observations Analyzed"]})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white border border-transparent rounded-lg text-xs font-bold shadow-sm",children:[l.jsx(ra,{className:"w-4 h-4"})," Export"]})})]}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto custom-scrollbar",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:w.length===0?l.jsxs("div",{className:"text-center py-20 text-slate-400",children:[l.jsx(pv,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),l.jsx("p",{children:"No records match the current filters."})]}):l.jsx(q1e,{metrics:S,records:w,onUpdateCapacity:E,onDrillDown:(T,F,G)=>d({title:T,events:F,context:G})})})}),c&&l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[450px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800",children:"Auto Field Detection"}),l.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Map Excel columns to required system fields."})]}),l.jsx("button",{onClick:()=>u(!1),children:l.jsx(on,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[j&&l.jsxs("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[l.jsx(ur,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block mb-1",children:"Missing Required Fields"}),l.jsx("ul",{className:"list-disc list-inside space-y-0.5",children:N.map(T=>l.jsx("li",{children:T.label},T.key))})]})]}),l.jsx("div",{className:"space-y-6",children:k.map(T=>{const F=m[T.key],G=F!==void 0&&a.length>1?a.slice(1,4).map(M=>M[F]).filter(M=>M!==void 0&&M!==""):[];return l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm",children:[l.jsxs("label",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[T.label,T.required&&l.jsx("span",{className:"text-rose-500",title:"Required",children:"*"})]}),F===void 0&&T.required&&l.jsx("span",{className:"text-[9px] text-rose-500 font-bold uppercase bg-rose-50 px-1.5 py-0.5 rounded",children:"Unmapped"})]}),l.jsxs("select",{className:`w-full p-2 text-sm border rounded outline-none transition-all ${F===void 0&&T.required?"border-rose-300 bg-rose-50 focus:border-rose-500":"border-slate-300 bg-white focus:border-indigo-500"}`,value:F??"",onChange:M=>{const W=M.target.value,Y={...m};W===""?delete Y[T.key]:Y[T.key]=parseInt(W),g(Y)},children:[l.jsx("option",{value:"",children:"(Select Excel Column)"}),n.map((M,W)=>l.jsx("option",{value:W,children:M},W))]}),l.jsx("div",{className:"mt-2 min-h-[1.5em]",children:F!==void 0?l.jsxs("div",{className:"text-[10px] text-slate-500 flex items-start gap-1.5 bg-slate-50 p-1.5 rounded",children:[l.jsx("span",{className:"font-bold text-slate-400 uppercase text-[9px] mt-0.5",children:"Preview:"}),l.jsx("span",{className:"font-mono text-slate-700 break-all leading-tight",children:G.length>0?G.join(", "):l.jsx("span",{className:"italic text-slate-400",children:"Empty column"})})]}):l.jsx("div",{className:"text-[10px] text-slate-300 italic pl-1",children:"Map a column to see preview"})})]},T.key)})})]}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:y,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(Cn,{className:"w-4 h-4"})," Apply Mapping"]})})]})}),f&&l.jsx(H1e,{title:f.title,events:f.events,context:f.context,onClose:()=>d(null),onJumpToRaw:T=>p(T)}),h&&l.jsx(V1e,{ids:h,allRecords:e,onClose:()=>p(null)})]})},H1e=({title:e,events:t,context:r,onClose:n,onJumpToRaw:a})=>{const i=()=>{const s=t.map(u=>({Week:u.week,Day:u.day,Time:u.time,Floor:u.floor,Room:u.roomName,Type:u.roomType,Attendees:u.attendees})),o=br.book_new(),c=br.json_to_sheet(s);br.book_append_sheet(o,c,"Events"),em(o,"Drilldown_Events.xlsx")};return l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[600px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-6 border-b border-slate-200 bg-slate-50 flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e,l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-sm px-2 py-0.5 rounded-full",children:t.length})]}),r&&l.jsxs("div",{className:"mt-2 p-2 bg-indigo-50 border border-indigo-100 rounded text-xs text-indigo-700 font-medium",children:["These events contribute to the room being classified as ",l.jsx("span",{className:"font-bold uppercase",children:r}),"."]})]}),l.jsx("button",{onClick:n,children:l.jsx(on,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-0",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-white border-b border-slate-200 text-xs text-slate-500 uppercase font-semibold sticky top-0 z-10 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Wk-Day"}),l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Time"}),l.jsx("th",{className:"px-6 py-3 bg-white",children:"Room"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Attendees"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t.map((s,o)=>l.jsxs("tr",{className:"hover:bg-slate-50 group",children:[l.jsxs("td",{className:"px-6 py-3 font-medium text-slate-500",children:["W",s.week,"-D",s.day]}),l.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.time}),l.jsxs("td",{className:"px-6 py-3 text-slate-700",children:[l.jsx("div",{className:"truncate w-32",title:s.roomName,children:s.roomName}),l.jsx("div",{className:"text-[10px] text-slate-400",children:s.roomType})]}),l.jsx("td",{className:"px-6 py-3 text-right font-bold text-indigo-600",children:s.attendees}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("button",{onClick:()=>a(s.rawRowIds),className:"text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx(Qp,{className:"w-3 h-3"})," Raw Data"]})})]},o))})]})}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:i,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(ra,{className:"w-4 h-4"})," Export Events CSV"]})})]})})},V1e=({ids:e,allRecords:t,onClose:r})=>{const n=t.filter(a=>e.includes(a.id));return l.jsx("div",{className:"absolute inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[80vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2",children:[l.jsx(Qp,{className:"w-5 h-5 text-indigo-600"})," Source Data Inspection"]}),l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Showing ",n.length," raw Excel row(s) corresponding to selected event."]})]}),l.jsx("button",{onClick:r,children:l.jsx(on,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-auto p-6 bg-slate-50/50",children:l.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"ID"}),l.jsx("th",{className:"px-4 py-3",children:"Floor"}),l.jsx("th",{className:"px-4 py-3",children:"Room / Dept"}),l.jsx("th",{className:"px-4 py-3",children:"Day"}),l.jsx("th",{className:"px-4 py-3",children:"Time"}),l.jsx("th",{className:"px-4 py-3",children:"Occupancy"}),l.jsx("th",{className:"px-4 py-3",children:"Status"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(a=>l.jsxs("tr",{className:"hover:bg-indigo-50/30",children:[l.jsx("td",{className:"px-4 py-2 font-mono text-slate-400",children:a.id}),l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:a.floor}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.roomName||a.department}),l.jsxs("td",{className:"px-4 py-2 text-slate-600",children:["Day ",a.day]}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.timeSlot}),l.jsx("td",{className:"px-4 py-2 font-bold text-indigo-600",children:a.attendeeCount||1}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${a.isOccupied?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:a.isOccupied?"Occupied":"Vacant"})})]},a.id))})]})})}),l.jsx("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end",children:l.jsx("button",{onClick:r,className:"px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-bold transition-colors",children:"Close"})})]})})},G1e=({row:e})=>{const[t,r]=H.useState(!1);if(!e.capacity||e.capacity===0)return l.jsx("div",{className:"text-xs text-slate-400 italic",children:"Set capacity to evaluate fit."});const n=e.sizeBreakdown.map(m=>({label:`${m.size}p`,pct:m.occupancyPct,count:m.count,size:m.size})).filter(m=>m.pct>0),a=m=>m<=1?"bg-slate-200":m<=2?"bg-slate-300":m<=4?"bg-indigo-200":m<=6?"bg-indigo-300":m<=10?"bg-indigo-400":"bg-indigo-500",s=(m=>m.includes("Under")?{class:"bg-blue-50 text-blue-700 border-blue-200",icon:Up}:m.includes("Reasonably")||m.includes("Well")?{class:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:fa}:m.includes("Over")?{class:"bg-rose-50 text-rose-700 border-rose-200",icon:ur}:{class:"bg-amber-50 text-amber-700 border-amber-200",icon:Gp})(e.classification),o=s.icon;let c="";e.classification.includes("Underutilized")?c="Most meetings occur well below room capacity.":e.classification.includes("Over")?c="Meetings frequently approach or exceed room capacity.":e.classification.includes("Reasonably")?c="Room usage generally aligns with its designed capacity.":c="Meeting size patterns vary significantly and require review.";const u=Math.round(e.capacity),f=Math.round(.5*u),d=Math.round(.7*u),h=Math.round(.8*u),p=parseInt(e.topMeetingSize.split("p")[0])||0;return l.jsxs("div",{className:"flex flex-col gap-4 w-full relative",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border flex items-center gap-1.5 ${s.class}`,children:[l.jsx(o,{className:"w-3 h-3"}),e.classification]}),l.jsx("button",{onClick:()=>r(!t),className:`p-1 rounded hover:bg-slate-100 ${t?"text-indigo-600 bg-indigo-50":"text-slate-400"}`,title:"Explain Logic",children:l.jsx(t0,{className:"w-3 h-3"})})]}),t&&l.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded p-3 text-[10px] space-y-2 animate-in fade-in slide-in-from-top-1 mt-1",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2 border-b border-slate-200 pb-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Capacity"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[u," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Primary"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[p," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Avg Occ"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Logic Applied"}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["< ",f," pax"]}),l.jsx("span",{children:"Underutilized"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:[f,"",d," pax"]}),l.jsx("span",{children:"Reasonable"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["> ",h," pax"]}),l.jsx("span",{children:"Over Utilized"})]})]}),l.jsx("div",{className:"pt-1 text-slate-500 italic",children:"Values are rounded before comparison. Primary size or Avg Occ must trigger threshold."})]}),!t&&l.jsx("div",{className:"text-[10px] text-slate-500 italic",children:c})]}),l.jsx("div",{className:"relative h-8 w-full mt-1",children:l.jsx("div",{className:"absolute inset-0 flex rounded-md overflow-hidden h-full border border-white bg-slate-50",children:n.map((m,g)=>l.jsx("div",{style:{width:`${m.pct}%`},className:`${a(m.size)} h-full border-r border-white last:border-0 relative group flex items-center justify-center transition-colors hover:brightness-95`,title:`${m.label}: ${m.pct.toFixed(1)}%`,children:m.pct>8&&l.jsx("span",{className:"text-[9px] font-bold text-slate-700 opacity-80 whitespace-nowrap px-1",children:m.label})},g))})}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-500 font-medium flex gap-3 border-b border-slate-100 pb-2",children:[l.jsxs("span",{children:["Room Capacity: ",l.jsxs("strong",{className:"text-slate-700",children:[e.capacity," pax"]})]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:["Avg Occupancy: ",l.jsxs("strong",{className:"text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsx("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:n.map((m,g)=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${a(m.size)}`}),l.jsxs("span",{className:"text-[9px] text-slate-400 font-medium",children:[m.label," (",m.pct.toFixed(0),"%)"]})]},g))})]})]})},X1e=({stats:e,totalRooms:t,roomTypes:r,selectedType:n,onSelectType:a})=>{const[i,s]=H.useState({bar:"#cbd5e1",highlight:"#f43f5e",line:"#6366f1"}),[o,c]=H.useState(!1),[u,f]=H.useState(!1),d=H.useRef(null);if(H.useEffect(()=>{const x=localStorage.getItem("mm_chart_colors");if(x)try{s(JSON.parse(x))}catch{}},[]),!e||!e.timeline)return null;const h=Math.round(e.avgPct/100*e.uniqueRoomsCount),p=Math.round(e.maxPct/100*e.uniqueRoomsCount),m=n==="All Rooms"?"OVERALL ROOM OCCUPANCY (CONCURRENCY)":`${n.toUpperCase()} OCCUPANCY (CONCURRENCY)`,g=x=>{s(x),localStorage.setItem("mm_chart_colors",JSON.stringify(x))},y=()=>{g({bar:"#cbd5e1",highlight:"#f43f5e",line:"#6366f1"})},v=()=>{const x=["Time","Occupied Rooms","Total Rooms","Concurrency %"],_=e.timeline.map(k=>[k.time,k.occupied,k.total,k.pct.toFixed(2)]),w="data:text/csv;charset=utf-8,"+[x.join(","),..._.map(k=>k.join(","))].join(`
`),S=document.createElement("a");S.setAttribute("href",encodeURI(w)),S.setAttribute("download","concurrency_data.csv"),document.body.appendChild(S),S.click(),document.body.removeChild(S),f(!1)},b=()=>{if(!d.current)return;const x=d.current.querySelector("svg");if(!x)return;const w=new XMLSerializer().serializeToString(x),S=new Blob([w],{type:"image/svg+xml;charset=utf-8"}),k=URL.createObjectURL(S),N=document.createElement("canvas");N.width=1200,N.height=600;const j=N.getContext("2d");if(!j)return;j.fillStyle="#ffffff",j.fillRect(0,0,N.width,N.height);const E=new Image;E.onload=()=>{j.drawImage(E,40,40,1120,520);const A=N.toDataURL("image/png"),T=document.createElement("a");T.download="concurrency_chart.png",T.href=A,T.click(),URL.revokeObjectURL(k),f(!1)},E.src=k};return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8 relative",children:[l.jsxs("div",{className:"md:w-1/3 flex flex-col justify-center space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase",children:m}),l.jsxs("div",{className:"relative group",children:[l.jsx("select",{className:"appearance-none bg-slate-50 border border-slate-200 text-xs font-bold text-slate-700 py-1 pl-2 pr-6 rounded-md hover:border-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 cursor-pointer max-w-[140px] truncate",value:n,onChange:x=>a(x.target.value),children:r.map(x=>l.jsx("option",{value:x,children:x},x))}),l.jsx(Xr,{className:"w-3 h-3 text-slate-400 absolute right-2 top-1.5 pointer-events-none"})]})]}),l.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Based on concurrent usage across all observed time slots."}),l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>f(!u),className:"p-2 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 text-slate-500 hover:text-indigo-600 transition-colors",title:"Download",children:l.jsx(ra,{className:"w-4 h-4"})}),u&&l.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-40 bg-white border border-slate-200 rounded-lg shadow-xl z-20 overflow-hidden",children:[l.jsxs("button",{onClick:b,className:"w-full text-left px-4 py-2 text-xs font-bold text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[l.jsx(D8,{className:"w-3 h-3"})," Download PNG"]}),l.jsxs("button",{onClick:v,className:"w-full text-left px-4 py-2 text-xs font-bold text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[l.jsx(hc,{className:"w-3 h-3"})," Download CSV"]})]})]}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>c(!o),className:`p-2 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors ${o?"text-indigo-600 border-indigo-200":"text-slate-500"}`,title:"Chart Colors",children:l.jsx(qp,{className:"w-4 h-4"})}),o&&l.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 p-4 animate-in fade-in slide-in-from-bottom-2",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-800 mb-3 border-b border-slate-100 pb-2",children:"Chart Theme"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Standard Bar"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.bar,onChange:x=>g({...i,bar:x.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.bar})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Max Peak (Highlight)"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.highlight,onChange:x=>g({...i,highlight:x.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.highlight})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Average Line"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.line,onChange:x=>g({...i,line:x.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.line})]})]}),l.jsxs("button",{onClick:y,className:"w-full mt-2 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded text-[10px] font-bold flex items-center justify-center gap-1",children:[l.jsx(XT,{className:"w-3 h-3"})," Reset Defaults"]})]})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Average Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[e.avgPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",h," rooms in use"]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Max Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-rose-500",children:[e.maxPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",p," rooms in use"]})]})]})]}),l.jsx("div",{className:"md:w-2/3 h-64",ref:d,children:e.timeline.length>0?l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(g0,{data:e.timeline,margin:{top:20,right:20,left:0,bottom:0},children:[l.jsx(Pf,{strokeDasharray:"3 3",vertical:!1}),l.jsx(la,{dataKey:"time",tick:{fontSize:10},interval:"preserveStartEnd",minTickGap:30}),l.jsx(ca,{unit:"%",tick:{fontSize:10},domain:[0,100]}),l.jsx(ir,{content:({active:x,payload:_,label:w})=>{if(x&&_&&_.length){const S=_[0].payload;return l.jsxs("div",{className:"bg-white p-2 border border-slate-200 rounded shadow-lg text-xs",children:[l.jsx("div",{className:"font-bold text-slate-800 mb-1",children:w}),l.jsxs("div",{className:"text-indigo-600 font-bold",children:[S.pct.toFixed(1),"% Occupied"]}),l.jsxs("div",{className:"text-slate-500",children:[S.occupied," / ",S.total," Rooms Observed"]})]})}return null}}),l.jsx(x0,{y:e.avgPct,stroke:i.line,strokeDasharray:"3 3",label:{value:"Avg",position:"insideTopRight",fill:"#6366f1",fontSize:10}}),l.jsx(Ia,{dataKey:"pct",fill:i.bar,radius:[2,2,0,0],children:e.timeline.map((x,_)=>l.jsx(Ci,{fill:x.pct===e.maxPct?i.highlight:i.bar},`cell-${_}`))})]})}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-100 rounded-xl",children:[l.jsx(fc,{className:"w-8 h-8 mb-2"}),l.jsx("p",{className:"text-xs",children:"No occupied observations for selected room type."})]})})]})},K1e=({metrics:e})=>{const t=e.globalSizeBins,r=t.map(n=>({name:n.label,value:n.count,pct:n.occupancyPct,fill:n.label.includes("12p")?vr.program[5]:n.label.includes("8-11")?vr.program[2]:n.label.includes("5-7")?vr.program[1]:n.label.includes("3-4")?vr.program[3]:vr.program[0]}));return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"flex-1 min-w-[300px]",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Meeting Size Distribution (Occupancy %)"}),l.jsx("div",{className:"h-64",children:l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(Hx,{children:[l.jsxs(pa,{data:r,dataKey:"pct",nameKey:"name",innerRadius:60,outerRadius:80,paddingAngle:2,children:[r.map((n,a)=>l.jsx(Ci,{fill:n.fill,stroke:"none"},`cell-${a}`)),l.jsx(Dn,{dataKey:"name",position:"outside",style:{fontSize:10,fill:"#64748b",fontWeight:"bold"}})]}),l.jsx(ir,{formatter:(n,a,i)=>[`${n.toFixed(1)}% (${i.payload.value} mtgs)`,a],contentStyle:{borderRadius:"8px",fontSize:"12px"}}),l.jsx(na,{verticalAlign:"bottom",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Global Distribution"}),l.jsx("div",{className:"bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occupancy %"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-200",children:t.map(n=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:n.label}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-500",children:n.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-bold text-indigo-600",children:[n.occupancyPct.toFixed(1),"%"]})]},n.label))})]})})]}),l.jsxs("div",{className:"flex-1 bg-indigo-50 rounded-xl border border-indigo-100 p-5",children:[l.jsxs("h3",{className:"text-xs font-bold text-indigo-800 uppercase mb-3 flex items-center gap-2",children:[l.jsx(BT,{className:"w-4 h-4 text-indigo-600"})," Work Behaviors"]}),l.jsx("ul",{className:"space-y-3",children:e.globalInsights.map((n,a)=>l.jsxs("li",{className:"flex gap-2 text-xs text-indigo-900 leading-relaxed",children:[l.jsx(zp,{className:"w-3 h-3 text-indigo-400 mt-0.5 flex-shrink-0"}),n]},a))})]})]})},q1e=({metrics:e,records:t,onUpdateCapacity:r,onDrillDown:n})=>{const[a,i]=H.useState("utilizationPct"),[s,o]=H.useState(!1),[c,u]=H.useState(null),[f,d]=H.useState("All"),[h,p]=H.useState("All Rooms"),m=H.useMemo(()=>{let x=[...e.roomMetrics];return f!=="All"&&(x=x.filter(_=>f==="Under"?_.classification.includes("Under"):f==="Fit"?_.classification.includes("Reasonably")||_.classification.includes("Well"):f==="Over"?_.classification.includes("Over"):f==="Mixed"?_.classification.includes("Mixed")||_.classification.includes("Unclassified"):!0)),x.sort((_,w)=>{const S=_[a],k=w[a];return s?S-k:k-S})},[e.roomMetrics,a,s,f]),g=H.useMemo(()=>{const x=new Set;return t.forEach(_=>{_.roomType&&x.add(_.roomType.trim())}),["All Rooms",...Array.from(x).sort()]},[t]),y=H.useMemo(()=>{const x=h==="All Rooms"?t:t.filter(_=>(_.roomType||"").trim()===h);return e6(x)},[t,h]),v=x=>{if(!x.sizeBreakdown||x.sizeBreakdown.length===0)return"No data available.";const w=[...x.sizeBreakdown].sort((E,A)=>A.count-E.count)[0],k=x.sizeBreakdown.filter(E=>E.size<=2).reduce((E,A)=>E+A.occupancyPct,0);if(w.size<=2&&k>w.occupancyPct+5)return`Small meetings (12p) account for ${k.toFixed(0)}% of usage.`;const j=x.sizeBreakdown.filter(E=>E.size>=3&&E.size<=4).reduce((E,A)=>E+A.occupancyPct,0);return(w.size===3||w.size===4)&&j>w.occupancyPct+5?`34 pax meetings account for ${j.toFixed(0)}% of usage.`:"Most frequent occupancy observed."},b=x=>x.includes("Under")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded border border-blue-100",children:[l.jsx(Up,{className:"w-3 h-3"})," Under"]}):x.includes("Reasonably")||x.includes("Well")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded border border-emerald-100",children:[l.jsx(fa,{className:"w-3 h-3"})," Fit"]}):x.includes("Over")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-rose-600 bg-rose-50 px-2 py-0.5 rounded border border-rose-100",children:[l.jsx(ur,{className:"w-3 h-3"})," Over"]}):l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-100",children:[l.jsx(Gp,{className:"w-3 h-3"})," Mixed"]});return l.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsx(X1e,{stats:y,totalRooms:e.totalRooms,roomTypes:g,selectedType:h,onSelectType:p}),l.jsx(K1e,{metrics:e}),l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(YT,{className:"w-4 h-4 text-slate-500"})," Room Performance"]}),l.jsx("div",{className:"flex items-center gap-1 bg-white border border-slate-200 p-0.5 rounded-lg",children:["All","Under","Fit","Over","Mixed"].map(x=>l.jsx("button",{onClick:()=>d(x),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-colors ${f===x?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:x},x))}),l.jsxs("div",{className:"text-xs text-slate-400 hidden sm:block",children:[e.totalRooms," Rooms | ",e.totalObservations," Observations"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-xs uppercase text-slate-500 font-semibold",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("floor"),children:"Floor"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomName"),children:"Room Name"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomType"),children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-center w-24",children:"Capacity (Pax)"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("utilizationPct"),children:"Util %"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("avgOccupancy"),children:"Avg Occ."}),l.jsx("th",{className:"px-6 py-3 text-center",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-center w-10"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:m.map((x,_)=>{const w=c===`${x.floor}-${x.roomName}`;return l.jsxs(q.Fragment,{children:[l.jsxs("tr",{className:`hover:bg-slate-50 transition-colors cursor-pointer ${w?"bg-slate-50":""}`,onClick:()=>u(w?null:`${x.floor}-${x.roomName}`),children:[l.jsx("td",{className:"px-6 py-3 text-slate-600",children:x.floor}),l.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:x.roomName}),l.jsx("td",{className:"px-6 py-3 text-slate-500 text-xs",children:x.roomType}),l.jsx("td",{className:"px-6 py-3 text-center",onClick:S=>S.stopPropagation(),children:l.jsxs("div",{className:"relative group/edit w-20 mx-auto",children:[l.jsx("input",{type:"number",className:"w-full text-center border-b border-transparent hover:border-slate-300 focus:border-indigo-500 focus:outline-none bg-transparent",placeholder:"-",value:x.capacity||"",onChange:S=>r(x.floor,x.roomName,parseInt(S.target.value)||0)}),l.jsx(GT,{className:"w-3 h-3 text-slate-300 absolute right-0 top-1 opacity-0 group-hover/edit:opacity-100 pointer-events-none"})]})}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("span",{className:`px-2 py-1 rounded text-xs font-bold ${x.utilizationPct>50?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[x.utilizationPct.toFixed(0),"%"]})}),l.jsx("td",{className:"px-6 py-3 text-right font-mono text-slate-600",children:x.avgOccupancy.toFixed(1)}),l.jsx("td",{className:"px-6 py-3 text-center",children:b(x.classification)}),l.jsx("td",{className:"px-4 py-3 text-center text-slate-400",children:l.jsx(Xr,{className:`w-4 h-4 transition-transform ${w?"rotate-180":""}`})})]}),w&&l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"p-0 bg-slate-50 border-b border-slate-200",children:l.jsxs("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col justify-between",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase",children:"Room Snapshot"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Total Meetings (Occupied)"}),l.jsx("span",{className:"text-lg font-bold text-slate-800",children:x.occupiedSlots})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Room Utilization"}),l.jsxs("span",{className:`text-lg font-bold ${x.utilizationPct>50?"text-emerald-600":"text-slate-800"}`,children:[x.utilizationPct.toFixed(1),"%"]})]}),l.jsxs("div",{className:"pt-2 border-t border-slate-100 mt-2",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Primary Meeting Size"}),l.jsx("div",{className:"text-xl font-bold text-indigo-700",children:x.topMeetingSize}),l.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:v(x)})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Capacity Fit Analysis"}),l.jsx("div",{className:"flex-grow flex items-center",children:l.jsx(G1e,{row:x})})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden flex flex-col max-h-64",children:[l.jsx("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200",children:l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Size Breakdown"})}),l.jsx("div",{className:"flex-grow overflow-y-auto",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-white sticky top-0 text-slate-400 font-bold border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occ %"}),l.jsx("th",{className:"px-4 py-2"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-100",children:[x.sizeBreakdown.map((S,k)=>l.jsxs("tr",{className:"hover:bg-slate-50",children:[l.jsxs("td",{className:"px-4 py-2 font-bold text-slate-700",children:[S.size," pax"]}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-600",children:S.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-mono font-bold text-indigo-700",children:[S.occupancyPct.toFixed(0),"%"]}),l.jsx("td",{className:"px-4 py-2 text-right",children:l.jsxs("button",{onClick:()=>n(`${x.roomName} - ${S.size} Pax Meetings`,S.events,x.classification),className:"text-[9px] font-bold text-slate-400 hover:text-indigo-600 border border-slate-200 hover:border-indigo-200 px-2 py-1 rounded transition-colors",children:["View (",S.count,")"]})})]},k)),x.sizeBreakdown.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-4 text-center text-slate-400",children:"No data"})})]})]})})]})]})})})]},_)})})]})})]})]})},Cs=[{title:"Project Context",desc:"Define the strategic identity, scale, and physical constraints of your project. These inputs drive all subsequent capacity calculations.",icon:Xp},{title:"Strategy & Budget",desc:"Model scenarios by adjusting policy ratios (Sharing, Meeting, Support). See real-time impact on area demand vs supply.",icon:ps},{title:"Decision Framework",desc:"Compare scenarios side-by-side using strategic indicators like Density, Utilization Index, and Meeting Ratios.",icon:ms},{title:"Stacking & Mix",desc:"Visualize program distribution across floors. Ensure the 'Program Mix' aligns with organizational goals.",icon:Rn},{title:"Deep Analysis",desc:"Use Team Adjacency and Utilization Studies to validate your strategy with data-driven evidence.",icon:xs}],Y1e=({onClose:e})=>{const[t,r]=H.useState(0),n=()=>{t<Cs.length-1?r(t+1):e()},a=Cs[t].icon;return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"h-32 bg-gradient-to-r from-orange-500 to-rose-500 relative flex items-center justify-center",children:[l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-md",children:l.jsx(a,{className:"w-8 h-8 text-white"})}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white/70 hover:text-white",children:l.jsx(on,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsxs("div",{className:"text-xs font-bold text-orange-600 uppercase tracking-widest mb-2",children:["Step ",t+1," of ",Cs.length]}),l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:Cs[t].title}),l.jsx("p",{className:"text-slate-500 leading-relaxed mb-8 h-16",children:Cs[t].desc}),l.jsx("div",{className:"flex gap-2 justify-center mb-8",children:Cs.map((i,s)=>l.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${s===t?"w-8 bg-orange-500":"w-2 bg-slate-200"}`},s))}),l.jsxs("button",{onClick:n,className:"w-full py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg",children:[t===Cs.length-1?"Get Started":"Next Step"," ",l.jsx(Pr,{className:"w-4 h-4"})]})]})]})})},Q1e=()=>{const[e,t]=H.useState(ED),[r,n]=H.useState("home"),[a,i]=H.useState(!0),[s,o]=H.useState([{...iS,id:"s1",name:"Scenario A"}]),[c,u]=H.useState("s1"),[f,d]=H.useState(null),h=s.find(S=>S.id===c)||s[0],p=H.useMemo(()=>W1(e,h),[e,h]),m=s.find(S=>S.id===f),g=m?W1(e,m):null,y=S=>{o(k=>k.map(N=>N.id===S.id?S:N))},v=()=>{const S=`s${Date.now()}`,k={...iS,id:S,name:`Option ${s.length+1}`};o([...s,k]),u(S)},b=()=>{const S=`s${Date.now()}`,k={...h,id:S,name:`${h.name} (Copy)`};o([...s,k]),u(S)},x=S=>{if(s.length>1){const k=s.filter(N=>N.id!==S);o(k),c===S&&u(k[0].id),f===S&&d(null)}},_=(S,k)=>{o(N=>N.map(j=>j.id===S?{...j,name:k}:j))};H.useEffect(()=>{const S=TD(e.industry,e.projectType);Object.keys(S).length>0&&o(k=>k.map(N=>N.id===c?{...N,...S}:N))},[e.industry,e.projectType]);const w=({page:S,label:k,icon:N})=>l.jsxs("button",{onClick:()=>n(S),className:`w-full flex items-center gap-3 px-5 py-3 text-sm font-medium transition-all duration-200 border-l-2 ${r===S?"border-orange-500 bg-slate-50 text-slate-900":"border-transparent text-slate-500 hover:bg-slate-50 hover:text-slate-700"}`,children:[l.jsx(N,{className:`w-4 h-4 ${r===S?"text-orange-500":"text-slate-400"}`}),k]});return l.jsxs("div",{className:"h-screen w-screen bg-slate-100 flex overflow-hidden font-sans text-slate-900",children:[a&&l.jsx(Y1e,{onClose:()=>i(!1)}),l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0 z-30 shadow-sm",children:[l.jsx("div",{className:"p-6 border-b border-slate-100",children:l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-8 bg-orange-500 rounded-sm"}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]",children:"M MOSER ASSOCIATES"})]}),l.jsxs("h1",{className:"text-base font-bold text-slate-800 leading-tight pl-4",children:["Workplace Strategy",l.jsx("br",{}),"Toolkit"]})]})}),l.jsxs("div",{className:"flex-grow py-8 space-y-8 overflow-y-auto",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Context"}),l.jsx(w,{page:"home",label:"Project Information",icon:Xp})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Strategy & Planning"}),l.jsx(w,{page:"budget",label:"Space Budget",icon:ps}),l.jsx(w,{page:"stacking",label:"Stacking Plan",icon:Mr})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deep Analysis"}),l.jsx(w,{page:"adjacency",label:"Team Adjacency",icon:xs}),l.jsx(w,{page:"utilization",label:"Utilization Study",icon:fc}),l.jsx(w,{page:"test-fit",label:"Test Fit Scoring",icon:uc})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deliverables"}),l.jsx(w,{page:"exports",label:"Exports",icon:ra})]})]}),l.jsx("div",{className:"p-5 border-t border-slate-100 bg-slate-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-white border border-slate-200 rounded-full flex items-center justify-center shadow-sm",children:l.jsx($T,{className:"w-4 h-4 text-slate-400"})}),l.jsxs("div",{className:"flex-grow overflow-hidden",children:[l.jsx("div",{className:"text-xs font-bold text-slate-800 truncate",title:e.projectName,children:e.projectName||"New Project"}),l.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:e.location||"Location N/A"})]})]})})]}),l.jsx("div",{className:"flex-grow flex flex-col overflow-hidden bg-[#F8FAFC] relative",children:l.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[r==="home"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(AD,{data:e,onChange:t})}),r==="budget"&&l.jsx(Tle,{project:e,setProject:t,activeStrategy:h,handleStrategyChange:y,activeMetrics:p,scenarios:s,activeScenarioId:c,setActiveScenarioId:u,addScenario:v,duplicateScenario:b,deleteScenario:x,renameScenario:_,compareScenarioId:f,setCompareScenarioId:d,compareMetrics:g,onNavigate:S=>n(S)}),r==="stacking"&&l.jsxs("div",{className:"h-full p-6 flex flex-col",children:[l.jsxs("div",{className:"mb-6 flex justify-between items-end px-2",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Stacking Plan"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Translate strategy into floor-by-floor allocation."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Active Strategy:"}),l.jsx("span",{className:"text-xs font-bold bg-white border border-slate-200 text-orange-600 px-3 py-1 rounded-full shadow-sm",children:h.name})]})]}),l.jsx("div",{className:"flex-grow overflow-hidden bg-white rounded-xl shadow-sm border border-slate-200",children:l.jsx(UC,{metrics:p,project:e,strategy:h,mode:"default",onUpdateProject:t})})]}),r==="adjacency"&&l.jsx("div",{className:"h-full p-6",children:l.jsx(Ple,{project:e,onChange:t,metrics:p,onNavigateToStacking:()=>n("stacking")})}),r==="utilization"&&l.jsx("div",{className:"h-full",children:l.jsx(z1e,{})}),r==="test-fit"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(Mle,{metrics:p,project:e})}),r==="exports"&&l.jsx("div",{className:"h-full",children:l.jsx(Fle,{project:e,scenarios:s,activeScenarioId:c})})]})})]})},t6=document.getElementById("root");if(!t6)throw new Error("Could not find root element to mount to");const Z1e=Fd.createRoot(t6);Z1e.render(l.jsx(q.StrictMode,{children:l.jsx(Q1e,{})}));const bd=({number:e,title:t,icon:r})=>l.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-slate-100",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold font-mono",children:e}),l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(r,{className:"w-4 h-4 text-orange-500"}),t]})]}),J1e=({data:e,onChange:t})=>{const[r,n]=H.useState(!1),[a,i]=H.useState(!1);H.useEffect(()=>{let h=e.areaInput;e.areaDefinition==="Gross"&&(h=e.areaInput*(e.targetEfficiency/100)),h!==e.calculatedNia&&t({...e,calculatedNia:h})},[e.areaInput,e.areaDefinition,e.targetEfficiency,e.calculatedNia]);const s=(h,p)=>{let m={...e,[h]:p};if(h==="projectType"){const g=n0();m={...m,programStructure:g}}t(m)},o=h=>{t({...e,unit:h})},c=h=>{const p=[...e.floors];if(h>p.length)for(let m=p.length;m<h;m++)p.push({id:`f${m+1}`,name:`Floor ${m+1}`,headcount:0});else h<p.length&&(p.length=h);t({...e,floors:p})},u=(h,p)=>{const m=[...e.floors];m[h].headcount=p,t({...e,floors:m})},f=e.floors.reduce((h,p)=>h+p.headcount,0),d=f!==e.headcount;return l.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto",children:[l.jsxs("div",{className:"mb-10",children:[l.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(ih,{className:"w-6 h-6 text-orange-500"}),"Project Information"]}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Defining the strategic context and constraints for the portfolio analysis."})]}),l.jsxs("div",{className:"space-y-12",children:[l.jsxs("section",{children:[l.jsx(bd,{number:"1",title:"Strategic Context",icon:hs}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"col-span-1 md:col-span-2",children:[l.jsxs("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2",children:["Project Name ",l.jsx("span",{className:"text-rose-500",children:"*"})]}),l.jsxs("div",{className:"flex items-center bg-slate-50 px-4 py-3 rounded-lg border border-slate-200 focus-within:border-orange-400 transition-all",children:[l.jsx(hc,{className:"w-5 h-5 text-slate-400 mr-3"}),l.jsx("input",{type:"text",className:"bg-transparent w-full text-lg font-bold text-slate-800 focus:outline-none placeholder-slate-300",value:e.projectName||"",onChange:h=>s("projectName",h.target.value),placeholder:"e.g. Project Zenith - Global HQ"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Industry Sector"}),l.jsxs("div",{className:"relative group",children:[l.jsx(e0,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.industry,onChange:h=>s("industry",h.target.value),children:xD.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Location"}),l.jsxs("div",{className:"relative group",children:[l.jsx(zT,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"text",className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.location,onChange:h=>s("location",h.target.value),placeholder:"City, Country"})]})]})]})]}),l.jsxs("section",{children:[l.jsx(bd,{number:"2",title:"Scale & Typology",icon:KT}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Project Typology"}),l.jsxs("div",{className:"relative group",children:[l.jsx(ih,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.projectType,onChange:h=>s("projectType",h.target.value),children:mD.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Total Base Headcount"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"number",min:"1",className:"w-full bg-slate-50 border border-slate-200 text-sm font-bold text-slate-800 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.headcount,onChange:h=>s("headcount",parseInt(h.target.value)||0)})]})]})]})]}),l.jsxs("section",{children:[l.jsx(bd,{number:"3",title:"Physical Constraints",icon:Mr}),l.jsxs("div",{className:"flex flex-wrap items-end gap-6 bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6",children:[l.jsxs("div",{className:"flex-grow min-w-[240px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Input Area"}),l.jsxs("div",{className:"flex items-center gap-6 mb-3",children:[l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="NIA",onChange:()=>t({...e,areaDefinition:"NIA",targetEfficiency:100})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"NIA (Net Internal)"})]}),l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="Gross",onChange:()=>t({...e,areaDefinition:"Gross",targetEfficiency:80})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"Gross Area"})]})]}),l.jsxs("div",{className:"relative group max-w-xs",children:[l.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 text-lg font-bold text-slate-800 pl-4 pr-12 py-2 rounded-lg focus:outline-none focus:border-orange-400 shadow-sm",value:e.areaInput,onChange:h=>s("areaInput",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-4 top-3 text-xs font-bold text-slate-400 uppercase",children:e.unit})]})]}),e.areaDefinition==="Gross"&&l.jsxs("div",{className:"w-40 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Efficiency"}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:"number",min:"50",max:"100",className:"w-full bg-white border border-slate-300 text-lg font-medium text-slate-700 px-3 py-2 rounded-lg focus:outline-none focus:border-orange-400 text-right pr-8 shadow-sm",value:e.targetEfficiency,onChange:h=>s("targetEfficiency",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-3 top-3 text-sm text-slate-400 font-bold",children:"%"})]})]}),l.jsx("div",{className:"flex items-center pb-4 text-slate-300",children:l.jsx(Fa,{className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-grow min-w-[200px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Effective NIA (Usable)"}),l.jsxs("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("span",{className:"text-xl font-bold text-slate-800 w-full font-mono",children:Math.round(e.calculatedNia).toLocaleString()}),l.jsx("span",{className:"text-xs text-slate-400 font-bold ml-2 uppercase",children:e.unit})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Number of Floors"}),l.jsx("input",{type:"number",min:"1",max:"50",className:"w-24 bg-white border border-slate-200 text-sm font-medium text-slate-700 px-3 py-1.5 rounded-lg focus:outline-none focus:border-orange-400 text-right",value:e.floors.length,onChange:h=>c(parseInt(h.target.value)||1)})]}),l.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-bold text-slate-600 uppercase hover:text-orange-600 transition-colors group",children:[r?l.jsx(Xr,{className:"w-4 h-4 text-orange-500"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400 group-hover:text-orange-500"}),"Floor-by-Floor Allocation ",r?"":"(Optional)"]}),r&&l.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200 animate-in fade-in slide-in-from-top-2",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:e.floors.map((h,p)=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm focus-within:border-orange-400 transition-colors",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wide",children:h.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Fr,{className:"w-3 h-3 text-slate-300"}),l.jsx("input",{type:"number",className:"w-full text-sm font-bold text-slate-700 focus:outline-none",value:h.headcount,onChange:m=>u(p,parseInt(m.target.value)||0)})]})]},h.id))}),d&&l.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs font-medium text-amber-700 bg-amber-50 p-3 rounded-lg border border-amber-100",children:[l.jsx(ur,{className:"w-4 h-4 text-amber-500"}),l.jsxs("span",{children:["Warning: Floor headcount sum (",f,") does not match Total Headcount (",e.headcount,"). Stacking calculations generally prioritize floor data."]})]})]})]})]}),l.jsxs("section",{children:[l.jsx(bd,{number:"4",title:"System Preferences",icon:Yp}),l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-100",children:[l.jsx("div",{className:"flex items-center gap-6",children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Unit System"}),l.jsxs("div",{className:"flex bg-white p-1 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("button",{onClick:()=>o("sqm"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqm"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQM"}),l.jsx("button",{onClick:()=>o("sqft"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqft"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQFT"})]})]})}),l.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2.5 text-sm font-bold text-slate-700 bg-white border border-slate-300 rounded-lg hover:border-orange-400 hover:text-orange-600 transition-all shadow-sm",children:[l.jsx(qp,{className:"w-4 h-4"})," Customize Visualization"]})]})]})]}),a&&l.jsx(eA,{project:e,onChange:t,onClose:()=>i(!1)})]})},m4=({title:e,icon:t,isOpen:r,toggle:n})=>l.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-3 bg-white border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(t,{className:"w-4 h-4 text-indigo-600"}),l.jsx("span",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:e})]}),r?l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400"})]}),Ko=({label:e,value:t,unit:r,min:n,max:a,onChange:i,disabled:s,step:o=1,note:c})=>l.jsxs("div",{className:`mb-3 ${s?"opacity-60 grayscale":""}`,children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:e}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",min:n,max:a,step:o,value:t,disabled:s,onChange:u=>i(parseFloat(u.target.value)||0),className:"w-full p-2 text-sm border border-slate-200 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none bg-white font-medium"}),r&&l.jsx("div",{className:"px-3 py-2 bg-slate-100 border border-l-0 border-slate-200 rounded-r-md text-xs font-bold text-slate-500 whitespace-nowrap",children:r})]}),c&&l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:c})]}),eye=({pct:e,baseHc:t,onChange:r,disabled:n})=>{const[a,i]=H.useState("%"),s=Math.round(t*(e/100)),o=c=>{if(t>0){const u=c/t*100;r(parseFloat(u.toFixed(1)))}};return l.jsxs("div",{className:`mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100 ${n?"opacity-60 grayscale":""}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide",children:"Growth Buffer"}),l.jsxs("div",{className:"flex bg-white rounded border border-indigo-200 p-0.5",children:[l.jsx("button",{onClick:()=>i("%"),className:`text-[10px] px-2 py-0.5 rounded ${a==="%"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"%"}),l.jsx("button",{onClick:()=>i("Abs"),className:`text-[10px] px-2 py-0.5 rounded ${a==="Abs"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"HC"})]})]}),a==="%"?l.jsx(Ko,{label:"",value:e,unit:"% add-on",min:0,max:100,step:1,onChange:r,disabled:n}):l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",className:"w-full p-2 text-sm border border-indigo-200 rounded-l-md focus:outline-none focus:ring-1 focus:ring-indigo-500",value:s,onChange:c=>o(parseInt(c.target.value)||0),disabled:n}),l.jsx("div",{className:"px-3 py-2 bg-white border border-l-0 border-indigo-200 rounded-r-md text-xs font-bold text-indigo-500 whitespace-nowrap",children:"People"})]}),l.jsxs("div",{className:"text-[10px] text-indigo-400 mt-1 flex justify-between",children:[l.jsx("span",{children:"Reserve capacity"}),l.jsx("span",{children:a==="%"?`+${s} people`:`+${e}% add-on`})]})]})},tye=({ratios:e,onChange:t,disabled:r})=>{const n=(s,o)=>{t({...e,[s]:o})},a=(s,o)=>{if(s===0)return{label:"None",color:"bg-slate-100 text-slate-400"};const c=(s-o)/o;return c>.1?{label:"Conservative",color:"bg-orange-100 text-orange-700"}:c<-.1?{label:"Generous",color:"bg-emerald-100 text-emerald-700"}:{label:"Typical",color:"bg-blue-100 text-blue-700"}},i=({type:s,label:o,val:c,bench:u})=>{const f=a(c,u);return l.jsxs("tr",{className:"border-b border-slate-50 last:border-0 hover:bg-slate-50 group",children:[l.jsxs("td",{className:"py-2 pl-2 text-xs font-medium text-slate-700 flex items-center gap-1",children:[o,l.jsxs("div",{className:"group relative",children:[l.jsx(DT,{className:"w-3 h-3 text-slate-300 cursor-help"}),l.jsxs("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 w-32 bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 pointer-events-none z-50 whitespace-normal",children:["Benchmark: 1 per ",u," ppl"]})]})]}),l.jsx("td",{className:"py-2 px-1",children:l.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border border-slate-200 rounded focus:ring-1 focus:ring-indigo-500 font-medium",value:c,onChange:d=>n(s,parseInt(d.target.value)||0),disabled:r})}),l.jsx("td",{className:"py-2 pr-2 text-right",children:l.jsx("span",{className:`text-[9px] uppercase font-bold px-1.5 py-0.5 rounded ${f.color}`,children:f.label})})]})};return l.jsxs("div",{className:"mb-4 bg-white border border-slate-200 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"bg-slate-50 px-3 py-2 border-b border-slate-200 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Meeting Strategy"}),l.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"People per Room"})]}),l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 text-[10px] text-slate-400 uppercase font-semibold text-left",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pl-2 py-1 font-normal w-1/3",children:"Room Type"}),l.jsx("th",{className:"py-1 text-right font-normal pr-2",children:"Input"}),l.jsx("th",{className:"pr-2 py-1 text-right font-normal",children:"Status"})]})}),l.jsxs("tbody",{children:[l.jsx(i,{type:"small",label:"Small (4p)",val:e.small,bench:Ho.small}),l.jsx(i,{type:"medium",label:"Medium (8p)",val:e.medium,bench:Ho.medium}),l.jsx(i,{type:"large",label:"Large (14p)",val:e.large,bench:Ho.large}),l.jsx(i,{type:"board",label:"Board (20p)",val:e.board,bench:Ho.board}),l.jsx(i,{type:"townhall",label:"Townhall",val:e.townhall,bench:Ho.townhall})]})]})]})},rye=({spaces:e,onChange:t})=>{const r=()=>{t([...e,{id:`sup-${Date.now()}`,name:"New Amenity",category:"other",logic:"pct_nia",value:1}])},n=(i,s,o)=>{t(e.map(c=>c.id===i?{...c,[s]:o}:c))},a=i=>{t(e.filter(s=>s.id!==i))};return l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-600 uppercase flex items-center gap-1",children:[l.jsx(Wp,{className:"w-3 h-3"})," Support & Amenity"]}),l.jsxs("button",{onClick:r,className:"text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[l.jsx(Za,{className:"w-3 h-3"})," Add"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(i=>l.jsxs("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 text-xs hover:border-indigo-200 transition-colors",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 gap-2",children:[l.jsx("input",{className:"bg-transparent font-bold text-slate-700 w-full focus:outline-none border-b border-transparent focus:border-indigo-200 text-xs",value:i.name,onChange:s=>n(i.id,"name",s.target.value),placeholder:"Space Name"}),l.jsx("button",{onClick:()=>a(i.id),className:"text-slate-400 hover:text-rose-500",children:l.jsx(gs,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("select",{className:"w-full p-1 border rounded bg-white text-[10px]",value:i.logic,onChange:s=>n(i.id,"logic",s.target.value),children:[l.jsx("option",{value:"ratio",children:"Ratio (1:X)"}),l.jsx("option",{value:"pct_nia",children:"% of NIA"}),l.jsx("option",{value:"fixed_area",children:"Fixed Area"}),l.jsx("option",{value:"fixed_count",children:"Fixed Count"}),l.jsx("option",{value:"area_per_person",children:"Area / Person"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right",value:i.value,onChange:s=>n(i.id,"value",parseFloat(s.target.value))}),l.jsx("span",{className:"text-[9px] text-slate-400 w-8 text-right",children:i.logic==="pct_nia"?"%":i.logic==="ratio"?"ppl":"val"})]})]}),(i.logic==="ratio"||i.logic==="fixed_count")&&l.jsxs("div",{className:"mt-2 flex items-center justify-between pt-1 border-t border-slate-200",children:[l.jsx("span",{className:"text-[9px] text-slate-400",children:"Size per room:"}),l.jsx("div",{className:"flex items-center gap-1 w-20",children:l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right text-[10px]",value:i.areaPerUnit||0,onChange:s=>n(i.id,"areaPerUnit",parseFloat(s.target.value))})})]})]},i.id))})]})},nye=({strategy:e,onChange:t,title:r="Active Strategy",isReadOnly:n=!1,baseHeadcount:a=100})=>{var g,y;const[i,s]=H.useState({planning:!0,workplace:!0}),o=Math.ceil(a*(1+e.growthBuffer/100)),c=((g=e.workpoints)==null?void 0:g.fixed)||0,u=((y=e.workpoints)==null?void 0:y.alternative)||0,f=c+u,d=f-o,h=(v,b)=>{n||t({...e,[v]:b})},p=(v,b)=>{n||t({...e,workpoints:{...e.workpoints,[v]:Math.max(0,b)}})},m=v=>s(b=>({...b,[v]:!b[v]}));return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Yp,{className:"w-4 h-4 text-indigo-600"}),"Strategy Inputs"]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate font-medium",children:r})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx(m4,{title:"Planning Factors",icon:LT,isOpen:i.planning,toggle:()=>m("planning")}),i.planning&&l.jsxs("div",{className:"p-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(eye,{pct:e.growthBuffer,baseHc:a,onChange:v=>h("growthBuffer",v),disabled:n}),l.jsx(Ko,{label:"Circulation",value:e.circulationPct,unit:"% add-on",min:10,max:60,onChange:v=>h("circulationPct",v),disabled:n})]}),l.jsx(m4,{title:"Workplace Strategy",icon:hs,isOpen:i.workplace,toggle:()=>m("workplace")}),i.workplace&&l.jsxs("div",{className:"p-4 space-y-6 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(Ko,{label:"Enclosed Offices",value:e.enclosedOfficeCount,unit:"people",min:0,onChange:v=>h("enclosedOfficeCount",v),disabled:n,note:"Included within Fixed Workstations count"}),l.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:"Workpoints Target"})}),l.jsx(Ko,{label:"Fixed Workstations",value:c,unit:"seats",min:0,onChange:v=>p("fixed",v),disabled:n,note:"Total assigned desks (includes Enclosed Offices)"}),l.jsx(Ko,{label:"Alternative Workpoints",value:u,unit:"points",min:0,onChange:v=>p("alternative",v),disabled:n,note:"Agile, flex, or touchdown points"}),l.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-3 text-xs space-y-2 shadow-sm mb-3 mt-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 border-b border-indigo-200 pb-1.5 mb-1",children:[l.jsx(ps,{className:"w-3 h-3 text-indigo-500"}),l.jsx("span",{className:"font-bold text-indigo-800",children:"Supply vs Demand"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Headcount:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:o})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Workpoints:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:f})]}),l.jsxs("div",{className:`flex justify-between font-bold pt-1 border-t border-indigo-100 ${d<0?"text-amber-600":d>0?"text-blue-600":"text-emerald-600"}`,children:[l.jsxs("span",{className:"flex items-center gap-1",children:[d<0?l.jsx(ur,{className:"w-3 h-3"}):l.jsx(fa,{className:"w-3 h-3"})," Status:"]}),l.jsx("span",{children:d===0?"Matched":d>0?`Over by ${d}`:`Under by ${Math.abs(d)}`})]})]})]}),l.jsx(tye,{ratios:e.meetingRatios,onChange:v=>h("meetingRatios",v),disabled:n}),l.jsx(Ko,{label:"Phone Booth Ratio",value:e.phoneBoothRatio,unit:"ppl : 1 booth",min:1,max:100,onChange:v=>h("phoneBoothRatio",v),disabled:n}),l.jsx("div",{className:"border-t border-slate-100 pt-4",children:l.jsx(rye,{spaces:e.supportSpaces||[],onChange:v=>h("supportSpaces",v)})})]})]})]})},aye=[{id:"work_open",label:"Fixed Workstations"},{id:"work_enclosed",label:"Enclosed Offices (Private)"},{id:"work_alt",label:"Alternative Workpoints"},{id:"meet",label:"Meeting Rooms (Enclosed)"},{id:"phone",label:"Phone Booths"},{id:"circ",label:"Circulation"}],g4=["#6366f1","#ec4899","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#64748b"],iye=({groups:e,supportSpaces:t,onSave:r,onClose:n})=>{const[a,i]=H.useState(JSON.parse(JSON.stringify(e))),s=[...aye,...t.map(p=>({id:p.id,label:p.name}))],o=()=>{const p=`g-${Date.now()}`,m=g4[a.length%g4.length];i([...a,{id:p,name:"New Category",color:m,items:[]}])},c=p=>{if(a.length<=1)return;const m=a.find(v=>v.id===p),g=a.find(v=>v.id!==p);if(!g)return;const y=a.filter(v=>v.id!==p).map(v=>v.id===g.id?{...v,items:[...v.items,...(m==null?void 0:m.items)||[]]}:v);i(y)},u=(p,m)=>{const g=a.map(y=>({...y,items:y.id===m?[...y.items,p]:y.items.filter(v=>v!==p)}));i(g)},f=(p,m)=>{i(a.map(g=>g.id===p?{...g,color:m}:g))},d=(p,m)=>{i(a.map(g=>g.id===p?{...g,name:m}:g))},h=a.length>6;return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/30 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[85vh]",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Configure Program Structure"}),l.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Define how space types are categorized for visual analysis and reporting."})]}),l.jsx("button",{onClick:n,children:l.jsx(on,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[h&&l.jsxs("div",{className:"mb-6 flex items-start gap-3 bg-amber-50 border border-amber-200 p-3 rounded-lg text-sm text-amber-800",children:[l.jsx(ur,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold",children:"Recommendation:"})," You have defined ",a.length,' categories. For optimal clarity in client presentations, we recommend sticking to 4-6 distinct program categories. Excess categories will be automatically collapsed into "Other" in some summary charts.']})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(p=>l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b border-slate-100 pb-3",children:[l.jsx("input",{type:"color",value:p.color,onChange:m=>f(p.id,m.target.value),className:"w-6 h-6 rounded cursor-pointer border-0 p-0 overflow-hidden"}),l.jsx("input",{type:"text",value:p.name,onChange:m=>d(p.id,m.target.value),className:"font-bold text-sm bg-transparent border-b border-transparent focus:border-indigo-500 outline-none text-slate-800 flex-grow",placeholder:"Category Name"}),a.length>1&&l.jsx("button",{onClick:()=>c(p.id),className:"text-slate-300 hover:text-rose-500 transition-colors",title:"Delete Category (Items will be moved)",children:l.jsx(gs,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"space-y-2",children:p.items.length===0?l.jsx("div",{className:"text-xs text-slate-400 italic py-4 text-center border-2 border-dashed border-slate-100 rounded",children:"No items assigned"}):p.items.map(m=>{const g=s.find(y=>y.id===m);return l.jsxs("div",{className:"relative group flex items-center bg-slate-50 border border-slate-200 rounded px-3 py-2 text-xs hover:border-indigo-300 transition-colors",children:[l.jsx("span",{className:"mr-2 text-slate-700 font-medium truncate flex-grow",title:g==null?void 0:g.label,children:(g==null?void 0:g.label)||m}),l.jsxs("div",{className:"relative",children:[l.jsx(Fa,{className:"w-3 h-3 text-slate-300 group-hover:text-indigo-600"}),l.jsx("select",{className:"absolute right-0 top-0 w-6 h-6 opacity-0 cursor-pointer",value:p.id,onChange:y=>u(m,y.target.value),children:a.map(y=>l.jsxs("option",{value:y.id,children:["Move to ",y.name]},y.id))})]})]},m)})})]},p.id)),l.jsxs("button",{onClick:o,className:"flex flex-col items-center justify-center gap-2 p-6 rounded-xl border-2 border-dashed border-slate-300 text-slate-400 hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all min-h-[200px]",children:[l.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:l.jsx(Za,{className:"w-6 h-6"})}),l.jsx("span",{className:"text-sm font-bold",children:"Add Category"})]})]})]}),l.jsxs("div",{className:"p-5 border-t border-slate-200 flex justify-between items-center bg-white",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[l.jsx("strong",{children:"Integrity Check:"})," All space types must belong to exactly one category."]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:n,className:"px-5 py-2.5 text-sm font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),l.jsx("button",{onClick:()=>r(a),className:"px-6 py-2.5 bg-indigo-600 text-white text-sm font-bold rounded-lg hover:bg-indigo-700 shadow-md transition-all transform hover:scale-105",children:"Apply Configuration"})]})]})]})})},r6=({metrics:e,project:t,strategy:r,mode:n="default",onUpdateProject:a})=>{const[i,s]=H.useState(n==="review"?"visual":"summary"),[o,c]=H.useState("qty"),[u,f]=H.useState(!1),[d,h]=H.useState(!1),[p,m]=H.useState(!1),[g,y]=H.useState(t.programStructure||n0(t.projectType));H.useEffect(()=>{t.programStructure&&y(t.programStructure)},[t.programStructure]);const v=E=>{y(E),a&&a({...t,programStructure:E}),m(!1)},b=t.unit.toUpperCase(),x=t.floors,_=()=>{const E=["Space Type",...x.map(F=>F.name),"Total"].join("	"),A=[["Headcount",...e.floorMetrics.map(F=>F.headcount),e.totalHeadcountWithGrowth],["Total Seats",...e.floorMetrics.map(F=>F.totalDesks),e.requiredDesks],["Used Area",...e.floorMetrics.map(F=>Math.round(F.areaUsed)),Math.round(e.totalUsedArea)]],T=[E,...A.map(F=>F.join("	"))].join(`
`);navigator.clipboard.writeText(T),f(!0),setTimeout(()=>f(!1),2e3)},w=()=>h(!d),S=H.useMemo(()=>{const E=_o(t.unit);return x.map(A=>{const T=e.floorMetrics.find(G=>G.floorId===A.id);if(!T)return{name:A.name};const F={name:A.name};return g.forEach(G=>{let M=0;G.items.forEach(W=>{if(W==="work_open")M+=T.openDesks*E.deskOpen;else if(W==="work_enclosed")M+=T.enclosedOffices*E.deskEnclosed;else if(W==="work_alt")M+=T.altDesks*E.deskAlt;else if(W==="meet")M+=T.areaMeeting;else if(W==="phone")M+=T.areaPhone;else if(W==="circ")M+=T.areaCirculation;else{const Y=r.supportSpaces.find(K=>K.id===W);if(Y){const K=T.supportSummary.find(D=>D.name===Y.name);K&&(M+=K.area)}}}),F[G.id]=M}),F})},[e,t,g,r]),k=d?"fixed inset-0 z-50 bg-white flex flex-col":"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full",N=({val:E,isTotal:A=!1,type:T="number"})=>l.jsx("td",{className:`px-4 py-3 text-right text-xs whitespace-nowrap ${A?"font-bold bg-indigo-50 text-indigo-900 border-l border-slate-200 sticky right-0 z-10":"text-slate-600 border-b border-slate-50"}`,children:T==="area"?Math.round(E).toLocaleString():T==="percent"?`${E.toFixed(0)}%`:E.toLocaleString()}),j=({label:E,isGroup:A=!1})=>l.jsx("td",{className:`sticky left-0 bg-white z-10 px-4 py-3 text-xs border-r border-slate-100 ${A?"font-bold text-slate-800 bg-slate-50 uppercase tracking-wide":"font-medium text-slate-600"}`,children:E});return l.jsxs("div",{className:k,children:[l.jsxs("div",{className:"p-3 border-b border-slate-200 bg-slate-50 flex justify-between items-center flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Mr,{className:"w-4 h-4 text-indigo-600"}),d?"Stacking Plan (Full Screen)":"Stacking Plan"]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4 bg-white border border-slate-200 rounded-lg p-0.5",children:[l.jsxs("button",{onClick:()=>s("summary"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="summary"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(UT,{className:"w-3 h-3"})," Summary"]}),l.jsxs("button",{onClick:()=>s("matrix"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="matrix"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Hp,{className:"w-3 h-3"})," Matrix"]}),l.jsxs("button",{onClick:()=>s("visual"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="visual"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(dc,{className:"w-3 h-3"})," Program Mix"]})]}),i==="visual"&&l.jsx(l.Fragment,{children:l.jsxs("button",{onClick:()=>m(!0),className:"ml-2 flex items-center gap-1 px-3 py-1.5 text-xs font-bold text-slate-600 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition border border-transparent hover:border-slate-200",children:[l.jsx(r0,{className:"w-3 h-3"})," Structure"]})}),i==="matrix"&&l.jsxs("div",{className:"flex bg-white border border-slate-200 rounded-lg p-0.5 ml-2",children:[l.jsx("button",{onClick:()=>c("qty"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="qty"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Qty"}),l.jsx("button",{onClick:()=>c("area"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="area"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Area"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:_,className:"flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-300 rounded-lg text-xs font-bold text-slate-700 hover:bg-slate-50 transition",children:[u?l.jsx(Cn,{className:"w-3 h-3 text-emerald-600"}):l.jsx(Vp,{className:"w-3 h-3"}),u?"Copied":"Export"]}),l.jsx("button",{onClick:w,className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition",title:d?"Exit Full Screen":"Expand to Full Screen",children:d?l.jsx(HT,{className:"w-4 h-4"}):l.jsx(Yy,{className:"w-4 h-4"})}),d&&l.jsx("button",{onClick:w,className:"ml-2 p-1 text-slate-400 hover:text-slate-700",children:l.jsx(on,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:`flex-grow overflow-auto relative custom-scrollbar ${d?"p-6 bg-slate-100":""}`,children:i==="visual"?l.jsx("div",{className:`h-full flex flex-col ${d?"bg-white shadow-sm rounded-lg p-6":"p-4"}`,children:l.jsx("div",{className:"flex-grow w-full min-h-[300px]",children:l.jsx(v0,{data:S,groups:g,unit:b,layout:"vertical",showLabels:!0})})}):l.jsx("div",{className:d?"bg-white shadow-sm rounded-lg overflow-hidden":"",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{className:"sticky top-0 bg-white z-20 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"sticky left-0 z-30 bg-white border-b border-slate-200 px-4 py-3 text-xs font-bold text-slate-500 uppercase tracking-wider min-w-[160px] border-r border-slate-100",children:"Space Type"}),x.map(E=>l.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200 bg-slate-50 min-w-[100px]",children:E.name},E.id)),l.jsx("th",{className:"sticky right-0 z-30 bg-indigo-50 border-b border-l border-slate-200 px-4 py-3 text-right text-xs font-bold text-indigo-800 uppercase tracking-wider min-w-[100px]",children:"Total"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i==="summary"?l.jsxs(l.Fragment,{children:[l.jsxs("tr",{children:[l.jsx(j,{label:"Headcount (Capacity)",isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.headcount},E.floorId)),l.jsx(N,{val:e.totalHeadcountWithGrowth,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Workpoints (Seats)"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.totalDesks},E.floorId)),l.jsx(N,{val:e.requiredDesks,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting Rooms"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.meetingRoomsTotal},E.floorId)),l.jsx(N,{val:e.totalMeetingRooms,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:`Total Area (${b})`,isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.areaUsed,type:"area"},E.floorId)),l.jsx(N,{val:e.totalUsedArea,isTotal:!0,type:"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Space Utilization Index"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.utilization,type:"percent"},E.floorId)),l.jsx(N,{val:e.fitFactor,isTotal:!0,type:"percent"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"WORKSTATIONS",isGroup:!0}),l.jsx("td",{colSpan:x.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Enclosed Offices"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.enclosedOffices:E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.enclosedOffices:e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Fixed Workstations"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.openDesks:E.areaWorkstations-E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.openDesks:e.areaWorkstations-e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Alternative Workpoints"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.altDesks:E.altDesks*3,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.altDesks:e.altDesks*3,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"MEETING ROOMS",isGroup:!0}),l.jsx("td",{colSpan:x.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.meetingRoomsTotal:E.areaMeeting,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.totalMeetingRooms:e.areaMeeting,isTotal:!0,type:o==="qty"?"number":"area"})]})]})})]})})}),p&&l.jsx(iye,{groups:g,supportSpaces:r.supportSpaces,onSave:v,onClose:()=>m(!1)})]})},sye=({metrics:e,strategy:t,project:r})=>{var f;const n=r.programStructure||n0(r.projectType),a=_o(r.unit),i=H.useMemo(()=>n.map(d=>{let h=0;return e.floorMetrics.forEach(p=>{d.items.forEach(m=>{if(m==="work_open")h+=p.openDesks*a.deskOpen;else if(m==="work_enclosed")h+=p.enclosedOffices*a.deskEnclosed;else if(m==="work_alt")h+=p.altDesks*a.deskAlt;else if(m==="meet")h+=p.areaMeeting;else if(m==="phone")h+=p.areaPhone;else if(m==="circ")h+=p.areaCirculation;else{const g=t.supportSpaces.find(y=>y.id===m);if(g){const y=p.supportSummary.find(v=>v.name===g.name);y&&(h+=y.area)}}})}),{name:d.name,value:h,color:d.color}}).filter(d=>d.value>0),[e,n,t,a]),s=r.unit.toUpperCase(),o=e.fitFactor>100?"text-rose-600":"text-emerald-600",c=({cx:d,cy:h,midAngle:p,innerRadius:m,outerRadius:g,percent:y})=>{if(y<.05)return null;const v=Math.PI/180,b=m+(g-m)*.5,x=d+b*Math.cos(-p*v),_=h+b*Math.sin(-p*v);return l.jsx("text",{x,y:_,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:"bold",style:{textShadow:"0px 0px 3px rgba(0,0,0,0.5)",pointerEvents:"none"},children:`${(y*100).toFixed(0)}%`})},u=d=>{const h=i.find(p=>p.name===d);return h?Math.round(h.value).toLocaleString():"0"};return l.jsxs("div",{className:"h-full flex flex-col gap-6",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-shrink-0",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Capacity"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.totalHeadcountWithGrowth}),l.jsx("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:"Total People (w/ Growth)"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Rn,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Workpoints"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.requiredDesks}),l.jsxs("div",{className:"text-xs text-slate-400 flex gap-2 mt-1 font-medium",children:[l.jsxs("span",{children:[e.openDesks," Open"]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:[e.enclosedOffices," Enc"]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Fr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Meeting Rms"})]}),l.jsxs("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:[e.totalMeetingRooms," ",l.jsx("span",{className:"text-lg font-normal text-slate-400",children:"rms"})]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:["Ratio 1 : ",e.derivedMeetingRatio.toFixed(1)]})]}),l.jsxs("div",{className:`bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-shadow ${e.fitFactor>100?"border-l-4 border-l-rose-500":"border-l-4 border-l-emerald-500"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Kp,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Space Utilization Index"})]}),l.jsxs("div",{className:`text-3xl font-bold tracking-tight ${o}`,children:[e.fitFactor.toFixed(0),"%"]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:[Math.round(e.totalUsedArea).toLocaleString()," / ",Math.round(r.calculatedNia).toLocaleString()," ",s]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 flex-grow min-h-0",children:[l.jsxs("div",{className:"flex flex-col gap-6 min-h-0",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-64 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-white flex justify-between items-center rounded-t-xl",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Strategic Metrics Overview"}),l.jsxs("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-0.5 rounded",children:[e.density.toFixed(1)," ",s,"/p"]})]}),l.jsx("div",{className:"flex-grow p-2",children:l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(Hx,{children:[l.jsx(pa,{data:i,innerRadius:60,outerRadius:80,paddingAngle:2,dataKey:"value",label:c,labelLine:!1,children:i.map((d,h)=>l.jsx(Ci,{fill:d.color,stroke:"none"},`cell-${h}`))}),l.jsx(ir,{formatter:d=>[`${Math.round(d).toLocaleString()} ${s}`,"Area"],contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),l.jsx(na,{iconType:"circle",layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col flex-grow overflow-hidden",children:[l.jsx("div",{className:"p-4 border-b border-slate-100 bg-white rounded-t-xl",children:l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Program Budget"})}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Workstations"}),l.jsx("span",{children:u("Workstations")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Open (",e.openDesks,")"]})," ",l.jsx("span",{children:"Fixed Points"})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Enclosed (",e.enclosedOffices,")"]})," ",l.jsx("span",{children:"Fixed Points"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Meeting Rooms"}),l.jsx("span",{children:u("Meeting Rooms")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Rooms"})," ",l.jsx("span",{children:e.totalMeetingRooms})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Ratio"})," ",l.jsxs("span",{children:["1:",e.derivedMeetingRatio.toFixed(0)]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Collaboration"}),l.jsx("span",{children:u("Collaboration")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Open Zones"})," ",l.jsx("span",{className:"text-[10px] text-slate-400",children:"Calculated"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Support"}),l.jsx("span",{children:u("Support")})]}),(f=e.floorMetrics[0])==null?void 0:f.supportSummary.filter(d=>d.name!=="Open Collaboration").map((d,h)=>l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:d.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"Included"})]},h))]})]})]})]}),l.jsx("div",{className:"min-h-0 h-full",children:l.jsx(r6,{metrics:e,project:r,strategy:t})})]})]})},oye=({scenarios:e,activeId:t,project:r,metrics:n,onActivate:a,onAdd:i,onDuplicate:s,onDelete:o,onRename:c,compareId:u,onCompare:f,compareMetrics:d,onGoToDecision:h})=>{const p=e.find(b=>b.id===t),m=e.find(b=>b.id===u),g=({label:b,v1:x,v2:_,unit:w="",inverse:S=!1})=>{const k=x-_,N=k===0,j=k>0,E=N?"text-slate-300":j?"text-blue-600":"text-orange-600",A=j?"+":"";return l.jsxs("div",{className:"flex justify-between items-center text-xs py-1 border-b border-slate-50 last:border-0",children:[l.jsx("span",{className:"text-slate-500",children:b}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-bold text-slate-800",children:x.toLocaleString()}),!N&&l.jsxs("span",{className:`font-mono text-[10px] ${E}`,children:[A,k.toLocaleString()]})]})]})},v=d?((b,x)=>{const _=b.requiredDesks-x.requiredDesks,w=b.totalUsedArea-x.totalUsedArea,S=b.density-x.density;let k="";_>0?k=`Increases capacity by ${_} workpoints (+${(_/x.requiredDesks*100).toFixed(0)}%).`:_<0?k=`Reduces capacity by ${Math.abs(_)} workpoints.`:k="Maintains equivalent workpoint capacity.";let N="";w>0?N=`Requires ${Math.round(w)} ${r.unit} additional area, putting pressure on the spatial budget.`:w<0?N=`Recovers ${Math.round(Math.abs(w))} ${r.unit} of area, improving spatial efficiency.`:N="Neutral impact on overall area consumption.";let j="";return S<-1?j="Consider: Does the higher density impact acoustic comfort?":S>1?j="Consider: Is the generous density essential for experience targets?":j="Consider: Trade-off lies primarily in operational style rather than space.",{varianceText:k,impactText:N,decisionText:j}})(n,d):null;return l.jsxs("div",{className:"bg-white border-l border-slate-200 h-full flex flex-col w-80",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:"Scenarios"}),l.jsxs("button",{onClick:i,className:"text-xs flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-bold",children:[l.jsx(Za,{className:"w-3 h-3"})," New"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(b=>l.jsx("div",{onClick:()=>a(b.id),className:`group p-2 rounded-lg border cursor-pointer transition-all ${t===b.id?"bg-white border-indigo-500 shadow-sm ring-1 ring-indigo-500":"bg-white border-slate-200 hover:border-indigo-300"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[t===b.id?l.jsx("input",{value:b.name,onChange:x=>c(b.id,x.target.value),className:"text-sm font-bold text-indigo-700 bg-transparent outline-none w-full",onClick:x=>x.stopPropagation()}):l.jsx("span",{className:"text-sm font-medium text-slate-600 group-hover:text-indigo-600",children:b.name}),t===b.id&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:x=>{x.stopPropagation(),s()},className:"p-1 text-slate-400 hover:text-indigo-600",title:"Duplicate",children:l.jsx(Vp,{className:"w-3 h-3"})}),e.length>1&&l.jsx("button",{onClick:x=>{x.stopPropagation(),o(b.id)},className:"p-1 text-slate-400 hover:text-rose-500",title:"Delete",children:l.jsx(gs,{className:"w-3 h-3"})})]})]})},b.id))}),l.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:l.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-lg text-xs font-bold transition-colors border border-indigo-200",children:[l.jsx(ms,{className:"w-4 h-4"})," Compare & Decide"]})})]}),l.jsxs("div",{className:"p-4 border-b border-slate-200",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-2 block flex items-center gap-2",children:[l.jsx(Fa,{className:"w-3 h-3"})," Quick Comparison"]}),l.jsxs("select",{className:"w-full text-sm p-2 border border-slate-200 rounded-md bg-slate-50 focus:outline-none",value:u||"",onChange:b=>f(b.target.value||null),children:[l.jsx("option",{value:"",children:"None (Single View)"}),e.filter(b=>b.id!==t).map(b=>l.jsx("option",{value:b.id,children:b.name},b.id))]})]}),d&&m&&v?l.jsxs("div",{className:"flex-grow overflow-y-auto p-4 bg-slate-50",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-600 truncate max-w-[100px]",children:p==null?void 0:p.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"vs"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 truncate max-w-[100px]",children:m.name})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Seating"}),l.jsx(g,{label:"Open Seats",v1:n.openDesks,v2:d.openDesks}),l.jsx(g,{label:"Alt Seats",v1:n.altDesks,v2:d.altDesks}),l.jsx(g,{label:"Total",v1:n.requiredDesks,v2:d.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Spaces"}),l.jsx(g,{label:"Meeting Rms",v1:n.totalMeetingRooms,v2:d.totalMeetingRooms}),l.jsx(g,{label:"Phone Booths",v1:n.totalPhoneBooths,v2:d.totalPhoneBooths})]}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:["Area (",r.unit,")"]}),l.jsx(g,{label:"Used Area",v1:Math.round(n.totalUsedArea),v2:Math.round(d.totalUsedArea)}),l.jsxs("div",{className:"flex justify-between items-center text-xs py-1",children:[l.jsx("span",{className:"text-slate-500",children:"Utilization Index"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:`font-bold ${n.fitFactor>100?"text-rose-600":"text-emerald-600"}`,children:[n.fitFactor.toFixed(0),"%"]}),l.jsx("span",{className:"text-slate-300",children:"/"}),l.jsxs("span",{className:"text-slate-400",children:[d.fitFactor.toFixed(0),"%"]})]})]})]})]}),l.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-100 rounded-lg text-xs text-blue-800",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(hc,{className:"w-4 h-4 mt-0.5 text-blue-600"}),l.jsx("span",{className:"font-bold uppercase text-[10px] text-blue-500 mt-0.5",children:"Analysis"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Variance"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:v.varianceText})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Strategic Impact"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:v.impactText})]}),l.jsx("div",{className:"pt-2 border-t border-blue-100 mt-1",children:l.jsx("span",{className:"leading-tight block text-blue-700 italic",children:v.decisionText})})]})]})]}):l.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-slate-400 p-8 text-center",children:[l.jsx(Fa,{className:"w-8 h-8 mb-2 opacity-20"}),l.jsx("p",{className:"text-xs",children:"Select a scenario above to compare metrics."})]})]})},lye=(e,t=!1)=>{const r=Math.min(...e),n=Math.max(...e);if(r===0&&n===0)return null;if(r===n)return l.jsx("span",{className:"text-[10px] text-slate-400 font-medium px-2",children:"No Variance"});const a=n-r,i=r===0?100:a/r*100;return l.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${i>15?"text-amber-600 bg-amber-50 border-amber-100":"text-slate-600 bg-slate-100 border-slate-200"}`,children:[i>100?">100%":`${i.toFixed(0)}%`," "]})},cye=e=>{const t={};return e.floorMetrics.forEach(r=>{r.supportSummary.forEach(n=>{t[n.name]||(t[n.name]={count:0,area:0}),t[n.name].count+=n.count,t[n.name].area+=n.area})}),t},Ps=({title:e,icon:t,isOpen:r,onToggle:n,children:a,deltaValues:i})=>l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-4 ${r?"bg-slate-50 border-b border-slate-100":"bg-white hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`p-1.5 rounded-lg ${r?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}`,children:l.jsx(t,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide",children:e})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[!r&&i&&lye(i),r?l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}):l.jsx(Pr,{className:"w-4 h-4 text-slate-400"})]})]}),r&&l.jsx("div",{className:"p-5 animate-in slide-in-from-top-2 duration-200",children:a})]}),bg=({scenarios:e,rows:t})=>l.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-3 pl-4 text-xs font-bold text-slate-400 uppercase w-1/3",children:"Metric / Driver"}),e.map(r=>l.jsx("th",{className:"text-right py-3 px-4 text-xs font-bold text-indigo-800 uppercase w-32",children:r.name},r.id))]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:t.map((r,n)=>l.jsxs("tr",{className:`hover:bg-slate-50/80 ${r.highlight?"bg-indigo-50/30":""}`,children:[l.jsxs("td",{className:"py-3 pl-4",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700",children:r.label}),r.subLabel&&l.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:r.subLabel})]}),r.values.map((a,i)=>l.jsx("td",{className:"py-3 px-4 text-right text-sm font-medium text-slate-700",children:a},i))]},n))})]})}),uye=({scenario:e,metrics:t,project:r,isActive:n,onSelect:a,onDeepDive:i})=>{const s=t.fitFactor<=100,o=r.unit.toUpperCase();return l.jsxs("div",{className:`relative flex flex-col p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md h-full ${n?"bg-white border-indigo-600 shadow-lg z-10":"bg-white border-slate-200 hover:border-indigo-300"}`,onClick:a,children:[n&&l.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:"Selected Direction"}),l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsx("h3",{className:`text-base font-bold truncate ${n?"text-indigo-800":"text-slate-700"}`,title:e.name,children:e.name}),l.jsx("div",{className:`flex-shrink-0 flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${s?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:s?l.jsx(fa,{className:"w-3 h-3"}):l.jsx(FT,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-y-3 gap-x-2 mb-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Total Headcount"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.totalHeadcountWithGrowth})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Workpoints"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Density"}),l.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[t.density.toFixed(1)," ",l.jsxs("span",{className:"text-[10px] font-normal text-slate-400",children:[o,"/p"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Space Utilization Index"}),l.jsxs("div",{className:`text-sm font-bold ${t.fitFactor>100?"text-rose-600":"text-slate-800"}`,children:[t.fitFactor.toFixed(0),"%"]})]})]}),l.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Meeting Ratio"}),l.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:["1 : ",t.derivedMeetingRatio.toFixed(0)]})]}),l.jsxs("button",{onClick:c=>{c.stopPropagation(),i()},className:"text-[10px] flex items-center gap-1 bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1.5 rounded-md font-bold transition-colors border border-slate-200",children:[l.jsx(qT,{className:"w-3 h-3"})," Details"]})]})]})},fye=({project:e,scenarios:t,metricsMap:r,programGroups:n})=>{const a=_o(e.unit);return l.jsx("div",{className:"space-y-6",children:e.floors.map(i=>{const s=t.map(o=>{const c=r[o.id].floorMetrics.find(f=>f.floorId===i.id),u={name:o.name};return c&&n.forEach(f=>{let d=0;f.items.forEach(h=>{if(h==="work_open")d+=c.openDesks*a.deskOpen;else if(h==="work_enclosed")d+=c.enclosedOffices*a.deskEnclosed;else if(h==="work_alt")d+=c.altDesks*a.deskAlt;else if(h==="meet")d+=c.areaMeeting;else if(h==="phone")d+=c.areaPhone;else if(h==="circ")d+=c.areaCirculation;else{const p=o.supportSpaces.find(m=>m.id===h);if(p){const m=c.supportSummary.find(g=>g.name===p.name);m&&(d+=m.area)}}}),u[f.id]=d}),u});return l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-3 flex justify-between",children:[l.jsx("span",{children:i.name}),l.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:[i.headcount," HC"]})]}),l.jsx("div",{className:"h-24",children:l.jsx(v0,{data:s,groups:n,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:30,showLegend:!1,showLabels:!0})})]},i.id)})})},dye=({scenario:e,metrics:t,project:r,programGroups:n})=>{const a=()=>t.effectiveDeskRatio<=1?"Assignments: Traditional 1:1 model ensures dedicated seating for all, minimizing change management but maximizing area consumption.":t.effectiveDeskRatio<1.4?"Assignments: Hybrid approach introduces sharing while maintaining team anchors. Requires team-level zoning.":"Assignments: High-agility model assumes mostly mobile workforce. Relies heavily on alternative settings to absorb overflow.",i=()=>t.derivedMeetingRatio>25?"Collaboration: Lean meeting ratio may cause room scarcity during peak hours. Focus on bookable open collab zones.":t.derivedMeetingRatio<15?"Collaboration: High provision of enclosed meeting spaces supports intensive privacy needs but impacts open plan capacity.":"Collaboration: Balanced meeting supply aligns with standard benchmarks.",s=()=>t.areaSupport/t.totalUsedArea*100>15?"Experience: Amenity-rich environment emphasizes social connection and wellness over density.":"Experience: Functional approach to amenities prioritizes operational efficiency.";return l.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200 h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3 border-b border-slate-200 pb-2",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 truncate pr-2",children:e.name}),l.jsx("div",{className:"text-[9px] px-1.5 py-0.5 rounded font-bold uppercase bg-slate-200 text-slate-600",children:"Strategy Profile"})]}),l.jsx("ul",{className:"space-y-3 flex-grow",children:[{label:"Workstations",text:a()},{label:"Meeting & Collab",text:i()},{label:"Support",text:s()}].map((o,c)=>l.jsxs("li",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:o.label}),l.jsx("span",{className:"text-xs text-slate-600 leading-snug",children:o.text})]},c))})]})},hye=({project:e,scenarios:t,activeScenarioId:r,onActivateScenario:n,onProceed:a})=>{const[i,s]=H.useState(null),[o,c]=H.useState([]),[u,f]=H.useState(["metrics","implications"]);H.useEffect(()=>{const x=[r];t.filter(w=>w.id!==r).slice(0,2).forEach(w=>x.push(w.id)),c(x)},[t,r]);const d=x=>{f(_=>_.includes(x)?_.filter(w=>w!==x):[..._,x])},h=H.useMemo(()=>t.reduce((x,_)=>(x[_.id]=up(e,_),x),{}),[e,t]),p=t.filter(x=>o.includes(x.id)),m=t.find(x=>x.id===r),g=m?h[r]:null,y=e.programStructure||n0(e.projectType),v=H.useMemo(()=>{const x=_o(e.unit);return p.map(_=>{const w=h[_.id],S={name:_.name};return y.forEach(k=>{let N=0;w.floorMetrics.forEach(j=>{k.items.forEach(E=>{if(E==="work_open")N+=j.openDesks*x.deskOpen;else if(E==="work_enclosed")N+=j.enclosedOffices*x.deskEnclosed;else if(E==="work_alt")N+=j.altDesks*x.deskAlt;else if(E==="meet")N+=j.areaMeeting;else if(E==="phone")N+=j.areaPhone;else if(E==="circ")N+=j.areaCirculation;else{const A=_.supportSpaces.find(T=>T.id===E);if(A){const T=j.supportSummary.find(F=>F.name===A.name);T&&(N+=T.area)}}})}),S[k.id]=N}),S})},[p,h,e,y]),b=x=>{o.includes(x)?o.length>1&&c(o.filter(_=>_!==x)):o.length<3&&c([...o,x])};if(i){const x=t.find(_=>_.id===i);if(x&&h[i])return l.jsx(zC,{project:e,scenario:x,metrics:h[i],allScenarios:t,onBack:()=>s(null),programGroups:y,onSwitchScenario:s,onGoToStacking:a})}return l.jsxs("div",{className:"flex h-full bg-slate-50 overflow-hidden",children:[l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col z-10 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(Fa,{className:"w-4 h-4 text-indigo-600"})," Compare"]}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Select up to 3 scenarios."})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:t.map(x=>{const _=o.includes(x.id),w=r===x.id;return l.jsxs("div",{className:`p-3 rounded-lg border transition-all cursor-pointer ${_?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200 hover:border-indigo-200"}`,onClick:()=>b(x.id),children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${_?"bg-indigo-600 border-indigo-600":"border-slate-300"}`,children:_&&l.jsx(fa,{className:"w-3 h-3 text-white"})}),l.jsx("span",{className:`text-sm font-bold ${_?"text-indigo-900":"text-slate-600"}`,children:x.name})]}),w&&l.jsx("div",{className:"ml-6 text-[10px] font-bold text-indigo-600 uppercase tracking-wider",children:"Current Selection"})]},x.id)})})]}),l.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden relative",children:[l.jsx("div",{className:"flex-grow overflow-y-auto p-8 custom-scrollbar bg-slate-50/50",children:l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-32",children:[l.jsx("div",{className:"mb-8",children:l.jsx("div",{className:"flex justify-between items-end",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Strategic Decision Framework"}),l.jsxs("p",{className:"text-slate-500",children:["Evaluating strategies for ",e.projectName,"."]})]})})}),l.jsx(Ps,{title:"Strategic Metrics Overview",icon:Rn,isOpen:u.includes("metrics"),onToggle:()=>d("metrics"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(x=>l.jsx(uye,{scenario:x,metrics:h[x.id],project:e,isActive:r===x.id,onSelect:()=>n(x.id),onDeepDive:()=>s(x.id)},x.id))})}),l.jsx(Ps,{title:"Workstation Strategy",icon:VT,isOpen:u.includes("workpoints"),onToggle:()=>d("workpoints"),deltaValues:p.map(x=>h[x.id].requiredDesks),children:l.jsx(bg,{scenarios:p,rows:[{label:"Total Workpoints (Seats)",values:p.map(x=>h[x.id].requiredDesks.toLocaleString()),highlight:!0},{label:"Open Workstations",values:p.map(x=>h[x.id].openDesks)},{label:"Enclosed Offices (Private)",values:p.map(x=>h[x.id].enclosedOffices)},{label:"Alternative Workpoints",values:p.map(x=>h[x.id].altDesks)},{label:"Effective Sharing Ratio",subLabel:"Total HC / Total Seats",values:p.map(x=>`1 : ${h[x.id].effectiveDeskRatio.toFixed(2)}`)}]})}),l.jsx(Ps,{title:"Meeting Rooms",icon:Fr,isOpen:u.includes("meeting"),onToggle:()=>d("meeting"),deltaValues:p.map(x=>h[x.id].totalMeetingRooms),children:l.jsx(bg,{scenarios:p,rows:[{label:"Total Enclosed Meeting Rooms",values:p.map(x=>h[x.id].totalMeetingRooms),highlight:!0},{label:"Total Meeting Capacity (Seats)",values:p.map(x=>h[x.id].totalMeetingSeats)},{label:"Effective Meeting Ratio",subLabel:"Headcount per Room",values:p.map(x=>`1 : ${h[x.id].derivedMeetingRatio.toFixed(1)}`)},{label:"Small Meeting Rooms (4p)",values:p.map(x=>h[x.id].roomMix.small)},{label:"Medium Meeting Rooms (8p)",values:p.map(x=>h[x.id].roomMix.medium)},{label:"Large Meeting Rooms (14p)",values:p.map(x=>h[x.id].roomMix.large)},{label:"Boardrooms (20p)",values:p.map(x=>h[x.id].roomMix.board)},{label:"Phone Booths (1p)",values:p.map(x=>h[x.id].totalPhoneBooths)}]})}),l.jsx(Ps,{title:"Support & Amenity Allocation",icon:Wp,isOpen:u.includes("support"),onToggle:()=>d("support"),deltaValues:p.map(x=>Math.round(h[x.id].areaSupport)),children:l.jsx(bg,{scenarios:p,rows:[{label:"Total Support Area",values:p.map(x=>`${Math.round(h[x.id].areaSupport).toLocaleString()} ${e.unit.toUpperCase()}`),highlight:!0},{label:"% of NIA",values:p.map(x=>`${(h[x.id].areaSupport/e.calculatedNia*100).toFixed(1)}%`)},...(()=>{const x=new Set;return p.forEach(_=>_.supportSpaces.forEach(w=>x.add(w.name))),Array.from(x).map(_=>({label:_,values:p.map(w=>{const S=w.supportSpaces.find(E=>E.name===_),N=cye(h[w.id])[_];if(!S||!N)return"-";const j=S.logic==="ratio"?`1:${S.value}`:S.logic==="pct_nia"?`${S.value}%`:"Fixed";return N.count>0?`${N.count} (${j})`:`${Math.round(N.area)} ${e.unit==="sqm"?"m":"ft"} (${j})`})}))})()]})}),l.jsx(Ps,{title:"Program Mix (Space Distribution)",icon:dc,isOpen:u.includes("space_mix"),onToggle:()=>d("space_mix"),children:l.jsx("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-72",children:l.jsx(v0,{data:v,groups:y,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:60,showLabels:!0})})}),l.jsx(Ps,{title:"Floor-by-Floor Breakdown",icon:Mr,isOpen:u.includes("floors"),onToggle:()=>d("floors"),children:l.jsx(fye,{project:e,scenarios:p,metricsMap:h,programGroups:y})}),l.jsx(Ps,{title:"Strategic Implications & Recommendations",icon:QT,isOpen:u.includes("implications"),onToggle:()=>d("implications"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(x=>l.jsx(dye,{scenario:x,metrics:h[x.id],project:e,programGroups:y},x.id))})})]})}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-2xl flex justify-between items-center z-20 px-8",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:l.jsx(ms,{className:"w-5 h-5 text-indigo-700"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Selected Strategy"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:m==null?void 0:m.name})]}),g&&l.jsxs("div",{className:`ml-4 px-3 py-1 rounded text-xs font-bold ${g.fitFactor<=100?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[g.fitFactor.toFixed(0),"% Utilization"]})]}),l.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-bold shadow-md transition-all hover:translate-x-1",children:["Proceed to Stacking Plan ",l.jsx(Mr,{className:"w-4 h-4"})]})]})]})]})},pye=({project:e,activeStrategy:t,handleStrategyChange:r,activeMetrics:n,scenarios:a,activeScenarioId:i,setActiveScenarioId:s,addScenario:o,duplicateScenario:c,deleteScenario:u,renameScenario:f,compareScenarioId:d,setCompareScenarioId:h,compareMetrics:p,onNavigate:m})=>{const[g,y]=H.useState("planning");return l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-6 py-2 flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center bg-slate-100 p-1 rounded-lg",children:[l.jsxs("button",{onClick:()=>y("planning"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${g==="planning"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ps,{className:"w-3 h-3"})," Detailed Planning"]}),l.jsxs("button",{onClick:()=>y("decision"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${g==="decision"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ms,{className:"w-3 h-3"})," Decision Framework"]})]})}),l.jsx("div",{className:"flex-grow overflow-hidden relative",children:g==="decision"?l.jsx(hye,{project:e,scenarios:a,activeScenarioId:i,onActivateScenario:s,onProceed:()=>m("stacking")}):l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[340px] flex-shrink-0 flex flex-col border-r border-slate-200 bg-white z-10",children:l.jsx("div",{className:"flex-grow overflow-hidden",children:l.jsx(nye,{strategy:t,onChange:r,title:t.name,baseHeadcount:e.headcount})})}),l.jsx("div",{className:"flex-grow overflow-y-auto bg-slate-50/50 p-6",children:l.jsx(sye,{metrics:n,strategy:t,project:e})}),l.jsx("div",{className:"w-80 flex-shrink-0 bg-white border-l border-slate-200 z-10",children:l.jsx(oye,{scenarios:a,activeId:i,project:e,metrics:n,onActivate:s,onAdd:o,onDuplicate:c,onDelete:u,onRename:f,compareId:d,onCompare:h,compareMetrics:p,onGoToDecision:()=>y("decision")})})]})})]})},xye=({project:e,onChange:t,selectedDeptId:r,onSelectDept:n})=>{const a=(c,u)=>{const f=e.departments.map(d=>d.id===c?{...d,...u}:d);t({...e,departments:f})},i=()=>{const c=`d-${Date.now()}`,u={id:c,name:"New Dept",headcount:10,color:Nt.departments[e.departments.length%Nt.departments.length],collaborators:[]};t({...e,departments:[...e.departments,u]}),n(c)},s=c=>{const f=e.departments.filter(d=>d.id!==c).map(d=>({...d,collaborators:d.collaborators.filter(h=>h.deptId!==c)}));t({...e,departments:f}),r===c&&n(null)},o=(c,u,f)=>{const d=e.departments.find(m=>m.id===c);if(!d)return;let h=[...d.collaborators];const p=h.findIndex(m=>m.deptId===u);p>=0?f===0?h.splice(p,1):h[p]={...h[p],strength:f}:f>0&&h.push({deptId:u,strength:f}),a(c,{collaborators:h})};return e.departments.find(c=>c.id===r),l.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200 w-full",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(xs,{className:"w-4 h-4 text-orange-600"}),"Departments & Flows"]}),l.jsx("button",{onClick:i,className:"p-1.5 bg-white border border-slate-200 rounded hover:bg-orange-50 hover:text-orange-600 transition-colors",children:l.jsx(Za,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx("div",{className:"divide-y divide-slate-100",children:e.departments.map(c=>{var f;const u=c.id===r;return l.jsxs("div",{className:`group transition-colors ${u?"bg-orange-50/50":"hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"p-3 flex items-center gap-3 cursor-pointer",onClick:()=>n(u?null:c.id),children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:c.color}}),l.jsx("input",{type:"color",className:"absolute inset-0 opacity-0 cursor-pointer",value:c.color,onChange:d=>a(c.id,{color:d.target.value}),onClick:d=>d.stopPropagation()})]}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("input",{className:`text-sm font-bold bg-transparent w-full outline-none truncate ${u?"text-orange-900":"text-slate-700"}`,value:c.name,onChange:d=>a(c.id,{name:d.target.value}),onClick:d=>d.stopPropagation()}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400 mt-0.5",children:[l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(JT,{className:"w-3 h-3"})," ",c.headcount]}),l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(Mr,{className:"w-3 h-3"})," ",((f=e.floors.find(d=>d.id===c.pinnedFloor))==null?void 0:f.name)||"Unassigned"]})]})]}),l.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:d=>{d.stopPropagation(),s(c.id)},className:"p-1.5 text-slate-300 hover:text-rose-500",children:l.jsx(gs,{className:"w-3 h-3"})}),l.jsx(Pr,{className:`w-4 h-4 text-slate-300 transition-transform ${u?"rotate-90":""}`})]})]}),u&&l.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-1",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Headcount"}),l.jsx("input",{type:"number",className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.headcount,onChange:d=>a(c.id,{headcount:parseInt(d.target.value)||0})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Floor"}),l.jsxs("select",{className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.pinnedFloor||"",onChange:d=>a(c.id,{pinnedFloor:d.target.value||void 0}),children:[l.jsx("option",{value:"",children:"Unassigned"}),e.floors.map(d=>l.jsx("option",{value:d.id,children:d.name},d.id))]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2 flex justify-between",children:[l.jsx("span",{children:"Interaction Strength (0-100)"}),l.jsx("span",{className:"text-orange-600",children:"With..."})]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-1",children:e.departments.filter(d=>d.id!==c.id).map(d=>{const h=c.collaborators.find(m=>m.deptId===d.id),p=(h==null?void 0:h.strength)||0;return l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"w-20 truncate text-slate-600",title:d.name,children:d.name}),l.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"flex-grow h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-orange-500",value:p,onChange:m=>o(c.id,d.id,parseInt(m.target.value))}),l.jsx("span",{className:`w-8 text-right font-mono ${p>0?"text-slate-800 font-bold":"text-slate-300"}`,children:p})]},d.id)})})]})]})]},c.id)})}),e.departments.length===0&&l.jsxs("div",{className:"p-8 text-center text-slate-400 text-xs",children:["No departments defined.",l.jsx("br",{}),"Click + to add one."]})]})]})},mye=({matrix:e,onCellClick:t,hoveredLink:r,onHoverLink:n,sortedDepts:a})=>{const o=100+a.length*28;return l.jsx("div",{className:"w-full h-full overflow-auto flex justify-center items-center p-4 bg-slate-50/50",children:l.jsxs("div",{className:"relative bg-white shadow-sm border border-slate-200 p-2 rounded-lg",style:{width:o+20,height:o+20},children:[l.jsx("div",{className:"absolute left-[100px] top-0 flex pointer-events-none",children:a.map((c,u)=>l.jsx("div",{className:"relative h-[100px]",style:{width:28},children:l.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 origin-bottom-left -rotate-45 text-[10px] font-bold text-slate-600 whitespace-nowrap overflow-visible",style:{width:120},children:c.name})},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-0 flex flex-col pointer-events-none",children:a.map((c,u)=>l.jsxs("div",{className:"h-[28px] w-[100px] flex items-center justify-end pr-2 gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate max-w-[70px]",title:c.name,children:c.name}),l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:c.color}})]},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-[100px] flex flex-col border-t border-l border-slate-200",children:a.map(c=>l.jsx("div",{className:"flex",children:a.map(u=>{var p;if(c.id===u.id)return l.jsx("div",{className:"bg-slate-100 border-r border-b border-slate-200",style:{width:28,height:28}},u.id);const f=((p=e[c.id])==null?void 0:p[u.id])||0,d=f/100,h=r&&(r.d1===c.id&&r.d2===u.id||r.d1===u.id&&r.d2===c.id);return l.jsx("div",{className:`border-r border-b border-slate-200 flex items-center justify-center text-[9px] font-bold cursor-pointer transition-all duration-150 ${h?"ring-2 ring-indigo-500 z-10 scale-110":"hover:bg-slate-50"}`,style:{width:28,height:28,backgroundColor:f>0?`rgba(249, 115, 22, ${d})`:"transparent",color:f>50?"white":"#94a3b8"},onClick:()=>t(c,u),onMouseEnter:()=>n({d1:c.id,d2:u.id}),onMouseLeave:()=>n(null),title:`${c.name}  ${u.name}: ${f}`,children:f>0?f:""},u.id)})},c.id))})]})})},gye=({sortedDepts:e,pairs:t,onHoverLink:r,hoveredLink:n,project:a})=>{const f=x=>{var _;return((_=a.floors.find(w=>w.id===x))==null?void 0:_.name)||"Unassigned"},d=e.reduce((x,_)=>x+Math.max(_.headcount||0,5),0),h=.05,m=(2*Math.PI-h*e.length)/(d||1);let g=-Math.PI/2;const y=e.map(x=>{const w=Math.max(x.headcount||0,5)*m,S=g,k=g+w,N=(S+k)/2;g=k+h;const j=300+200*Math.cos(N),E=300+200*Math.sin(N);return{...x,start:S,end:k,mid:N,x:j,y:E}}),v=[];if(y.length>0){let x=y[0].pinnedFloor,_=0;y.forEach((w,S)=>{const k=S===y.length-1,N=k?null:y[S+1].pinnedFloor;if(N!==x||k){const j=y[_],E=w;v.push({name:f(x),start:j.start-.02,end:E.end+.02}),x=N,_=S+1}})}const b=(x,_,w,S=0)=>{const k=300+x*Math.cos(_),N=300+x*Math.sin(_),j=300+x*Math.cos(w),E=300+x*Math.sin(w),A=w-_<=Math.PI?0:1;return`M ${k} ${N} A ${x} ${x} 0 ${A} 1 ${j} ${E}`};return l.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:l.jsxs("svg",{viewBox:"0 0 600 600",className:"w-full h-full max-w-[600px] select-none",children:[v.map((x,_)=>{const w=(x.start+x.end)/2,S=300+275*Math.cos(w),k=300+275*Math.sin(w);return l.jsxs("g",{children:[l.jsx("path",{d:b(250,x.start,x.end),fill:"none",stroke:"#f1f5f9",strokeWidth:"20",strokeLinecap:"butt"}),l.jsx("text",{x:S,y:k,textAnchor:"middle",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-400 uppercase tracking-wide",style:{fontSize:"10px"},children:x.name})]},`floor-${_}`)}),t.map((x,_)=>{const w=y.find(j=>j.id===x.dept1.id),S=y.find(j=>j.id===x.dept2.id);if(!w||!S)return null;const k=n&&(n.d1===w.id&&n.d2===S.id||n.d1===S.id&&n.d2===w.id),N=n&&!k;return l.jsx("path",{d:`M ${w.x} ${w.y} Q 300 300 ${S.x} ${S.y}`,fill:"none",stroke:k?Nt.primary:`url(#grad-${_})`,strokeWidth:k?4:Math.max(1,x.score/200*12),opacity:k?1:N?.05:.4,onMouseEnter:()=>r({d1:w.id,d2:S.id}),onMouseLeave:()=>r(null),className:"transition-all duration-300 cursor-pointer"},`link-${_}`)}),l.jsx("defs",{children:t.map((x,_)=>{const w=y.find(k=>k.id===x.dept1.id),S=y.find(k=>k.id===x.dept2.id);return!w||!S?null:l.jsxs("linearGradient",{id:`grad-${_}`,gradientUnits:"userSpaceOnUse",x1:w.x,y1:w.y,x2:S.x,y2:S.y,children:[l.jsx("stop",{offset:"0%",stopColor:w.color}),l.jsx("stop",{offset:"100%",stopColor:S.color})]},`grad-${_}`)})}),y.map(x=>{const _=n&&(n.d1===x.id||n.d2===x.id),w=n&&!_,S=x.mid,k=300+235*Math.cos(S),N=300+235*Math.sin(S),j=S*180/Math.PI+(k<300?180:0);return l.jsxs("g",{className:"transition-opacity duration-300",style:{opacity:w?.2:1},children:[l.jsx("path",{d:b(200,x.start,x.end),fill:"none",stroke:x.color,strokeWidth:"16",className:"cursor-pointer hover:brightness-110",onMouseEnter:()=>r({d1:x.id,d2:x.id}),onMouseLeave:()=>r(null)}),l.jsx("text",{x:k,y:N,textAnchor:k>300?"start":"end",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-700 pointer-events-none",transform:`rotate(${j-(k<300?180:0)}, ${k}, ${N})`,children:x.name})]},x.id)})]})})},vye=({project:e,onChange:t,metrics:r,onNavigateToStacking:n})=>{const[a,i]=H.useState(null),[s,o]=H.useState(null),[c,u]=H.useState(!0),{adjacencyStats:f}=r,d=H.useMemo(()=>{const p=m=>e.floors.findIndex(g=>g.id===m);return[...e.departments].sort((m,g)=>{const y=p(m.pinnedFloor),v=p(g.pinnedFloor);return y!==v?(y===-1?99:y)-(v===-1?99:v):g.headcount-m.headcount})},[e]),h=(p,m)=>{o(p.id),u(!0)};return l.jsxs("div",{className:"flex h-full bg-slate-100 overflow-hidden relative",children:[l.jsxs("div",{className:`transition-all duration-300 ease-in-out bg-white border-r border-slate-200 z-20 flex-shrink-0 flex flex-col absolute md:relative h-full ${c?"w-80 translate-x-0":"w-0 -translate-x-full md:translate-x-0 md:w-0"}`,children:[l.jsx("div",{className:"flex-grow overflow-hidden w-80",children:l.jsx(xye,{project:e,onChange:t,selectedDeptId:s,onSelectDept:o})}),l.jsx("button",{onClick:()=>u(!c),className:"absolute top-1/2 -right-8 bg-white border border-l-0 border-slate-200 p-1.5 rounded-r-lg shadow-sm text-slate-500 hover:text-indigo-600 z-30",title:c?"Collapse Panel":"Expand Panel",children:c?l.jsx(WT,{className:"w-4 h-4"}):l.jsx(Pr,{className:"w-4 h-4"})})]}),!c&&l.jsx("button",{onClick:()=>u(!0),className:"absolute top-4 left-4 bg-white p-2 rounded-lg shadow border border-slate-200 z-10 text-slate-600 hover:text-indigo-600",children:l.jsx(Hp,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-grow flex flex-col h-full overflow-hidden",children:[l.jsxs("div",{className:"bg-white p-4 border-b border-slate-200 shadow-sm flex justify-between items-center flex-shrink-0 z-10",children:[l.jsxs("div",{className:"ml-10 md:ml-0",children:[" ",l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(sh,{className:"w-5 h-5 text-orange-500"})," Team Adjacency Model"]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Define departmental flows to optimize stacking."})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"hidden sm:flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-100 text-xs text-slate-500",children:[l.jsx(t0,{className:"w-3 h-3 text-slate-400"}),l.jsx("span",{children:"Hover diagram to trace flows"})]}),l.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold shadow-sm transition-colors",children:["Go to Stacking ",l.jsx(zp,{className:"w-3 h-3"})]})]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-4 md:p-8 bg-slate-50/50",children:l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 h-full min-h-[600px]",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(RT,{className:"w-4 h-4 text-slate-400"})," Interaction Matrix"]}),l.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"Click cell to edit flow"})]}),l.jsx("div",{className:"flex-grow relative",children:l.jsx(mye,{matrix:f.matrix,onCellClick:h,hoveredLink:a,onHoverLink:i,sortedDepts:d})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(sh,{className:"w-4 h-4 text-slate-400"})," Flow Network"]}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-300"})," Floor Ring"]})})]}),l.jsx("div",{className:"flex-grow relative flex items-center justify-center bg-white",children:l.jsx(gye,{sortedDepts:d,pairs:f.allPairs,onHoverLink:i,hoveredLink:a,project:e})})]})]})})]})]})},wg=({label:e,score:t,max:r,unit:n,inverse:a=!1,warning:i})=>{const s=Math.min(t/r*100,100),o=a?s<95:s>80,c=i?"text-amber-500":o?"text-emerald-600":"text-rose-600",u=i?"bg-amber-500":o?"bg-emerald-500":"bg-rose-500";return l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:e}),i?l.jsx(ur,{className:"w-4 h-4 text-amber-500"}):l.jsx(uc,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:`text-2xl font-bold ${c}`,children:[t.toLocaleString()," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:["/ ",r.toLocaleString()," ",n]})]}),l.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full mt-2 overflow-hidden",children:l.jsx("div",{className:`h-full ${u} transition-all duration-500`,style:{width:`${s}%`}})})]})]})},yye=({metrics:e,project:t})=>{const r=e.totalUsedArea/t.calculatedNia*100,n=e.adjacencyStats.stressScore;let a=100;r>100&&(a-=(r-100)*2),e.effectiveDeskRatio>1.8&&(a-=10),e.derivedMeetingRatio>25&&(a-=10),n>20&&(a-=(n-20)*.5),a=Math.max(0,Math.min(100,a));const i=a>85?"Excellent Fit":a>70?"Manageable with Compromise":"High Risk / Not Feasible",s=a>85?"bg-emerald-100 text-emerald-700":a>70?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700";return l.jsxs("div",{className:"flex flex-col h-full gap-6 max-w-5xl mx-auto w-full",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Spatial Stress Analysis"}),l.jsx("p",{className:"text-slate-500",children:"Automated assessment of project constraints vs strategic demand."})]}),l.jsxs("div",{className:`px-6 py-4 rounded-xl text-center ${s}`,children:[l.jsxs("div",{className:"text-3xl font-bold",children:[a.toFixed(0),"/100"]}),l.jsx("div",{className:"text-xs font-bold uppercase tracking-wide mt-1",children:i})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(wg,{label:"Space Utilization Index",score:Math.round(e.totalUsedArea),max:Math.round(t.calculatedNia),unit:t.unit.toUpperCase(),inverse:!0,warning:r>95&&r<=100}),l.jsx(wg,{label:"Operational Stress Index",score:Math.round(n),max:100,unit:"Score",inverse:!0}),l.jsx(wg,{label:"Headcount",score:e.totalHeadcountWithGrowth,max:t.headcount,unit:"ppl",inverse:!0}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Density"}),l.jsx(Kp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:[e.density.toFixed(1)," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:[t.unit.toUpperCase(),"/p"]})]}),l.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Target: 8.0 - 12.0"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex-grow",children:[l.jsx("h3",{className:"text-sm font-bold text-slate-800 uppercase mb-4",children:"Strategic Stress Factors"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-4",children:[{label:"Circulation & Flow",val:e.areaCirculation,max:e.totalUsedArea*.35,desc:"Circulation ratio check."},{label:"Meeting Capacity",val:20,max:e.derivedMeetingRatio,desc:"Meeting capacity verification.",inverse:!0},{label:"Sharing Strategy Alignment",val:e.effectiveDeskRatio,max:1.5,desc:"Evaluates cultural readiness for shared desks."}].map((o,c)=>{const u=c===0?"Good":c===1?"Tight":"Aggressive",f=u==="Good"?"text-emerald-600":"text-amber-600";return l.jsxs("div",{className:"flex items-center p-3 bg-slate-50 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"p-2 bg-white rounded-md shadow-sm mr-4",children:c===0?l.jsx(IT,{className:"w-5 h-5 text-indigo-500"}):l.jsx(Fr,{className:"w-5 h-5 text-indigo-500"})}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("div",{className:"text-sm font-bold text-slate-700",children:o.label}),l.jsx("div",{className:"text-xs text-slate-500",children:o.desc})]}),l.jsx("div",{className:`text-right font-bold text-sm ${f}`,children:u})]},c)})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[l.jsx(xs,{className:"w-4 h-4 text-indigo-500"}),l.jsx("h4",{className:"text-sm font-bold text-slate-800",children:"Top Friction Drivers"}),l.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:"Impact Score (0-100)"})]}),l.jsx("div",{className:"space-y-2",children:e.adjacencyStats.topFrictionPairs.length>0?e.adjacencyStats.topFrictionPairs.slice(0,5).map((o,c)=>l.jsxs("div",{className:"flex justify-between items-center p-2 rounded hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:o.dept1.color}}),o.dept1.name," + ",o.dept2.name]}),l.jsx("div",{className:"text-[10px] text-amber-600 font-medium",children:"Split across floors"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Str: ",(o.score/2).toFixed(0)]}),l.jsx("div",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded text-xs font-bold w-12 text-center",children:o.friction.toFixed(0)})]})]},c)):l.jsxs("div",{className:"text-xs text-slate-500 italic flex items-center gap-2 p-4 bg-emerald-50 rounded border border-emerald-100",children:[l.jsx(fa,{className:"w-4 h-4 text-emerald-500"}),"No significant adjacency friction detected."]})})]})]})]})]})},bye=({project:e,scenarios:t,activeScenarioId:r})=>{const n=t.find(f=>f.id===r),[a,i]=H.useState(!1),[s,o]=H.useState("custom"),c=f=>{o(f),i(!0)},u=({preset:f,title:d,desc:h,icon:p,color:m,items:g,isCustom:y=!1})=>l.jsxs("div",{className:`relative bg-white p-6 rounded-xl border transition-all flex flex-col h-full group ${y?"border-dashed border-slate-300 hover:border-indigo-400":"border-slate-200 shadow-sm hover:shadow-md"}`,children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110 ${m}`,children:l.jsx(p,{className:`w-6 h-6 ${y?"text-indigo-600":"text-white"}`})}),l.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:d}),l.jsx("p",{className:"text-sm text-slate-500 mb-6 flex-grow",children:h}),l.jsx("ul",{className:"space-y-2 mb-6",children:g.map((v,b)=>l.jsxs("li",{className:"flex items-center gap-2 text-xs text-slate-600",children:[l.jsx(Cn,{className:`w-3 h-3 ${y?"text-slate-400":"text-emerald-500"}`})," ",v]},b))}),l.jsxs("button",{onClick:()=>c(f),className:`w-full py-2.5 rounded-lg border font-bold text-sm flex items-center justify-center gap-2 transition-colors ${y?"border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,children:[y?l.jsx(r0,{className:"w-4 h-4"}):l.jsx(ra,{className:"w-4 h-4"}),y?"Open Builder":"Download Package"]})]});return l.jsxs("div",{className:"max-w-6xl mx-auto w-full h-full flex flex-col p-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Project Exports"}),l.jsx("p",{className:"text-slate-500 mt-1",children:"Generate documentation packages for different stakeholders."}),l.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-full border border-indigo-100",children:["Active Scenario: ",n==null?void 0:n.name]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(u,{preset:"client",title:"Client Presentation",desc:"Executive summary with transparent charts, strategic metrics, and comparisons.",icon:hs,color:"bg-indigo-600",items:["PDF Report","High-level KPIs","Strategic Insights"]}),l.jsx(u,{preset:"designer",title:"Designer Handoff",desc:"Technical data package for architectural teams to begin test fitting.",icon:Rn,color:"bg-pink-600",items:["Excel / CSV","Stacking Matrices","Room Quantities"]}),l.jsx(u,{preset:"internal",title:"Internal Record",desc:"Complete project dump containing all assumptions and metadata.",icon:e0,color:"bg-emerald-600",items:["Excel Workbook","All Scenarios","Full Audit Log"]}),l.jsx(u,{preset:"custom",title:"Custom Builder",desc:"Build a specific export package by selecting content and formats manually.",icon:Za,color:"bg-indigo-50",items:["Select Content","Choose Formats","Multi-Scenario"],isCustom:!0})]}),l.jsx(WC,{isOpen:a,onClose:()=>i(!1),initialPreset:s,scenarios:t,activeScenarioId:r,project:e})]})},n6=[{key:"floor",label:"Level / Floor",required:!0},{key:"department",label:"Department (Team)",required:!1},{key:"date",label:"Date",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status (Occupied?)",required:!0}],a6=[{key:"floor",label:"Level / Floor",required:!0},{key:"roomName",label:"Room Name",required:!0},{key:"roomType",label:"Space Type",required:!0},{key:"capacity",label:"Capacity (Marker)",required:!1},{key:"week",label:"Week",required:!1},{key:"day",label:"Day",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status",required:!0},{key:"attendeeCount",label:"Occupancy (Count)",required:!1}],wye=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var i;try{const s=(i=a.target)==null?void 0:i.result,o=_p(s,{type:"binary"}),c=o.SheetNames[0],u=o.Sheets[c],f=br.sheet_to_json(u,{header:1});t(f)}catch(s){r(s)}},n.onerror=a=>r(a),n.readAsBinaryString(e)}),Sye=(e,t)=>{const r=e.map(i=>String(i).toLowerCase().trim()),n={},a=i=>r.findIndex(s=>i.some(o=>s.includes(o)));return n.date=a(["date","timestamp"]),n.timeSlot=a(["time","slot","hour","start","period"]),n.floor=a(["floor","level","zone","lvl"]),n.week=a(["week","wk"]),n.day=a(["day"]),t==="workstation"?(n.isOccupied=a(["occup","status","state","vacan","activity"]),n.department=a(["dept","department","team","group","cost center"])):(n.roomName=a(["room","name","id","department","dept"]),n.roomType=a(["type","category","kind"]),n.capacity=a(["cap","seat","pax"]),n.isOccupied=a(["status","state"]),n.attendeeCount=a(["occupancy","actual","pax","people","count"])),Object.keys(n).forEach(i=>{n[i]===-1&&delete n[i]}),n},_ye=(e,t,r)=>{const a=(r==="workstation"?n6:a6).filter(o=>o.required&&t[o.key]===void 0),i=[],s=e.slice(1,11);if(s.length>0&&t.isOccupied!==void 0){const o=t.isOccupied;s.some(u=>{const f=String(u[o]).toLowerCase();return f.includes("occ")||f==="1"||f==="0"||f==="yes"||f==="no"||f==="true"||f==="false"})||i.push("Status column values don't look standard (e.g. 'Occupied', '1', 'Yes').")}if(s.length>0&&t.timeSlot!==void 0){const o=t.timeSlot;s.some(u=>{const f=String(u[o]);return f.includes(":")||!isNaN(parseFloat(f))})||i.push("Time column doesn't appear to contain time formats.")}return{isValid:a.length===0,missingFields:a.map(o=>o.label),warnings:i}},v4=e=>{if(e===1||e==="1")return!0;if(typeof e=="string"){const t=e.toLowerCase().trim();if(t.includes("unoccupied"))return!1;if(t.includes("occupied")||t==="yes"||t==="y"||t==="occ")return!0}return!1},y4=(e,t,r)=>{const n=[],a=i=>{const s=String(i).toLowerCase().trim();return["level","floor","department","room","type","capacity","status","occupancy","week","day","time"].includes(s)};for(let i=1;i<e.length;i++){const s=e[i];if(!s||s.length===0)continue;const o=g=>{const y=t[g];return y!==void 0?s[y]:void 0},c=String(o("date")||""),u=String(o("timeSlot")||""),f=String(o("floor")||"Unknown").trim(),d=o("week"),h=o("day"),p=parseInt(d)||void 0,m=parseInt(h)||void 0;if(!a(f)&&!(f==="Unknown"&&!u&&!c))if(r==="workstation")(c||u||f!=="Unknown")&&n.push({id:`obs-${i}`,date:c||"Unknown Date",timeSlot:u||"Unknown Time",floor:f,department:String(o("department")||"Unassigned"),isOccupied:v4(o("isOccupied")),week:p,day:m});else{const g=v4(o("isOccupied")),y=o("attendeeCount");let v=0;if(g){const b=parseInt(y);!isNaN(b)&&b>0?v=b:v=1}(u||m||p||f!=="Unknown")&&n.push({id:`mtg-${i}`,date:c,timeSlot:u||"Unknown Time",floor:f,roomName:String(o("roomName")||`Room ${i}`),roomType:String(o("roomType")||"Meeting Room"),capacity:1,attendeeCount:v,isOccupied:g,week:p,day:m})}}return n},kye=e=>{const t=e.length,r=e.filter(u=>u.isOccupied).length,n=t>0?r/t*100:0,a={};e.forEach(u=>{a[u.timeSlot]||(a[u.timeSlot]={t:0,o:0}),a[u.timeSlot].t++,u.isOccupied&&a[u.timeSlot].o++});let i=0;const s=Object.keys(a).map(u=>{const f=a[u].o/a[u].t*100;return f>i&&(i=f),{time:u,rate:f}}).sort((u,f)=>u.time.localeCompare(f.time)),o={};e.forEach(u=>{o[u.floor]||(o[u.floor]={t:0,o:0}),o[u.floor].t++,u.isOccupied&&o[u.floor].o++});const c=Object.keys(o).map(u=>({floor:u,rate:o[u].o/o[u].t*100}));return{avgOccupancy:n,peakOccupancy:i,occupancyByTime:s,occupancyByFloor:c,roomMetrics:[],totalObservations:t,totalRooms:0,overallUtilization:n,overallAvgAttendees:0,globalSizeBins:[],globalInsights:[]}},Nye=e=>e===1?"1p":e===2?"2p":e>=3&&e<=4?"3-4p":e>=5&&e<=7?"5-7p":e>=8&&e<=11?"8-11p":e>=12?"12p+":"0p",i6=e=>{const t=new Map,r=new Set;e.forEach(s=>{if(s.roomName&&r.add(s.roomName),!s.timeSlot)return;const o=s.week||1,c=s.day||1,u=s.timeSlot.trim(),f=`W${o}-D${c}-${u}`;t.has(f)||t.set(f,{week:o,day:c,timeStr:u,allRooms:new Set,occupiedRooms:new Set});const d=t.get(f),h=s.roomName||"Unknown";d.allRooms.add(h),s.isOccupied&&d.occupiedRooms.add(h)});const n=Array.from(t.values()).map(s=>{const o=s.allRooms.size,c=s.occupiedRooms.size,u=o>0?c/o*100:0;let f=0;if(s.timeStr.includes(":")){const h=s.timeStr.split(":");f=(parseInt(h[0])||0)*60+(parseInt(h[1])||0)}else{const h=parseFloat(s.timeStr);isNaN(h)||(h<1?f=h*1440:f=h)}const d=s.week*1e5+s.day*2e3+f;return{time:`W${s.week} D${s.day} ${s.timeStr}`,sortKey:d,occupied:c,total:o,pct:u}}).sort((s,o)=>s.sortKey-o.sortKey).map(({time:s,occupied:o,total:c,pct:u})=>({time:s,occupied:o,total:c,pct:u})),a=n.length>0?n.reduce((s,o)=>s+o.pct,0)/n.length:0,i=n.length>0?Math.max(...n.map(s=>s.pct)):0;return{avgPct:a,maxPct:i,timeline:n,uniqueRoomsCount:r.size}},jye=(e,t={})=>{const r=new Map;e.forEach(v=>{const b=`${v.floor}::${v.roomName}::${v.week}::${v.day}::${v.timeSlot}`;r.has(b)||r.set(b,{eventId:b,floor:v.floor,roomName:v.roomName||"Unknown",roomType:v.roomType||"General",week:v.week||0,day:v.day||0,time:v.timeSlot,attendees:0,occupied:!1,rawRowIds:[]});const x=r.get(b);x.rawRowIds.push(v.id),v.isOccupied&&(x.occupied=!0,x.attendees+=v.attendeeCount||1)});const n=new Map,a={},i=["1p","2p","3-4p","5-7p","8-11p","12p+"];i.forEach(v=>a[v]=0);let s=0,o=0;r.forEach(v=>{const b=`${v.floor}::${v.roomName}`;n.has(b)||n.set(b,{floor:v.floor,name:v.roomName,type:v.roomType,totalMeetings:0,occupiedMeetings:0,totalAttendees:0,sizeCounts:{},binCounts:{},eventsBySize:{},fitBuckets:{low:[],mid:[],fit:[],over:[]}});const x=n.get(b);if(x.totalMeetings++,v.occupied&&v.attendees>0){x.occupiedMeetings++,x.totalAttendees+=v.attendees,s++,o+=v.attendees;const _=v.attendees;x.sizeCounts[_]=(x.sizeCounts[_]||0)+1;const w={week:v.week,day:v.day,time:v.time,attendees:v.attendees,eventId:v.eventId,floor:v.floor,roomName:v.roomName,roomType:v.roomType,rawRowIds:v.rawRowIds};x.eventsBySize[_]||(x.eventsBySize[_]=[]),x.eventsBySize[_].push(w);const S=Nye(_);x.binCounts[S]=(x.binCounts[S]||0)+1,a[S]=(a[S]||0)+1;const k=t[b]||0;if(k>0){const N=v.attendees/k;N<.4?x.fitBuckets.low.push(w):N<.7?x.fitBuckets.mid.push(w):N<=1?x.fitBuckets.fit.push(w):x.fitBuckets.over.push(w)}}});const c=[];n.forEach((v,b)=>{const x=Object.keys(v.sizeCounts).map(Z=>{const ee=parseInt(Z),O=v.sizeCounts[ee],L=v.occupiedMeetings>0?O/v.occupiedMeetings*100:0,R=(v.eventsBySize[ee]||[]).sort((X,J)=>X.day!==J.day?X.day-J.day:X.time.localeCompare(J.time));return{floor:v.floor,roomName:v.name,size:ee,count:O,occupancyPct:L,events:R}}).sort((Z,ee)=>Z.size-ee.size);let _=0,w=0;x.forEach(Z=>{Z.count>w&&(w=Z.count,_=Z.size)});const S=v.occupiedMeetings>0?w/v.occupiedMeetings*100:0,k=_>0?`${_}p (${S.toFixed(0)}%)`:"-",N=t[b]||0,j=v.occupiedMeetings>0?v.totalAttendees/v.occupiedMeetings:0,E=N>0?j/N:0;let A="Mixed Pattern / Review Required";if(N===0||v.occupiedMeetings===0)A="Unclassified";else{const Z=Math.round(N),ee=Math.round(_),O=Math.round(j),L=Math.round(.5*Z),R=Math.round(.7*Z),X=Math.round(.8*Z);ee<L&&O<L?A="Underutilized / Size Mismatch":ee>=L&&ee<=R||O>=L&&O<=R?A="Reasonably Utilized":ee>=X&&O>=X?A="Over Utilized":A="Mixed Pattern / Review Required"}const T=v.fitBuckets.low.length,F=v.fitBuckets.mid.length,G=v.fitBuckets.fit.length,M=v.fitBuckets.over.length,W=v.occupiedMeetings>0?T/v.occupiedMeetings:0,Y=v.occupiedMeetings>0?F/v.occupiedMeetings:0,K=v.occupiedMeetings>0?G/v.occupiedMeetings:0,D=v.occupiedMeetings>0?M/v.occupiedMeetings:0;c.push({floor:v.floor,roomName:v.name,roomType:v.type,capacity:N,observedSlots:v.totalMeetings,occupiedSlots:v.occupiedMeetings,utilizationPct:v.totalMeetings>0?v.occupiedMeetings/v.totalMeetings*100:0,avgOccupancy:j,meetingSizeDistribution:v.binCounts,sizeBreakdown:x,topMeetingSize:k,avgCapRatio:E,classification:A,capacityFit:{low:{count:T,pct:W*100,events:v.fitBuckets.low},mid:{count:F,pct:Y*100,events:v.fitBuckets.mid},fit:{count:G,pct:K*100,events:v.fitBuckets.fit},over:{count:M,pct:D*100,events:v.fitBuckets.over}}})});const u=c.reduce((v,b)=>v+b.observedSlots,0),f=i.map(v=>({label:v,count:a[v],occupancyPct:s>0?a[v]/s*100:0})),d=[],h=a["1p"]||0,p=a["2p"]||0,m=a["8-11p"]||0,g=a["12p+"]||0;if(s>0){const v=(h+p)/s*100,b=(m+g)/s*100;v>60&&d.push("Most interactions are small-format (1-2p), suggesting high demand for focus or dyad rooms."),b>15&&d.push("Notable volume of mid-to-large meetings indicates valid need for formal conference spaces."),b<5&&d.push("Large meetings (8p+) are infrequent; consider repurposing large boardrooms."),a["3-4p"]>a["1p"]&&d.push("Small group collaboration (3-4p) is a dominant behavior.")}else d.push("Insufficient data to generate behavioral insights.");const y=i6(e);return{avgOccupancy:0,peakOccupancy:0,occupancyByTime:[],occupancyByFloor:[],roomMetrics:c,totalObservations:u,totalRooms:n.size,overallUtilization:u>0?s/u*100:0,overallAvgAttendees:s>0?o/s:0,globalSizeBins:f,globalInsights:d,concurrencyStats:y}},Eye=e=>{const t=[],r=["L10","L11","L12"],n=["09:00","10:00","11:00","13:00","14:00","15:00","16:00"];if(e==="workstation"){const a=["Sales","IT","HR","Finance","Product"];for(let i=0;i<800;i++){const s=Math.random()>.4;t.push({id:`sim-${i}`,date:"2024-01-01",timeSlot:n[Math.floor(Math.random()*n.length)],floor:r[Math.floor(Math.random()*r.length)],department:a[Math.floor(Math.random()*a.length)],isOccupied:s})}}else{const a=[{name:"Focus 01",type:"Focus Room"},{name:"Meet 01",type:"Meeting Room"},{name:"Meet 02",type:"Meeting Room"},{name:"Boardroom",type:"Boardroom"}];for(let i=0;i<500;i++){const s=a[Math.floor(Math.random()*a.length)],o=n[Math.floor(Math.random()*n.length)],c=r[Math.floor(Math.random()*r.length)],u=Math.floor(Math.random()*5)+1;if(!(Math.random()>.3))t.push({id:`sim-empty-${i}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!1,date:""});else{const d=Math.floor(Math.random()*8)+1;for(let h=0;h<d;h++)t.push({id:`sim-occ-${i}-${h}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!0,attendeeCount:1,date:""})}}}return t},Tye=()=>{const[e,t]=H.useState("import"),[r,n]=H.useState("workstation"),[a,i]=H.useState([]),[s,o]=H.useState([]),[c,u]=H.useState({}),[f,d]=H.useState([]),[h,p]=H.useState(null),[m,g]=H.useState(!1),[y,v]=H.useState(1),[b,x]=H.useState(""),[_,w]=H.useState(null),[S,k]=H.useState(!1),N=(A,T)=>{k(!0),i(A),x(T);const F=A[0];o(F);const G=Sye(F,r==="workstation"?"workstation":"meeting");u(G);const M=y4(A,G,r==="workstation"?"workstation":"meeting");d(M);const W=_ye(A,G,r==="workstation"?"workstation":"meeting");!W.isValid||W.warnings.length>0?(p({missing:W.missingFields,warnings:W.warnings}),g(!0)):(p(null),g(!1)),setTimeout(()=>{k(!1),t("results")},800)},j=async A=>{var F;const T=(F=A.target.files)==null?void 0:F[0];if(T)try{const G=await wye(T);G&&G.length>0?(N(G,T.name),w(null)):w("File appears empty.")}catch{w("Failed to parse Excel.")}},E=()=>{const A=Eye(r==="workstation"?"workstation":"meeting");d(A),x("Sample_Data.xlsx"),g(!1),t("results")};return e==="results"?l.jsx(Aye,{records:f,type:r,onBack:()=>{t("import"),v(1)},headers:s,rawData:a,currentMappings:c,initialShowMapping:m,onUpdateMappings:A=>{u(A);const T=y4(a,A,r==="workstation"?"workstation":"meeting");d(T)}}):l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 overflow-hidden",children:[l.jsx("div",{className:"p-6 border-b border-slate-200 bg-white flex justify-between items-center",children:l.jsxs("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(fc,{className:"w-6 h-6 text-orange-500"})," Utilization Study"]})}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[500px] flex flex-col justify-center",children:[y===1&&l.jsxs("div",{className:"p-10 text-center animate-in fade-in",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Study Type"}),l.jsx("p",{className:"text-slate-500 mb-8",children:"Choose the analytical lens for your observation data."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto",children:[l.jsxs("button",{onClick:()=>{n("workstation"),v(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(Rn,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(Rn,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Workstation Occupancy"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Analyze desk usage, peak loads, and department patterns."})]}),l.jsxs("button",{onClick:()=>{n("meeting"),v(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(Fr,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(Fr,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Meeting Utilization"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Evaluate room capacity sizing and frequency of use."})]})]})]}),y===2&&l.jsx("div",{className:"p-10 text-center animate-in fade-in",children:S?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-600 rounded-full animate-spin mb-6"}),l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Processing Data..."}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Auto-detecting columns and calculating metrics."})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:l.jsx(ZT,{className:"w-10 h-10 text-slate-400"})}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Upload Data Source"}),l.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:"Upload your Excel observation log. The system will automatically detect fields like Date, Time, Floor, and Occupancy."}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("label",{className:"cursor-pointer bg-slate-900 hover:bg-slate-800 text-white px-8 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3",children:[l.jsx(qy,{className:"w-5 h-5"}),"Select Excel File",l.jsx("input",{type:"file",className:"hidden",accept:".xlsx, .xls",onChange:j})]}),l.jsx("button",{onClick:E,className:"text-sm font-bold text-slate-400 hover:text-orange-600 transition-colors py-2",children:"Use Sample Dataset"})]}),_&&l.jsxs("div",{className:"mt-6 bg-rose-50 text-rose-600 px-4 py-3 rounded-lg inline-flex items-center gap-2 text-sm font-medium",children:[l.jsx(ur,{className:"w-4 h-4"})," ",_]}),l.jsx("button",{onClick:()=>v(1),className:"mt-12 text-xs font-bold text-slate-400 hover:text-slate-600",children:" Back to Study Type"})]})})]})})]})},Aye=({records:e,type:t,onBack:r,headers:n,rawData:a,currentMappings:i,initialShowMapping:s,onUpdateMappings:o})=>{const[c,u]=H.useState(!1),[f,d]=H.useState(null),[h,p]=H.useState(null),[m,g]=H.useState({});H.useEffect(()=>{c&&g({...i})},[c,i]),H.useEffect(()=>{s&&u(!0)},[s]);const y=()=>{o(m),u(!1)},[v,b]=H.useState({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),[x,_]=H.useState({}),w=H.useMemo(()=>{const M=new Set,W=new Set,Y=new Set,K=new Set,D=new Set,Z=new Set,ee=new Set,O=new Set,L=R=>["level","floor","department","room","type","capacity","week","day","time"].includes(String(R).toLowerCase().trim());return e.forEach(R=>{R.floor&&!L(R.floor)&&M.add(R.floor),R.roomName&&!L(R.roomName)&&W.add(R.roomName),R.roomType&&!L(R.roomType)&&Y.add(R.roomType),R.week!==void 0&&K.add(R.week.toString()),R.day!==void 0&&D.add(R.day),R.timeSlot&&!L(R.timeSlot)&&Z.add(R.timeSlot),R.department&&!L(R.department)&&ee.add(R.department),R.date&&O.add(R.date)}),{floors:Array.from(M).sort(),rooms:Array.from(W).sort(),types:Array.from(Y).sort(),weeks:Array.from(K).sort((R,X)=>parseInt(R)-parseInt(X)),days:Array.from(D).sort((R,X)=>R-X).map(String),timeSlots:Array.from(Z).sort(),depts:Array.from(ee).sort(),dates:Array.from(O).sort()}},[e]),S=H.useMemo(()=>e.filter(M=>{if(v.floors.length&&!v.floors.includes(M.floor)||v.timeSlots.length&&!v.timeSlots.includes(M.timeSlot))return!1;if(t==="meeting"){if(v.rooms.length&&M.roomName&&!v.rooms.includes(M.roomName)||v.types.length&&M.roomType&&!v.types.includes(M.roomType)||v.weeks.length&&M.week!==void 0&&!v.weeks.includes(M.week.toString())||v.days.length&&M.day!==void 0&&!v.days.includes(M.day.toString()))return!1}else if(v.depts.length&&M.department&&!v.depts.includes(M.department)||v.dates.length&&M.date&&!v.dates.includes(M.date))return!1;return!0}),[e,v,t]),k=H.useMemo(()=>t==="workstation"?kye(S):jye(S,x),[S,t,x]),N=t==="workstation"?n6:a6,j=N.filter(M=>M.required&&i[M.key]===void 0),E=j.length>0,A=(M,W)=>{b(Y=>{const K=Y[M];return{...Y,[M]:K.includes(W)?K.filter(D=>D!==W):[...K,W]}})},T=(M,W,Y)=>{const K=`${M}::${W}`;_(D=>({...D,[K]:Y}))},F=({label:M,items:W,active:Y,field:K})=>l.jsxs("div",{className:"relative group",children:[l.jsxs("button",{className:`flex items-center gap-1.5 px-3 py-1.5 text-xs font-bold rounded-lg border transition-colors ${Y.length>0?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-600 hover:border-slate-300"}`,children:[M," ",Y.length>0&&l.jsx("span",{className:"bg-indigo-600 text-white px-1.5 rounded-full text-[9px]",children:Y.length}),l.jsx(Pr,{className:"w-3 h-3 rotate-90 text-slate-400"})]}),l.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 hidden group-hover:block z-50 p-2 max-h-64 overflow-y-auto",children:W.length===0?l.jsx("div",{className:"p-2 text-xs text-slate-400 italic",children:"No options found"}):W.map(D=>l.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"rounded text-indigo-600 focus:ring-indigo-500",checked:Y.includes(D),onChange:()=>A(K,D)}),l.jsx("span",{className:"text-xs text-slate-700 truncate",children:D})]},D))})]}),G=()=>{const M=br.book_new(),W=br.json_to_sheet(S);if(br.book_append_sheet(M,W,"Raw Data"),t==="meeting"&&k.roomMetrics){const Y=k.roomMetrics.map(D=>({Floor:D.floor,"Room Name":D.roomName,Type:D.roomType,"Room Capacity (User)":D.capacity,"Observed Slots":D.observedSlots,"Occupied Slots":D.occupiedSlots,"Utilization %":(D.utilizationPct/100).toFixed(2),"Avg Occupancy":D.avgOccupancy.toFixed(1),"Top Meeting Size":D.topMeetingSize,Classification:D.classification})),K=br.json_to_sheet(Y);br.book_append_sheet(M,K,"Room Performance")}em(M,"Utilization_Analysis.xlsx")};return l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 relative",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm z-20",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 transition-colors",children:l.jsx(Pr,{className:"w-5 h-5 rotate-180"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[t==="workstation"?"Workstation Occupancy":"Meeting Utilization",E&&l.jsxs("span",{title:"Mapping Incomplete",className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-200",children:[l.jsx(ur,{className:"w-3 h-3"})," Fix Mapping"]})]}),l.jsxs("p",{className:"text-xs text-slate-500",children:[S.length," Observations Analyzed"]})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsxs("button",{onClick:G,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white border border-transparent rounded-lg text-xs font-bold shadow-sm",children:[l.jsx(ra,{className:"w-4 h-4"})," Export"]})})]}),t==="workstation"&&l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-2 flex items-center gap-4 z-10 overflow-x-auto",children:[l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase mr-2",children:[l.jsx(pv,{className:"w-3 h-3"})," Filters:"]}),l.jsx(F,{label:"Floor",items:w.floors,active:v.floors,field:"floors"}),l.jsx(F,{label:"Time Slot",items:w.timeSlots,active:v.timeSlots,field:"timeSlots"}),l.jsx(F,{label:"Department",items:w.depts,active:v.depts,field:"depts"}),l.jsx(F,{label:"Date",items:w.dates,active:v.dates,field:"dates"}),l.jsxs("button",{onClick:()=>b({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),className:"ml-auto text-xs font-bold text-rose-500 hover:text-rose-700 flex items-center gap-1",children:[l.jsx(on,{className:"w-3 h-3"})," Clear"]})]}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto custom-scrollbar",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:S.length===0?l.jsxs("div",{className:"text-center py-20 text-slate-400",children:[l.jsx(pv,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),l.jsx("p",{children:"No records match the current filters."})]}):t==="workstation"?l.jsx(Pye,{metrics:k}):l.jsx(Iye,{metrics:k,records:S,onUpdateCapacity:T,onDrillDown:(M,W,Y)=>d({title:M,events:W,context:Y})})})}),c&&l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[450px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800",children:"Auto Field Detection"}),l.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Map Excel columns to required system fields."})]}),l.jsx("button",{onClick:()=>u(!1),children:l.jsx(on,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[E&&l.jsxs("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[l.jsx(ur,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block mb-1",children:"Missing Required Fields"}),l.jsx("ul",{className:"list-disc list-inside space-y-0.5",children:j.map(M=>l.jsx("li",{children:M.label},M.key))})]})]}),l.jsx("div",{className:"space-y-6",children:N.map(M=>{const W=m[M.key],Y=W!==void 0&&a.length>1?a.slice(1,4).map(K=>K[W]).filter(K=>K!==void 0&&K!==""):[];return l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm",children:[l.jsxs("label",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[M.label,M.required&&l.jsx("span",{className:"text-rose-500",title:"Required",children:"*"})]}),W===void 0&&M.required&&l.jsx("span",{className:"text-[9px] text-rose-500 font-bold uppercase bg-rose-50 px-1.5 py-0.5 rounded",children:"Unmapped"})]}),l.jsxs("select",{className:`w-full p-2 text-sm border rounded outline-none transition-all ${W===void 0&&M.required?"border-rose-300 bg-rose-50 focus:border-rose-500":"border-slate-300 bg-white focus:border-indigo-500"}`,value:W??"",onChange:K=>{const D=K.target.value,Z={...m};D===""?delete Z[M.key]:Z[M.key]=parseInt(D),g(Z)},children:[l.jsx("option",{value:"",children:"(Select Excel Column)"}),n.map((K,D)=>l.jsx("option",{value:D,children:K},D))]}),l.jsx("div",{className:"mt-2 min-h-[1.5em]",children:W!==void 0?l.jsxs("div",{className:"text-[10px] text-slate-500 flex items-start gap-1.5 bg-slate-50 p-1.5 rounded",children:[l.jsx("span",{className:"font-bold text-slate-400 uppercase text-[9px] mt-0.5",children:"Preview:"}),l.jsx("span",{className:"font-mono text-slate-700 break-all leading-tight",children:Y.length>0?Y.join(", "):l.jsx("span",{className:"italic text-slate-400",children:"Empty column"})})]}):l.jsx("div",{className:"text-[10px] text-slate-300 italic pl-1",children:"Map a column to see preview"})})]},M.key)})})]}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:y,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(Cn,{className:"w-4 h-4"})," Apply Mapping"]})})]})}),f&&l.jsx(Oye,{title:f.title,events:f.events,context:f.context,onClose:()=>d(null),onJumpToRaw:M=>p(M)}),h&&l.jsx(Cye,{ids:h,allRecords:e,onClose:()=>p(null)})]})},Oye=({title:e,events:t,context:r,onClose:n,onJumpToRaw:a})=>{const i=()=>{const s=t.map(u=>({Week:u.week,Day:u.day,Time:u.time,Floor:u.floor,Room:u.roomName,Type:u.roomType,Attendees:u.attendees})),o=br.book_new(),c=br.json_to_sheet(s);br.book_append_sheet(o,c,"Events"),em(o,"Drilldown_Events.xlsx")};return l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[600px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-6 border-b border-slate-200 bg-slate-50 flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e,l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-sm px-2 py-0.5 rounded-full",children:t.length})]}),r&&l.jsxs("div",{className:"mt-2 p-2 bg-indigo-50 border border-indigo-100 rounded text-xs text-indigo-700 font-medium",children:["These events contribute to the room being classified as ",l.jsx("span",{className:"font-bold uppercase",children:r}),"."]})]}),l.jsx("button",{onClick:n,children:l.jsx(on,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-0",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-white border-b border-slate-200 text-xs text-slate-500 uppercase font-semibold sticky top-0 z-10 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Wk-Day"}),l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Time"}),l.jsx("th",{className:"px-6 py-3 bg-white",children:"Room"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Attendees"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t.map((s,o)=>l.jsxs("tr",{className:"hover:bg-slate-50 group",children:[l.jsxs("td",{className:"px-6 py-3 font-medium text-slate-500",children:["W",s.week,"-D",s.day]}),l.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.time}),l.jsxs("td",{className:"px-6 py-3 text-slate-700",children:[l.jsx("div",{className:"truncate w-32",title:s.roomName,children:s.roomName}),l.jsx("div",{className:"text-[10px] text-slate-400",children:s.roomType})]}),l.jsx("td",{className:"px-6 py-3 text-right font-bold text-indigo-600",children:s.attendees}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("button",{onClick:()=>a(s.rawRowIds),className:"text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx(Qp,{className:"w-3 h-3"})," Raw Data"]})})]},o))})]})}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:i,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(ra,{className:"w-4 h-4"})," Export Events CSV"]})})]})})},Cye=({ids:e,allRecords:t,onClose:r})=>{const n=t.filter(a=>e.includes(a.id));return l.jsx("div",{className:"absolute inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[80vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2",children:[l.jsx(Qp,{className:"w-5 h-5 text-indigo-600"})," Source Data Inspection"]}),l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Showing ",n.length," raw Excel row(s) corresponding to selected event."]})]}),l.jsx("button",{onClick:r,children:l.jsx(on,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-auto p-6 bg-slate-50/50",children:l.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"ID"}),l.jsx("th",{className:"px-4 py-3",children:"Floor"}),l.jsx("th",{className:"px-4 py-3",children:"Room / Dept"}),l.jsx("th",{className:"px-4 py-3",children:"Day"}),l.jsx("th",{className:"px-4 py-3",children:"Time"}),l.jsx("th",{className:"px-4 py-3",children:"Occupancy"}),l.jsx("th",{className:"px-4 py-3",children:"Status"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(a=>l.jsxs("tr",{className:"hover:bg-indigo-50/30",children:[l.jsx("td",{className:"px-4 py-2 font-mono text-slate-400",children:a.id}),l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:a.floor}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.roomName||a.department}),l.jsxs("td",{className:"px-4 py-2 text-slate-600",children:["Day ",a.day]}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.timeSlot}),l.jsx("td",{className:"px-4 py-2 font-bold text-indigo-600",children:a.attendeeCount||1}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${a.isOccupied?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:a.isOccupied?"Occupied":"Vacant"})})]},a.id))})]})})}),l.jsx("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end",children:l.jsx("button",{onClick:r,className:"px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-bold transition-colors",children:"Close"})})]})})},Pye=({metrics:e})=>l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"col-span-1 lg:col-span-2 grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Avg Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-indigo-600 mt-2",children:[e.avgOccupancy.toFixed(0),"%"]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Peak Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-rose-500 mt-2",children:[e.peakOccupancy.toFixed(0),"%"]})]}),l.jsx("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:l.jsxs("div",{className:"flex gap-2 items-start text-xs text-slate-600",children:[l.jsx(t0,{className:"w-4 h-4 text-indigo-500 flex-shrink-0"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Insight:"})," ",e.avgOccupancy<50?"Low utilization suggests opportunity for desk sharing or consolidation.":"High utilization indicates steady demand."]})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy Profile (Time)"}),l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(ple,{data:e.occupancyByTime,children:[l.jsx(Pf,{strokeDasharray:"3 3",vertical:!1}),l.jsx(la,{dataKey:"time",tick:{fontSize:10}}),l.jsx(ca,{unit:"%",tick:{fontSize:10}}),l.jsx(ir,{}),l.jsx(m0,{type:"monotone",dataKey:"rate",stroke:Nt.primary,strokeWidth:3,dot:{r:4}})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy by Floor"}),l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(g0,{data:e.occupancyByFloor,layout:"vertical",children:[l.jsx(Pf,{strokeDasharray:"3 3",horizontal:!1}),l.jsx(la,{type:"number",unit:"%",hide:!0}),l.jsx(ca,{type:"category",dataKey:"floor",tick:{fontSize:11},width:50}),l.jsx(ir,{}),l.jsx(Ia,{dataKey:"rate",fill:Nt.program[0],radius:[0,4,4,0],barSize:20,label:{position:"right",fontSize:10,fill:"#64748b",formatter:t=>`${t.toFixed(0)}%`}})]})})]})]}),Mye=({row:e})=>{const[t,r]=H.useState(!1);if(!e.capacity||e.capacity===0)return l.jsx("div",{className:"text-xs text-slate-400 italic",children:"Set capacity to evaluate fit."});const n=e.sizeBreakdown.map(m=>({label:`${m.size}p`,pct:m.occupancyPct,count:m.count,size:m.size})).filter(m=>m.pct>0),a=m=>m<=1?"bg-slate-200":m<=2?"bg-slate-300":m<=4?"bg-indigo-200":m<=6?"bg-indigo-300":m<=10?"bg-indigo-400":"bg-indigo-500",s=(m=>m.includes("Under")?{class:"bg-blue-50 text-blue-700 border-blue-200",icon:Up}:m.includes("Reasonably")||m.includes("Well")?{class:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:fa}:m.includes("Over")?{class:"bg-rose-50 text-rose-700 border-rose-200",icon:ur}:{class:"bg-amber-50 text-amber-700 border-amber-200",icon:Gp})(e.classification),o=s.icon;let c="";e.classification.includes("Underutilized")?c="Most meetings occur well below room capacity.":e.classification.includes("Over")?c="Meetings frequently approach or exceed room capacity.":e.classification.includes("Reasonably")?c="Room usage generally aligns with its designed capacity.":c="Meeting size patterns vary significantly and require review.";const u=Math.round(e.capacity),f=Math.round(.5*u),d=Math.round(.7*u),h=Math.round(.8*u),p=parseInt(e.topMeetingSize.split("p")[0])||0;return l.jsxs("div",{className:"flex flex-col gap-4 w-full relative",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border flex items-center gap-1.5 ${s.class}`,children:[l.jsx(o,{className:"w-3 h-3"}),e.classification]}),l.jsx("button",{onClick:()=>r(!t),className:`p-1 rounded hover:bg-slate-100 ${t?"text-indigo-600 bg-indigo-50":"text-slate-400"}`,title:"Explain Logic",children:l.jsx(t0,{className:"w-3 h-3"})})]}),t&&l.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded p-3 text-[10px] space-y-2 animate-in fade-in slide-in-from-top-1 mt-1",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2 border-b border-slate-200 pb-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Capacity"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[u," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Primary"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[p," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Avg Occ"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Logic Applied"}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["< ",f," pax"]}),l.jsx("span",{children:"Underutilized"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:[f,"",d," pax"]}),l.jsx("span",{children:"Reasonable"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["> ",h," pax"]}),l.jsx("span",{children:"Over Utilized"})]})]}),l.jsx("div",{className:"pt-1 text-slate-500 italic",children:"Values are rounded before comparison. Primary size or Avg Occ must trigger threshold."})]}),!t&&l.jsx("div",{className:"text-[10px] text-slate-500 italic",children:c})]}),l.jsx("div",{className:"relative h-8 w-full mt-1",children:l.jsx("div",{className:"absolute inset-0 flex rounded-md overflow-hidden h-full border border-white bg-slate-50",children:n.map((m,g)=>l.jsx("div",{style:{width:`${m.pct}%`},className:`${a(m.size)} h-full border-r border-white last:border-0 relative group flex items-center justify-center transition-colors hover:brightness-95`,title:`${m.label}: ${m.pct.toFixed(1)}%`,children:m.pct>8&&l.jsx("span",{className:"text-[9px] font-bold text-slate-700 opacity-80 whitespace-nowrap px-1",children:m.label})},g))})}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-500 font-medium flex gap-3 border-b border-slate-100 pb-2",children:[l.jsxs("span",{children:["Room Capacity: ",l.jsxs("strong",{className:"text-slate-700",children:[e.capacity," pax"]})]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:["Avg Occupancy: ",l.jsxs("strong",{className:"text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsx("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:n.map((m,g)=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${a(m.size)}`}),l.jsxs("span",{className:"text-[9px] text-slate-400 font-medium",children:[m.label," (",m.pct.toFixed(0),"%)"]})]},g))})]})]})},Fye=({stats:e,totalRooms:t,roomTypes:r,selectedType:n,onSelectType:a})=>{if(!e||!e.timeline)return null;const i=Math.round(e.avgPct/100*e.uniqueRoomsCount),s=Math.round(e.maxPct/100*e.uniqueRoomsCount),o=n==="All Rooms"?"OVERALL ROOM OCCUPANCY (CONCURRENCY)":`${n.toUpperCase()} OCCUPANCY (CONCURRENCY)`;return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"md:w-1/3 flex flex-col justify-center space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase",children:o}),l.jsxs("div",{className:"relative group",children:[l.jsx("select",{className:"appearance-none bg-slate-50 border border-slate-200 text-xs font-bold text-slate-700 py-1 pl-2 pr-6 rounded-md hover:border-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 cursor-pointer max-w-[140px] truncate",value:n,onChange:c=>a(c.target.value),children:r.map(c=>l.jsx("option",{value:c,children:c},c))}),l.jsx(Xr,{className:"w-3 h-3 text-slate-400 absolute right-2 top-1.5 pointer-events-none"})]})]}),l.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Based on concurrent usage across all observed time slots."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Average Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[e.avgPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",i," rooms in use"]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Max Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-rose-500",children:[e.maxPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",s," rooms in use"]})]})]})]}),l.jsx("div",{className:"md:w-2/3 h-64",children:e.timeline.length>0?l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(g0,{data:e.timeline,margin:{top:20,right:20,left:0,bottom:0},children:[l.jsx(Pf,{strokeDasharray:"3 3",vertical:!1}),l.jsx(la,{dataKey:"time",tick:{fontSize:10},interval:"preserveStartEnd",minTickGap:30}),l.jsx(ca,{unit:"%",tick:{fontSize:10},domain:[0,100]}),l.jsx(ir,{content:({active:c,payload:u,label:f})=>{if(c&&u&&u.length){const d=u[0].payload;return l.jsxs("div",{className:"bg-white p-2 border border-slate-200 rounded shadow-lg text-xs",children:[l.jsx("div",{className:"font-bold text-slate-800 mb-1",children:f}),l.jsxs("div",{className:"text-indigo-600 font-bold",children:[d.pct.toFixed(1),"% Occupied"]}),l.jsxs("div",{className:"text-slate-500",children:[d.occupied," / ",d.total," Rooms Observed"]})]})}return null}}),l.jsx(x0,{y:e.avgPct,stroke:"#6366f1",strokeDasharray:"3 3",label:{value:"Avg",position:"insideTopRight",fill:"#6366f1",fontSize:10}}),l.jsx(Ia,{dataKey:"pct",fill:"#cbd5e1",radius:[2,2,0,0],children:e.timeline.map((c,u)=>l.jsx(Ci,{fill:c.pct===e.maxPct?"#f43f5e":"#cbd5e1"},`cell-${u}`))})]})}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-100 rounded-xl",children:[l.jsx(fc,{className:"w-8 h-8 mb-2"}),l.jsx("p",{className:"text-xs",children:"No occupied observations for selected room type."})]})})]})},Dye=({metrics:e})=>{const t=e.globalSizeBins,r=t.map(n=>({name:n.label,value:n.count,pct:n.occupancyPct,fill:n.label.includes("12p")?Nt.program[5]:n.label.includes("8-11")?Nt.program[2]:n.label.includes("5-7")?Nt.program[1]:n.label.includes("3-4")?Nt.program[3]:Nt.program[0]}));return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"flex-1 min-w-[300px]",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Meeting Size Distribution (Occupancy %)"}),l.jsx("div",{className:"h-64",children:l.jsx(qa,{width:"100%",height:"100%",children:l.jsxs(Hx,{children:[l.jsxs(pa,{data:r,dataKey:"pct",nameKey:"name",innerRadius:60,outerRadius:80,paddingAngle:2,children:[r.map((n,a)=>l.jsx(Ci,{fill:n.fill,stroke:"none"},`cell-${a}`)),l.jsx(Dn,{dataKey:"name",position:"outside",style:{fontSize:10,fill:"#64748b",fontWeight:"bold"}})]}),l.jsx(ir,{formatter:(n,a,i)=>[`${n.toFixed(1)}% (${i.payload.value} mtgs)`,a],contentStyle:{borderRadius:"8px",fontSize:"12px"}}),l.jsx(na,{verticalAlign:"bottom",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Global Distribution"}),l.jsx("div",{className:"bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occupancy %"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-200",children:t.map(n=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:n.label}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-500",children:n.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-bold text-indigo-600",children:[n.occupancyPct.toFixed(1),"%"]})]},n.label))})]})})]}),l.jsxs("div",{className:"flex-1 bg-indigo-50 rounded-xl border border-indigo-100 p-5",children:[l.jsxs("h3",{className:"text-xs font-bold text-indigo-800 uppercase mb-3 flex items-center gap-2",children:[l.jsx(BT,{className:"w-4 h-4 text-indigo-600"})," Work Behaviors"]}),l.jsx("ul",{className:"space-y-3",children:e.globalInsights.map((n,a)=>l.jsxs("li",{className:"flex gap-2 text-xs text-indigo-900 leading-relaxed",children:[l.jsx(zp,{className:"w-3 h-3 text-indigo-400 mt-0.5 flex-shrink-0"}),n]},a))})]})]})},Iye=({metrics:e,records:t,onUpdateCapacity:r,onDrillDown:n})=>{const[a,i]=H.useState("utilizationPct"),[s,o]=H.useState(!1),[c,u]=H.useState(null),[f,d]=H.useState("All"),[h,p]=H.useState("All Rooms"),m=H.useMemo(()=>{let x=[...e.roomMetrics];return f!=="All"&&(x=x.filter(_=>f==="Under"?_.classification.includes("Under"):f==="Fit"?_.classification.includes("Reasonably")||_.classification.includes("Well"):f==="Over"?_.classification.includes("Over"):f==="Mixed"?_.classification.includes("Mixed")||_.classification.includes("Unclassified"):!0)),x.sort((_,w)=>{const S=_[a],k=w[a];return s?S-k:k-S})},[e.roomMetrics,a,s,f]),g=H.useMemo(()=>{const x=new Set;return t.forEach(_=>{_.roomType&&x.add(_.roomType.trim())}),["All Rooms",...Array.from(x).sort()]},[t]),y=H.useMemo(()=>{const x=h==="All Rooms"?t:t.filter(_=>(_.roomType||"").trim()===h);return i6(x)},[t,h]),v=x=>{if(!x.sizeBreakdown||x.sizeBreakdown.length===0)return"No data available.";const w=[...x.sizeBreakdown].sort((E,A)=>A.count-E.count)[0],k=x.sizeBreakdown.filter(E=>E.size<=2).reduce((E,A)=>E+A.occupancyPct,0);if(w.size<=2&&k>w.occupancyPct+5)return`Small meetings (12p) account for ${k.toFixed(0)}% of usage.`;const j=x.sizeBreakdown.filter(E=>E.size>=3&&E.size<=4).reduce((E,A)=>E+A.occupancyPct,0);return(w.size===3||w.size===4)&&j>w.occupancyPct+5?`34 pax meetings account for ${j.toFixed(0)}% of usage.`:"Most frequent occupancy observed."},b=x=>x.includes("Under")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded border border-blue-100",children:[l.jsx(Up,{className:"w-3 h-3"})," Under"]}):x.includes("Reasonably")||x.includes("Well")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded border border-emerald-100",children:[l.jsx(fa,{className:"w-3 h-3"})," Fit"]}):x.includes("Over")?l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-rose-600 bg-rose-50 px-2 py-0.5 rounded border border-rose-100",children:[l.jsx(ur,{className:"w-3 h-3"})," Over"]}):l.jsxs("span",{title:x,className:"inline-flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-100",children:[l.jsx(Gp,{className:"w-3 h-3"})," Mixed"]});return l.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsx(Fye,{stats:y,totalRooms:e.totalRooms,roomTypes:g,selectedType:h,onSelectType:p}),l.jsx(Dye,{metrics:e}),l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(YT,{className:"w-4 h-4 text-slate-500"})," Room Performance"]}),l.jsx("div",{className:"flex items-center gap-1 bg-white border border-slate-200 p-0.5 rounded-lg",children:["All","Under","Fit","Over","Mixed"].map(x=>l.jsx("button",{onClick:()=>d(x),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-colors ${f===x?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:x},x))}),l.jsxs("div",{className:"text-xs text-slate-400 hidden sm:block",children:[e.totalRooms," Rooms | ",e.totalObservations," Observations"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-xs uppercase text-slate-500 font-semibold",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("floor"),children:"Floor"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomName"),children:"Room Name"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomType"),children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-center w-24",children:"Capacity (Pax)"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("utilizationPct"),children:"Util %"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("avgOccupancy"),children:"Avg Occ."}),l.jsx("th",{className:"px-6 py-3 text-center",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-center w-10"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:m.map((x,_)=>{const w=c===`${x.floor}-${x.roomName}`;return l.jsxs(q.Fragment,{children:[l.jsxs("tr",{className:`hover:bg-slate-50 transition-colors cursor-pointer ${w?"bg-slate-50":""}`,onClick:()=>u(w?null:`${x.floor}-${x.roomName}`),children:[l.jsx("td",{className:"px-6 py-3 text-slate-600",children:x.floor}),l.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:x.roomName}),l.jsx("td",{className:"px-6 py-3 text-slate-500 text-xs",children:x.roomType}),l.jsx("td",{className:"px-6 py-3 text-center",onClick:S=>S.stopPropagation(),children:l.jsxs("div",{className:"relative group/edit w-20 mx-auto",children:[l.jsx("input",{type:"number",className:"w-full text-center border-b border-transparent hover:border-slate-300 focus:border-indigo-500 focus:outline-none bg-transparent",placeholder:"-",value:x.capacity||"",onChange:S=>r(x.floor,x.roomName,parseInt(S.target.value)||0)}),l.jsx(GT,{className:"w-3 h-3 text-slate-300 absolute right-0 top-1 opacity-0 group-hover/edit:opacity-100 pointer-events-none"})]})}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("span",{className:`px-2 py-1 rounded text-xs font-bold ${x.utilizationPct>50?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[x.utilizationPct.toFixed(0),"%"]})}),l.jsx("td",{className:"px-6 py-3 text-right font-mono text-slate-600",children:x.avgOccupancy.toFixed(1)}),l.jsx("td",{className:"px-6 py-3 text-center",children:b(x.classification)}),l.jsx("td",{className:"px-4 py-3 text-center text-slate-400",children:l.jsx(Xr,{className:`w-4 h-4 transition-transform ${w?"rotate-180":""}`})})]}),w&&l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"p-0 bg-slate-50 border-b border-slate-200",children:l.jsxs("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col justify-between",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Room Snapshot"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Total Meetings (Occupied)"}),l.jsx("span",{className:"text-lg font-bold text-slate-800",children:x.occupiedSlots})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Room Utilization"}),l.jsxs("span",{className:`text-lg font-bold ${x.utilizationPct>50?"text-emerald-600":"text-slate-800"}`,children:[x.utilizationPct.toFixed(1),"%"]})]}),l.jsxs("div",{className:"pt-2 border-t border-slate-100 mt-2",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Primary Meeting Size"}),l.jsx("div",{className:"text-xl font-bold text-indigo-700",children:x.topMeetingSize}),l.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:v(x)})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Capacity Fit Analysis"}),l.jsx("div",{className:"flex-grow flex items-center",children:l.jsx(Mye,{row:x})})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden flex flex-col max-h-64",children:[l.jsx("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200",children:l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Size Breakdown"})}),l.jsx("div",{className:"flex-grow overflow-y-auto",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-white sticky top-0 text-slate-400 font-bold border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occ %"}),l.jsx("th",{className:"px-4 py-2"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-100",children:[x.sizeBreakdown.map((S,k)=>l.jsxs("tr",{className:"hover:bg-slate-50",children:[l.jsxs("td",{className:"px-4 py-2 font-bold text-slate-700",children:[S.size," pax"]}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-600",children:S.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-mono font-bold text-indigo-700",children:[S.occupancyPct.toFixed(0),"%"]}),l.jsx("td",{className:"px-4 py-2 text-right",children:l.jsxs("button",{onClick:()=>n(`${x.roomName} - ${S.size} Pax Meetings`,S.events,x.classification),className:"text-[9px] font-bold text-slate-400 hover:text-indigo-600 border border-slate-200 hover:border-indigo-200 px-2 py-1 rounded transition-colors",children:["View (",S.count,")"]})})]},k)),x.sizeBreakdown.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-4 text-center text-slate-400",children:"No data"})})]})]})})]})]})})})]},_)})})]})})]})]})},Ms=[{title:"Project Context",desc:"Define the strategic identity, scale, and physical constraints of your project. These inputs drive all subsequent capacity calculations.",icon:Xp},{title:"Strategy & Budget",desc:"Model scenarios by adjusting policy ratios (Sharing, Meeting, Support). See real-time impact on area demand vs supply.",icon:ps},{title:"Decision Framework",desc:"Compare scenarios side-by-side using strategic indicators like Density, Utilization Index, and Meeting Ratios.",icon:ms},{title:"Stacking & Mix",desc:"Visualize program distribution across floors. Ensure the 'Program Mix' aligns with organizational goals.",icon:Rn},{title:"Deep Analysis",desc:"Use Team Adjacency and Utilization Studies to validate your strategy with data-driven evidence.",icon:xs}],Rye=({onClose:e})=>{const[t,r]=H.useState(0),n=()=>{t<Ms.length-1?r(t+1):e()},a=Ms[t].icon;return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"h-32 bg-gradient-to-r from-orange-500 to-rose-500 relative flex items-center justify-center",children:[l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-md",children:l.jsx(a,{className:"w-8 h-8 text-white"})}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white/70 hover:text-white",children:l.jsx(on,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsxs("div",{className:"text-xs font-bold text-orange-600 uppercase tracking-widest mb-2",children:["Step ",t+1," of ",Ms.length]}),l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:Ms[t].title}),l.jsx("p",{className:"text-slate-500 leading-relaxed mb-8 h-16",children:Ms[t].desc}),l.jsx("div",{className:"flex gap-2 justify-center mb-8",children:Ms.map((i,s)=>l.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${s===t?"w-8 bg-orange-500":"w-2 bg-slate-200"}`},s))}),l.jsxs("button",{onClick:n,className:"w-full py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg",children:[t===Ms.length-1?"Get Started":"Next Step"," ",l.jsx(Pr,{className:"w-4 h-4"})]})]})]})})},$ye=()=>{const[e,t]=H.useState(bD),[r,n]=H.useState("home"),[a,i]=H.useState(!0),[s,o]=H.useState([{...aS,id:"s1",name:"Scenario A"}]),[c,u]=H.useState("s1"),[f,d]=H.useState(null),h=s.find(S=>S.id===c)||s[0],p=H.useMemo(()=>up(e,h),[e,h]),m=s.find(S=>S.id===f),g=m?up(e,m):null,y=S=>{o(k=>k.map(N=>N.id===S.id?S:N))},v=()=>{const S=`s${Date.now()}`,k={...aS,id:S,name:`Option ${s.length+1}`};o([...s,k]),u(S)},b=()=>{const S=`s${Date.now()}`,k={...h,id:S,name:`${h.name} (Copy)`};o([...s,k]),u(S)},x=S=>{if(s.length>1){const k=s.filter(N=>N.id!==S);o(k),c===S&&u(k[0].id),f===S&&d(null)}},_=(S,k)=>{o(N=>N.map(j=>j.id===S?{...j,name:k}:j))};H.useEffect(()=>{const S=wD(e.industry,e.projectType);Object.keys(S).length>0&&o(k=>k.map(N=>N.id===c?{...N,...S}:N))},[e.industry,e.projectType]);const w=({page:S,label:k,icon:N})=>l.jsxs("button",{onClick:()=>n(S),className:`w-full flex items-center gap-3 px-5 py-3 text-sm font-medium transition-all duration-200 border-l-2 ${r===S?"border-orange-500 bg-slate-50 text-slate-900":"border-transparent text-slate-500 hover:bg-slate-50 hover:text-slate-700"}`,children:[l.jsx(N,{className:`w-4 h-4 ${r===S?"text-orange-500":"text-slate-400"}`}),k]});return l.jsxs("div",{className:"h-screen w-screen bg-slate-100 flex overflow-hidden font-sans text-slate-900",children:[a&&l.jsx(Rye,{onClose:()=>i(!1)}),l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0 z-30 shadow-sm",children:[l.jsx("div",{className:"p-6 border-b border-slate-100",children:l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-8 bg-orange-500 rounded-sm"}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]",children:"M MOSER ASSOCIATES"})]}),l.jsxs("h1",{className:"text-base font-bold text-slate-800 leading-tight pl-4",children:["Workplace Strategy",l.jsx("br",{}),"Toolkit"]})]})}),l.jsxs("div",{className:"flex-grow py-8 space-y-8 overflow-y-auto",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Context"}),l.jsx(w,{page:"home",label:"Project Information",icon:Xp})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Strategy & Planning"}),l.jsx(w,{page:"budget",label:"Space Budget",icon:ps}),l.jsx(w,{page:"stacking",label:"Stacking Plan",icon:Mr})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deep Analysis"}),l.jsx(w,{page:"adjacency",label:"Team Adjacency",icon:xs}),l.jsx(w,{page:"utilization",label:"Utilization Study",icon:fc}),l.jsx(w,{page:"test-fit",label:"Test Fit Scoring",icon:uc})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deliverables"}),l.jsx(w,{page:"exports",label:"Exports",icon:ra})]})]}),l.jsx("div",{className:"p-5 border-t border-slate-100 bg-slate-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-white border border-slate-200 rounded-full flex items-center justify-center shadow-sm",children:l.jsx($T,{className:"w-4 h-4 text-slate-400"})}),l.jsxs("div",{className:"flex-grow overflow-hidden",children:[l.jsx("div",{className:"text-xs font-bold text-slate-800 truncate",title:e.projectName,children:e.projectName||"New Project"}),l.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:e.location||"Location N/A"})]})]})})]}),l.jsx("div",{className:"flex-grow flex flex-col overflow-hidden bg-[#F8FAFC] relative",children:l.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[r==="home"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(J1e,{data:e,onChange:t})}),r==="budget"&&l.jsx(pye,{project:e,setProject:t,activeStrategy:h,handleStrategyChange:y,activeMetrics:p,scenarios:s,activeScenarioId:c,setActiveScenarioId:u,addScenario:v,duplicateScenario:b,deleteScenario:x,renameScenario:_,compareScenarioId:f,setCompareScenarioId:d,compareMetrics:g,onNavigate:S=>n(S)}),r==="stacking"&&l.jsxs("div",{className:"h-full p-6 flex flex-col",children:[l.jsxs("div",{className:"mb-6 flex justify-between items-end px-2",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Stacking Plan"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Translate strategy into floor-by-floor allocation."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Active Strategy:"}),l.jsx("span",{className:"text-xs font-bold bg-white border border-slate-200 text-orange-600 px-3 py-1 rounded-full shadow-sm",children:h.name})]})]}),l.jsx("div",{className:"flex-grow overflow-hidden bg-white rounded-xl shadow-sm border border-slate-200",children:l.jsx(r6,{metrics:p,project:e,strategy:h,mode:"default",onUpdateProject:t})})]}),r==="adjacency"&&l.jsx("div",{className:"h-full p-6",children:l.jsx(vye,{project:e,onChange:t,metrics:p,onNavigateToStacking:()=>n("stacking")})}),r==="utilization"&&l.jsx("div",{className:"h-full",children:l.jsx(Tye,{})}),r==="test-fit"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(yye,{metrics:p,project:e})}),r==="exports"&&l.jsx("div",{className:"h-full",children:l.jsx(bye,{project:e,scenarios:s,activeScenarioId:c})})]})})]})},s6=document.getElementById("root");if(!s6)throw new Error("Could not find root element to mount to");const Lye=Fd.createRoot(s6);Lye.render(l.jsx(q.StrictMode,{children:l.jsx($ye,{})}));
