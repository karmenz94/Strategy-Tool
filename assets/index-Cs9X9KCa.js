(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var S0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function st(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m4={exports:{}},gp={},x4={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qf=Symbol.for("react.element"),xM=Symbol.for("react.portal"),vM=Symbol.for("react.fragment"),gM=Symbol.for("react.strict_mode"),yM=Symbol.for("react.profiler"),bM=Symbol.for("react.provider"),wM=Symbol.for("react.context"),_M=Symbol.for("react.forward_ref"),SM=Symbol.for("react.suspense"),kM=Symbol.for("react.memo"),NM=Symbol.for("react.lazy"),zw=Symbol.iterator;function jM(e){return e===null||typeof e!="object"?null:(e=zw&&e[zw]||e["@@iterator"],typeof e=="function"?e:null)}var v4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g4=Object.assign,y4={};function ic(e,t,r){this.props=e,this.context=t,this.refs=y4,this.updater=r||v4}ic.prototype.isReactComponent={};ic.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ic.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b4(){}b4.prototype=ic.prototype;function Y1(e,t,r){this.props=e,this.context=t,this.refs=y4,this.updater=r||v4}var Q1=Y1.prototype=new b4;Q1.constructor=Y1;g4(Q1,ic.prototype);Q1.isPureReactComponent=!0;var Ww=Array.isArray,w4=Object.prototype.hasOwnProperty,Z1={current:null},_4={key:!0,ref:!0,__self:!0,__source:!0};function S4(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)w4.call(t,n)&&!_4.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:qf,type:e,key:i,ref:s,props:a,_owner:Z1.current}}function EM(e,t){return{$$typeof:qf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function J1(e){return typeof e=="object"&&e!==null&&e.$$typeof===qf}function TM(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Hw=/\/+/g;function Zm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?TM(""+e.key):t.toString(36)}function pd(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case qf:case xM:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+Zm(s,0):n,Ww(a)?(r="",e!=null&&(r=e.replace(Hw,"$&/")+"/"),pd(a,t,r,"",function(u){return u})):a!=null&&(J1(a)&&(a=EM(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Hw,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",Ww(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Zm(i,o);s+=pd(i,t,r,c,a)}else if(c=jM(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Zm(i,o++),s+=pd(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function k0(e,t,r){if(e==null)return e;var n=[],a=0;return pd(e,n,"","",function(i){return t.call(r,i,a++)}),n}function AM(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var an={current:null},md={transition:null},OM={ReactCurrentDispatcher:an,ReactCurrentBatchConfig:md,ReactCurrentOwner:Z1};function k4(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:k0,forEach:function(e,t,r){k0(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return k0(e,function(){t++}),t},toArray:function(e){return k0(e,function(t){return t})||[]},only:function(e){if(!J1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=ic;Xe.Fragment=vM;Xe.Profiler=yM;Xe.PureComponent=Y1;Xe.StrictMode=gM;Xe.Suspense=SM;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OM;Xe.act=k4;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=g4({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Z1.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w4.call(t,c)&&!_4.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:qf,type:e.type,key:a,ref:i,props:n,_owner:s}};Xe.createContext=function(e){return e={$$typeof:wM,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:bM,_context:e},e.Consumer=e};Xe.createElement=S4;Xe.createFactory=function(e){var t=S4.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:_M,render:e}};Xe.isValidElement=J1;Xe.lazy=function(e){return{$$typeof:NM,_payload:{_status:-1,_result:e},_init:AM}};Xe.memo=function(e,t){return{$$typeof:kM,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=md.transition;md.transition={};try{e()}finally{md.transition=t}};Xe.unstable_act=k4;Xe.useCallback=function(e,t){return an.current.useCallback(e,t)};Xe.useContext=function(e){return an.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return an.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return an.current.useEffect(e,t)};Xe.useId=function(){return an.current.useId()};Xe.useImperativeHandle=function(e,t,r){return an.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return an.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return an.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return an.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return an.current.useReducer(e,t,r)};Xe.useRef=function(e){return an.current.useRef(e)};Xe.useState=function(e){return an.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return an.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return an.current.useTransition()};Xe.version="18.3.1";x4.exports=Xe;var G=x4.exports;const Y=st(G);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CM=G,PM=Symbol.for("react.element"),MM=Symbol.for("react.fragment"),FM=Object.prototype.hasOwnProperty,DM=CM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IM={key:!0,ref:!0,__self:!0,__source:!0};function N4(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)FM.call(t,n)&&!IM.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:PM,type:e,key:i,ref:s,props:a,_owner:DM.current}}gp.Fragment=MM;gp.jsx=N4;gp.jsxs=N4;m4.exports=gp;var l=m4.exports,Ed={},j4={exports:{}},$n={},E4={exports:{}},T4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,F){var Q=K.length;K.push(F);e:for(;0<Q;){var ie=Q-1>>>1,A=K[ie];if(0<a(A,F))K[ie]=F,K[Q]=A,Q=ie;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var F=K[0],Q=K.pop();if(Q!==F){K[0]=Q;e:for(var ie=0,A=K.length,R=A>>>1;ie<R;){var D=2*(ie+1)-1,H=K[D],J=D+1,ue=K[J];if(0>a(H,Q))J<A&&0>a(ue,H)?(K[ie]=ue,K[J]=Q,ie=J):(K[ie]=H,K[D]=Q,ie=D);else if(J<A&&0>a(ue,Q))K[ie]=ue,K[J]=Q,ie=J;else break e}}return F}function a(K,F){var Q=K.sortIndex-F.sortIndex;return Q!==0?Q:K.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var c=[],u=[],f=1,d=null,h=3,p=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(K){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=K)n(u),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(u)}}function S(K){if(x=!1,m(K),!v)if(r(c)!==null)v=!0,U(w);else{var F=r(u);F!==null&&q(S,F.startTime-K)}}function w(K,F){v=!1,x&&(x=!1,g(N),N=-1),p=!0;var Q=h;try{for(m(F),d=r(c);d!==null&&(!(d.expirationTime>F)||K&&!O());){var ie=d.callback;if(typeof ie=="function"){d.callback=null,h=d.priorityLevel;var A=ie(d.expirationTime<=F);F=e.unstable_now(),typeof A=="function"?d.callback=A:d===r(c)&&n(c),m(F)}else n(c);d=r(c)}if(d!==null)var R=!0;else{var D=r(u);D!==null&&q(S,D.startTime-F),R=!1}return R}finally{d=null,h=Q,p=!1}}var _=!1,k=null,N=-1,j=5,E=-1;function O(){return!(e.unstable_now()-E<j)}function T(){if(k!==null){var K=e.unstable_now();E=K;var F=!0;try{F=k(!0,K)}finally{F?L():(_=!1,k=null)}}else _=!1}var L;if(typeof b=="function")L=function(){b(T)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,M=X.port2;X.port1.onmessage=T,L=function(){M.postMessage(null)}}else L=function(){y(T,0)};function U(K){k=K,_||(_=!0,L())}function q(K,F){N=y(function(){K(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,U(w))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var Q=h;h=F;try{return K()}finally{h=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,F){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Q=h;h=K;try{return F()}finally{h=Q}},e.unstable_scheduleCallback=function(K,F,Q){var ie=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ie+Q:ie):Q=ie,K){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=Q+A,K={id:f++,callback:F,priorityLevel:K,startTime:Q,expirationTime:A,sortIndex:-1},Q>ie?(K.sortIndex=Q,t(u,K),r(c)===null&&K===r(u)&&(x?(g(N),N=-1):x=!0,q(S,Q-ie))):(K.sortIndex=A,t(c,K),v||p||(v=!0,U(w))),K},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(K){var F=h;return function(){var Q=h;h=F;try{return K.apply(this,arguments)}finally{h=Q}}}})(T4);E4.exports=T4;var RM=E4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $M=G,Dn=RM;function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var A4=new Set,Iu={};function bo(e,t){kl(e,t),kl(e+"Capture",t)}function kl(e,t){for(Iu[e]=t,e=0;e<t.length;e++)A4.add(t[e])}var gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vv=Object.prototype.hasOwnProperty,LM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vw={},Gw={};function BM(e){return vv.call(Gw,e)?!0:vv.call(Vw,e)?!1:LM.test(e)?Gw[e]=!0:(Vw[e]=!0,!1)}function UM(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function zM(e,t,r,n){if(t===null||typeof t>"u"||UM(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function sn(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var Ar={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ar[e]=new sn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ar[t]=new sn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ar[e]=new sn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ar[e]=new sn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ar[e]=new sn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ar[e]=new sn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ar[e]=new sn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ar[e]=new sn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ar[e]=new sn(e,5,!1,e.toLowerCase(),null,!1,!1)});var ey=/[\-:]([a-z])/g;function ty(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ey,ty);Ar[t]=new sn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ey,ty);Ar[t]=new sn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ey,ty);Ar[t]=new sn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ar[e]=new sn(e,1,!1,e.toLowerCase(),null,!1,!1)});Ar.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ar[e]=new sn(e,1,!1,e.toLowerCase(),null,!0,!0)});function ry(e,t,r,n){var a=Ar.hasOwnProperty(t)?Ar[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(zM(t,r,a,n)&&(r=null),n||a===null?BM(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ji=$M.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N0=Symbol.for("react.element"),Xo=Symbol.for("react.portal"),Ko=Symbol.for("react.fragment"),ny=Symbol.for("react.strict_mode"),gv=Symbol.for("react.profiler"),O4=Symbol.for("react.provider"),C4=Symbol.for("react.context"),ay=Symbol.for("react.forward_ref"),yv=Symbol.for("react.suspense"),bv=Symbol.for("react.suspense_list"),iy=Symbol.for("react.memo"),Ri=Symbol.for("react.lazy"),P4=Symbol.for("react.offscreen"),Xw=Symbol.iterator;function Dc(e){return e===null||typeof e!="object"?null:(e=Xw&&e[Xw]||e["@@iterator"],typeof e=="function"?e:null)}var Ft=Object.assign,Jm;function au(e){if(Jm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Jm=t&&t[1]||""}return`
`+Jm+e}var ex=!1;function tx(e,t){if(!e||ex)return"";ex=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=o);break}}}finally{ex=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?au(e):""}function WM(e){switch(e.tag){case 5:return au(e.type);case 16:return au("Lazy");case 13:return au("Suspense");case 19:return au("SuspenseList");case 0:case 2:case 15:return e=tx(e.type,!1),e;case 11:return e=tx(e.type.render,!1),e;case 1:return e=tx(e.type,!0),e;default:return""}}function wv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ko:return"Fragment";case Xo:return"Portal";case gv:return"Profiler";case ny:return"StrictMode";case yv:return"Suspense";case bv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case C4:return(e.displayName||"Context")+".Consumer";case O4:return(e._context.displayName||"Context")+".Provider";case ay:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case iy:return t=e.displayName||null,t!==null?t:wv(e.type)||"Memo";case Ri:t=e._payload,e=e._init;try{return wv(e(t))}catch{}}return null}function HM(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wv(t);case 8:return t===ny?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ns(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function M4(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function VM(e){var t=M4(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function j0(e){e._valueTracker||(e._valueTracker=VM(e))}function F4(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=M4(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Td(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _v(e,t){var r=t.checked;return Ft({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Kw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ns(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function D4(e,t){t=t.checked,t!=null&&ry(e,"checked",t,!1)}function Sv(e,t){D4(e,t);var r=ns(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?kv(e,t.type,r):t.hasOwnProperty("defaultValue")&&kv(e,t.type,ns(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function kv(e,t,r){(t!=="number"||Td(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var iu=Array.isArray;function fl(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ns(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Nv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return Ft({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(me(92));if(iu(r)){if(1<r.length)throw Error(me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ns(r)}}function I4(e,t){var r=ns(t.value),n=ns(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Qw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function R4(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?R4(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var E0,$4=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(E0=E0||document.createElement("div"),E0.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=E0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ru(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var du={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GM=["Webkit","ms","Moz","O"];Object.keys(du).forEach(function(e){GM.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),du[t]=du[e]})});function L4(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||du.hasOwnProperty(e)&&du[e]?(""+t).trim():t+"px"}function B4(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=L4(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var XM=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ev(e,t){if(t){if(XM[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function Tv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Av=null;function sy(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ov=null,dl=null,hl=null;function Zw(e){if(e=Zf(e)){if(typeof Ov!="function")throw Error(me(280));var t=e.stateNode;t&&(t=Sp(t),Ov(e.stateNode,e.type,t))}}function U4(e){dl?hl?hl.push(e):hl=[e]:dl=e}function z4(){if(dl){var e=dl,t=hl;if(hl=dl=null,Zw(e),t)for(e=0;e<t.length;e++)Zw(t[e])}}function W4(e,t){return e(t)}function H4(){}var rx=!1;function V4(e,t,r){if(rx)return e(t,r);rx=!0;try{return W4(e,t,r)}finally{rx=!1,(dl!==null||hl!==null)&&(H4(),z4())}}function $u(e,t){var r=e.stateNode;if(r===null)return null;var n=Sp(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(me(231,t,typeof r));return r}var Cv=!1;if(gi)try{var Ic={};Object.defineProperty(Ic,"passive",{get:function(){Cv=!0}}),window.addEventListener("test",Ic,Ic),window.removeEventListener("test",Ic,Ic)}catch{Cv=!1}function KM(e,t,r,n,a,i,s,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var hu=!1,Ad=null,Od=!1,Pv=null,qM={onError:function(e){hu=!0,Ad=e}};function YM(e,t,r,n,a,i,s,o,c){hu=!1,Ad=null,KM.apply(qM,arguments)}function QM(e,t,r,n,a,i,s,o,c){if(YM.apply(this,arguments),hu){if(hu){var u=Ad;hu=!1,Ad=null}else throw Error(me(198));Od||(Od=!0,Pv=u)}}function wo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function G4(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jw(e){if(wo(e)!==e)throw Error(me(188))}function ZM(e){var t=e.alternate;if(!t){if(t=wo(e),t===null)throw Error(me(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Jw(a),e;if(i===n)return Jw(a),t;i=i.sibling}throw Error(me(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?e:t}function X4(e){return e=ZM(e),e!==null?K4(e):null}function K4(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=K4(e);if(t!==null)return t;e=e.sibling}return null}var q4=Dn.unstable_scheduleCallback,e2=Dn.unstable_cancelCallback,JM=Dn.unstable_shouldYield,eF=Dn.unstable_requestPaint,Ht=Dn.unstable_now,tF=Dn.unstable_getCurrentPriorityLevel,oy=Dn.unstable_ImmediatePriority,Y4=Dn.unstable_UserBlockingPriority,Cd=Dn.unstable_NormalPriority,rF=Dn.unstable_LowPriority,Q4=Dn.unstable_IdlePriority,yp=null,za=null;function nF(e){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(yp,e,void 0,(e.current.flags&128)===128)}catch{}}var ja=Math.clz32?Math.clz32:sF,aF=Math.log,iF=Math.LN2;function sF(e){return e>>>=0,e===0?32:31-(aF(e)/iF|0)|0}var T0=64,A0=4194304;function su(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=su(o):(i&=s,i!==0&&(n=su(i)))}else s=r&~a,s!==0?n=su(s):i!==0&&(n=su(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ja(t),a=1<<r,n|=e[r],t&=~a;return n}function oF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lF(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-ja(i),o=1<<s,c=a[s];c===-1?(!(o&r)||o&n)&&(a[s]=oF(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Mv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Z4(){var e=T0;return T0<<=1,!(T0&4194240)&&(T0=64),e}function nx(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Yf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ja(t),e[t]=r}function cF(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ja(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function ly(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ja(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var it=0;function J4(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var eE,cy,tE,rE,nE,Fv=!1,O0=[],Ki=null,qi=null,Yi=null,Lu=new Map,Bu=new Map,Bi=[],uF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t2(e,t){switch(e){case"focusin":case"focusout":Ki=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Yi=null;break;case"pointerover":case"pointerout":Lu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bu.delete(t.pointerId)}}function Rc(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Zf(t),t!==null&&cy(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function fF(e,t,r,n,a){switch(t){case"focusin":return Ki=Rc(Ki,e,t,r,n,a),!0;case"dragenter":return qi=Rc(qi,e,t,r,n,a),!0;case"mouseover":return Yi=Rc(Yi,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Lu.set(i,Rc(Lu.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Bu.set(i,Rc(Bu.get(i)||null,e,t,r,n,a)),!0}return!1}function aE(e){var t=Ls(e.target);if(t!==null){var r=wo(t);if(r!==null){if(t=r.tag,t===13){if(t=G4(r),t!==null){e.blockedOn=t,nE(e.priority,function(){tE(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Dv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Av=n,r.target.dispatchEvent(n),Av=null}else return t=Zf(r),t!==null&&cy(t),e.blockedOn=r,!1;t.shift()}return!0}function r2(e,t,r){xd(e)&&r.delete(t)}function dF(){Fv=!1,Ki!==null&&xd(Ki)&&(Ki=null),qi!==null&&xd(qi)&&(qi=null),Yi!==null&&xd(Yi)&&(Yi=null),Lu.forEach(r2),Bu.forEach(r2)}function $c(e,t){e.blockedOn===t&&(e.blockedOn=null,Fv||(Fv=!0,Dn.unstable_scheduleCallback(Dn.unstable_NormalPriority,dF)))}function Uu(e){function t(a){return $c(a,e)}if(0<O0.length){$c(O0[0],e);for(var r=1;r<O0.length;r++){var n=O0[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ki!==null&&$c(Ki,e),qi!==null&&$c(qi,e),Yi!==null&&$c(Yi,e),Lu.forEach(t),Bu.forEach(t),r=0;r<Bi.length;r++)n=Bi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Bi.length&&(r=Bi[0],r.blockedOn===null);)aE(r),r.blockedOn===null&&Bi.shift()}var pl=ji.ReactCurrentBatchConfig,Md=!0;function hF(e,t,r,n){var a=it,i=pl.transition;pl.transition=null;try{it=1,uy(e,t,r,n)}finally{it=a,pl.transition=i}}function pF(e,t,r,n){var a=it,i=pl.transition;pl.transition=null;try{it=4,uy(e,t,r,n)}finally{it=a,pl.transition=i}}function uy(e,t,r,n){if(Md){var a=Dv(e,t,r,n);if(a===null)hx(e,t,n,Fd,r),t2(e,n);else if(fF(a,e,t,r,n))n.stopPropagation();else if(t2(e,n),t&4&&-1<uF.indexOf(e)){for(;a!==null;){var i=Zf(a);if(i!==null&&eE(i),i=Dv(e,t,r,n),i===null&&hx(e,t,n,Fd,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else hx(e,t,n,null,r)}}var Fd=null;function Dv(e,t,r,n){if(Fd=null,e=sy(n),e=Ls(e),e!==null)if(t=wo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=G4(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Fd=e,null}function iE(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tF()){case oy:return 1;case Y4:return 4;case Cd:case rF:return 16;case Q4:return 536870912;default:return 16}default:return 16}}var Wi=null,fy=null,vd=null;function sE(){if(vd)return vd;var e,t=fy,r=t.length,n,a="value"in Wi?Wi.value:Wi.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return vd=a.slice(e,1<n?1-n:void 0)}function gd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function C0(){return!0}function n2(){return!1}function Ln(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?C0:n2,this.isPropagationStopped=n2,this}return Ft(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=C0)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=C0)},persist:function(){},isPersistent:C0}),t}var sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dy=Ln(sc),Qf=Ft({},sc,{view:0,detail:0}),mF=Ln(Qf),ax,ix,Lc,bp=Ft({},Qf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hy,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Lc&&(Lc&&e.type==="mousemove"?(ax=e.screenX-Lc.screenX,ix=e.screenY-Lc.screenY):ix=ax=0,Lc=e),ax)},movementY:function(e){return"movementY"in e?e.movementY:ix}}),a2=Ln(bp),xF=Ft({},bp,{dataTransfer:0}),vF=Ln(xF),gF=Ft({},Qf,{relatedTarget:0}),sx=Ln(gF),yF=Ft({},sc,{animationName:0,elapsedTime:0,pseudoElement:0}),bF=Ln(yF),wF=Ft({},sc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_F=Ln(wF),SF=Ft({},sc,{data:0}),i2=Ln(SF),kF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jF[e])?!!t[e]:!1}function hy(){return EF}var TF=Ft({},Qf,{key:function(e){if(e.key){var t=kF[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=gd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?NF[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hy,charCode:function(e){return e.type==="keypress"?gd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?gd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AF=Ln(TF),OF=Ft({},bp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s2=Ln(OF),CF=Ft({},Qf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hy}),PF=Ln(CF),MF=Ft({},sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),FF=Ln(MF),DF=Ft({},bp,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),IF=Ln(DF),RF=[9,13,27,32],py=gi&&"CompositionEvent"in window,pu=null;gi&&"documentMode"in document&&(pu=document.documentMode);var $F=gi&&"TextEvent"in window&&!pu,oE=gi&&(!py||pu&&8<pu&&11>=pu),o2=" ",l2=!1;function lE(e,t){switch(e){case"keyup":return RF.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var qo=!1;function LF(e,t){switch(e){case"compositionend":return cE(t);case"keypress":return t.which!==32?null:(l2=!0,o2);case"textInput":return e=t.data,e===o2&&l2?null:e;default:return null}}function BF(e,t){if(qo)return e==="compositionend"||!py&&lE(e,t)?(e=sE(),vd=fy=Wi=null,qo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return oE&&t.locale!=="ko"?null:t.data;default:return null}}var UF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!UF[e.type]:t==="textarea"}function uE(e,t,r,n){U4(n),t=Dd(t,"onChange"),0<t.length&&(r=new dy("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var mu=null,zu=null;function zF(e){wE(e,0)}function wp(e){var t=Zo(e);if(F4(t))return e}function WF(e,t){if(e==="change")return t}var fE=!1;if(gi){var ox;if(gi){var lx="oninput"in document;if(!lx){var u2=document.createElement("div");u2.setAttribute("oninput","return;"),lx=typeof u2.oninput=="function"}ox=lx}else ox=!1;fE=ox&&(!document.documentMode||9<document.documentMode)}function f2(){mu&&(mu.detachEvent("onpropertychange",dE),zu=mu=null)}function dE(e){if(e.propertyName==="value"&&wp(zu)){var t=[];uE(t,zu,e,sy(e)),V4(zF,t)}}function HF(e,t,r){e==="focusin"?(f2(),mu=t,zu=r,mu.attachEvent("onpropertychange",dE)):e==="focusout"&&f2()}function VF(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wp(zu)}function GF(e,t){if(e==="click")return wp(t)}function XF(e,t){if(e==="input"||e==="change")return wp(t)}function KF(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pa=typeof Object.is=="function"?Object.is:KF;function Wu(e,t){if(Pa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!vv.call(t,a)||!Pa(e[a],t[a]))return!1}return!0}function d2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function h2(e,t){var r=d2(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=d2(r)}}function hE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function pE(){for(var e=window,t=Td();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Td(e.document)}return t}function my(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qF(e){var t=pE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hE(r.ownerDocument.documentElement,r)){if(n!==null&&my(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=h2(r,i);var s=h2(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var YF=gi&&"documentMode"in document&&11>=document.documentMode,Yo=null,Iv=null,xu=null,Rv=!1;function p2(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Rv||Yo==null||Yo!==Td(n)||(n=Yo,"selectionStart"in n&&my(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),xu&&Wu(xu,n)||(xu=n,n=Dd(Iv,"onSelect"),0<n.length&&(t=new dy("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Yo)))}function P0(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Qo={animationend:P0("Animation","AnimationEnd"),animationiteration:P0("Animation","AnimationIteration"),animationstart:P0("Animation","AnimationStart"),transitionend:P0("Transition","TransitionEnd")},cx={},mE={};gi&&(mE=document.createElement("div").style,"AnimationEvent"in window||(delete Qo.animationend.animation,delete Qo.animationiteration.animation,delete Qo.animationstart.animation),"TransitionEvent"in window||delete Qo.transitionend.transition);function _p(e){if(cx[e])return cx[e];if(!Qo[e])return e;var t=Qo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in mE)return cx[e]=t[r];return e}var xE=_p("animationend"),vE=_p("animationiteration"),gE=_p("animationstart"),yE=_p("transitionend"),bE=new Map,m2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(e,t){bE.set(e,t),bo(t,[e])}for(var ux=0;ux<m2.length;ux++){var fx=m2[ux],QF=fx.toLowerCase(),ZF=fx[0].toUpperCase()+fx.slice(1);cs(QF,"on"+ZF)}cs(xE,"onAnimationEnd");cs(vE,"onAnimationIteration");cs(gE,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(yE,"onTransitionEnd");kl("onMouseEnter",["mouseout","mouseover"]);kl("onMouseLeave",["mouseout","mouseover"]);kl("onPointerEnter",["pointerout","pointerover"]);kl("onPointerLeave",["pointerout","pointerover"]);bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bo("onBeforeInput",["compositionend","keypress","textInput","paste"]);bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JF=new Set("cancel close invalid load scroll toggle".split(" ").concat(ou));function x2(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,QM(n,t,void 0,e),e.currentTarget=null}function wE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;x2(a,o,u),i=c}else for(s=0;s<n.length;s++){if(o=n[s],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;x2(a,o,u),i=c}}}if(Od)throw e=Pv,Od=!1,Pv=null,e}function vt(e,t){var r=t[zv];r===void 0&&(r=t[zv]=new Set);var n=e+"__bubble";r.has(n)||(_E(t,e,2,!1),r.add(n))}function dx(e,t,r){var n=0;t&&(n|=4),_E(r,e,n,t)}var M0="_reactListening"+Math.random().toString(36).slice(2);function Hu(e){if(!e[M0]){e[M0]=!0,A4.forEach(function(r){r!=="selectionchange"&&(JF.has(r)||dx(r,!1,e),dx(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[M0]||(t[M0]=!0,dx("selectionchange",!1,t))}}function _E(e,t,r,n){switch(iE(t)){case 1:var a=hF;break;case 4:a=pF;break;default:a=uy}r=a.bind(null,t,r,e),a=void 0,!Cv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function hx(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Ls(o),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}o=o.parentNode}}n=n.return}V4(function(){var u=i,f=sy(r),d=[];e:{var h=bE.get(e);if(h!==void 0){var p=dy,v=e;switch(e){case"keypress":if(gd(r)===0)break e;case"keydown":case"keyup":p=AF;break;case"focusin":v="focus",p=sx;break;case"focusout":v="blur",p=sx;break;case"beforeblur":case"afterblur":p=sx;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=a2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=vF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=PF;break;case xE:case vE:case gE:p=bF;break;case yE:p=FF;break;case"scroll":p=mF;break;case"wheel":p=IF;break;case"copy":case"cut":case"paste":p=_F;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=s2}var x=(t&4)!==0,y=!x&&e==="scroll",g=x?h!==null?h+"Capture":null:h;x=[];for(var b=u,m;b!==null;){m=b;var S=m.stateNode;if(m.tag===5&&S!==null&&(m=S,g!==null&&(S=$u(b,g),S!=null&&x.push(Vu(b,S,m)))),y)break;b=b.return}0<x.length&&(h=new p(h,v,null,r,f),d.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Av&&(v=r.relatedTarget||r.fromElement)&&(Ls(v)||v[yi]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=u,v=v?Ls(v):null,v!==null&&(y=wo(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=u),p!==v)){if(x=a2,S="onMouseLeave",g="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(x=s2,S="onPointerLeave",g="onPointerEnter",b="pointer"),y=p==null?h:Zo(p),m=v==null?h:Zo(v),h=new x(S,b+"leave",p,r,f),h.target=y,h.relatedTarget=m,S=null,Ls(f)===u&&(x=new x(g,b+"enter",v,r,f),x.target=m,x.relatedTarget=y,S=x),y=S,p&&v)t:{for(x=p,g=v,b=0,m=x;m;m=Fo(m))b++;for(m=0,S=g;S;S=Fo(S))m++;for(;0<b-m;)x=Fo(x),b--;for(;0<m-b;)g=Fo(g),m--;for(;b--;){if(x===g||g!==null&&x===g.alternate)break t;x=Fo(x),g=Fo(g)}x=null}else x=null;p!==null&&v2(d,h,p,x,!1),v!==null&&y!==null&&v2(d,y,v,x,!0)}}e:{if(h=u?Zo(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var w=WF;else if(c2(h))if(fE)w=XF;else{w=VF;var _=HF}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=GF);if(w&&(w=w(e,u))){uE(d,w,r,f);break e}_&&_(e,h,u),e==="focusout"&&(_=h._wrapperState)&&_.controlled&&h.type==="number"&&kv(h,"number",h.value)}switch(_=u?Zo(u):window,e){case"focusin":(c2(_)||_.contentEditable==="true")&&(Yo=_,Iv=u,xu=null);break;case"focusout":xu=Iv=Yo=null;break;case"mousedown":Rv=!0;break;case"contextmenu":case"mouseup":case"dragend":Rv=!1,p2(d,r,f);break;case"selectionchange":if(YF)break;case"keydown":case"keyup":p2(d,r,f)}var k;if(py)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else qo?lE(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(oE&&r.locale!=="ko"&&(qo||N!=="onCompositionStart"?N==="onCompositionEnd"&&qo&&(k=sE()):(Wi=f,fy="value"in Wi?Wi.value:Wi.textContent,qo=!0)),_=Dd(u,N),0<_.length&&(N=new i2(N,e,null,r,f),d.push({event:N,listeners:_}),k?N.data=k:(k=cE(r),k!==null&&(N.data=k)))),(k=$F?LF(e,r):BF(e,r))&&(u=Dd(u,"onBeforeInput"),0<u.length&&(f=new i2("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=k))}wE(d,t)})}function Vu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dd(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=$u(e,r),i!=null&&n.unshift(Vu(e,i,a)),i=$u(e,t),i!=null&&n.push(Vu(e,i,a))),e=e.return}return n}function Fo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function v2(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=$u(r,i),c!=null&&s.unshift(Vu(r,c,o))):a||(c=$u(r,i),c!=null&&s.push(Vu(r,c,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var e6=/\r\n?/g,t6=/\u0000|\uFFFD/g;function g2(e){return(typeof e=="string"?e:""+e).replace(e6,`
`).replace(t6,"")}function F0(e,t,r){if(t=g2(t),g2(e)!==t&&r)throw Error(me(425))}function Id(){}var $v=null,Lv=null;function Bv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Uv=typeof setTimeout=="function"?setTimeout:void 0,r6=typeof clearTimeout=="function"?clearTimeout:void 0,y2=typeof Promise=="function"?Promise:void 0,n6=typeof queueMicrotask=="function"?queueMicrotask:typeof y2<"u"?function(e){return y2.resolve(null).then(e).catch(a6)}:Uv;function a6(e){setTimeout(function(){throw e})}function px(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Uu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Uu(t)}function Qi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function b2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var oc=Math.random().toString(36).slice(2),La="__reactFiber$"+oc,Gu="__reactProps$"+oc,yi="__reactContainer$"+oc,zv="__reactEvents$"+oc,i6="__reactListeners$"+oc,s6="__reactHandles$"+oc;function Ls(e){var t=e[La];if(t)return t;for(var r=e.parentNode;r;){if(t=r[yi]||r[La]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=b2(e);e!==null;){if(r=e[La])return r;e=b2(e)}return t}e=r,r=e.parentNode}return null}function Zf(e){return e=e[La]||e[yi],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function Sp(e){return e[Gu]||null}var Wv=[],Jo=-1;function us(e){return{current:e}}function wt(e){0>Jo||(e.current=Wv[Jo],Wv[Jo]=null,Jo--)}function ht(e,t){Jo++,Wv[Jo]=e.current,e.current=t}var as={},Vr=us(as),fn=us(!1),to=as;function Nl(e,t){var r=e.type.contextTypes;if(!r)return as;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function dn(e){return e=e.childContextTypes,e!=null}function Rd(){wt(fn),wt(Vr)}function w2(e,t,r){if(Vr.current!==as)throw Error(me(168));ht(Vr,t),ht(fn,r)}function SE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(me(108,HM(e)||"Unknown",a));return Ft({},r,n)}function $d(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||as,to=Vr.current,ht(Vr,e),ht(fn,fn.current),!0}function _2(e,t,r){var n=e.stateNode;if(!n)throw Error(me(169));r?(e=SE(e,t,to),n.__reactInternalMemoizedMergedChildContext=e,wt(fn),wt(Vr),ht(Vr,e)):wt(fn),ht(fn,r)}var ii=null,kp=!1,mx=!1;function kE(e){ii===null?ii=[e]:ii.push(e)}function o6(e){kp=!0,kE(e)}function fs(){if(!mx&&ii!==null){mx=!0;var e=0,t=it;try{var r=ii;for(it=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ii=null,kp=!1}catch(a){throw ii!==null&&(ii=ii.slice(e+1)),q4(oy,fs),a}finally{it=t,mx=!1}}return null}var el=[],tl=0,Ld=null,Bd=0,qn=[],Yn=0,ro=null,si=1,oi="";function Ps(e,t){el[tl++]=Bd,el[tl++]=Ld,Ld=e,Bd=t}function NE(e,t,r){qn[Yn++]=si,qn[Yn++]=oi,qn[Yn++]=ro,ro=e;var n=si;e=oi;var a=32-ja(n)-1;n&=~(1<<a),r+=1;var i=32-ja(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,si=1<<32-ja(t)+a|r<<a|n,oi=i+e}else si=1<<i|r<<a|n,oi=e}function xy(e){e.return!==null&&(Ps(e,1),NE(e,1,0))}function vy(e){for(;e===Ld;)Ld=el[--tl],el[tl]=null,Bd=el[--tl],el[tl]=null;for(;e===ro;)ro=qn[--Yn],qn[Yn]=null,oi=qn[--Yn],qn[Yn]=null,si=qn[--Yn],qn[Yn]=null}var Pn=null,Cn=null,kt=!1,_a=null;function jE(e,t){var r=Zn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function S2(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Pn=e,Cn=Qi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Pn=e,Cn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ro!==null?{id:si,overflow:oi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Zn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Pn=e,Cn=null,!0):!1;default:return!1}}function Hv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Vv(e){if(kt){var t=Cn;if(t){var r=t;if(!S2(e,t)){if(Hv(e))throw Error(me(418));t=Qi(r.nextSibling);var n=Pn;t&&S2(e,t)?jE(n,r):(e.flags=e.flags&-4097|2,kt=!1,Pn=e)}}else{if(Hv(e))throw Error(me(418));e.flags=e.flags&-4097|2,kt=!1,Pn=e}}}function k2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Pn=e}function D0(e){if(e!==Pn)return!1;if(!kt)return k2(e),kt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Bv(e.type,e.memoizedProps)),t&&(t=Cn)){if(Hv(e))throw EE(),Error(me(418));for(;t;)jE(e,t),t=Qi(t.nextSibling)}if(k2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Cn=Qi(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Cn=null}}else Cn=Pn?Qi(e.stateNode.nextSibling):null;return!0}function EE(){for(var e=Cn;e;)e=Qi(e.nextSibling)}function jl(){Cn=Pn=null,kt=!1}function gy(e){_a===null?_a=[e]:_a.push(e)}var l6=ji.ReactCurrentBatchConfig;function Bc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,e))}return e}function I0(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function N2(e){var t=e._init;return t(e._payload)}function TE(e){function t(g,b){if(e){var m=g.deletions;m===null?(g.deletions=[b],g.flags|=16):m.push(b)}}function r(g,b){if(!e)return null;for(;b!==null;)t(g,b),b=b.sibling;return null}function n(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function a(g,b){return g=ts(g,b),g.index=0,g.sibling=null,g}function i(g,b,m){return g.index=m,e?(m=g.alternate,m!==null?(m=m.index,m<b?(g.flags|=2,b):m):(g.flags|=2,b)):(g.flags|=1048576,b)}function s(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,b,m,S){return b===null||b.tag!==6?(b=_x(m,g.mode,S),b.return=g,b):(b=a(b,m),b.return=g,b)}function c(g,b,m,S){var w=m.type;return w===Ko?f(g,b,m.props.children,S,m.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ri&&N2(w)===b.type)?(S=a(b,m.props),S.ref=Bc(g,b,m),S.return=g,S):(S=Nd(m.type,m.key,m.props,null,g.mode,S),S.ref=Bc(g,b,m),S.return=g,S)}function u(g,b,m,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==m.containerInfo||b.stateNode.implementation!==m.implementation?(b=Sx(m,g.mode,S),b.return=g,b):(b=a(b,m.children||[]),b.return=g,b)}function f(g,b,m,S,w){return b===null||b.tag!==7?(b=Ks(m,g.mode,S,w),b.return=g,b):(b=a(b,m),b.return=g,b)}function d(g,b,m){if(typeof b=="string"&&b!==""||typeof b=="number")return b=_x(""+b,g.mode,m),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case N0:return m=Nd(b.type,b.key,b.props,null,g.mode,m),m.ref=Bc(g,null,b),m.return=g,m;case Xo:return b=Sx(b,g.mode,m),b.return=g,b;case Ri:var S=b._init;return d(g,S(b._payload),m)}if(iu(b)||Dc(b))return b=Ks(b,g.mode,m,null),b.return=g,b;I0(g,b)}return null}function h(g,b,m,S){var w=b!==null?b.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return w!==null?null:o(g,b,""+m,S);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case N0:return m.key===w?c(g,b,m,S):null;case Xo:return m.key===w?u(g,b,m,S):null;case Ri:return w=m._init,h(g,b,w(m._payload),S)}if(iu(m)||Dc(m))return w!==null?null:f(g,b,m,S,null);I0(g,m)}return null}function p(g,b,m,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return g=g.get(m)||null,o(b,g,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case N0:return g=g.get(S.key===null?m:S.key)||null,c(b,g,S,w);case Xo:return g=g.get(S.key===null?m:S.key)||null,u(b,g,S,w);case Ri:var _=S._init;return p(g,b,m,_(S._payload),w)}if(iu(S)||Dc(S))return g=g.get(m)||null,f(b,g,S,w,null);I0(b,S)}return null}function v(g,b,m,S){for(var w=null,_=null,k=b,N=b=0,j=null;k!==null&&N<m.length;N++){k.index>N?(j=k,k=null):j=k.sibling;var E=h(g,k,m[N],S);if(E===null){k===null&&(k=j);break}e&&k&&E.alternate===null&&t(g,k),b=i(E,b,N),_===null?w=E:_.sibling=E,_=E,k=j}if(N===m.length)return r(g,k),kt&&Ps(g,N),w;if(k===null){for(;N<m.length;N++)k=d(g,m[N],S),k!==null&&(b=i(k,b,N),_===null?w=k:_.sibling=k,_=k);return kt&&Ps(g,N),w}for(k=n(g,k);N<m.length;N++)j=p(k,g,N,m[N],S),j!==null&&(e&&j.alternate!==null&&k.delete(j.key===null?N:j.key),b=i(j,b,N),_===null?w=j:_.sibling=j,_=j);return e&&k.forEach(function(O){return t(g,O)}),kt&&Ps(g,N),w}function x(g,b,m,S){var w=Dc(m);if(typeof w!="function")throw Error(me(150));if(m=w.call(m),m==null)throw Error(me(151));for(var _=w=null,k=b,N=b=0,j=null,E=m.next();k!==null&&!E.done;N++,E=m.next()){k.index>N?(j=k,k=null):j=k.sibling;var O=h(g,k,E.value,S);if(O===null){k===null&&(k=j);break}e&&k&&O.alternate===null&&t(g,k),b=i(O,b,N),_===null?w=O:_.sibling=O,_=O,k=j}if(E.done)return r(g,k),kt&&Ps(g,N),w;if(k===null){for(;!E.done;N++,E=m.next())E=d(g,E.value,S),E!==null&&(b=i(E,b,N),_===null?w=E:_.sibling=E,_=E);return kt&&Ps(g,N),w}for(k=n(g,k);!E.done;N++,E=m.next())E=p(k,g,N,E.value,S),E!==null&&(e&&E.alternate!==null&&k.delete(E.key===null?N:E.key),b=i(E,b,N),_===null?w=E:_.sibling=E,_=E);return e&&k.forEach(function(T){return t(g,T)}),kt&&Ps(g,N),w}function y(g,b,m,S){if(typeof m=="object"&&m!==null&&m.type===Ko&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case N0:e:{for(var w=m.key,_=b;_!==null;){if(_.key===w){if(w=m.type,w===Ko){if(_.tag===7){r(g,_.sibling),b=a(_,m.props.children),b.return=g,g=b;break e}}else if(_.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Ri&&N2(w)===_.type){r(g,_.sibling),b=a(_,m.props),b.ref=Bc(g,_,m),b.return=g,g=b;break e}r(g,_);break}else t(g,_);_=_.sibling}m.type===Ko?(b=Ks(m.props.children,g.mode,S,m.key),b.return=g,g=b):(S=Nd(m.type,m.key,m.props,null,g.mode,S),S.ref=Bc(g,b,m),S.return=g,g=S)}return s(g);case Xo:e:{for(_=m.key;b!==null;){if(b.key===_)if(b.tag===4&&b.stateNode.containerInfo===m.containerInfo&&b.stateNode.implementation===m.implementation){r(g,b.sibling),b=a(b,m.children||[]),b.return=g,g=b;break e}else{r(g,b);break}else t(g,b);b=b.sibling}b=Sx(m,g.mode,S),b.return=g,g=b}return s(g);case Ri:return _=m._init,y(g,b,_(m._payload),S)}if(iu(m))return v(g,b,m,S);if(Dc(m))return x(g,b,m,S);I0(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,b!==null&&b.tag===6?(r(g,b.sibling),b=a(b,m),b.return=g,g=b):(r(g,b),b=_x(m,g.mode,S),b.return=g,g=b),s(g)):r(g,b)}return y}var El=TE(!0),AE=TE(!1),Ud=us(null),zd=null,rl=null,yy=null;function by(){yy=rl=zd=null}function wy(e){var t=Ud.current;wt(Ud),e._currentValue=t}function Gv(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ml(e,t){zd=e,yy=rl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cn=!0),e.firstContext=null)}function na(e){var t=e._currentValue;if(yy!==e)if(e={context:e,memoizedValue:t,next:null},rl===null){if(zd===null)throw Error(me(308));rl=e,zd.dependencies={lanes:0,firstContext:e}}else rl=rl.next=e;return t}var Bs=null;function _y(e){Bs===null?Bs=[e]:Bs.push(e)}function OE(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,_y(t)):(r.next=a.next,a.next=r),t.interleaved=r,bi(e,n)}function bi(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var $i=!1;function Sy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,qe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,bi(e,r)}return a=n.interleaved,a===null?(t.next=t,_y(n)):(t.next=a.next,a.next=t),n.interleaved=t,bi(e,r)}function yd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ly(e,r)}}function j2(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Wd(e,t,r,n){var a=e.updateQueue;$i=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,s===null?i=u:s.next=u,s=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==s&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(i!==null){var d=a.baseState;s=0,f=u=c=null,o=i;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,x=o;switch(h=t,p=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){d=v.call(p,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(p,d,h):v,h==null)break e;d=Ft({},d,h);break e;case 2:$i=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=p,c=d):f=f.next=p,s|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);ao|=s,e.lanes=s,e.memoizedState=d}}function E2(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(me(191,a));a.call(n)}}}var Jf={},Wa=us(Jf),Xu=us(Jf),Ku=us(Jf);function Us(e){if(e===Jf)throw Error(me(174));return e}function ky(e,t){switch(ht(Ku,t),ht(Xu,e),ht(Wa,Jf),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:jv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=jv(t,e)}wt(Wa),ht(Wa,t)}function Tl(){wt(Wa),wt(Xu),wt(Ku)}function PE(e){Us(Ku.current);var t=Us(Wa.current),r=jv(t,e.type);t!==r&&(ht(Xu,e),ht(Wa,r))}function Ny(e){Xu.current===e&&(wt(Wa),wt(Xu))}var Ot=us(0);function Hd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var xx=[];function jy(){for(var e=0;e<xx.length;e++)xx[e]._workInProgressVersionPrimary=null;xx.length=0}var bd=ji.ReactCurrentDispatcher,vx=ji.ReactCurrentBatchConfig,no=0,Mt=null,ir=null,mr=null,Vd=!1,vu=!1,qu=0,c6=0;function Mr(){throw Error(me(321))}function Ey(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Pa(e[r],t[r]))return!1;return!0}function Ty(e,t,r,n,a,i){if(no=i,Mt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bd.current=e===null||e.memoizedState===null?h6:p6,e=r(n,a),vu){i=0;do{if(vu=!1,qu=0,25<=i)throw Error(me(301));i+=1,mr=ir=null,t.updateQueue=null,bd.current=m6,e=r(n,a)}while(vu)}if(bd.current=Gd,t=ir!==null&&ir.next!==null,no=0,mr=ir=Mt=null,Vd=!1,t)throw Error(me(300));return e}function Ay(){var e=qu!==0;return qu=0,e}function $a(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?Mt.memoizedState=mr=e:mr=mr.next=e,mr}function aa(){if(ir===null){var e=Mt.alternate;e=e!==null?e.memoizedState:null}else e=ir.next;var t=mr===null?Mt.memoizedState:mr.next;if(t!==null)mr=t,ir=e;else{if(e===null)throw Error(me(310));ir=e,e={memoizedState:ir.memoizedState,baseState:ir.baseState,baseQueue:ir.baseQueue,queue:ir.queue,next:null},mr===null?Mt.memoizedState=mr=e:mr=mr.next=e}return mr}function Yu(e,t){return typeof t=="function"?t(e):t}function gx(e){var t=aa(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=ir,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,c=null,u=i;do{var f=u.lane;if((no&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,s=n):c=c.next=d,Mt.lanes|=f,ao|=f}u=u.next}while(u!==null&&u!==i);c===null?s=n:c.next=o,Pa(n,t.memoizedState)||(cn=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Mt.lanes|=i,ao|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function yx(e){var t=aa(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Pa(i,t.memoizedState)||(cn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function ME(){}function FE(e,t){var r=Mt,n=aa(),a=t(),i=!Pa(n.memoizedState,a);if(i&&(n.memoizedState=a,cn=!0),n=n.queue,Oy(RE.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mr!==null&&mr.memoizedState.tag&1){if(r.flags|=2048,Qu(9,IE.bind(null,r,n,a,t),void 0,null),br===null)throw Error(me(349));no&30||DE(r,t,a)}return a}function DE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function IE(e,t,r,n){t.value=r,t.getSnapshot=n,$E(t)&&LE(e)}function RE(e,t,r){return r(function(){$E(t)&&LE(e)})}function $E(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Pa(e,r)}catch{return!0}}function LE(e){var t=bi(e,1);t!==null&&Ea(t,e,1,-1)}function T2(e){var t=$a();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yu,lastRenderedState:e},t.queue=e,e=e.dispatch=d6.bind(null,Mt,e),[t.memoizedState,e]}function Qu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Mt.updateQueue,t===null?(t={lastEffect:null,stores:null},Mt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function BE(){return aa().memoizedState}function wd(e,t,r,n){var a=$a();Mt.flags|=e,a.memoizedState=Qu(1|t,r,void 0,n===void 0?null:n)}function Np(e,t,r,n){var a=aa();n=n===void 0?null:n;var i=void 0;if(ir!==null){var s=ir.memoizedState;if(i=s.destroy,n!==null&&Ey(n,s.deps)){a.memoizedState=Qu(t,r,i,n);return}}Mt.flags|=e,a.memoizedState=Qu(1|t,r,i,n)}function A2(e,t){return wd(8390656,8,e,t)}function Oy(e,t){return Np(2048,8,e,t)}function UE(e,t){return Np(4,2,e,t)}function zE(e,t){return Np(4,4,e,t)}function WE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function HE(e,t,r){return r=r!=null?r.concat([e]):null,Np(4,4,WE.bind(null,t,e),r)}function Cy(){}function VE(e,t){var r=aa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ey(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function GE(e,t){var r=aa();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ey(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function XE(e,t,r){return no&21?(Pa(r,t)||(r=Z4(),Mt.lanes|=r,ao|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,cn=!0),e.memoizedState=r)}function u6(e,t){var r=it;it=r!==0&&4>r?r:4,e(!0);var n=vx.transition;vx.transition={};try{e(!1),t()}finally{it=r,vx.transition=n}}function KE(){return aa().memoizedState}function f6(e,t,r){var n=es(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qE(e))YE(t,r);else if(r=OE(e,t,r,n),r!==null){var a=rn();Ea(r,e,n,a),QE(r,t,n)}}function d6(e,t,r){var n=es(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qE(e))YE(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Pa(o,s)){var c=t.interleaved;c===null?(a.next=a,_y(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=OE(e,t,a,n),r!==null&&(a=rn(),Ea(r,e,n,a),QE(r,t,n))}}function qE(e){var t=e.alternate;return e===Mt||t!==null&&t===Mt}function YE(e,t){vu=Vd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function QE(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ly(e,r)}}var Gd={readContext:na,useCallback:Mr,useContext:Mr,useEffect:Mr,useImperativeHandle:Mr,useInsertionEffect:Mr,useLayoutEffect:Mr,useMemo:Mr,useReducer:Mr,useRef:Mr,useState:Mr,useDebugValue:Mr,useDeferredValue:Mr,useTransition:Mr,useMutableSource:Mr,useSyncExternalStore:Mr,useId:Mr,unstable_isNewReconciler:!1},h6={readContext:na,useCallback:function(e,t){return $a().memoizedState=[e,t===void 0?null:t],e},useContext:na,useEffect:A2,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wd(4194308,4,WE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wd(4194308,4,e,t)},useInsertionEffect:function(e,t){return wd(4,2,e,t)},useMemo:function(e,t){var r=$a();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=$a();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=f6.bind(null,Mt,e),[n.memoizedState,e]},useRef:function(e){var t=$a();return e={current:e},t.memoizedState=e},useState:T2,useDebugValue:Cy,useDeferredValue:function(e){return $a().memoizedState=e},useTransition:function(){var e=T2(!1),t=e[0];return e=u6.bind(null,e[1]),$a().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Mt,a=$a();if(kt){if(r===void 0)throw Error(me(407));r=r()}else{if(r=t(),br===null)throw Error(me(349));no&30||DE(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,A2(RE.bind(null,n,i,e),[e]),n.flags|=2048,Qu(9,IE.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=$a(),t=br.identifierPrefix;if(kt){var r=oi,n=si;r=(n&~(1<<32-ja(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=qu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=c6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},p6={readContext:na,useCallback:VE,useContext:na,useEffect:Oy,useImperativeHandle:HE,useInsertionEffect:UE,useLayoutEffect:zE,useMemo:GE,useReducer:gx,useRef:BE,useState:function(){return gx(Yu)},useDebugValue:Cy,useDeferredValue:function(e){var t=aa();return XE(t,ir.memoizedState,e)},useTransition:function(){var e=gx(Yu)[0],t=aa().memoizedState;return[e,t]},useMutableSource:ME,useSyncExternalStore:FE,useId:KE,unstable_isNewReconciler:!1},m6={readContext:na,useCallback:VE,useContext:na,useEffect:Oy,useImperativeHandle:HE,useInsertionEffect:UE,useLayoutEffect:zE,useMemo:GE,useReducer:yx,useRef:BE,useState:function(){return yx(Yu)},useDebugValue:Cy,useDeferredValue:function(e){var t=aa();return ir===null?t.memoizedState=e:XE(t,ir.memoizedState,e)},useTransition:function(){var e=yx(Yu)[0],t=aa().memoizedState;return[e,t]},useMutableSource:ME,useSyncExternalStore:FE,useId:KE,unstable_isNewReconciler:!1};function ga(e,t){if(e&&e.defaultProps){t=Ft({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Xv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ft({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jp={isMounted:function(e){return(e=e._reactInternals)?wo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=rn(),a=es(e),i=di(n,a);i.payload=t,r!=null&&(i.callback=r),t=Zi(e,i,a),t!==null&&(Ea(t,e,a,n),yd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=rn(),a=es(e),i=di(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Zi(e,i,a),t!==null&&(Ea(t,e,a,n),yd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=rn(),n=es(e),a=di(r,n);a.tag=2,t!=null&&(a.callback=t),t=Zi(e,a,n),t!==null&&(Ea(t,e,n,r),yd(t,e,n))}};function O2(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Wu(r,n)||!Wu(a,i):!0}function ZE(e,t,r){var n=!1,a=as,i=t.contextType;return typeof i=="object"&&i!==null?i=na(i):(a=dn(t)?to:Vr.current,n=t.contextTypes,i=(n=n!=null)?Nl(e,a):as),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function C2(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jp.enqueueReplaceState(t,t.state,null)}function Kv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Sy(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=na(i):(i=dn(t)?to:Vr.current,a.context=Nl(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Xv(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&jp.enqueueReplaceState(a,a.state,null),Wd(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Al(e,t){try{var r="",n=t;do r+=WM(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function bx(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function qv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var x6=typeof WeakMap=="function"?WeakMap:Map;function JE(e,t,r){r=di(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Kd||(Kd=!0,ig=n),qv(e,t)},r}function eT(e,t,r){r=di(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){qv(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){qv(e,t),typeof n!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function P2(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new x6;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=O6.bind(null,e,t,r),t.then(e,e))}function M2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function F2(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=di(-1,1),t.tag=2,Zi(r,t,1))),r.lanes|=1),e)}var v6=ji.ReactCurrentOwner,cn=!1;function Yr(e,t,r,n){t.child=e===null?AE(t,null,r,n):El(t,e.child,r,n)}function D2(e,t,r,n,a){r=r.render;var i=t.ref;return ml(t,a),n=Ty(e,t,r,n,i,a),r=Ay(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wi(e,t,a)):(kt&&r&&xy(t),t.flags|=1,Yr(e,t,n,a),t.child)}function I2(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Ly(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,tT(e,t,i,n,a)):(e=Nd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Wu,r(s,n)&&e.ref===t.ref)return wi(e,t,a)}return t.flags|=1,e=ts(i,n),e.ref=t.ref,e.return=t,t.child=e}function tT(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Wu(i,n)&&e.ref===t.ref)if(cn=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(cn=!0);else return t.lanes=e.lanes,wi(e,t,a)}return Yv(e,t,r,n,a)}function rT(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(al,Sn),Sn|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ht(al,Sn),Sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ht(al,Sn),Sn|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ht(al,Sn),Sn|=n;return Yr(e,t,a,r),t.child}function nT(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Yv(e,t,r,n,a){var i=dn(r)?to:Vr.current;return i=Nl(t,i),ml(t,a),r=Ty(e,t,r,n,i,a),n=Ay(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,wi(e,t,a)):(kt&&n&&xy(t),t.flags|=1,Yr(e,t,r,a),t.child)}function R2(e,t,r,n,a){if(dn(r)){var i=!0;$d(t)}else i=!1;if(ml(t,a),t.stateNode===null)_d(e,t),ZE(t,r,n),Kv(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var c=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=na(u):(u=dn(r)?to:Vr.current,u=Nl(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||c!==u)&&C2(t,s,n,u),$i=!1;var h=t.memoizedState;s.state=h,Wd(t,n,s,a),c=t.memoizedState,o!==n||h!==c||fn.current||$i?(typeof f=="function"&&(Xv(t,r,f,n),c=t.memoizedState),(o=$i||O2(t,r,o,n,h,c,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,CE(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ga(t.type,o),s.props=u,d=t.pendingProps,h=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=na(c):(c=dn(r)?to:Vr.current,c=Nl(t,c));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||h!==c)&&C2(t,s,n,c),$i=!1,h=t.memoizedState,s.state=h,Wd(t,n,s,a);var v=t.memoizedState;o!==d||h!==v||fn.current||$i?(typeof p=="function"&&(Xv(t,r,p,n),v=t.memoizedState),(u=$i||O2(t,r,u,n,h,v,c)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=c,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Qv(e,t,r,n,i,a)}function Qv(e,t,r,n,a,i){nT(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&_2(t,r,!1),wi(e,t,i);n=t.stateNode,v6.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=El(t,e.child,null,i),t.child=El(t,null,o,i)):Yr(e,t,o,i),t.memoizedState=n.state,a&&_2(t,r,!0),t.child}function aT(e){var t=e.stateNode;t.pendingContext?w2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&w2(e,t.context,!1),ky(e,t.containerInfo)}function $2(e,t,r,n,a){return jl(),gy(a),t.flags|=256,Yr(e,t,r,n),t.child}var Zv={dehydrated:null,treeContext:null,retryLane:0};function Jv(e){return{baseLanes:e,cachePool:null,transitions:null}}function iT(e,t,r){var n=t.pendingProps,a=Ot.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ht(Ot,a&1),e===null)return Vv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ap(s,n,0,null),e=Ks(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Jv(r),t.memoizedState=Zv,e):Py(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return g6(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ts(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=ts(o,i):(i=Ks(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?Jv(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Zv,n}return i=e.child,e=i.sibling,n=ts(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Py(e,t){return t=Ap({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function R0(e,t,r,n){return n!==null&&gy(n),El(t,e.child,null,r),e=Py(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function g6(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=bx(Error(me(422))),R0(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Ap({mode:"visible",children:n.children},a,0,null),i=Ks(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&El(t,e.child,null,s),t.child.memoizedState=Jv(s),t.memoizedState=Zv,i);if(!(t.mode&1))return R0(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(me(419)),n=bx(i,n,void 0),R0(e,t,s,n)}if(o=(s&e.childLanes)!==0,cn||o){if(n=br,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,bi(e,a),Ea(n,e,a,-1))}return $y(),n=bx(Error(me(421))),R0(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=C6.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Cn=Qi(a.nextSibling),Pn=t,kt=!0,_a=null,e!==null&&(qn[Yn++]=si,qn[Yn++]=oi,qn[Yn++]=ro,si=e.id,oi=e.overflow,ro=t),t=Py(t,n.children),t.flags|=4096,t)}function L2(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Gv(e.return,t,r)}function wx(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function sT(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Yr(e,t,n.children,r),n=Ot.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&L2(e,r,t);else if(e.tag===19)L2(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ht(Ot,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Hd(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),wx(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Hd(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}wx(t,!0,r,null,i);break;case"together":wx(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _d(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function wi(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ao|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,r=ts(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ts(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function y6(e,t,r){switch(t.tag){case 3:aT(t),jl();break;case 5:PE(t);break;case 1:dn(t.type)&&$d(t);break;case 4:ky(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ht(Ud,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ht(Ot,Ot.current&1),t.flags|=128,null):r&t.child.childLanes?iT(e,t,r):(ht(Ot,Ot.current&1),e=wi(e,t,r),e!==null?e.sibling:null);ht(Ot,Ot.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return sT(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ht(Ot,Ot.current),n)break;return null;case 22:case 23:return t.lanes=0,rT(e,t,r)}return wi(e,t,r)}var oT,eg,lT,cT;oT=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};eg=function(){};lT=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Us(Wa.current);var i=null;switch(r){case"input":a=_v(e,a),n=_v(e,n),i=[];break;case"select":a=Ft({},a,{value:void 0}),n=Ft({},n,{value:void 0}),i=[];break;case"textarea":a=Nv(e,a),n=Nv(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Id)}Ev(r,n);var s;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Iu.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&o[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Iu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&vt("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};cT=function(e,t,r,n){r!==n&&(t.flags|=4)};function Uc(e,t){if(!kt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Fr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function b6(e,t,r){var n=t.pendingProps;switch(vy(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(t),null;case 1:return dn(t.type)&&Rd(),Fr(t),null;case 3:return n=t.stateNode,Tl(),wt(fn),wt(Vr),jy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(D0(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,_a!==null&&(lg(_a),_a=null))),eg(e,t),Fr(t),null;case 5:Ny(t);var a=Us(Ku.current);if(r=t.type,e!==null&&t.stateNode!=null)lT(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(me(166));return Fr(t),null}if(e=Us(Wa.current),D0(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[La]=t,n[Gu]=i,e=(t.mode&1)!==0,r){case"dialog":vt("cancel",n),vt("close",n);break;case"iframe":case"object":case"embed":vt("load",n);break;case"video":case"audio":for(a=0;a<ou.length;a++)vt(ou[a],n);break;case"source":vt("error",n);break;case"img":case"image":case"link":vt("error",n),vt("load",n);break;case"details":vt("toggle",n);break;case"input":Kw(n,i),vt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},vt("invalid",n);break;case"textarea":Yw(n,i),vt("invalid",n)}Ev(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&F0(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&F0(n.textContent,o,e),a=["children",""+o]):Iu.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&vt("scroll",n)}switch(r){case"input":j0(n),qw(n,i,!0);break;case"textarea":j0(n),Qw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Id)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=R4(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[La]=t,e[Gu]=n,oT(e,t,!1,!1),t.stateNode=e;e:{switch(s=Tv(r,n),r){case"dialog":vt("cancel",e),vt("close",e),a=n;break;case"iframe":case"object":case"embed":vt("load",e),a=n;break;case"video":case"audio":for(a=0;a<ou.length;a++)vt(ou[a],e);a=n;break;case"source":vt("error",e),a=n;break;case"img":case"image":case"link":vt("error",e),vt("load",e),a=n;break;case"details":vt("toggle",e),a=n;break;case"input":Kw(e,n),a=_v(e,n),vt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ft({},n,{value:void 0}),vt("invalid",e);break;case"textarea":Yw(e,n),a=Nv(e,n),vt("invalid",e);break;default:a=n}Ev(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?B4(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$4(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Ru(e,c):typeof c=="number"&&Ru(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Iu.hasOwnProperty(i)?c!=null&&i==="onScroll"&&vt("scroll",e):c!=null&&ry(e,i,c,s))}switch(r){case"input":j0(e),qw(e,n,!1);break;case"textarea":j0(e),Qw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ns(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?fl(e,!!n.multiple,i,!1):n.defaultValue!=null&&fl(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Id)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Fr(t),null;case 6:if(e&&t.stateNode!=null)cT(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(me(166));if(r=Us(Ku.current),Us(Wa.current),D0(t)){if(n=t.stateNode,r=t.memoizedProps,n[La]=t,(i=n.nodeValue!==r)&&(e=Pn,e!==null))switch(e.tag){case 3:F0(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&F0(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[La]=t,t.stateNode=n}return Fr(t),null;case 13:if(wt(Ot),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(kt&&Cn!==null&&t.mode&1&&!(t.flags&128))EE(),jl(),t.flags|=98560,i=!1;else if(i=D0(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(me(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(me(317));i[La]=t}else jl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Fr(t),i=!1}else _a!==null&&(lg(_a),_a=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ot.current&1?lr===0&&(lr=3):$y())),t.updateQueue!==null&&(t.flags|=4),Fr(t),null);case 4:return Tl(),eg(e,t),e===null&&Hu(t.stateNode.containerInfo),Fr(t),null;case 10:return wy(t.type._context),Fr(t),null;case 17:return dn(t.type)&&Rd(),Fr(t),null;case 19:if(wt(Ot),i=t.memoizedState,i===null)return Fr(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Uc(i,!1);else{if(lr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Hd(e),s!==null){for(t.flags|=128,Uc(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ht(Ot,Ot.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ht()>Ol&&(t.flags|=128,n=!0,Uc(i,!1),t.lanes=4194304)}else{if(!n)if(e=Hd(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Uc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!kt)return Fr(t),null}else 2*Ht()-i.renderingStartTime>Ol&&r!==1073741824&&(t.flags|=128,n=!0,Uc(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ht(),t.sibling=null,r=Ot.current,ht(Ot,n?r&1|2:r&1),t):(Fr(t),null);case 22:case 23:return Ry(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sn&1073741824&&(Fr(t),t.subtreeFlags&6&&(t.flags|=8192)):Fr(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function w6(e,t){switch(vy(t),t.tag){case 1:return dn(t.type)&&Rd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tl(),wt(fn),wt(Vr),jy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Ny(t),null;case 13:if(wt(Ot),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));jl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return wt(Ot),null;case 4:return Tl(),null;case 10:return wy(t.type._context),null;case 22:case 23:return Ry(),null;case 24:return null;default:return null}}var $0=!1,Lr=!1,_6=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function nl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){It(e,t,n)}else r.current=null}function tg(e,t,r){try{r()}catch(n){It(e,t,n)}}var B2=!1;function S6(e,t){if($v=Md,e=pE(),my(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||a!==0&&d.nodeType!==3||(o=s+a),d!==i||n!==0&&d.nodeType!==3||(c=s+n),d.nodeType===3&&(s+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++u===a&&(o=s),h===i&&++f===n&&(c=s),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Lv={focusedElem:e,selectionRange:r},Md=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,g=t.stateNode,b=g.getSnapshotBeforeUpdate(t.elementType===t.type?x:ga(t.type,x),y);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(S){It(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return v=B2,B2=!1,v}function gu(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&tg(t,r,i)}a=a.next}while(a!==n)}}function Ep(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function rg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function uT(e){var t=e.alternate;t!==null&&(e.alternate=null,uT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[La],delete t[Gu],delete t[zv],delete t[i6],delete t[s6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function fT(e){return e.tag===5||e.tag===3||e.tag===4}function U2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||fT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ng(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Id));else if(n!==4&&(e=e.child,e!==null))for(ng(e,t,r),e=e.sibling;e!==null;)ng(e,t,r),e=e.sibling}function ag(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(ag(e,t,r),e=e.sibling;e!==null;)ag(e,t,r),e=e.sibling}var Nr=null,ya=!1;function Di(e,t,r){for(r=r.child;r!==null;)dT(e,t,r),r=r.sibling}function dT(e,t,r){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(yp,r)}catch{}switch(r.tag){case 5:Lr||nl(r,t);case 6:var n=Nr,a=ya;Nr=null,Di(e,t,r),Nr=n,ya=a,Nr!==null&&(ya?(e=Nr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Nr.removeChild(r.stateNode));break;case 18:Nr!==null&&(ya?(e=Nr,r=r.stateNode,e.nodeType===8?px(e.parentNode,r):e.nodeType===1&&px(e,r),Uu(e)):px(Nr,r.stateNode));break;case 4:n=Nr,a=ya,Nr=r.stateNode.containerInfo,ya=!0,Di(e,t,r),Nr=n,ya=a;break;case 0:case 11:case 14:case 15:if(!Lr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&tg(r,t,s),a=a.next}while(a!==n)}Di(e,t,r);break;case 1:if(!Lr&&(nl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){It(r,t,o)}Di(e,t,r);break;case 21:Di(e,t,r);break;case 22:r.mode&1?(Lr=(n=Lr)||r.memoizedState!==null,Di(e,t,r),Lr=n):Di(e,t,r);break;default:Di(e,t,r)}}function z2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new _6),t.forEach(function(n){var a=P6.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ma(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:Nr=o.stateNode,ya=!1;break e;case 3:Nr=o.stateNode.containerInfo,ya=!0;break e;case 4:Nr=o.stateNode.containerInfo,ya=!0;break e}o=o.return}if(Nr===null)throw Error(me(160));dT(i,s,a),Nr=null,ya=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){It(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)hT(t,e),t=t.sibling}function hT(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ma(t,e),Fa(e),n&4){try{gu(3,e,e.return),Ep(3,e)}catch(x){It(e,e.return,x)}try{gu(5,e,e.return)}catch(x){It(e,e.return,x)}}break;case 1:ma(t,e),Fa(e),n&512&&r!==null&&nl(r,r.return);break;case 5:if(ma(t,e),Fa(e),n&512&&r!==null&&nl(r,r.return),e.flags&32){var a=e.stateNode;try{Ru(a,"")}catch(x){It(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&D4(a,i),Tv(o,s);var u=Tv(o,i);for(s=0;s<c.length;s+=2){var f=c[s],d=c[s+1];f==="style"?B4(a,d):f==="dangerouslySetInnerHTML"?$4(a,d):f==="children"?Ru(a,d):ry(a,f,d,u)}switch(o){case"input":Sv(a,i);break;case"textarea":I4(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?fl(a,!!i.multiple,p,!1):h!==!!i.multiple&&(i.defaultValue!=null?fl(a,!!i.multiple,i.defaultValue,!0):fl(a,!!i.multiple,i.multiple?[]:"",!1))}a[Gu]=i}catch(x){It(e,e.return,x)}}break;case 6:if(ma(t,e),Fa(e),n&4){if(e.stateNode===null)throw Error(me(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(x){It(e,e.return,x)}}break;case 3:if(ma(t,e),Fa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Uu(t.containerInfo)}catch(x){It(e,e.return,x)}break;case 4:ma(t,e),Fa(e);break;case 13:ma(t,e),Fa(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Dy=Ht())),n&4&&z2(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Lr=(u=Lr)||f,ma(t,e),Lr=u):ma(t,e),Fa(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(d=Ne=f;Ne!==null;){switch(h=Ne,p=h.child,h.tag){case 0:case 11:case 14:case 15:gu(4,h,h.return);break;case 1:nl(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){It(n,r,x)}}break;case 5:nl(h,h.return);break;case 22:if(h.memoizedState!==null){H2(d);continue}}p!==null?(p.return=h,Ne=p):H2(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=d.stateNode,c=d.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=L4("display",s))}catch(x){It(e,e.return,x)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(x){It(e,e.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ma(t,e),Fa(e),n&4&&z2(e);break;case 21:break;default:ma(t,e),Fa(e)}}function Fa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(fT(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Ru(a,""),n.flags&=-33);var i=U2(e);ag(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=U2(e);ng(e,o,s);break;default:throw Error(me(161))}}catch(c){It(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function k6(e,t,r){Ne=e,pT(e)}function pT(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var a=Ne,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||$0;if(!s){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Lr;o=$0;var u=Lr;if($0=s,(Lr=c)&&!u)for(Ne=a;Ne!==null;)s=Ne,c=s.child,s.tag===22&&s.memoizedState!==null?V2(a):c!==null?(c.return=s,Ne=c):V2(a);for(;i!==null;)Ne=i,pT(i),i=i.sibling;Ne=a,$0=o,Lr=u}W2(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ne=i):W2(e)}}function W2(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Lr||Ep(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Lr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ga(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&E2(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}E2(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Uu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Lr||t.flags&512&&rg(t)}catch(h){It(t,t.return,h)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function H2(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function V2(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ep(4,t)}catch(c){It(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){It(t,a,c)}}var i=t.return;try{rg(t)}catch(c){It(t,i,c)}break;case 5:var s=t.return;try{rg(t)}catch(c){It(t,s,c)}}}catch(c){It(t,t.return,c)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var N6=Math.ceil,Xd=ji.ReactCurrentDispatcher,My=ji.ReactCurrentOwner,ea=ji.ReactCurrentBatchConfig,qe=0,br=null,Jt=null,Tr=0,Sn=0,al=us(0),lr=0,Zu=null,ao=0,Tp=0,Fy=0,yu=null,ln=null,Dy=0,Ol=1/0,ni=null,Kd=!1,ig=null,Ji=null,L0=!1,Hi=null,qd=0,bu=0,sg=null,Sd=-1,kd=0;function rn(){return qe&6?Ht():Sd!==-1?Sd:Sd=Ht()}function es(e){return e.mode&1?qe&2&&Tr!==0?Tr&-Tr:l6.transition!==null?(kd===0&&(kd=Z4()),kd):(e=it,e!==0||(e=window.event,e=e===void 0?16:iE(e.type)),e):1}function Ea(e,t,r,n){if(50<bu)throw bu=0,sg=null,Error(me(185));Yf(e,r,n),(!(qe&2)||e!==br)&&(e===br&&(!(qe&2)&&(Tp|=r),lr===4&&Ui(e,Tr)),hn(e,n),r===1&&qe===0&&!(t.mode&1)&&(Ol=Ht()+500,kp&&fs()))}function hn(e,t){var r=e.callbackNode;lF(e,t);var n=Pd(e,e===br?Tr:0);if(n===0)r!==null&&e2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&e2(r),t===1)e.tag===0?o6(G2.bind(null,e)):kE(G2.bind(null,e)),n6(function(){!(qe&6)&&fs()}),r=null;else{switch(J4(n)){case 1:r=oy;break;case 4:r=Y4;break;case 16:r=Cd;break;case 536870912:r=Q4;break;default:r=Cd}r=_T(r,mT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function mT(e,t){if(Sd=-1,kd=0,qe&6)throw Error(me(327));var r=e.callbackNode;if(xl()&&e.callbackNode!==r)return null;var n=Pd(e,e===br?Tr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yd(e,n);else{t=n;var a=qe;qe|=2;var i=vT();(br!==e||Tr!==t)&&(ni=null,Ol=Ht()+500,Xs(e,t));do try{T6();break}catch(o){xT(e,o)}while(!0);by(),Xd.current=i,qe=a,Jt!==null?t=0:(br=null,Tr=0,t=lr)}if(t!==0){if(t===2&&(a=Mv(e),a!==0&&(n=a,t=og(e,a))),t===1)throw r=Zu,Xs(e,0),Ui(e,n),hn(e,Ht()),r;if(t===6)Ui(e,n);else{if(a=e.current.alternate,!(n&30)&&!j6(a)&&(t=Yd(e,n),t===2&&(i=Mv(e),i!==0&&(n=i,t=og(e,i))),t===1))throw r=Zu,Xs(e,0),Ui(e,n),hn(e,Ht()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(me(345));case 2:Ms(e,ln,ni);break;case 3:if(Ui(e,n),(n&130023424)===n&&(t=Dy+500-Ht(),10<t)){if(Pd(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){rn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Uv(Ms.bind(null,e,ln,ni),t);break}Ms(e,ln,ni);break;case 4:if(Ui(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ja(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Ht()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*N6(n/1960))-n,10<n){e.timeoutHandle=Uv(Ms.bind(null,e,ln,ni),n);break}Ms(e,ln,ni);break;case 5:Ms(e,ln,ni);break;default:throw Error(me(329))}}}return hn(e,Ht()),e.callbackNode===r?mT.bind(null,e):null}function og(e,t){var r=yu;return e.current.memoizedState.isDehydrated&&(Xs(e,t).flags|=256),e=Yd(e,t),e!==2&&(t=ln,ln=r,t!==null&&lg(t)),e}function lg(e){ln===null?ln=e:ln.push.apply(ln,e)}function j6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Pa(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ui(e,t){for(t&=~Fy,t&=~Tp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ja(t),n=1<<r;e[r]=-1,t&=~n}}function G2(e){if(qe&6)throw Error(me(327));xl();var t=Pd(e,0);if(!(t&1))return hn(e,Ht()),null;var r=Yd(e,t);if(e.tag!==0&&r===2){var n=Mv(e);n!==0&&(t=n,r=og(e,n))}if(r===1)throw r=Zu,Xs(e,0),Ui(e,t),hn(e,Ht()),r;if(r===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ms(e,ln,ni),hn(e,Ht()),null}function Iy(e,t){var r=qe;qe|=1;try{return e(t)}finally{qe=r,qe===0&&(Ol=Ht()+500,kp&&fs())}}function io(e){Hi!==null&&Hi.tag===0&&!(qe&6)&&xl();var t=qe;qe|=1;var r=ea.transition,n=it;try{if(ea.transition=null,it=1,e)return e()}finally{it=n,ea.transition=r,qe=t,!(qe&6)&&fs()}}function Ry(){Sn=al.current,wt(al)}function Xs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,r6(r)),Jt!==null)for(r=Jt.return;r!==null;){var n=r;switch(vy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Rd();break;case 3:Tl(),wt(fn),wt(Vr),jy();break;case 5:Ny(n);break;case 4:Tl();break;case 13:wt(Ot);break;case 19:wt(Ot);break;case 10:wy(n.type._context);break;case 22:case 23:Ry()}r=r.return}if(br=e,Jt=e=ts(e.current,null),Tr=Sn=t,lr=0,Zu=null,Fy=Tp=ao=0,ln=yu=null,Bs!==null){for(t=0;t<Bs.length;t++)if(r=Bs[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Bs=null}return e}function xT(e,t){do{var r=Jt;try{if(by(),bd.current=Gd,Vd){for(var n=Mt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Vd=!1}if(no=0,mr=ir=Mt=null,vu=!1,qu=0,My.current=null,r===null||r.return===null){lr=1,Zu=t,Jt=null;break}e:{var i=e,s=r.return,o=r,c=t;if(t=Tr,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=M2(s);if(p!==null){p.flags&=-257,F2(p,s,o,i,t),p.mode&1&&P2(i,u,t),t=p,c=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){P2(i,u,t),$y();break e}c=Error(me(426))}}else if(kt&&o.mode&1){var y=M2(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),F2(y,s,o,i,t),gy(Al(c,o));break e}}i=c=Al(c,o),lr!==4&&(lr=2),yu===null?yu=[i]:yu.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var g=JE(i,c,t);j2(i,g);break e;case 1:o=c;var b=i.type,m=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ji===null||!Ji.has(m)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=eT(i,o,t);j2(i,S);break e}}i=i.return}while(i!==null)}yT(r)}catch(w){t=w,Jt===r&&r!==null&&(Jt=r=r.return);continue}break}while(!0)}function vT(){var e=Xd.current;return Xd.current=Gd,e===null?Gd:e}function $y(){(lr===0||lr===3||lr===2)&&(lr=4),br===null||!(ao&268435455)&&!(Tp&268435455)||Ui(br,Tr)}function Yd(e,t){var r=qe;qe|=2;var n=vT();(br!==e||Tr!==t)&&(ni=null,Xs(e,t));do try{E6();break}catch(a){xT(e,a)}while(!0);if(by(),qe=r,Xd.current=n,Jt!==null)throw Error(me(261));return br=null,Tr=0,lr}function E6(){for(;Jt!==null;)gT(Jt)}function T6(){for(;Jt!==null&&!JM();)gT(Jt)}function gT(e){var t=wT(e.alternate,e,Sn);e.memoizedProps=e.pendingProps,t===null?yT(e):Jt=t,My.current=null}function yT(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=w6(r,t),r!==null){r.flags&=32767,Jt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{lr=6,Jt=null;return}}else if(r=b6(r,t,Sn),r!==null){Jt=r;return}if(t=t.sibling,t!==null){Jt=t;return}Jt=t=e}while(t!==null);lr===0&&(lr=5)}function Ms(e,t,r){var n=it,a=ea.transition;try{ea.transition=null,it=1,A6(e,t,r,n)}finally{ea.transition=a,it=n}return null}function A6(e,t,r,n){do xl();while(Hi!==null);if(qe&6)throw Error(me(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(cF(e,i),e===br&&(Jt=br=null,Tr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||L0||(L0=!0,_T(Cd,function(){return xl(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ea.transition,ea.transition=null;var s=it;it=1;var o=qe;qe|=4,My.current=null,S6(e,r),hT(r,e),qF(Lv),Md=!!$v,Lv=$v=null,e.current=r,k6(r),eF(),qe=o,it=s,ea.transition=i}else e.current=r;if(L0&&(L0=!1,Hi=e,qd=a),i=e.pendingLanes,i===0&&(Ji=null),nF(r.stateNode),hn(e,Ht()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Kd)throw Kd=!1,e=ig,ig=null,e;return qd&1&&e.tag!==0&&xl(),i=e.pendingLanes,i&1?e===sg?bu++:(bu=0,sg=e):bu=0,fs(),null}function xl(){if(Hi!==null){var e=J4(qd),t=ea.transition,r=it;try{if(ea.transition=null,it=16>e?16:e,Hi===null)var n=!1;else{if(e=Hi,Hi=null,qd=0,qe&6)throw Error(me(331));var a=qe;for(qe|=4,Ne=e.current;Ne!==null;){var i=Ne,s=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Ne=u;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:gu(8,f,i)}var d=f.child;if(d!==null)d.return=f,Ne=d;else for(;Ne!==null;){f=Ne;var h=f.sibling,p=f.return;if(uT(f),f===u){Ne=null;break}if(h!==null){h.return=p,Ne=h;break}Ne=p}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}Ne=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,Ne=s;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:gu(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,Ne=g;break e}Ne=i.return}}var b=e.current;for(Ne=b;Ne!==null;){s=Ne;var m=s.child;if(s.subtreeFlags&2064&&m!==null)m.return=s,Ne=m;else e:for(s=b;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ep(9,o)}}catch(w){It(o,o.return,w)}if(o===s){Ne=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,Ne=S;break e}Ne=o.return}}if(qe=a,fs(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(yp,e)}catch{}n=!0}return n}finally{it=r,ea.transition=t}}return!1}function X2(e,t,r){t=Al(r,t),t=JE(e,t,1),e=Zi(e,t,1),t=rn(),e!==null&&(Yf(e,1,t),hn(e,t))}function It(e,t,r){if(e.tag===3)X2(e,e,r);else for(;t!==null;){if(t.tag===3){X2(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ji===null||!Ji.has(n))){e=Al(r,e),e=eT(t,e,1),t=Zi(t,e,1),e=rn(),t!==null&&(Yf(t,1,e),hn(t,e));break}}t=t.return}}function O6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=rn(),e.pingedLanes|=e.suspendedLanes&r,br===e&&(Tr&r)===r&&(lr===4||lr===3&&(Tr&130023424)===Tr&&500>Ht()-Dy?Xs(e,0):Fy|=r),hn(e,t)}function bT(e,t){t===0&&(e.mode&1?(t=A0,A0<<=1,!(A0&130023424)&&(A0=4194304)):t=1);var r=rn();e=bi(e,t),e!==null&&(Yf(e,t,r),hn(e,r))}function C6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bT(e,r)}function P6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(t),bT(e,r)}var wT;wT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fn.current)cn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return cn=!1,y6(e,t,r);cn=!!(e.flags&131072)}else cn=!1,kt&&t.flags&1048576&&NE(t,Bd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;_d(e,t),e=t.pendingProps;var a=Nl(t,Vr.current);ml(t,r),a=Ty(null,t,n,e,a,r);var i=Ay();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dn(n)?(i=!0,$d(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Sy(t),a.updater=jp,t.stateNode=a,a._reactInternals=t,Kv(t,n,e,r),t=Qv(null,t,n,!0,i,r)):(t.tag=0,kt&&i&&xy(t),Yr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(_d(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=F6(n),e=ga(n,e),a){case 0:t=Yv(null,t,n,e,r);break e;case 1:t=R2(null,t,n,e,r);break e;case 11:t=D2(null,t,n,e,r);break e;case 14:t=I2(null,t,n,ga(n.type,e),r);break e}throw Error(me(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ga(n,a),Yv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ga(n,a),R2(e,t,n,a,r);case 3:e:{if(aT(t),e===null)throw Error(me(387));n=t.pendingProps,i=t.memoizedState,a=i.element,CE(e,t),Wd(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Al(Error(me(423)),t),t=$2(e,t,n,r,a);break e}else if(n!==a){a=Al(Error(me(424)),t),t=$2(e,t,n,r,a);break e}else for(Cn=Qi(t.stateNode.containerInfo.firstChild),Pn=t,kt=!0,_a=null,r=AE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(jl(),n===a){t=wi(e,t,r);break e}Yr(e,t,n,r)}t=t.child}return t;case 5:return PE(t),e===null&&Vv(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,Bv(n,a)?s=null:i!==null&&Bv(n,i)&&(t.flags|=32),nT(e,t),Yr(e,t,s,r),t.child;case 6:return e===null&&Vv(t),null;case 13:return iT(e,t,r);case 4:return ky(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=El(t,null,n,r):Yr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ga(n,a),D2(e,t,n,a,r);case 7:return Yr(e,t,t.pendingProps,r),t.child;case 8:return Yr(e,t,t.pendingProps.children,r),t.child;case 12:return Yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,ht(Ud,n._currentValue),n._currentValue=s,i!==null)if(Pa(i.value,s)){if(i.children===a.children&&!fn.current){t=wi(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=di(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Gv(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(me(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),Gv(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Yr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ml(t,r),a=na(a),n=n(a),t.flags|=1,Yr(e,t,n,r),t.child;case 14:return n=t.type,a=ga(n,t.pendingProps),a=ga(n.type,a),I2(e,t,n,a,r);case 15:return tT(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ga(n,a),_d(e,t),t.tag=1,dn(n)?(e=!0,$d(t)):e=!1,ml(t,r),ZE(t,n,a),Kv(t,n,a,r),Qv(null,t,n,!0,e,r);case 19:return sT(e,t,r);case 22:return rT(e,t,r)}throw Error(me(156,t.tag))};function _T(e,t){return q4(e,t)}function M6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zn(e,t,r,n){return new M6(e,t,r,n)}function Ly(e){return e=e.prototype,!(!e||!e.isReactComponent)}function F6(e){if(typeof e=="function")return Ly(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ay)return 11;if(e===iy)return 14}return 2}function ts(e,t){var r=e.alternate;return r===null?(r=Zn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Nd(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")Ly(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Ko:return Ks(r.children,a,i,t);case ny:s=8,a|=8;break;case gv:return e=Zn(12,r,t,a|2),e.elementType=gv,e.lanes=i,e;case yv:return e=Zn(13,r,t,a),e.elementType=yv,e.lanes=i,e;case bv:return e=Zn(19,r,t,a),e.elementType=bv,e.lanes=i,e;case P4:return Ap(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O4:s=10;break e;case C4:s=9;break e;case ay:s=11;break e;case iy:s=14;break e;case Ri:s=16,n=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=Zn(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Ks(e,t,r,n){return e=Zn(7,e,n,t),e.lanes=r,e}function Ap(e,t,r,n){return e=Zn(22,e,n,t),e.elementType=P4,e.lanes=r,e.stateNode={isHidden:!1},e}function _x(e,t,r){return e=Zn(6,e,null,t),e.lanes=r,e}function Sx(e,t,r){return t=Zn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function D6(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nx(0),this.expirationTimes=nx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nx(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function By(e,t,r,n,a,i,s,o,c){return e=new D6(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Zn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sy(i),e}function I6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function ST(e){if(!e)return as;e=e._reactInternals;e:{if(wo(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var r=e.type;if(dn(r))return SE(e,r,t)}return t}function kT(e,t,r,n,a,i,s,o,c){return e=By(r,n,!0,e,a,i,s,o,c),e.context=ST(null),r=e.current,n=rn(),a=es(r),i=di(n,a),i.callback=t??null,Zi(r,i,a),e.current.lanes=a,Yf(e,a,n),hn(e,n),e}function Op(e,t,r,n){var a=t.current,i=rn(),s=es(a);return r=ST(r),t.context===null?t.context=r:t.pendingContext=r,t=di(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zi(a,t,s),e!==null&&(Ea(e,a,s,i),yd(e,a,s)),s}function Qd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function K2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Uy(e,t){K2(e,t),(e=e.alternate)&&K2(e,t)}function R6(){return null}var NT=typeof reportError=="function"?reportError:function(e){console.error(e)};function zy(e){this._internalRoot=e}Cp.prototype.render=zy.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));Op(e,t,null,null)};Cp.prototype.unmount=zy.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;io(function(){Op(null,e,null,null)}),t[yi]=null}};function Cp(e){this._internalRoot=e}Cp.prototype.unstable_scheduleHydration=function(e){if(e){var t=rE();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bi.length&&t!==0&&t<Bi[r].priority;r++);Bi.splice(r,0,e),r===0&&aE(e)}};function Wy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Pp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function q2(){}function $6(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var u=Qd(s);i.call(u)}}var s=kT(t,n,e,0,null,!1,!1,"",q2);return e._reactRootContainer=s,e[yi]=s.current,Hu(e.nodeType===8?e.parentNode:e),io(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=Qd(c);o.call(u)}}var c=By(e,0,!1,null,null,!1,!1,"",q2);return e._reactRootContainer=c,e[yi]=c.current,Hu(e.nodeType===8?e.parentNode:e),io(function(){Op(t,c,r,n)}),c}function Mp(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var c=Qd(s);o.call(c)}}Op(t,s,e,a)}else s=$6(r,t,e,a,n);return Qd(s)}eE=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=su(t.pendingLanes);r!==0&&(ly(t,r|1),hn(t,Ht()),!(qe&6)&&(Ol=Ht()+500,fs()))}break;case 13:io(function(){var n=bi(e,1);if(n!==null){var a=rn();Ea(n,e,1,a)}}),Uy(e,1)}};cy=function(e){if(e.tag===13){var t=bi(e,134217728);if(t!==null){var r=rn();Ea(t,e,134217728,r)}Uy(e,134217728)}};tE=function(e){if(e.tag===13){var t=es(e),r=bi(e,t);if(r!==null){var n=rn();Ea(r,e,t,n)}Uy(e,t)}};rE=function(){return it};nE=function(e,t){var r=it;try{return it=e,t()}finally{it=r}};Ov=function(e,t,r){switch(t){case"input":if(Sv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Sp(n);if(!a)throw Error(me(90));F4(n),Sv(n,a)}}}break;case"textarea":I4(e,r);break;case"select":t=r.value,t!=null&&fl(e,!!r.multiple,t,!1)}};W4=Iy;H4=io;var L6={usingClientEntryPoint:!1,Events:[Zf,Zo,Sp,U4,z4,Iy]},zc={findFiberByHostInstance:Ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},B6={bundleType:zc.bundleType,version:zc.version,rendererPackageName:zc.rendererPackageName,rendererConfig:zc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ji.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=X4(e),e===null?null:e.stateNode},findFiberByHostInstance:zc.findFiberByHostInstance||R6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var B0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!B0.isDisabled&&B0.supportsFiber)try{yp=B0.inject(B6),za=B0}catch{}}$n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=L6;$n.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wy(t))throw Error(me(200));return I6(e,t,null,r)};$n.createRoot=function(e,t){if(!Wy(e))throw Error(me(299));var r=!1,n="",a=NT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=By(e,1,!1,null,null,r,!1,n,a),e[yi]=t.current,Hu(e.nodeType===8?e.parentNode:e),new zy(t)};$n.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=X4(t),e=e===null?null:e.stateNode,e};$n.flushSync=function(e){return io(e)};$n.hydrate=function(e,t,r){if(!Pp(t))throw Error(me(200));return Mp(null,e,t,!0,r)};$n.hydrateRoot=function(e,t,r){if(!Wy(e))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=NT;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=kT(t,null,e,1,r??null,a,!1,i,s),e[yi]=t.current,Hu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Cp(t)};$n.render=function(e,t,r){if(!Pp(t))throw Error(me(200));return Mp(null,e,t,!1,r)};$n.unmountComponentAtNode=function(e){if(!Pp(e))throw Error(me(40));return e._reactRootContainer?(io(function(){Mp(null,null,e,!1,function(){e._reactRootContainer=null,e[yi]=null})}),!0):!1};$n.unstable_batchedUpdates=Iy;$n.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Pp(r))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return Mp(e,t,r,!1,n)};$n.version="18.3.1-next-f1338f8080-20240426";function jT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jT)}catch(e){console.error(e)}}jT(),j4.exports=$n;var U6=j4.exports,Y2=U6;Ed.createRoot=Y2.createRoot,Ed.hydrateRoot=Y2.hydrateRoot;const z6=["Technology","Finance","Professional Services","Legal","Real Estate","Retail/FMCG","Media & Creative","Healthcare","Education","Manufacturing","Logistics","Public Sector","Other (Custom)"],W6=["Global HQ","Regional HQ","Corporate Office","Client-facing Office","R&D / Innovation Hub","Trading Floor","Back Office","Flex / Hybrid Workplace","Other (Custom)"],zr={primary:"#F97316",program:["#64748B","#F97316","#8B5CF6","#0EA5E9","#94A3B8","#F43F5E"],departments:["#3B82F6","#8B5CF6","#EC4899","#F43F5E","#F97316","#EAB308","#84CC16","#10B981","#06B6D4","#6366F1"]},H6={deskOpen:4.5,deskAlt:3,deskEnclosed:12,meetingAvg:18,phoneBooth:1.5},V6={deskOpen:48,deskAlt:32,deskEnclosed:130,meetingAvg:195,phoneBooth:16},e0=e=>e==="sqm"?H6:V6,zo={small:25,medium:60,large:150,board:300,townhall:1e3},G6=[{id:"sup-1",name:"Tea Point / Pantry",category:"pantry",logic:"ratio",value:50,areaPerUnit:15},{id:"sup-2",name:"Open Collaboration",category:"collab",logic:"pct_nia",value:15},{id:"sup-3",name:"Storage",category:"storage",logic:"pct_nia",value:2},{id:"sup-4",name:"IT / Server Room",category:"server",logic:"fixed_area",value:10},{id:"sup-5",name:"Wellness / Mothers",category:"wellness",logic:"fixed_count",value:1,areaPerUnit:10},{id:"sup-6",name:"Print / Utilities",category:"utilities",logic:"ratio",value:75,areaPerUnit:4}],t0=e=>[{id:"pg-work",name:"Workstations",color:zr.program[0],items:["work_open","work_alt","work_enclosed"]},{id:"pg-collab",name:"Collaboration",color:zr.program[1],items:["sup-2"]},{id:"pg-meet",name:"Meeting Rooms",color:zr.program[2],items:["meet","phone"]},{id:"pg-supp",name:"Support",color:zr.program[3],items:["sup-1","sup-3","sup-4","sup-5","sup-6"]},{id:"pg-circ",name:"Circulation",color:zr.program[4],items:["circ"]}],X6={projectName:"New Strategic Hub",location:"Singapore",industry:"Technology",projectType:"Regional HQ",areaInput:2500,areaDefinition:"NIA",targetEfficiency:80,calculatedNia:2500,unit:"sqm",headcount:300,floors:[{id:"f1",name:"Floor 1",headcount:300}],departments:[{id:"d1",name:"Sales",headcount:80,futureHeadcount:90,occupancy:80,color:zr.departments[0],collaborators:[{deptId:"d2",strength:80}]},{id:"d2",name:"Marketing",headcount:40,futureHeadcount:45,occupancy:70,color:zr.departments[1],collaborators:[{deptId:"d1",strength:80},{deptId:"d4",strength:50}]},{id:"d3",name:"Engineering",headcount:120,futureHeadcount:140,occupancy:60,color:zr.departments[2],collaborators:[{deptId:"d4",strength:80}]},{id:"d4",name:"Product",headcount:30,futureHeadcount:35,occupancy:90,color:zr.departments[3],collaborators:[{deptId:"d3",strength:80},{deptId:"d2",strength:50}]},{id:"d5",name:"G&A",headcount:30,futureHeadcount:30,occupancy:95,color:zr.departments[4],collaborators:[]}],programStructure:t0()},Q2={id:"default",name:"Base Case",workpoints:{fixed:240,alternative:60},circulationPct:25,growthBuffer:5,enclosedOfficeCount:10,meetingRatios:{...zo},phoneBoothRatio:15,supportSpaces:[...G6]},K6=(e,t)=>{let r={};switch(e){case"Legal":r={enclosedOfficeCount:50};break;case"Technology":r={enclosedOfficeCount:5};break}return r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Y6=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Z2=e=>{const t=Y6(e);return t.charAt(0).toUpperCase()+t.slice(1)},ET=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Q6=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Z6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=G.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...o},c)=>G.createElement("svg",{ref:c,...Z6,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:ET("lucide",a),...!i&&!Q6(o)&&{"aria-hidden":"true"},...o},[...s.map(([u,f])=>G.createElement(u,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=(e,t)=>{const r=G.forwardRef(({className:n,...a},i)=>G.createElement(J6,{ref:i,iconNode:t,className:ET(`lucide-${q6(Z2(e))}`,`lucide-${e}`,n),...a}));return r.displayName=Z2(e),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e8=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Fp=Ee("activity",e8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t8=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],TT=Ee("arrow-down",t8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r8=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Ga=Ee("arrow-right-left",r8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Dp=Ee("arrow-right",n8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a8=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],lc=Ee("briefcase",a8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i8=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Zd=Ee("building",i8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s8=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ds=Ee("calculator",s8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o8=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],cc=Ee("chart-no-axes-column",o8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l8=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],Ip=Ee("chart-pie",l8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],uc=Ee("check",c8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pn=Ee("chevron-down",u8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Gr=Ee("chevron-right",f8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d8=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],h8=Ee("chevron-up",d8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],AT=Ee("circle-alert",p8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],qa=Ee("circle-check-big",m8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],OT=Ee("circle-question-mark",x8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],Rp=Ee("coffee",v8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],$p=Ee("columns-2",g8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y8=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Lp=Ee("copy",y8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ei=Ee("download",b8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w8=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],CT=Ee("ellipsis",w8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],S8=Ee("eye",_8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],PT=Ee("file-spreadsheet",k8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],fc=Ee("file-text",N8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Jd=Ee("funnel",j8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],MT=Ee("gauge",E8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],hs=Ee("git-commit-horizontal",T8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Bp=Ee("globe",A8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],FT=Ee("grid-3x3",O8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]],DT=Ee("hexagon",C8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Up=Ee("house",P8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],IT=Ee("image",M8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],dc=Ee("info",F8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],ia=Ee("layers",D8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],RT=Ee("layout-grid",I8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],$T=Ee("lightbulb",R8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],LT=Ee("list",$8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],BT=Ee("map-pin",L8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],UT=Ee("maximize-2",B8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],zp=Ee("maximize",U8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],zT=Ee("menu",z8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],WT=Ee("minimize-2",W8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],HT=Ee("monitor",H8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],eh=Ee("network",V8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Wp=Ee("palette",G8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],In=Ee("panels-top-left",X8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],q8=Ee("pen",K8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ya=Ee("plus",Y8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Z8=Ee("rotate-ccw",Q8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]],VT=Ee("scaling",J8);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],GT=Ee("search",eD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hp=Ee("settings",tD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Vp=Ee("settings-2",rD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ps=Ee("shield-check",nD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Gp=Ee("table",aD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],sD=Ee("text-align-start",iD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ms=Ee("trash-2",oD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],XT=Ee("trending-up",lD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Or=Ee("triangle-alert",cD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],KT=Ee("upload",uD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qT=Ee("user",fD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Xr=Ee("users",dD);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],xn=Ee("x",hD),U0=({number:e,title:t,icon:r})=>l.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-slate-100",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold font-mono",children:e}),l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(r,{className:"w-4 h-4 text-orange-500"}),t]})]}),pD=({data:e,onChange:t})=>{const[r,n]=G.useState(!1),[a,i]=G.useState(!1);G.useEffect(()=>{let h=e.areaInput;e.areaDefinition==="Gross"&&(h=e.areaInput*(e.targetEfficiency/100)),h!==e.calculatedNia&&t({...e,calculatedNia:h})},[e.areaInput,e.areaDefinition,e.targetEfficiency,e.calculatedNia]);const s=(h,p)=>{let v={...e,[h]:p};if(h==="projectType"){const x=t0();v={...v,programStructure:x}}t(v)},o=h=>{t({...e,unit:h})},c=h=>{const p=[...e.floors];if(h>p.length)for(let v=p.length;v<h;v++)p.push({id:`f${v+1}`,name:`Floor ${v+1}`,headcount:0});else h<p.length&&(p.length=h);t({...e,floors:p})},u=(h,p)=>{const v=[...e.floors];v[h].headcount=p,t({...e,floors:v})},f=e.floors.reduce((h,p)=>h+p.headcount,0),d=f!==e.headcount;return l.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto",children:[l.jsxs("div",{className:"mb-10",children:[l.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Zd,{className:"w-6 h-6 text-orange-500"}),"Project Information"]}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Defining the strategic context and constraints for the portfolio analysis."})]}),l.jsxs("div",{className:"space-y-12",children:[l.jsxs("section",{children:[l.jsx(U0,{number:"1",title:"Strategic Context",icon:lc}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"col-span-1 md:col-span-2",children:[l.jsxs("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2",children:["Project Name ",l.jsx("span",{className:"text-rose-500",children:"*"})]}),l.jsxs("div",{className:"flex items-center bg-slate-50 px-4 py-3 rounded-lg border border-slate-200 focus-within:border-orange-400 transition-all",children:[l.jsx(fc,{className:"w-5 h-5 text-slate-400 mr-3"}),l.jsx("input",{type:"text",className:"bg-transparent w-full text-lg font-bold text-slate-800 focus:outline-none placeholder-slate-300",value:e.projectName||"",onChange:h=>s("projectName",h.target.value),placeholder:"e.g. Project Zenith - Global HQ"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Industry Sector"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Bp,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.industry,onChange:h=>s("industry",h.target.value),children:z6.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(pn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Location"}),l.jsxs("div",{className:"relative group",children:[l.jsx(BT,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"text",className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.location,onChange:h=>s("location",h.target.value),placeholder:"City, Country"})]})]})]})]}),l.jsxs("section",{children:[l.jsx(U0,{number:"2",title:"Scale & Typology",icon:VT}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Project Typology"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Zd,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.projectType,onChange:h=>s("projectType",h.target.value),children:W6.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(pn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Total Base Headcount"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"number",min:"1",className:"w-full bg-slate-50 border border-slate-200 text-sm font-bold text-slate-800 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.headcount,onChange:h=>s("headcount",parseInt(h.target.value)||0)})]})]})]})]}),l.jsxs("section",{children:[l.jsx(U0,{number:"3",title:"Physical Constraints",icon:ia}),l.jsxs("div",{className:"flex flex-wrap items-end gap-6 bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6",children:[l.jsxs("div",{className:"flex-grow min-w-[240px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Input Area"}),l.jsxs("div",{className:"flex items-center gap-6 mb-3",children:[l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="NIA",onChange:()=>t({...e,areaDefinition:"NIA",targetEfficiency:100})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"NIA (Net Internal)"})]}),l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="Gross",onChange:()=>t({...e,areaDefinition:"Gross",targetEfficiency:80})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"Gross Area"})]})]}),l.jsxs("div",{className:"relative group max-w-xs",children:[l.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 text-lg font-bold text-slate-800 pl-4 pr-12 py-2 rounded-lg focus:outline-none focus:border-orange-400 shadow-sm",value:e.areaInput,onChange:h=>s("areaInput",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-4 top-3 text-xs font-bold text-slate-400 uppercase",children:e.unit})]})]}),e.areaDefinition==="Gross"&&l.jsxs("div",{className:"w-40 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Efficiency"}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:"number",min:"50",max:"100",className:"w-full bg-white border border-slate-300 text-lg font-medium text-slate-700 px-3 py-2 rounded-lg focus:outline-none focus:border-orange-400 text-right pr-8 shadow-sm",value:e.targetEfficiency,onChange:h=>s("targetEfficiency",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-3 top-3 text-sm text-slate-400 font-bold",children:"%"})]})]}),l.jsx("div",{className:"flex items-center pb-4 text-slate-300",children:l.jsx(Ga,{className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-grow min-w-[200px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Effective NIA (Usable)"}),l.jsxs("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("span",{className:"text-xl font-bold text-slate-800 w-full font-mono",children:Math.round(e.calculatedNia).toLocaleString()}),l.jsx("span",{className:"text-xs text-slate-400 font-bold ml-2 uppercase",children:e.unit})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Number of Floors"}),l.jsx("input",{type:"number",min:"1",max:"50",className:"w-24 bg-white border border-slate-200 text-sm font-medium text-slate-700 px-3 py-1.5 rounded-lg focus:outline-none focus:border-orange-400 text-right",value:e.floors.length,onChange:h=>c(parseInt(h.target.value)||1)})]}),l.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-bold text-slate-600 uppercase hover:text-orange-600 transition-colors group",children:[r?l.jsx(pn,{className:"w-4 h-4 text-orange-500"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400 group-hover:text-orange-500"}),"Floor-by-Floor Allocation ",r?"":"(Optional)"]}),r&&l.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200 animate-in fade-in slide-in-from-top-2",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:e.floors.map((h,p)=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm focus-within:border-orange-400 transition-colors",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wide",children:h.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xr,{className:"w-3 h-3 text-slate-300"}),l.jsx("input",{type:"number",className:"w-full text-sm font-bold text-slate-700 focus:outline-none",value:h.headcount,onChange:v=>u(p,parseInt(v.target.value)||0)})]})]},h.id))}),d&&l.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs font-medium text-amber-700 bg-amber-50 p-3 rounded-lg border border-amber-100",children:[l.jsx(Or,{className:"w-4 h-4 text-amber-500"}),l.jsxs("span",{children:["Warning: Floor headcount sum (",f,") does not match Total Headcount (",e.headcount,"). Stacking calculations generally prioritize floor data."]})]})]})]})]}),l.jsxs("section",{children:[l.jsx(U0,{number:"4",title:"System Preferences",icon:Vp}),l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-100",children:[l.jsx("div",{className:"flex items-center gap-6",children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Unit System"}),l.jsxs("div",{className:"flex bg-white p-1 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("button",{onClick:()=>o("sqm"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqm"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQM"}),l.jsx("button",{onClick:()=>o("sqft"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqft"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQFT"})]})]})}),l.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2.5 text-sm font-bold text-slate-700 bg-white border border-slate-300 rounded-lg hover:border-orange-400 hover:text-orange-600 transition-all shadow-sm",children:[l.jsx(Wp,{className:"w-4 h-4"})," Customize Visualization"]})]})]})]}),a&&l.jsx(VisualizationSettings,{project:e,onChange:t,onClose:()=>i(!1)})]})},J2=({title:e,icon:t,isOpen:r,toggle:n})=>l.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-3 bg-white border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(t,{className:"w-4 h-4 text-indigo-600"}),l.jsx("span",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:e})]}),r?l.jsx(pn,{className:"w-4 h-4 text-slate-400"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400"})]}),Wo=({label:e,value:t,unit:r,min:n,max:a,onChange:i,disabled:s,step:o=1,note:c})=>l.jsxs("div",{className:`mb-3 ${s?"opacity-60 grayscale":""}`,children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:e}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",min:n,max:a,step:o,value:t,disabled:s,onChange:u=>i(parseFloat(u.target.value)||0),className:"w-full p-2 text-sm border border-slate-200 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none bg-white font-medium"}),r&&l.jsx("div",{className:"px-3 py-2 bg-slate-100 border border-l-0 border-slate-200 rounded-r-md text-xs font-bold text-slate-500 whitespace-nowrap",children:r})]}),c&&l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:c})]}),mD=({pct:e,baseHc:t,onChange:r,disabled:n})=>{const[a,i]=G.useState("%"),s=Math.round(t*(e/100)),o=c=>{if(t>0){const u=c/t*100;r(parseFloat(u.toFixed(1)))}};return l.jsxs("div",{className:`mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100 ${n?"opacity-60 grayscale":""}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide",children:"Growth Buffer"}),l.jsxs("div",{className:"flex bg-white rounded border border-indigo-200 p-0.5",children:[l.jsx("button",{onClick:()=>i("%"),className:`text-[10px] px-2 py-0.5 rounded ${a==="%"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"%"}),l.jsx("button",{onClick:()=>i("Abs"),className:`text-[10px] px-2 py-0.5 rounded ${a==="Abs"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"HC"})]})]}),a==="%"?l.jsx(Wo,{label:"",value:e,unit:"% add-on",min:0,max:100,step:1,onChange:r,disabled:n}):l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",className:"w-full p-2 text-sm border border-indigo-200 rounded-l-md focus:outline-none focus:ring-1 focus:ring-indigo-500",value:s,onChange:c=>o(parseInt(c.target.value)||0),disabled:n}),l.jsx("div",{className:"px-3 py-2 bg-white border border-l-0 border-indigo-200 rounded-r-md text-xs font-bold text-indigo-500 whitespace-nowrap",children:"People"})]}),l.jsxs("div",{className:"text-[10px] text-indigo-400 mt-1 flex justify-between",children:[l.jsx("span",{children:"Reserve capacity"}),l.jsx("span",{children:a==="%"?`+${s} people`:`+${e}% add-on`})]})]})},xD=({ratios:e,onChange:t,disabled:r})=>{const n=(s,o)=>{t({...e,[s]:o})},a=(s,o)=>{if(s===0)return{label:"None",color:"bg-slate-100 text-slate-400"};const c=(s-o)/o;return c>.1?{label:"Conservative",color:"bg-orange-100 text-orange-700"}:c<-.1?{label:"Generous",color:"bg-emerald-100 text-emerald-700"}:{label:"Typical",color:"bg-blue-100 text-blue-700"}},i=({type:s,label:o,val:c,bench:u})=>{const f=a(c,u);return l.jsxs("tr",{className:"border-b border-slate-50 last:border-0 hover:bg-slate-50 group",children:[l.jsxs("td",{className:"py-2 pl-2 text-xs font-medium text-slate-700 flex items-center gap-1",children:[o,l.jsxs("div",{className:"group relative",children:[l.jsx(OT,{className:"w-3 h-3 text-slate-300 cursor-help"}),l.jsxs("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 w-32 bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 pointer-events-none z-50 whitespace-normal",children:["Benchmark: 1 per ",u," ppl"]})]})]}),l.jsx("td",{className:"py-2 px-1",children:l.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border border-slate-200 rounded focus:ring-1 focus:ring-indigo-500 font-medium",value:c,onChange:d=>n(s,parseInt(d.target.value)||0),disabled:r})}),l.jsx("td",{className:"py-2 pr-2 text-right",children:l.jsx("span",{className:`text-[9px] uppercase font-bold px-1.5 py-0.5 rounded ${f.color}`,children:f.label})})]})};return l.jsxs("div",{className:"mb-4 bg-white border border-slate-200 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"bg-slate-50 px-3 py-2 border-b border-slate-200 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Meeting Strategy"}),l.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"People per Room"})]}),l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 text-[10px] text-slate-400 uppercase font-semibold text-left",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pl-2 py-1 font-normal w-1/3",children:"Room Type"}),l.jsx("th",{className:"py-1 text-right font-normal pr-2",children:"Input"}),l.jsx("th",{className:"pr-2 py-1 text-right font-normal",children:"Status"})]})}),l.jsxs("tbody",{children:[l.jsx(i,{type:"small",label:"Small (4p)",val:e.small,bench:zo.small}),l.jsx(i,{type:"medium",label:"Medium (8p)",val:e.medium,bench:zo.medium}),l.jsx(i,{type:"large",label:"Large (14p)",val:e.large,bench:zo.large}),l.jsx(i,{type:"board",label:"Board (20p)",val:e.board,bench:zo.board}),l.jsx(i,{type:"townhall",label:"Townhall",val:e.townhall,bench:zo.townhall})]})]})]})},vD=({spaces:e,onChange:t})=>{const r=()=>{t([...e,{id:`sup-${Date.now()}`,name:"New Amenity",category:"other",logic:"pct_nia",value:1}])},n=(i,s,o)=>{t(e.map(c=>c.id===i?{...c,[s]:o}:c))},a=i=>{t(e.filter(s=>s.id!==i))};return l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-600 uppercase flex items-center gap-1",children:[l.jsx(Rp,{className:"w-3 h-3"})," Support & Amenity"]}),l.jsxs("button",{onClick:r,className:"text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[l.jsx(Ya,{className:"w-3 h-3"})," Add"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(i=>l.jsxs("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 text-xs hover:border-indigo-200 transition-colors",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 gap-2",children:[l.jsx("input",{className:"bg-transparent font-bold text-slate-700 w-full focus:outline-none border-b border-transparent focus:border-indigo-200 text-xs",value:i.name,onChange:s=>n(i.id,"name",s.target.value),placeholder:"Space Name"}),l.jsx("button",{onClick:()=>a(i.id),className:"text-slate-400 hover:text-rose-500",children:l.jsx(ms,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("select",{className:"w-full p-1 border rounded bg-white text-[10px]",value:i.logic,onChange:s=>n(i.id,"logic",s.target.value),children:[l.jsx("option",{value:"ratio",children:"Ratio (1:X)"}),l.jsx("option",{value:"pct_nia",children:"% of NIA"}),l.jsx("option",{value:"fixed_area",children:"Fixed Area"}),l.jsx("option",{value:"fixed_count",children:"Fixed Count"}),l.jsx("option",{value:"area_per_person",children:"Area / Person"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right",value:i.value,onChange:s=>n(i.id,"value",parseFloat(s.target.value))}),l.jsx("span",{className:"text-[9px] text-slate-400 w-8 text-right",children:i.logic==="pct_nia"?"%":i.logic==="ratio"?"ppl":"val"})]})]}),(i.logic==="ratio"||i.logic==="fixed_count")&&l.jsxs("div",{className:"mt-2 flex items-center justify-between pt-1 border-t border-slate-200",children:[l.jsx("span",{className:"text-[9px] text-slate-400",children:"Size per room:"}),l.jsx("div",{className:"flex items-center gap-1 w-20",children:l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right text-[10px]",value:i.areaPerUnit||0,onChange:s=>n(i.id,"areaPerUnit",parseFloat(s.target.value))})})]})]},i.id))})]})},gD=({strategy:e,onChange:t,title:r="Active Strategy",isReadOnly:n=!1,baseHeadcount:a=100})=>{var x,y;const[i,s]=G.useState({planning:!0,workplace:!0}),o=Math.ceil(a*(1+e.growthBuffer/100)),c=((x=e.workpoints)==null?void 0:x.fixed)||0,u=((y=e.workpoints)==null?void 0:y.alternative)||0,f=c+u,d=f-o,h=(g,b)=>{n||t({...e,[g]:b})},p=(g,b)=>{n||t({...e,workpoints:{...e.workpoints,[g]:Math.max(0,b)}})},v=g=>s(b=>({...b,[g]:!b[g]}));return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Vp,{className:"w-4 h-4 text-indigo-600"}),"Strategy Inputs"]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate font-medium",children:r})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx(J2,{title:"Planning Factors",icon:RT,isOpen:i.planning,toggle:()=>v("planning")}),i.planning&&l.jsxs("div",{className:"p-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(mD,{pct:e.growthBuffer,baseHc:a,onChange:g=>h("growthBuffer",g),disabled:n}),l.jsx(Wo,{label:"Circulation",value:e.circulationPct,unit:"% add-on",min:10,max:60,onChange:g=>h("circulationPct",g),disabled:n})]}),l.jsx(J2,{title:"Workplace Strategy",icon:lc,isOpen:i.workplace,toggle:()=>v("workplace")}),i.workplace&&l.jsxs("div",{className:"p-4 space-y-6 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(Wo,{label:"Enclosed Offices",value:e.enclosedOfficeCount,unit:"people",min:0,onChange:g=>h("enclosedOfficeCount",g),disabled:n,note:"Included within Fixed Workstations count"}),l.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:"Workpoints Target"})}),l.jsx(Wo,{label:"Fixed Workstations",value:c,unit:"seats",min:0,onChange:g=>p("fixed",g),disabled:n,note:"Total assigned desks (includes Enclosed Offices)"}),l.jsx(Wo,{label:"Alternative Workpoints",value:u,unit:"points",min:0,onChange:g=>p("alternative",g),disabled:n,note:"Agile, flex, or touchdown points"}),l.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-3 text-xs space-y-2 shadow-sm mb-3 mt-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 border-b border-indigo-200 pb-1.5 mb-1",children:[l.jsx(ds,{className:"w-3 h-3 text-indigo-500"}),l.jsx("span",{className:"font-bold text-indigo-800",children:"Supply vs Demand"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Headcount:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:o})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Workpoints:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:f})]}),l.jsxs("div",{className:`flex justify-between font-bold pt-1 border-t border-indigo-100 ${d<0?"text-amber-600":d>0?"text-blue-600":"text-emerald-600"}`,children:[l.jsxs("span",{className:"flex items-center gap-1",children:[d<0?l.jsx(Or,{className:"w-3 h-3"}):l.jsx(qa,{className:"w-3 h-3"})," Status:"]}),l.jsx("span",{children:d===0?"Matched":d>0?`Over by ${d}`:`Under by ${Math.abs(d)}`})]})]})]}),l.jsx(xD,{ratios:e.meetingRatios,onChange:g=>h("meetingRatios",g),disabled:n}),l.jsx(Wo,{label:"Phone Booth Ratio",value:e.phoneBoothRatio,unit:"ppl : 1 booth",min:1,max:100,onChange:g=>h("phoneBoothRatio",g),disabled:n}),l.jsx("div",{className:"border-t border-slate-100 pt-4",children:l.jsx(vD,{spaces:e.supportSpaces||[],onChange:g=>h("supportSpaces",g)})})]})]})]})};function YT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=YT(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ze(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=YT(e))&&(n&&(n+=" "),n+=t);return n}var yD=Array.isArray,bn=yD,bD=typeof S0=="object"&&S0&&S0.Object===Object&&S0,QT=bD,wD=QT,_D=typeof self=="object"&&self&&self.Object===Object&&self,SD=wD||_D||Function("return this")(),Qa=SD,kD=Qa,ND=kD.Symbol,r0=ND,e_=r0,ZT=Object.prototype,jD=ZT.hasOwnProperty,ED=ZT.toString,Wc=e_?e_.toStringTag:void 0;function TD(e){var t=jD.call(e,Wc),r=e[Wc];try{e[Wc]=void 0;var n=!0}catch{}var a=ED.call(e);return n&&(t?e[Wc]=r:delete e[Wc]),a}var AD=TD,OD=Object.prototype,CD=OD.toString;function PD(e){return CD.call(e)}var MD=PD,t_=r0,FD=AD,DD=MD,ID="[object Null]",RD="[object Undefined]",r_=t_?t_.toStringTag:void 0;function $D(e){return e==null?e===void 0?RD:ID:r_&&r_ in Object(e)?FD(e):DD(e)}var Ti=$D;function LD(e){return e!=null&&typeof e=="object"}var Ai=LD,BD=Ti,UD=Ai,zD="[object Symbol]";function WD(e){return typeof e=="symbol"||UD(e)&&BD(e)==zD}var hc=WD,HD=bn,VD=hc,GD=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,XD=/^\w*$/;function KD(e,t){if(HD(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||VD(e)?!0:XD.test(e)||!GD.test(e)||t!=null&&e in Object(t)}var Hy=KD;function qD(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var xs=qD;const pc=st(xs);var YD=Ti,QD=xs,ZD="[object AsyncFunction]",JD="[object Function]",eI="[object GeneratorFunction]",tI="[object Proxy]";function rI(e){if(!QD(e))return!1;var t=YD(e);return t==JD||t==eI||t==ZD||t==tI}var Vy=rI;const Ie=st(Vy);var nI=Qa,aI=nI["__core-js_shared__"],iI=aI,kx=iI,n_=function(){var e=/[^.]+$/.exec(kx&&kx.keys&&kx.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function sI(e){return!!n_&&n_ in e}var oI=sI,lI=Function.prototype,cI=lI.toString;function uI(e){if(e!=null){try{return cI.call(e)}catch{}try{return e+""}catch{}}return""}var JT=uI,fI=Vy,dI=oI,hI=xs,pI=JT,mI=/[\\^$.*+?()[\]{}|]/g,xI=/^\[object .+?Constructor\]$/,vI=Function.prototype,gI=Object.prototype,yI=vI.toString,bI=gI.hasOwnProperty,wI=RegExp("^"+yI.call(bI).replace(mI,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _I(e){if(!hI(e)||dI(e))return!1;var t=fI(e)?wI:xI;return t.test(pI(e))}var SI=_I;function kI(e,t){return e==null?void 0:e[t]}var NI=kI,jI=SI,EI=NI;function TI(e,t){var r=EI(e,t);return jI(r)?r:void 0}var _o=TI,AI=_o,OI=AI(Object,"create"),Xp=OI,a_=Xp;function CI(){this.__data__=a_?a_(null):{},this.size=0}var PI=CI;function MI(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var FI=MI,DI=Xp,II="__lodash_hash_undefined__",RI=Object.prototype,$I=RI.hasOwnProperty;function LI(e){var t=this.__data__;if(DI){var r=t[e];return r===II?void 0:r}return $I.call(t,e)?t[e]:void 0}var BI=LI,UI=Xp,zI=Object.prototype,WI=zI.hasOwnProperty;function HI(e){var t=this.__data__;return UI?t[e]!==void 0:WI.call(t,e)}var VI=HI,GI=Xp,XI="__lodash_hash_undefined__";function KI(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=GI&&t===void 0?XI:t,this}var qI=KI,YI=PI,QI=FI,ZI=BI,JI=VI,eR=qI;function mc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}mc.prototype.clear=YI;mc.prototype.delete=QI;mc.prototype.get=ZI;mc.prototype.has=JI;mc.prototype.set=eR;var tR=mc;function rR(){this.__data__=[],this.size=0}var nR=rR;function aR(e,t){return e===t||e!==e&&t!==t}var Gy=aR,iR=Gy;function sR(e,t){for(var r=e.length;r--;)if(iR(e[r][0],t))return r;return-1}var Kp=sR,oR=Kp,lR=Array.prototype,cR=lR.splice;function uR(e){var t=this.__data__,r=oR(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():cR.call(t,r,1),--this.size,!0}var fR=uR,dR=Kp;function hR(e){var t=this.__data__,r=dR(t,e);return r<0?void 0:t[r][1]}var pR=hR,mR=Kp;function xR(e){return mR(this.__data__,e)>-1}var vR=xR,gR=Kp;function yR(e,t){var r=this.__data__,n=gR(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var bR=yR,wR=nR,_R=fR,SR=pR,kR=vR,NR=bR;function xc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xc.prototype.clear=wR;xc.prototype.delete=_R;xc.prototype.get=SR;xc.prototype.has=kR;xc.prototype.set=NR;var qp=xc,jR=_o,ER=Qa,TR=jR(ER,"Map"),Xy=TR,i_=tR,AR=qp,OR=Xy;function CR(){this.size=0,this.__data__={hash:new i_,map:new(OR||AR),string:new i_}}var PR=CR;function MR(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var FR=MR,DR=FR;function IR(e,t){var r=e.__data__;return DR(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Yp=IR,RR=Yp;function $R(e){var t=RR(this,e).delete(e);return this.size-=t?1:0,t}var LR=$R,BR=Yp;function UR(e){return BR(this,e).get(e)}var zR=UR,WR=Yp;function HR(e){return WR(this,e).has(e)}var VR=HR,GR=Yp;function XR(e,t){var r=GR(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var KR=XR,qR=PR,YR=LR,QR=zR,ZR=VR,JR=KR;function vc(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}vc.prototype.clear=qR;vc.prototype.delete=YR;vc.prototype.get=QR;vc.prototype.has=ZR;vc.prototype.set=JR;var Ky=vc,eA=Ky,e$="Expected a function";function qy(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(e$);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(qy.Cache||eA),r}qy.Cache=eA;var tA=qy;const t$=st(tA);var r$=tA,n$=500;function a$(e){var t=r$(e,function(n){return r.size===n$&&r.clear(),n}),r=t.cache;return t}var i$=a$,s$=i$,o$=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l$=/\\(\\)?/g,c$=s$(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(o$,function(r,n,a,i){t.push(a?i.replace(l$,"$1"):n||r)}),t}),u$=c$;function f$(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var Yy=f$,s_=r0,d$=Yy,h$=bn,p$=hc,o_=s_?s_.prototype:void 0,l_=o_?o_.toString:void 0;function rA(e){if(typeof e=="string")return e;if(h$(e))return d$(e,rA)+"";if(p$(e))return l_?l_.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var m$=rA,x$=m$;function v$(e){return e==null?"":x$(e)}var nA=v$,g$=bn,y$=Hy,b$=u$,w$=nA;function _$(e,t){return g$(e)?e:y$(e,t)?[e]:b$(w$(e))}var aA=_$,S$=hc;function k$(e){if(typeof e=="string"||S$(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Qp=k$,N$=aA,j$=Qp;function E$(e,t){t=N$(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[j$(t[r++])];return r&&r==n?e:void 0}var Qy=E$,T$=Qy;function A$(e,t,r){var n=e==null?void 0:T$(e,t);return n===void 0?r:n}var iA=A$;const Mn=st(iA);function O$(e){return e==null}var C$=O$;const $e=st(C$);var P$=Ti,M$=bn,F$=Ai,D$="[object String]";function I$(e){return typeof e=="string"||!M$(e)&&F$(e)&&P$(e)==D$}var R$=I$;const so=st(R$);var sA={exports:{}},ot={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zy=Symbol.for("react.element"),Jy=Symbol.for("react.portal"),Zp=Symbol.for("react.fragment"),Jp=Symbol.for("react.strict_mode"),em=Symbol.for("react.profiler"),tm=Symbol.for("react.provider"),rm=Symbol.for("react.context"),$$=Symbol.for("react.server_context"),nm=Symbol.for("react.forward_ref"),am=Symbol.for("react.suspense"),im=Symbol.for("react.suspense_list"),sm=Symbol.for("react.memo"),om=Symbol.for("react.lazy"),L$=Symbol.for("react.offscreen"),oA;oA=Symbol.for("react.module.reference");function ca(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Zy:switch(e=e.type,e){case Zp:case em:case Jp:case am:case im:return e;default:switch(e=e&&e.$$typeof,e){case $$:case rm:case nm:case om:case sm:case tm:return e;default:return t}}case Jy:return t}}}ot.ContextConsumer=rm;ot.ContextProvider=tm;ot.Element=Zy;ot.ForwardRef=nm;ot.Fragment=Zp;ot.Lazy=om;ot.Memo=sm;ot.Portal=Jy;ot.Profiler=em;ot.StrictMode=Jp;ot.Suspense=am;ot.SuspenseList=im;ot.isAsyncMode=function(){return!1};ot.isConcurrentMode=function(){return!1};ot.isContextConsumer=function(e){return ca(e)===rm};ot.isContextProvider=function(e){return ca(e)===tm};ot.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zy};ot.isForwardRef=function(e){return ca(e)===nm};ot.isFragment=function(e){return ca(e)===Zp};ot.isLazy=function(e){return ca(e)===om};ot.isMemo=function(e){return ca(e)===sm};ot.isPortal=function(e){return ca(e)===Jy};ot.isProfiler=function(e){return ca(e)===em};ot.isStrictMode=function(e){return ca(e)===Jp};ot.isSuspense=function(e){return ca(e)===am};ot.isSuspenseList=function(e){return ca(e)===im};ot.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Zp||e===em||e===Jp||e===am||e===im||e===L$||typeof e=="object"&&e!==null&&(e.$$typeof===om||e.$$typeof===sm||e.$$typeof===tm||e.$$typeof===rm||e.$$typeof===nm||e.$$typeof===oA||e.getModuleId!==void 0)};ot.typeOf=ca;sA.exports=ot;var B$=sA.exports,U$=Ti,z$=Ai,W$="[object Number]";function H$(e){return typeof e=="number"||z$(e)&&U$(e)==W$}var lA=H$;const V$=st(lA);var G$=lA;function X$(e){return G$(e)&&e!=+e}var K$=X$;const n0=st(K$);var Jr=function(t){return t===0?0:t>0?1:-1},zs=function(t){return so(t)&&t.indexOf("%")===t.length-1},ve=function(t){return V$(t)&&!n0(t)},q$=function(t){return $e(t)},cr=function(t){return ve(t)||so(t)},Y$=0,gc=function(t){var r=++Y$;return"".concat(t||"").concat(r)},en=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ve(t)&&!so(t))return n;var i;if(zs(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return n0(i)&&(i=n),a&&i>r&&(i=r),i},zi=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},Q$=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Nn=function(t,r){return ve(t)&&ve(r)?function(n){return t+n*(r-t)}:function(){return r}};function th(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Mn(n,t))===r})}var Z$=function(t,r){return ve(t)&&ve(r)?t-r:so(t)&&so(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function vl(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function cg(e){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(e)}var J$=["viewBox","children"],eL=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],c_=["points","pathLength"],Nx={svg:J$,polygon:c_,polyline:c_},eb=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],rh=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(G.isValidElement(t)&&(n=t.props),!pc(n))return null;var a={};return Object.keys(n).forEach(function(i){eb.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},tL=function(t,r,n){return function(a){return t(r,n,a),null}},oo=function(t,r,n){if(!pc(t)||cg(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];eb.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=tL(s,r,n))}),a},rL=["children"],nL=["children"];function u_(e,t){if(e==null)return{};var r=aL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ug(e){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(e)}var f_={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},hi=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},d_=null,jx=null,tb=function e(t){if(t===d_&&Array.isArray(jx))return jx;var r=[];return G.Children.forEach(t,function(n){$e(n)||(B$.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),jx=r,d_=t,r};function Fn(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return hi(a)}):n=[hi(t)],tb(e).forEach(function(a){var i=Mn(a,"type.displayName")||Mn(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function kn(e,t){var r=Fn(e,t);return r&&r[0]}var h_=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!ve(n)||n<=0||!ve(a)||a<=0)},iL=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],sL=function(t){return t&&t.type&&so(t.type)&&iL.indexOf(t.type)>=0},oL=function(t){return t&&ug(t)==="object"&&"clipDot"in t},lL=function(t,r,n,a){var i,s=(i=Nx==null?void 0:Nx[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Ie(t)&&(a&&s.includes(r)||eL.includes(r))||n&&eb.includes(r)},Ce=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(G.isValidElement(t)&&(a=t.props),!pc(a))return null;var i={};return Object.keys(a).forEach(function(s){var o;lL((o=a)===null||o===void 0?void 0:o[s],s,r,n)&&(i[s]=a[s])}),i},fg=function e(t,r){if(t===r)return!0;var n=G.Children.count(t);if(n!==G.Children.count(r))return!1;if(n===0)return!0;if(n===1)return p_(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!p_(i,s))return!1}return!0},p_=function(t,r){if($e(t)&&$e(r))return!0;if(!$e(t)&&!$e(r)){var n=t.props||{},a=n.children,i=u_(n,rL),s=r.props||{},o=s.children,c=u_(s,nL);return a&&o?vl(i,c)&&fg(a,o):!a&&!o?vl(i,c):!1}return!1},m_=function(t,r){var n=[],a={};return tb(t).forEach(function(i,s){if(sL(i))n.push(i);else if(i){var o=hi(i.type),c=r[o]||{},u=c.handler,f=c.once;if(u&&(!f||!a[o])){var d=u(i,o,s);n.push(d),a[o]=!0}}}),n},cL=function(t){var r=t&&t.type;return r&&f_[r]?f_[r]:null},uL=function(t,r){return tb(r).indexOf(t)},fL=["children","width","height","viewBox","className","style","title","desc"];function dg(){return dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dg.apply(this,arguments)}function dL(e,t){if(e==null)return{};var r=hL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function hg(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,o=e.title,c=e.desc,u=dL(e,fL),f=a||{width:r,height:n,x:0,y:0},d=ze("recharts-surface",i);return Y.createElement("svg",dg({},Ce(u,!0,"svg"),{className:d,width:r,height:n,style:s,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height)}),Y.createElement("title",null,o),Y.createElement("desc",null,c),t)}var pL=["children","className"];function pg(){return pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pg.apply(this,arguments)}function mL(e,t){if(e==null)return{};var r=xL(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xL(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Je=Y.forwardRef(function(e,t){var r=e.children,n=e.className,a=mL(e,pL),i=ze("recharts-layer",n);return Y.createElement("g",pg({className:i},Ce(a,!0),{ref:t}),r)}),Ta=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function vL(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var gL=vL,yL=gL;function bL(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:yL(e,t,r)}var wL=bL,_L="\\ud800-\\udfff",SL="\\u0300-\\u036f",kL="\\ufe20-\\ufe2f",NL="\\u20d0-\\u20ff",jL=SL+kL+NL,EL="\\ufe0e\\ufe0f",TL="\\u200d",AL=RegExp("["+TL+_L+jL+EL+"]");function OL(e){return AL.test(e)}var cA=OL;function CL(e){return e.split("")}var PL=CL,uA="\\ud800-\\udfff",ML="\\u0300-\\u036f",FL="\\ufe20-\\ufe2f",DL="\\u20d0-\\u20ff",IL=ML+FL+DL,RL="\\ufe0e\\ufe0f",$L="["+uA+"]",mg="["+IL+"]",xg="\\ud83c[\\udffb-\\udfff]",LL="(?:"+mg+"|"+xg+")",fA="[^"+uA+"]",dA="(?:\\ud83c[\\udde6-\\uddff]){2}",hA="[\\ud800-\\udbff][\\udc00-\\udfff]",BL="\\u200d",pA=LL+"?",mA="["+RL+"]?",UL="(?:"+BL+"(?:"+[fA,dA,hA].join("|")+")"+mA+pA+")*",zL=mA+pA+UL,WL="(?:"+[fA+mg+"?",mg,dA,hA,$L].join("|")+")",HL=RegExp(xg+"(?="+xg+")|"+WL+zL,"g");function VL(e){return e.match(HL)||[]}var GL=VL,XL=PL,KL=cA,qL=GL;function YL(e){return KL(e)?qL(e):XL(e)}var QL=YL,ZL=wL,JL=cA,eB=QL,tB=nA;function rB(e){return function(t){t=tB(t);var r=JL(t)?eB(t):void 0,n=r?r[0]:t.charAt(0),a=r?ZL(r,1).join(""):t.slice(1);return n[e]()+a}}var nB=rB,aB=nB,iB=aB("toUpperCase"),sB=iB;const lm=st(sB);function dt(e){return function(){return e}}const xA=Math.cos,nh=Math.sin,Ma=Math.sqrt,ah=Math.PI,cm=2*ah,vg=Math.PI,gg=2*vg,Fs=1e-6,oB=gg-Fs;function vA(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function lB(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return vA;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class cB{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?vA:lB(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,f=s-t,d=o-r,h=f*f+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Fs)if(!(Math.abs(d*c-u*f)>Fs)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-s,v=a-o,x=c*c+u*u,y=p*p+v*v,g=Math.sqrt(x),b=Math.sqrt(h),m=i*Math.tan((vg-Math.acos((x+h-y)/(2*g*b)))/2),S=m/b,w=m/g;Math.abs(S-1)>Fs&&this._append`L${t+S*f},${r+S*d}`,this._append`A${i},${i},0,0,${+(d*p>f*v)},${this._x1=t+w*c},${this._y1=r+w*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,f=r+c,d=1^s,h=s?a-i:i-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>Fs||Math.abs(this._y1-f)>Fs)&&this._append`L${u},${f}`,n&&(h<0&&(h=h%gg+gg),h>oB?this._append`A${n},${n},0,1,${d},${t-o},${r-c}A${n},${n},0,1,${d},${this._x1=u},${this._y1=f}`:h>Fs&&this._append`A${n},${n},0,${+(h>=vg)},${d},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function rb(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new cB(t)}function nb(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function gA(e){this._context=e}gA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function um(e){return new gA(e)}function yA(e){return e[0]}function bA(e){return e[1]}function wA(e,t){var r=dt(!0),n=null,a=um,i=null,s=rb(o);e=typeof e=="function"?e:e===void 0?yA:dt(e),t=typeof t=="function"?t:t===void 0?bA:dt(t);function o(c){var u,f=(c=nb(c)).length,d,h=!1,p;for(n==null&&(i=a(p=s())),u=0;u<=f;++u)!(u<f&&r(d=c[u],u,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,u,c),+t(d,u,c));if(p)return i=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:dt(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:dt(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:dt(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function z0(e,t,r){var n=null,a=dt(!0),i=null,s=um,o=null,c=rb(u);e=typeof e=="function"?e:e===void 0?yA:dt(+e),t=typeof t=="function"?t:dt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?bA:dt(+r);function u(d){var h,p,v,x=(d=nb(d)).length,y,g=!1,b,m=new Array(x),S=new Array(x);for(i==null&&(o=s(b=c())),h=0;h<=x;++h){if(!(h<x&&a(y=d[h],h,d))===g)if(g=!g)p=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=h-1;v>=p;--v)o.point(m[v],S[v]);o.lineEnd(),o.areaEnd()}g&&(m[h]=+e(y,h,d),S[h]=+t(y,h,d),o.point(n?+n(y,h,d):m[h],r?+r(y,h,d):S[h]))}if(b)return o=null,b+""||null}function f(){return wA().defined(a).curve(s).context(i)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:dt(+d),n=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:dt(+d),u):e},u.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:dt(+d),u):n},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:dt(+d),r=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:dt(+d),u):t},u.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:dt(+d),u):r},u.lineX0=u.lineY0=function(){return f().x(e).y(t)},u.lineY1=function(){return f().x(e).y(r)},u.lineX1=function(){return f().x(n).y(t)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:dt(!!d),u):a},u.curve=function(d){return arguments.length?(s=d,i!=null&&(o=s(i)),u):s},u.context=function(d){return arguments.length?(d==null?i=o=null:o=s(i=d),u):i},u}class _A{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function uB(e){return new _A(e,!0)}function fB(e){return new _A(e,!1)}const ab={draw(e,t){const r=Ma(t/ah);e.moveTo(r,0),e.arc(0,0,r,0,cm)}},dB={draw(e,t){const r=Ma(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},SA=Ma(1/3),hB=SA*2,pB={draw(e,t){const r=Ma(t/hB),n=r*SA;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},mB={draw(e,t){const r=Ma(t),n=-r/2;e.rect(n,n,r,r)}},xB=.8908130915292852,kA=nh(ah/10)/nh(7*ah/10),vB=nh(cm/10)*kA,gB=-xA(cm/10)*kA,yB={draw(e,t){const r=Ma(t*xB),n=vB*r,a=gB*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=cm*i/5,o=xA(s),c=nh(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},Ex=Ma(3),bB={draw(e,t){const r=-Ma(t/(Ex*3));e.moveTo(0,r*2),e.lineTo(-Ex*r,-r),e.lineTo(Ex*r,-r),e.closePath()}},Bn=-.5,Un=Ma(3)/2,yg=1/Ma(12),wB=(yg/2+1)*3,_B={draw(e,t){const r=Ma(t/wB),n=r/2,a=r*yg,i=n,s=r*yg+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(Bn*n-Un*a,Un*n+Bn*a),e.lineTo(Bn*i-Un*s,Un*i+Bn*s),e.lineTo(Bn*o-Un*c,Un*o+Bn*c),e.lineTo(Bn*n+Un*a,Bn*a-Un*n),e.lineTo(Bn*i+Un*s,Bn*s-Un*i),e.lineTo(Bn*o+Un*c,Bn*c-Un*o),e.closePath()}};function SB(e,t){let r=null,n=rb(a);e=typeof e=="function"?e:dt(e||ab),t=typeof t=="function"?t:dt(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:dt(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:dt(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function ih(){}function sh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function NA(e){this._context=e}NA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:sh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:sh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kB(e){return new NA(e)}function jA(e){this._context=e}jA.prototype={areaStart:ih,areaEnd:ih,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:sh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function NB(e){return new jA(e)}function EA(e){this._context=e}EA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:sh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jB(e){return new EA(e)}function TA(e){this._context=e}TA.prototype={areaStart:ih,areaEnd:ih,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function EB(e){return new TA(e)}function x_(e){return e<0?-1:1}function v_(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(x_(i)+x_(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function g_(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Tx(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function oh(e){this._context=e}oh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Tx(this,this._t0,g_(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Tx(this,g_(this,r=v_(this,e,t)),r);break;default:Tx(this,this._t0,r=v_(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function AA(e){this._context=new OA(e)}(AA.prototype=Object.create(oh.prototype)).point=function(e,t){oh.prototype.point.call(this,t,e)};function OA(e){this._context=e}OA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function TB(e){return new oh(e)}function AB(e){return new AA(e)}function CA(e){this._context=e}CA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=y_(e),a=y_(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function y_(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function OB(e){return new CA(e)}function fm(e,t){this._context=e,this._t=t}fm.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function CB(e){return new fm(e,.5)}function PB(e){return new fm(e,0)}function MB(e){return new fm(e,1)}function Cl(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function bg(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function FB(e,t){return e[t]}function DB(e){const t=[];return t.key=e,t}function IB(){var e=dt([]),t=bg,r=Cl,n=FB;function a(i){var s=Array.from(e.apply(this,arguments),DB),o,c=s.length,u=-1,f;for(const d of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(d,s[o].key,u,i)]).data=d;for(o=0,f=nb(t(s));o<c;++o)s[f[o]].index=o;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:dt(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:dt(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?bg:typeof i=="function"?i:dt(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Cl,a):r},a}function RB(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Cl(e,t)}}function $B(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Cl(e,t)}}function LB(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var f=e[t[o]],d=f[n][1]||0,h=f[n-1][1]||0,p=(d-h)/2,v=0;v<o;++v){var x=e[t[v]],y=x[n][1]||0,g=x[n-1][1]||0;p+=y-g}c+=d,u+=p*d}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Cl(e,t)}}function Ju(e){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(e)}var BB=["type","size","sizeType"];function wg(){return wg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wg.apply(this,arguments)}function b_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b_(Object(r),!0).forEach(function(n){UB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UB(e,t,r){return t=zB(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zB(e){var t=WB(e,"string");return Ju(t)=="symbol"?t:t+""}function WB(e,t){if(Ju(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ju(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HB(e,t){if(e==null)return{};var r=VB(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function VB(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var PA={symbolCircle:ab,symbolCross:dB,symbolDiamond:pB,symbolSquare:mB,symbolStar:yB,symbolTriangle:bB,symbolWye:_B},GB=Math.PI/180,XB=function(t){var r="symbol".concat(lm(t));return PA[r]||ab},KB=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*GB;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},qB=function(t,r){PA["symbol".concat(lm(t))]=r},ib=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,o=s===void 0?"area":s,c=HB(t,BB),u=w_(w_({},c),{},{type:n,size:i,sizeType:o}),f=function(){var y=XB(n),g=SB().type(y).size(KB(i,o,n));return g()},d=u.className,h=u.cx,p=u.cy,v=Ce(u,!0);return h===+h&&p===+p&&i===+i?Y.createElement("path",wg({},v,{className:ze("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(p,")"),d:f()})):null};ib.registerSymbol=qB;function Pl(e){"@babel/helpers - typeof";return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pl(e)}function _g(){return _g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_g.apply(this,arguments)}function __(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?__(Object(r),!0).forEach(function(n){ef(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):__(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FA(n.key),n)}}function JB(e,t,r){return t&&ZB(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function e7(e,t,r){return t=lh(t),t7(e,MA()?Reflect.construct(t,r||[],lh(e).constructor):t.apply(e,r))}function t7(e,t){if(t&&(Pl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r7(e)}function r7(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MA=function(){return!!e})()}function lh(e){return lh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lh(e)}function n7(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sg(e,t)}function Sg(e,t){return Sg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Sg(e,t)}function ef(e,t,r){return t=FA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FA(e){var t=a7(e,"string");return Pl(t)=="symbol"?t:t+""}function a7(e,t){if(Pl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zn=32,sb=function(e){function t(){return QB(this,t),e7(this,t,arguments)}return n7(t,e),JB(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=zn/2,s=zn/6,o=zn/3,c=n.inactive?a:n.color;if(n.type==="plainline")return Y.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:zn,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return Y.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(zn,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return Y.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(zn/8,"h").concat(zn,"v").concat(zn*3/4,"h").concat(-zn,"z"),className:"recharts-legend-icon"});if(Y.isValidElement(n.legendIcon)){var u=YB({},n);return delete u.legendIcon,Y.cloneElement(n.legendIcon,u)}return Y.createElement(ib,{fill:c,cx:i,cy:i,size:zn,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,o=a.layout,c=a.formatter,u=a.inactiveColor,f={x:0,y:0,width:zn,height:zn},d={display:o==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(p,v){var x=p.formatter||c,y=ze(ef(ef({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",p.inactive));if(p.type==="none")return null;var g=Ie(p.value)?null:p.value;Ta(!Ie(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?u:p.color;return Y.createElement("li",_g({className:y,style:d,key:"legend-item-".concat(v)},oo(n.props,p,v)),Y.createElement(hg,{width:s,height:s,viewBox:f,style:h},n.renderIcon(p)),Y.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},x?x(g,p,v):g))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var o={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return Y.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(G.PureComponent);ef(sb,"displayName","Legend");ef(sb,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var i7=qp;function s7(){this.__data__=new i7,this.size=0}var o7=s7;function l7(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var c7=l7;function u7(e){return this.__data__.get(e)}var f7=u7;function d7(e){return this.__data__.has(e)}var h7=d7,p7=qp,m7=Xy,x7=Ky,v7=200;function g7(e,t){var r=this.__data__;if(r instanceof p7){var n=r.__data__;if(!m7||n.length<v7-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new x7(n)}return r.set(e,t),this.size=r.size,this}var y7=g7,b7=qp,w7=o7,_7=c7,S7=f7,k7=h7,N7=y7;function yc(e){var t=this.__data__=new b7(e);this.size=t.size}yc.prototype.clear=w7;yc.prototype.delete=_7;yc.prototype.get=S7;yc.prototype.has=k7;yc.prototype.set=N7;var DA=yc,j7="__lodash_hash_undefined__";function E7(e){return this.__data__.set(e,j7),this}var T7=E7;function A7(e){return this.__data__.has(e)}var O7=A7,C7=Ky,P7=T7,M7=O7;function ch(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new C7;++t<r;)this.add(e[t])}ch.prototype.add=ch.prototype.push=P7;ch.prototype.has=M7;var IA=ch;function F7(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var RA=F7;function D7(e,t){return e.has(t)}var $A=D7,I7=IA,R7=RA,$7=$A,L7=1,B7=2;function U7(e,t,r,n,a,i){var s=r&L7,o=e.length,c=t.length;if(o!=c&&!(s&&c>o))return!1;var u=i.get(e),f=i.get(t);if(u&&f)return u==t&&f==e;var d=-1,h=!0,p=r&B7?new I7:void 0;for(i.set(e,t),i.set(t,e);++d<o;){var v=e[d],x=t[d];if(n)var y=s?n(x,v,d,t,e,i):n(v,x,d,e,t,i);if(y!==void 0){if(y)continue;h=!1;break}if(p){if(!R7(t,function(g,b){if(!$7(p,b)&&(v===g||a(v,g,r,n,i)))return p.push(b)})){h=!1;break}}else if(!(v===x||a(v,x,r,n,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var LA=U7,z7=Qa,W7=z7.Uint8Array,H7=W7;function V7(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var G7=V7;function X7(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var ob=X7,S_=r0,k_=H7,K7=Gy,q7=LA,Y7=G7,Q7=ob,Z7=1,J7=2,e9="[object Boolean]",t9="[object Date]",r9="[object Error]",n9="[object Map]",a9="[object Number]",i9="[object RegExp]",s9="[object Set]",o9="[object String]",l9="[object Symbol]",c9="[object ArrayBuffer]",u9="[object DataView]",N_=S_?S_.prototype:void 0,Ax=N_?N_.valueOf:void 0;function f9(e,t,r,n,a,i,s){switch(r){case u9:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case c9:return!(e.byteLength!=t.byteLength||!i(new k_(e),new k_(t)));case e9:case t9:case a9:return K7(+e,+t);case r9:return e.name==t.name&&e.message==t.message;case i9:case o9:return e==t+"";case n9:var o=Y7;case s9:var c=n&Z7;if(o||(o=Q7),e.size!=t.size&&!c)return!1;var u=s.get(e);if(u)return u==t;n|=J7,s.set(e,t);var f=q7(o(e),o(t),n,a,i,s);return s.delete(e),f;case l9:if(Ax)return Ax.call(e)==Ax.call(t)}return!1}var d9=f9;function h9(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var BA=h9,p9=BA,m9=bn;function x9(e,t,r){var n=t(e);return m9(e)?n:p9(n,r(e))}var v9=x9;function g9(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var y9=g9;function b9(){return[]}var w9=b9,_9=y9,S9=w9,k9=Object.prototype,N9=k9.propertyIsEnumerable,j_=Object.getOwnPropertySymbols,j9=j_?function(e){return e==null?[]:(e=Object(e),_9(j_(e),function(t){return N9.call(e,t)}))}:S9,E9=j9;function T9(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var A9=T9,O9=Ti,C9=Ai,P9="[object Arguments]";function M9(e){return C9(e)&&O9(e)==P9}var F9=M9,E_=F9,D9=Ai,UA=Object.prototype,I9=UA.hasOwnProperty,R9=UA.propertyIsEnumerable,$9=E_(function(){return arguments}())?E_:function(e){return D9(e)&&I9.call(e,"callee")&&!R9.call(e,"callee")},lb=$9,uh={exports:{}};function L9(){return!1}var B9=L9;uh.exports;(function(e,t){var r=Qa,n=B9,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,o=s?r.Buffer:void 0,c=o?o.isBuffer:void 0,u=c||n;e.exports=u})(uh,uh.exports);var zA=uh.exports,U9=9007199254740991,z9=/^(?:0|[1-9]\d*)$/;function W9(e,t){var r=typeof e;return t=t??U9,!!t&&(r=="number"||r!="symbol"&&z9.test(e))&&e>-1&&e%1==0&&e<t}var cb=W9,H9=9007199254740991;function V9(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H9}var ub=V9,G9=Ti,X9=ub,K9=Ai,q9="[object Arguments]",Y9="[object Array]",Q9="[object Boolean]",Z9="[object Date]",J9="[object Error]",eU="[object Function]",tU="[object Map]",rU="[object Number]",nU="[object Object]",aU="[object RegExp]",iU="[object Set]",sU="[object String]",oU="[object WeakMap]",lU="[object ArrayBuffer]",cU="[object DataView]",uU="[object Float32Array]",fU="[object Float64Array]",dU="[object Int8Array]",hU="[object Int16Array]",pU="[object Int32Array]",mU="[object Uint8Array]",xU="[object Uint8ClampedArray]",vU="[object Uint16Array]",gU="[object Uint32Array]",gt={};gt[uU]=gt[fU]=gt[dU]=gt[hU]=gt[pU]=gt[mU]=gt[xU]=gt[vU]=gt[gU]=!0;gt[q9]=gt[Y9]=gt[lU]=gt[Q9]=gt[cU]=gt[Z9]=gt[J9]=gt[eU]=gt[tU]=gt[rU]=gt[nU]=gt[aU]=gt[iU]=gt[sU]=gt[oU]=!1;function yU(e){return K9(e)&&X9(e.length)&&!!gt[G9(e)]}var bU=yU;function wU(e){return function(t){return e(t)}}var WA=wU,fh={exports:{}};fh.exports;(function(e,t){var r=QT,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,o=function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=o})(fh,fh.exports);var _U=fh.exports,SU=bU,kU=WA,T_=_U,A_=T_&&T_.isTypedArray,NU=A_?kU(A_):SU,HA=NU,jU=A9,EU=lb,TU=bn,AU=zA,OU=cb,CU=HA,PU=Object.prototype,MU=PU.hasOwnProperty;function FU(e,t){var r=TU(e),n=!r&&EU(e),a=!r&&!n&&AU(e),i=!r&&!n&&!a&&CU(e),s=r||n||a||i,o=s?jU(e.length,String):[],c=o.length;for(var u in e)(t||MU.call(e,u))&&!(s&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||OU(u,c)))&&o.push(u);return o}var DU=FU,IU=Object.prototype;function RU(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||IU;return e===r}var $U=RU;function LU(e,t){return function(r){return e(t(r))}}var VA=LU,BU=VA,UU=BU(Object.keys,Object),zU=UU,WU=$U,HU=zU,VU=Object.prototype,GU=VU.hasOwnProperty;function XU(e){if(!WU(e))return HU(e);var t=[];for(var r in Object(e))GU.call(e,r)&&r!="constructor"&&t.push(r);return t}var KU=XU,qU=Vy,YU=ub;function QU(e){return e!=null&&YU(e.length)&&!qU(e)}var a0=QU,ZU=DU,JU=KU,ez=a0;function tz(e){return ez(e)?ZU(e):JU(e)}var dm=tz,rz=v9,nz=E9,az=dm;function iz(e){return rz(e,az,nz)}var sz=iz,O_=sz,oz=1,lz=Object.prototype,cz=lz.hasOwnProperty;function uz(e,t,r,n,a,i){var s=r&oz,o=O_(e),c=o.length,u=O_(t),f=u.length;if(c!=f&&!s)return!1;for(var d=c;d--;){var h=o[d];if(!(s?h in t:cz.call(t,h)))return!1}var p=i.get(e),v=i.get(t);if(p&&v)return p==t&&v==e;var x=!0;i.set(e,t),i.set(t,e);for(var y=s;++d<c;){h=o[d];var g=e[h],b=t[h];if(n)var m=s?n(b,g,h,t,e,i):n(g,b,h,e,t,i);if(!(m===void 0?g===b||a(g,b,r,n,i):m)){x=!1;break}y||(y=h=="constructor")}if(x&&!y){var S=e.constructor,w=t.constructor;S!=w&&"constructor"in e&&"constructor"in t&&!(typeof S=="function"&&S instanceof S&&typeof w=="function"&&w instanceof w)&&(x=!1)}return i.delete(e),i.delete(t),x}var fz=uz,dz=_o,hz=Qa,pz=dz(hz,"DataView"),mz=pz,xz=_o,vz=Qa,gz=xz(vz,"Promise"),yz=gz,bz=_o,wz=Qa,_z=bz(wz,"Set"),GA=_z,Sz=_o,kz=Qa,Nz=Sz(kz,"WeakMap"),jz=Nz,kg=mz,Ng=Xy,jg=yz,Eg=GA,Tg=jz,XA=Ti,bc=JT,C_="[object Map]",Ez="[object Object]",P_="[object Promise]",M_="[object Set]",F_="[object WeakMap]",D_="[object DataView]",Tz=bc(kg),Az=bc(Ng),Oz=bc(jg),Cz=bc(Eg),Pz=bc(Tg),Ds=XA;(kg&&Ds(new kg(new ArrayBuffer(1)))!=D_||Ng&&Ds(new Ng)!=C_||jg&&Ds(jg.resolve())!=P_||Eg&&Ds(new Eg)!=M_||Tg&&Ds(new Tg)!=F_)&&(Ds=function(e){var t=XA(e),r=t==Ez?e.constructor:void 0,n=r?bc(r):"";if(n)switch(n){case Tz:return D_;case Az:return C_;case Oz:return P_;case Cz:return M_;case Pz:return F_}return t});var Mz=Ds,Ox=DA,Fz=LA,Dz=d9,Iz=fz,I_=Mz,R_=bn,$_=zA,Rz=HA,$z=1,L_="[object Arguments]",B_="[object Array]",W0="[object Object]",Lz=Object.prototype,U_=Lz.hasOwnProperty;function Bz(e,t,r,n,a,i){var s=R_(e),o=R_(t),c=s?B_:I_(e),u=o?B_:I_(t);c=c==L_?W0:c,u=u==L_?W0:u;var f=c==W0,d=u==W0,h=c==u;if(h&&$_(e)){if(!$_(t))return!1;s=!0,f=!1}if(h&&!f)return i||(i=new Ox),s||Rz(e)?Fz(e,t,r,n,a,i):Dz(e,t,c,r,n,a,i);if(!(r&$z)){var p=f&&U_.call(e,"__wrapped__"),v=d&&U_.call(t,"__wrapped__");if(p||v){var x=p?e.value():e,y=v?t.value():t;return i||(i=new Ox),a(x,y,r,n,i)}}return h?(i||(i=new Ox),Iz(e,t,r,n,a,i)):!1}var Uz=Bz,zz=Uz,z_=Ai;function KA(e,t,r,n,a){return e===t?!0:e==null||t==null||!z_(e)&&!z_(t)?e!==e&&t!==t:zz(e,t,r,n,KA,a)}var fb=KA,Wz=DA,Hz=fb,Vz=1,Gz=2;function Xz(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var o=r[a];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<i;){o=r[a];var c=o[0],u=e[c],f=o[1];if(s&&o[2]){if(u===void 0&&!(c in e))return!1}else{var d=new Wz;if(n)var h=n(u,f,c,e,t,d);if(!(h===void 0?Hz(f,u,Vz|Gz,n,d):h))return!1}}return!0}var Kz=Xz,qz=xs;function Yz(e){return e===e&&!qz(e)}var qA=Yz,Qz=qA,Zz=dm;function Jz(e){for(var t=Zz(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,Qz(a)]}return t}var eW=Jz;function tW(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var YA=tW,rW=Kz,nW=eW,aW=YA;function iW(e){var t=nW(e);return t.length==1&&t[0][2]?aW(t[0][0],t[0][1]):function(r){return r===e||rW(r,e,t)}}var sW=iW;function oW(e,t){return e!=null&&t in Object(e)}var lW=oW,cW=aA,uW=lb,fW=bn,dW=cb,hW=ub,pW=Qp;function mW(e,t,r){t=cW(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=pW(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&hW(a)&&dW(s,a)&&(fW(e)||uW(e)))}var xW=mW,vW=lW,gW=xW;function yW(e,t){return e!=null&&gW(e,t,vW)}var bW=yW,wW=fb,_W=iA,SW=bW,kW=Hy,NW=qA,jW=YA,EW=Qp,TW=1,AW=2;function OW(e,t){return kW(e)&&NW(t)?jW(EW(e),t):function(r){var n=_W(r,e);return n===void 0&&n===t?SW(r,e):wW(t,n,TW|AW)}}var CW=OW;function PW(e){return e}var wc=PW;function MW(e){return function(t){return t==null?void 0:t[e]}}var FW=MW,DW=Qy;function IW(e){return function(t){return DW(t,e)}}var RW=IW,$W=FW,LW=RW,BW=Hy,UW=Qp;function zW(e){return BW(e)?$W(UW(e)):LW(e)}var WW=zW,HW=sW,VW=CW,GW=wc,XW=bn,KW=WW;function qW(e){return typeof e=="function"?e:e==null?GW:typeof e=="object"?XW(e)?VW(e[0],e[1]):HW(e):KW(e)}var Za=qW;function YW(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var QA=YW;function QW(e){return e!==e}var ZW=QW;function JW(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var eH=JW,tH=QA,rH=ZW,nH=eH;function aH(e,t,r){return t===t?nH(e,t,r):tH(e,rH,r)}var iH=aH,sH=iH;function oH(e,t){var r=e==null?0:e.length;return!!r&&sH(e,t,0)>-1}var lH=oH;function cH(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var uH=cH;function fH(){}var dH=fH,Cx=GA,hH=dH,pH=ob,mH=1/0,xH=Cx&&1/pH(new Cx([,-0]))[1]==mH?function(e){return new Cx(e)}:hH,vH=xH,gH=IA,yH=lH,bH=uH,wH=$A,_H=vH,SH=ob,kH=200;function NH(e,t,r){var n=-1,a=yH,i=e.length,s=!0,o=[],c=o;if(r)s=!1,a=bH;else if(i>=kH){var u=t?null:_H(e);if(u)return SH(u);s=!1,a=wH,c=new gH}else c=t?[]:o;e:for(;++n<i;){var f=e[n],d=t?t(f):f;if(f=r||f!==0?f:0,s&&d===d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(f)}else a(c,d,r)||(c!==o&&c.push(d),o.push(f))}return o}var jH=NH,EH=Za,TH=jH;function AH(e,t){return e&&e.length?TH(e,EH(t)):[]}var OH=AH;const W_=st(OH);function ZA(e,t,r){return t===!0?W_(e,r):Ie(t)?W_(e,t):e}function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}var CH=["ref"];function H_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ri(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H_(Object(r),!0).forEach(function(n){hm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V_(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eO(n.key),n)}}function MH(e,t,r){return t&&V_(e.prototype,t),r&&V_(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FH(e,t,r){return t=dh(t),DH(e,JA()?Reflect.construct(t,r||[],dh(e).constructor):t.apply(e,r))}function DH(e,t){if(t&&(Ml(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IH(e)}function IH(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JA=function(){return!!e})()}function dh(e){return dh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dh(e)}function RH(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ag(e,t)}function Ag(e,t){return Ag=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Ag(e,t)}function hm(e,t,r){return t=eO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eO(e){var t=$H(e,"string");return Ml(t)=="symbol"?t:t+""}function $H(e,t){if(Ml(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ml(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function LH(e,t){if(e==null)return{};var r=BH(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function BH(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function UH(e){return e.value}function zH(e,t){if(Y.isValidElement(e))return Y.cloneElement(e,t);if(typeof e=="function")return Y.createElement(e,t);t.ref;var r=LH(t,CH);return Y.createElement(sb,r)}var G_=1,Aa=function(e){function t(){var r;PH(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=FH(this,t,[].concat(a)),hm(r,"lastBoundingBox",{width:-1,height:-1}),r}return RH(t,e),MH(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>G_||Math.abs(a.height-this.lastBoundingBox.height)>G_)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ri({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,o=a.verticalAlign,c=a.margin,u=a.chartWidth,f=a.chartHeight,d,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var p=this.getBBoxSnapshot();d={left:((u||0)-p.width)/2}}else d=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(o==="middle"){var v=this.getBBoxSnapshot();h={top:((f||0)-v.height)/2}}else h=o==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return ri(ri({},d),h)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,o=a.height,c=a.wrapperStyle,u=a.payloadUniqBy,f=a.payload,d=ri(ri({position:"absolute",width:s||"auto",height:o||"auto"},this.getDefaultPosition(c)),c);return Y.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(p){n.wrapperNode=p}},zH(i,ri(ri({},this.props),{},{payload:ZA(f,u,UH)})))}}],[{key:"getWithHeight",value:function(n,a){var i=ri(ri({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&ve(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(G.PureComponent);hm(Aa,"displayName","Legend");hm(Aa,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var X_=r0,WH=lb,HH=bn,K_=X_?X_.isConcatSpreadable:void 0;function VH(e){return HH(e)||WH(e)||!!(K_&&e&&e[K_])}var GH=VH,XH=BA,KH=GH;function tO(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=KH),a||(a=[]);++i<s;){var o=e[i];t>0&&r(o)?t>1?tO(o,t-1,r,n,a):XH(a,o):n||(a[a.length]=o)}return a}var rO=tO;function qH(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),o=s.length;o--;){var c=s[e?o:++a];if(r(i[c],c,i)===!1)break}return t}}var YH=qH,QH=YH,ZH=QH(),JH=ZH,eV=JH,tV=dm;function rV(e,t){return e&&eV(e,t,tV)}var nO=rV,nV=a0;function aV(e,t){return function(r,n){if(r==null)return r;if(!nV(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var iV=aV,sV=nO,oV=iV,lV=oV(sV),db=lV,cV=db,uV=a0;function fV(e,t){var r=-1,n=uV(e)?Array(e.length):[];return cV(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var aO=fV;function dV(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var hV=dV,q_=hc;function pV(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=q_(e),s=t!==void 0,o=t===null,c=t===t,u=q_(t);if(!o&&!u&&!i&&e>t||i&&s&&c&&!o&&!u||n&&s&&c||!r&&c||!a)return 1;if(!n&&!i&&!u&&e<t||u&&r&&a&&!n&&!i||o&&r&&a||!s&&a||!c)return-1}return 0}var mV=pV,xV=mV;function vV(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,o=r.length;++n<s;){var c=xV(a[n],i[n]);if(c){if(n>=o)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return e.index-t.index}var gV=vV,Px=Yy,yV=Qy,bV=Za,wV=aO,_V=hV,SV=WA,kV=gV,NV=wc,jV=bn;function EV(e,t,r){t.length?t=Px(t,function(i){return jV(i)?function(s){return yV(s,i.length===1?i[0]:i)}:i}):t=[NV];var n=-1;t=Px(t,SV(bV));var a=wV(e,function(i,s,o){var c=Px(t,function(u){return u(i)});return{criteria:c,index:++n,value:i}});return _V(a,function(i,s){return kV(i,s,r)})}var TV=EV;function AV(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var OV=AV,CV=OV,Y_=Math.max;function PV(e,t,r){return t=Y_(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=Y_(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(s),CV(e,this,o)}}var MV=PV;function FV(e){return function(){return e}}var DV=FV,IV=_o,RV=function(){try{var e=IV(Object,"defineProperty");return e({},"",{}),e}catch{}}(),iO=RV,$V=DV,Q_=iO,LV=wc,BV=Q_?function(e,t){return Q_(e,"toString",{configurable:!0,enumerable:!1,value:$V(t),writable:!0})}:LV,UV=BV,zV=800,WV=16,HV=Date.now;function VV(e){var t=0,r=0;return function(){var n=HV(),a=WV-(n-r);if(r=n,a>0){if(++t>=zV)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var GV=VV,XV=UV,KV=GV,qV=KV(XV),YV=qV,QV=wc,ZV=MV,JV=YV;function eG(e,t){return JV(ZV(e,t,QV),e+"")}var tG=eG,rG=Gy,nG=a0,aG=cb,iG=xs;function sG(e,t,r){if(!iG(r))return!1;var n=typeof t;return(n=="number"?nG(r)&&aG(t,r.length):n=="string"&&t in r)?rG(r[t],e):!1}var pm=sG,oG=rO,lG=TV,cG=tG,Z_=pm,uG=cG(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Z_(e,t[0],t[1])?t=[]:r>2&&Z_(t[0],t[1],t[2])&&(t=[t[0]]),lG(e,oG(t,1),[])}),fG=uG;const hb=st(fG);function tf(e){"@babel/helpers - typeof";return tf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(e)}function Og(){return Og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Og.apply(this,arguments)}function dG(e,t){return xG(e)||mG(e,t)||pG(e,t)||hG()}function hG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pG(e,t){if(e){if(typeof e=="string")return J_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return J_(e,t)}}function J_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function xG(e){if(Array.isArray(e))return e}function eS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eS(Object(r),!0).forEach(function(n){vG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vG(e,t,r){return t=gG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gG(e){var t=yG(e,"string");return tf(t)=="symbol"?t:t+""}function yG(e,t){if(tf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bG(e){return Array.isArray(e)&&cr(e[0])&&cr(e[1])?e.join(" ~ "):e}var wG=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,o=s===void 0?{}:s,c=t.labelStyle,u=c===void 0?{}:c,f=t.payload,d=t.formatter,h=t.itemSorter,p=t.wrapperClassName,v=t.labelClassName,x=t.label,y=t.labelFormatter,g=t.accessibilityLayer,b=g===void 0?!1:g,m=function(){if(f&&f.length){var T={padding:0,margin:0},L=(h?hb(f,h):f).map(function(X,M){if(X.type==="none")return null;var U=Mx({display:"block",paddingTop:4,paddingBottom:4,color:X.color||"#000"},o),q=X.formatter||d||bG,K=X.value,F=X.name,Q=K,ie=F;if(q&&Q!=null&&ie!=null){var A=q(K,F,X,M,f);if(Array.isArray(A)){var R=dG(A,2);Q=R[0],ie=R[1]}else Q=A}return Y.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:U},cr(ie)?Y.createElement("span",{className:"recharts-tooltip-item-name"},ie):null,cr(ie)?Y.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Y.createElement("span",{className:"recharts-tooltip-item-value"},Q),Y.createElement("span",{className:"recharts-tooltip-item-unit"},X.unit||""))});return Y.createElement("ul",{className:"recharts-tooltip-item-list",style:T},L)}return null},S=Mx({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),w=Mx({margin:0},u),_=!$e(x),k=_?x:"",N=ze("recharts-default-tooltip",p),j=ze("recharts-tooltip-label",v);_&&y&&f!==void 0&&f!==null&&(k=y(x,f));var E=b?{role:"status","aria-live":"assertive"}:{};return Y.createElement("div",Og({className:N,style:S},E),Y.createElement("p",{className:j,style:w},Y.isValidElement(k)?k:"".concat(k)),m())};function rf(e){"@babel/helpers - typeof";return rf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rf(e)}function H0(e,t,r){return t=_G(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _G(e){var t=SG(e,"string");return rf(t)=="symbol"?t:t+""}function SG(e,t){if(rf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hc="recharts-tooltip-wrapper",kG={visibility:"hidden"};function NG(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ze(Hc,H0(H0(H0(H0({},"".concat(Hc,"-right"),ve(r)&&t&&ve(t.x)&&r>=t.x),"".concat(Hc,"-left"),ve(r)&&t&&ve(t.x)&&r<t.x),"".concat(Hc,"-bottom"),ve(n)&&t&&ve(t.y)&&n>=t.y),"".concat(Hc,"-top"),ve(n)&&t&&ve(t.y)&&n<t.y))}function tS(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,o=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&ve(i[n]))return i[n];var f=r[n]-o-a,d=r[n]+a;if(t[n])return s[n]?f:d;if(s[n]){var h=f,p=c[n];return h<p?Math.max(d,c[n]):Math.max(f,c[n])}var v=d+o,x=c[n]+u;return v>x?Math.max(f,c[n]):Math.max(d,c[n])}function jG(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function EG(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,o=e.useTranslate3d,c=e.viewBox,u,f,d;return s.height>0&&s.width>0&&r?(f=tS({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),d=tS({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=jG({translateX:f,translateY:d,useTranslate3d:o})):u=kG,{cssProperties:u,cssClasses:NG({translateX:f,translateY:d,coordinate:r})}}function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}function rS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rS(Object(r),!0).forEach(function(n){Pg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oO(n.key),n)}}function OG(e,t,r){return t&&AG(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function CG(e,t,r){return t=hh(t),PG(e,sO()?Reflect.construct(t,r||[],hh(e).constructor):t.apply(e,r))}function PG(e,t){if(t&&(Fl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MG(e)}function MG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(sO=function(){return!!e})()}function hh(e){return hh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hh(e)}function FG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Cg(e,t)}function Cg(e,t){return Cg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Cg(e,t)}function Pg(e,t,r){return t=oO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oO(e){var t=DG(e,"string");return Fl(t)=="symbol"?t:t+""}function DG(e,t){if(Fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aS=1,IG=function(e){function t(){var r;TG(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=CG(this,t,[].concat(a)),Pg(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),Pg(r,"handleKeyDown",function(s){if(s.key==="Escape"){var o,c,u,f;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&o!==void 0?o:0,y:(u=(f=r.props.coordinate)===null||f===void 0?void 0:f.y)!==null&&u!==void 0?u:0}})}}),r}return FG(t,e),OG(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>aS||Math.abs(n.height-this.state.lastBoundingBox.height)>aS)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.children,f=a.coordinate,d=a.hasPayload,h=a.isAnimationActive,p=a.offset,v=a.position,x=a.reverseDirection,y=a.useTranslate3d,g=a.viewBox,b=a.wrapperStyle,m=EG({allowEscapeViewBox:s,coordinate:f,offsetTopLeft:p,position:v,reverseDirection:x,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:g}),S=m.cssClasses,w=m.cssProperties,_=nS(nS({transition:h&&i?"transform ".concat(o,"ms ").concat(c):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&d?"visible":"hidden",position:"absolute",top:0,left:0},b);return Y.createElement("div",{tabIndex:-1,className:S,style:_,ref:function(N){n.wrapperNode=N}},u)}}])}(G.PureComponent),RG=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},So={isSsr:RG()};function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}function iS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iS(Object(r),!0).forEach(function(n){pb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cO(n.key),n)}}function BG(e,t,r){return t&&LG(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UG(e,t,r){return t=ph(t),zG(e,lO()?Reflect.construct(t,r||[],ph(e).constructor):t.apply(e,r))}function zG(e,t){if(t&&(Dl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WG(e)}function WG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lO=function(){return!!e})()}function ph(e){return ph=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ph(e)}function HG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mg(e,t)}function Mg(e,t){return Mg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Mg(e,t)}function pb(e,t,r){return t=cO(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cO(e){var t=VG(e,"string");return Dl(t)=="symbol"?t:t+""}function VG(e,t){if(Dl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function GG(e){return e.dataKey}function XG(e,t){return Y.isValidElement(e)?Y.cloneElement(e,t):typeof e=="function"?Y.createElement(e,t):Y.createElement(wG,t)}var Wt=function(e){function t(){return $G(this,t),UG(this,t,arguments)}return HG(t,e),BG(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,o=a.animationDuration,c=a.animationEasing,u=a.content,f=a.coordinate,d=a.filterNull,h=a.isAnimationActive,p=a.offset,v=a.payload,x=a.payloadUniqBy,y=a.position,g=a.reverseDirection,b=a.useTranslate3d,m=a.viewBox,S=a.wrapperStyle,w=v??[];d&&w.length&&(w=ZA(v.filter(function(k){return k.value!=null&&(k.hide!==!0||n.props.includeHidden)}),x,GG));var _=w.length>0;return Y.createElement(IG,{allowEscapeViewBox:s,animationDuration:o,animationEasing:c,isAnimationActive:h,active:i,coordinate:f,hasPayload:_,offset:p,position:y,reverseDirection:g,useTranslate3d:b,viewBox:m,wrapperStyle:S},XG(u,sS(sS({},this.props),{},{payload:w})))}}])}(G.PureComponent);pb(Wt,"displayName","Tooltip");pb(Wt,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!So.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var KG=Qa,qG=function(){return KG.Date.now()},YG=qG,QG=/\s/;function ZG(e){for(var t=e.length;t--&&QG.test(e.charAt(t)););return t}var JG=ZG,eX=JG,tX=/^\s+/;function rX(e){return e&&e.slice(0,eX(e)+1).replace(tX,"")}var nX=rX,aX=nX,oS=xs,iX=hc,lS=NaN,sX=/^[-+]0x[0-9a-f]+$/i,oX=/^0b[01]+$/i,lX=/^0o[0-7]+$/i,cX=parseInt;function uX(e){if(typeof e=="number")return e;if(iX(e))return lS;if(oS(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=oS(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=aX(e);var r=oX.test(e);return r||lX.test(e)?cX(e.slice(2),r?2:8):sX.test(e)?lS:+e}var uO=uX,fX=xs,Fx=YG,cS=uO,dX="Expected a function",hX=Math.max,pX=Math.min;function mX(e,t,r){var n,a,i,s,o,c,u=0,f=!1,d=!1,h=!0;if(typeof e!="function")throw new TypeError(dX);t=cS(t)||0,fX(r)&&(f=!!r.leading,d="maxWait"in r,i=d?hX(cS(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function p(_){var k=n,N=a;return n=a=void 0,u=_,s=e.apply(N,k),s}function v(_){return u=_,o=setTimeout(g,t),f?p(_):s}function x(_){var k=_-c,N=_-u,j=t-k;return d?pX(j,i-N):j}function y(_){var k=_-c,N=_-u;return c===void 0||k>=t||k<0||d&&N>=i}function g(){var _=Fx();if(y(_))return b(_);o=setTimeout(g,x(_))}function b(_){return o=void 0,h&&n?p(_):(n=a=void 0,s)}function m(){o!==void 0&&clearTimeout(o),u=0,n=c=a=o=void 0}function S(){return o===void 0?s:b(Fx())}function w(){var _=Fx(),k=y(_);if(n=arguments,a=this,c=_,k){if(o===void 0)return v(c);if(d)return clearTimeout(o),o=setTimeout(g,t),p(c)}return o===void 0&&(o=setTimeout(g,t)),s}return w.cancel=m,w.flush=S,w}var xX=mX,vX=xX,gX=xs,yX="Expected a function";function bX(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(yX);return gX(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),vX(e,t,{leading:n,maxWait:t,trailing:a})}var wX=bX;const fO=st(wX);function nf(e){"@babel/helpers - typeof";return nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nf(e)}function uS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uS(Object(r),!0).forEach(function(n){_X(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _X(e,t,r){return t=SX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SX(e){var t=kX(e,"string");return nf(t)=="symbol"?t:t+""}function kX(e,t){if(nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NX(e,t){return AX(e)||TX(e,t)||EX(e,t)||jX()}function jX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EX(e,t){if(e){if(typeof e=="string")return fS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fS(e,t)}}function fS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function TX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function AX(e){if(Array.isArray(e))return e}var sa=G.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,o=e.height,c=o===void 0?"100%":o,u=e.minWidth,f=u===void 0?0:u,d=e.minHeight,h=e.maxHeight,p=e.children,v=e.debounce,x=v===void 0?0:v,y=e.id,g=e.className,b=e.onResize,m=e.style,S=m===void 0?{}:m,w=G.useRef(null),_=G.useRef();_.current=b,G.useImperativeHandle(t,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var k=G.useState({containerWidth:a.width,containerHeight:a.height}),N=NX(k,2),j=N[0],E=N[1],O=G.useCallback(function(L,X){E(function(M){var U=Math.round(L),q=Math.round(X);return M.containerWidth===U&&M.containerHeight===q?M:{containerWidth:U,containerHeight:q}})},[]);G.useEffect(function(){var L=function(F){var Q,ie=F[0].contentRect,A=ie.width,R=ie.height;O(A,R),(Q=_.current)===null||Q===void 0||Q.call(_,A,R)};x>0&&(L=fO(L,x,{trailing:!0,leading:!1}));var X=new ResizeObserver(L),M=w.current.getBoundingClientRect(),U=M.width,q=M.height;return O(U,q),X.observe(w.current),function(){X.disconnect()}},[O,x]);var T=G.useMemo(function(){var L=j.containerWidth,X=j.containerHeight;if(L<0||X<0)return null;Ta(zs(s)||zs(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),Ta(!r||r>0,"The aspect(%s) must be greater than zero.",r);var M=zs(s)?L:s,U=zs(c)?X:c;r&&r>0&&(M?U=M/r:U&&(M=U*r),h&&U>h&&(U=h)),Ta(M>0||U>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,M,U,s,c,f,d,r);var q=!Array.isArray(p)&&hi(p.type).endsWith("Chart");return Y.Children.map(p,function(K){return Y.isValidElement(K)?G.cloneElement(K,V0({width:M,height:U},q?{style:V0({height:"100%",width:"100%",maxHeight:U,maxWidth:M},K.props.style)}:{})):K})},[r,p,c,h,d,f,j,s]);return Y.createElement("div",{id:y?"".concat(y):void 0,className:ze("recharts-responsive-container",g),style:V0(V0({},S),{},{width:s,height:c,minWidth:f,minHeight:d,maxHeight:h}),ref:w},T)}),Oi=function(t){return null};Oi.displayName="Cell";function af(e){"@babel/helpers - typeof";return af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},af(e)}function dS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dS(Object(r),!0).forEach(function(n){OX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OX(e,t,r){return t=CX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CX(e){var t=PX(e,"string");return af(t)=="symbol"?t:t+""}function PX(e,t){if(af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Do={widthCache:{},cacheCount:0},MX=2e3,FX={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},hS="recharts_measurement_span";function DX(e){var t=Fg({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var wu=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||So.isSsr)return{width:0,height:0};var n=DX(r),a=JSON.stringify({text:t,copyStyle:n});if(Do.widthCache[a])return Do.widthCache[a];try{var i=document.getElementById(hS);i||(i=document.createElement("span"),i.setAttribute("id",hS),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=Fg(Fg({},FX),n);Object.assign(i.style,s),i.textContent="".concat(t);var o=i.getBoundingClientRect(),c={width:o.width,height:o.height};return Do.widthCache[a]=c,++Do.cacheCount>MX&&(Do.cacheCount=0,Do.widthCache={}),c}catch{return{width:0,height:0}}},IX=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function sf(e){"@babel/helpers - typeof";return sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(e)}function mh(e,t){return BX(e)||LX(e,t)||$X(e,t)||RX()}function RX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $X(e,t){if(e){if(typeof e=="string")return pS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pS(e,t)}}function pS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function LX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function BX(e){if(Array.isArray(e))return e}function UX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mS(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WX(n.key),n)}}function zX(e,t,r){return t&&mS(e.prototype,t),r&&mS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WX(e){var t=HX(e,"string");return sf(t)=="symbol"?t:t+""}function HX(e,t){if(sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(sf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xS=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vS=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,GX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,dO={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},XX=Object.keys(dO),il="NaN";function KX(e,t){return e*dO[t]}var G0=function(){function e(t,r){UX(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!VX.test(r)&&(this.num=NaN,this.unit=""),XX.includes(r)&&(this.num=KX(t,r),this.unit="px")}return zX(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=GX.exec(r))!==null&&n!==void 0?n:[],i=mh(a,3),s=i[1],o=i[2];return new e(parseFloat(s),o??"")}}])}();function hO(e){if(e.includes(il))return il;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=xS.exec(t))!==null&&r!==void 0?r:[],a=mh(n,4),i=a[1],s=a[2],o=a[3],c=G0.parse(i??""),u=G0.parse(o??""),f=s==="*"?c.multiply(u):c.divide(u);if(f.isNaN())return il;t=t.replace(xS,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,h=(d=vS.exec(t))!==null&&d!==void 0?d:[],p=mh(h,4),v=p[1],x=p[2],y=p[3],g=G0.parse(v??""),b=G0.parse(y??""),m=x==="+"?g.add(b):g.subtract(b);if(m.isNaN())return il;t=t.replace(vS,m.toString())}return t}var gS=/\(([^()]*)\)/;function qX(e){for(var t=e;t.includes("(");){var r=gS.exec(t),n=mh(r,2),a=n[1];t=t.replace(gS,hO(a))}return t}function YX(e){var t=e.replace(/\s+/g,"");return t=qX(t),t=hO(t),t}function QX(e){try{return YX(e)}catch{return il}}function Dx(e){var t=QX(e.slice(5,-1));return t===il?"":t}var ZX=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],JX=["dx","dy","angle","className","breakAll"];function Dg(){return Dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dg.apply(this,arguments)}function yS(e,t){if(e==null)return{};var r=eK(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eK(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function bS(e,t){return aK(e)||nK(e,t)||rK(e,t)||tK()}function tK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rK(e,t){if(e){if(typeof e=="string")return wS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wS(e,t)}}function wS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function nK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function aK(e){if(Array.isArray(e))return e}var pO=/[ \f\n\r\t\v\u2028\u2029]+/,mO=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];$e(r)||(n?i=r.toString().split(""):i=r.toString().split(pO));var s=i.map(function(c){return{word:c,width:wu(c,a).width}}),o=n?0:wu("",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}},iK=function(t,r,n,a,i){var s=t.maxLines,o=t.children,c=t.style,u=t.breakAll,f=ve(s),d=o,h=function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return M.reduce(function(U,q){var K=q.word,F=q.width,Q=U[U.length-1];if(Q&&(a==null||i||Q.width+F+n<Number(a)))Q.words.push(K),Q.width+=F+n;else{var ie={words:[K],width:F};U.push(ie)}return U},[])},p=h(r),v=function(M){return M.reduce(function(U,q){return U.width>q.width?U:q})};if(!f)return p;for(var x="",y=function(M){var U=d.slice(0,M),q=mO({breakAll:u,style:c,children:U+x}).wordsWithComputedWidth,K=h(q),F=K.length>s||v(K).width>Number(a);return[F,K]},g=0,b=d.length-1,m=0,S;g<=b&&m<=d.length-1;){var w=Math.floor((g+b)/2),_=w-1,k=y(_),N=bS(k,2),j=N[0],E=N[1],O=y(w),T=bS(O,1),L=T[0];if(!j&&!L&&(g=w+1),j&&L&&(b=w-1),!j&&L){S=E;break}m++}return S||p},_S=function(t){var r=$e(t)?[]:t.toString().split(pO);return[{words:r}]},sK=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,o=t.maxLines;if((r||n)&&!So.isSsr){var c,u,f=mO({breakAll:s,children:a,style:i});if(f){var d=f.wordsWithComputedWidth,h=f.spaceWidth;c=d,u=h}else return _S(a);return iK({breakAll:s,children:a,maxLines:o,style:i},c,u,r,n)}return _S(a)},SS="#808080",lo=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,o=s===void 0?"1em":s,c=t.capHeight,u=c===void 0?"0.71em":c,f=t.scaleToFit,d=f===void 0?!1:f,h=t.textAnchor,p=h===void 0?"start":h,v=t.verticalAnchor,x=v===void 0?"end":v,y=t.fill,g=y===void 0?SS:y,b=yS(t,ZX),m=G.useMemo(function(){return sK({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:d,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,d,b.style,b.width]),S=b.dx,w=b.dy,_=b.angle,k=b.className,N=b.breakAll,j=yS(b,JX);if(!cr(n)||!cr(i))return null;var E=n+(ve(S)?S:0),O=i+(ve(w)?w:0),T;switch(x){case"start":T=Dx("calc(".concat(u,")"));break;case"middle":T=Dx("calc(".concat((m.length-1)/2," * -").concat(o," + (").concat(u," / 2))"));break;default:T=Dx("calc(".concat(m.length-1," * -").concat(o,")"));break}var L=[];if(d){var X=m[0].width,M=b.width;L.push("scale(".concat((ve(M)?M/X:1)/X,")"))}return _&&L.push("rotate(".concat(_,", ").concat(E,", ").concat(O,")")),L.length&&(j.transform=L.join(" ")),Y.createElement("text",Dg({},Ce(j,!0),{x:E,y:O,className:ze("recharts-text",k),textAnchor:p,fill:g.includes("url")?SS:g}),m.map(function(U,q){var K=U.words.join(N?"":" ");return Y.createElement("tspan",{x:E,dy:q===0?T:o,key:"".concat(K,"-").concat(q)},K)}))};function rs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function oK(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function mb(e){let t,r,n;e.length!==2?(t=rs,r=(o,c)=>rs(e(o),c),n=(o,c)=>e(o)-c):(t=e===rs||e===oK?e:lK,r=e,n=e);function a(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<0?u=d+1:f=d}while(u<f)}return u}function i(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<=0?u=d+1:f=d}while(u<f)}return u}function s(o,c,u=0,f=o.length){const d=a(o,c,u,f-1);return d>u&&n(o[d-1],c)>-n(o[d],c)?d-1:d}return{left:a,center:s,right:i}}function lK(){return 0}function xO(e){return e===null?NaN:+e}function*cK(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const uK=mb(rs),i0=uK.right;mb(xO).center;class kS extends Map{constructor(t,r=hK){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(NS(this,t))}has(t){return super.has(NS(this,t))}set(t,r){return super.set(fK(this,t),r)}delete(t){return super.delete(dK(this,t))}}function NS({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function fK({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function dK({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function hK(e){return e!==null&&typeof e=="object"?e.valueOf():e}function pK(e=rs){if(e===rs)return vO;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function vO(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const mK=Math.sqrt(50),xK=Math.sqrt(10),vK=Math.sqrt(2);function xh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=mK?10:i>=xK?5:i>=vK?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?xh(e,t,r*2):[o,c,u]}function Ig(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?xh(t,e,r):xh(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function Rg(e,t,r){return t=+t,e=+e,r=+r,xh(e,t,r)[2]}function $g(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?Rg(t,e,r):Rg(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function jS(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function ES(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function gO(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?vO:pK(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,f=Math.log(c),d=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*d*(c-d)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*d/c+h)),v=Math.min(n,Math.floor(t+(c-u)*d/c+h));gO(e,t,p,v,a)}const i=e[t];let s=r,o=n;for(Vc(e,r,t),a(e[n],i)>0&&Vc(e,r,n);s<o;){for(Vc(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Vc(e,r,o):(++o,Vc(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Vc(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function gK(e,t,r){if(e=Float64Array.from(cK(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return ES(e);if(t>=1)return jS(e);var n,a=(n-1)*t,i=Math.floor(a),s=jS(gO(e,i).subarray(0,i+1)),o=ES(e.subarray(i+1));return s+(o-s)*(a-i)}}function yK(e,t,r=xO){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function bK(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function ua(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ci(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Lg=Symbol("implicit");function xb(){var e=new kS,t=[],r=[],n=Lg;function a(i){let s=e.get(i);if(s===void 0){if(n!==Lg)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new kS;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return xb(t,r).unknown(n)},ua.apply(a,arguments),a}function of(){var e=xb().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,f=.5;delete e.unknown;function d(){var h=t().length,p=a<n,v=p?a:n,x=p?n:a;i=(x-v)/Math.max(1,h-c+u*2),o&&(i=Math.floor(i)),v+=(x-v-i*(h-c))*f,s=i*(1-c),o&&(v=Math.round(v),s=Math.round(s));var y=bK(h).map(function(g){return v+i*g});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?([n,a]=h,n=+n,a=+a,d()):[n,a]},e.rangeRound=function(h){return[n,a]=h,n=+n,a=+a,o=!0,d()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(h){return arguments.length?(o=!!h,d()):o},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),d()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),d()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,d()):u},e.align=function(h){return arguments.length?(f=Math.max(0,Math.min(1,h)),d()):f},e.copy=function(){return of(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(f)},ua.apply(d(),arguments)}function yO(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return yO(t())},e}function _u(){return yO(of.apply(null,arguments).paddingInner(1))}function vb(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function bO(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function s0(){}var lf=.7,vh=1/lf,gl="\\s*([+-]?\\d+)\\s*",cf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ha="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wK=/^#([0-9a-f]{3,8})$/,_K=new RegExp(`^rgb\\(${gl},${gl},${gl}\\)$`),SK=new RegExp(`^rgb\\(${Ha},${Ha},${Ha}\\)$`),kK=new RegExp(`^rgba\\(${gl},${gl},${gl},${cf}\\)$`),NK=new RegExp(`^rgba\\(${Ha},${Ha},${Ha},${cf}\\)$`),jK=new RegExp(`^hsl\\(${cf},${Ha},${Ha}\\)$`),EK=new RegExp(`^hsla\\(${cf},${Ha},${Ha},${cf}\\)$`),TS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vb(s0,uf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:AS,formatHex:AS,formatHex8:TK,formatHsl:AK,formatRgb:OS,toString:OS});function AS(){return this.rgb().formatHex()}function TK(){return this.rgb().formatHex8()}function AK(){return wO(this).formatHsl()}function OS(){return this.rgb().formatRgb()}function uf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=wK.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?CS(t):r===3?new un(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?X0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?X0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=_K.exec(e))?new un(t[1],t[2],t[3],1):(t=SK.exec(e))?new un(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=kK.exec(e))?X0(t[1],t[2],t[3],t[4]):(t=NK.exec(e))?X0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=jK.exec(e))?FS(t[1],t[2]/100,t[3]/100,1):(t=EK.exec(e))?FS(t[1],t[2]/100,t[3]/100,t[4]):TS.hasOwnProperty(e)?CS(TS[e]):e==="transparent"?new un(NaN,NaN,NaN,0):null}function CS(e){return new un(e>>16&255,e>>8&255,e&255,1)}function X0(e,t,r,n){return n<=0&&(e=t=r=NaN),new un(e,t,r,n)}function OK(e){return e instanceof s0||(e=uf(e)),e?(e=e.rgb(),new un(e.r,e.g,e.b,e.opacity)):new un}function Bg(e,t,r,n){return arguments.length===1?OK(e):new un(e,t,r,n??1)}function un(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}vb(un,Bg,bO(s0,{brighter(e){return e=e==null?vh:Math.pow(vh,e),new un(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?lf:Math.pow(lf,e),new un(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new un(qs(this.r),qs(this.g),qs(this.b),gh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:PS,formatHex:PS,formatHex8:CK,formatRgb:MS,toString:MS}));function PS(){return`#${Ws(this.r)}${Ws(this.g)}${Ws(this.b)}`}function CK(){return`#${Ws(this.r)}${Ws(this.g)}${Ws(this.b)}${Ws((isNaN(this.opacity)?1:this.opacity)*255)}`}function MS(){const e=gh(this.opacity);return`${e===1?"rgb(":"rgba("}${qs(this.r)}, ${qs(this.g)}, ${qs(this.b)}${e===1?")":`, ${e})`}`}function gh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ws(e){return e=qs(e),(e<16?"0":"")+e.toString(16)}function FS(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Sa(e,t,r,n)}function wO(e){if(e instanceof Sa)return new Sa(e.h,e.s,e.l,e.opacity);if(e instanceof s0||(e=uf(e)),!e)return new Sa;if(e instanceof Sa)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new Sa(s,o,c,e.opacity)}function PK(e,t,r,n){return arguments.length===1?wO(e):new Sa(e,t,r,n??1)}function Sa(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}vb(Sa,PK,bO(s0,{brighter(e){return e=e==null?vh:Math.pow(vh,e),new Sa(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?lf:Math.pow(lf,e),new Sa(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new un(Ix(e>=240?e-240:e+120,a,n),Ix(e,a,n),Ix(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Sa(DS(this.h),K0(this.s),K0(this.l),gh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=gh(this.opacity);return`${e===1?"hsl(":"hsla("}${DS(this.h)}, ${K0(this.s)*100}%, ${K0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function DS(e){return e=(e||0)%360,e<0?e+360:e}function K0(e){return Math.max(0,Math.min(1,e||0))}function Ix(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const gb=e=>()=>e;function MK(e,t){return function(r){return e+r*t}}function FK(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function DK(e){return(e=+e)==1?_O:function(t,r){return r-t?FK(t,r,e):gb(isNaN(t)?r:t)}}function _O(e,t){var r=t-e;return r?MK(e,r):gb(isNaN(e)?t:e)}const IS=function e(t){var r=DK(t);function n(a,i){var s=r((a=Bg(a)).r,(i=Bg(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=_O(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=c(f),a.opacity=u(f),a+""}}return n.gamma=e,n}(1);function IK(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function RK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $K(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=_c(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function LK(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function yh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function BK(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=_c(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var Ug=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Rx=new RegExp(Ug.source,"g");function UK(e){return function(){return e}}function zK(e){return function(t){return e(t)+""}}function WK(e,t){var r=Ug.lastIndex=Rx.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=Ug.exec(e))&&(a=Rx.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:yh(n,a)})),r=Rx.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?zK(c[0].x):UK(t):(t=c.length,function(u){for(var f=0,d;f<t;++f)o[(d=c[f]).i]=d.x(u);return o.join("")})}function _c(e,t){var r=typeof t,n;return t==null||r==="boolean"?gb(t):(r==="number"?yh:r==="string"?(n=uf(t))?(t=n,IS):WK:t instanceof uf?IS:t instanceof Date?LK:RK(t)?IK:Array.isArray(t)?$K:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?BK:yh)(e,t)}function yb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function HK(e,t){t===void 0&&(t=e,e=_c);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function VK(e){return function(){return e}}function bh(e){return+e}var RS=[0,1];function tn(e){return e}function zg(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:VK(isNaN(t)?NaN:.5)}function GK(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function XK(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=zg(a,n),i=r(s,i)):(n=zg(n,a),i=r(i,s)),function(o){return i(n(o))}}function KK(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=zg(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=i0(e,o,1,n)-1;return i[c](a[c](o))}}function o0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function mm(){var e=RS,t=RS,r=_c,n,a,i,s=tn,o,c,u;function f(){var h=Math.min(e.length,t.length);return s!==tn&&(s=GK(e[0],e[h-1])),o=h>2?KK:XK,c=u=null,d}function d(h){return h==null||isNaN(h=+h)?i:(c||(c=o(e.map(n),t,r)))(n(s(h)))}return d.invert=function(h){return s(a((u||(u=o(t,e.map(n),yh)))(h)))},d.domain=function(h){return arguments.length?(e=Array.from(h,bh),f()):e.slice()},d.range=function(h){return arguments.length?(t=Array.from(h),f()):t.slice()},d.rangeRound=function(h){return t=Array.from(h),r=yb,f()},d.clamp=function(h){return arguments.length?(s=h?!0:tn,f()):s!==tn},d.interpolate=function(h){return arguments.length?(r=h,f()):r},d.unknown=function(h){return arguments.length?(i=h,d):i},function(h,p){return n=h,a=p,f()}}function bb(){return mm()(tn,tn)}function qK(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wh(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Il(e){return e=wh(Math.abs(e)),e?e[1]:NaN}function YK(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function QK(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var ZK=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ff(e){if(!(t=ZK.exec(e)))throw new Error("invalid format: "+e);var t;return new wb({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ff.prototype=wb.prototype;function wb(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function JK(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var _h;function eq(e,t){var r=wh(e,t);if(!r)return _h=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(_h=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wh(e,Math.max(0,t+i-1))[0]}function $S(e,t){var r=wh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const LS={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:qK,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>$S(e*100,t),r:$S,s:eq,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function BS(e){return e}var US=Array.prototype.map,zS=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function tq(e){var t=e.grouping===void 0||e.thousands===void 0?BS:YK(US.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?BS:QK(US.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(d,h){d=ff(d);var p=d.fill,v=d.align,x=d.sign,y=d.symbol,g=d.zero,b=d.width,m=d.comma,S=d.precision,w=d.trim,_=d.type;_==="n"?(m=!0,_="g"):LS[_]||(S===void 0&&(S=12),w=!0,_="g"),(g||p==="0"&&v==="=")&&(g=!0,p="0",v="=");var k=(h&&h.prefix!==void 0?h.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():""),N=(y==="$"?n:/[%p]/.test(_)?s:"")+(h&&h.suffix!==void 0?h.suffix:""),j=LS[_],E=/[defgprs%]/.test(_);S=S===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function O(T){var L=k,X=N,M,U,q;if(_==="c")X=j(T)+X,T="";else{T=+T;var K=T<0||1/T<0;if(T=isNaN(T)?c:j(Math.abs(T),S),w&&(T=JK(T)),K&&+T==0&&x!=="+"&&(K=!1),L=(K?x==="("?x:o:x==="-"||x==="("?"":x)+L,X=(_==="s"&&!isNaN(T)&&_h!==void 0?zS[8+_h/3]:"")+X+(K&&x==="("?")":""),E){for(M=-1,U=T.length;++M<U;)if(q=T.charCodeAt(M),48>q||q>57){X=(q===46?a+T.slice(M+1):T.slice(M))+X,T=T.slice(0,M);break}}}m&&!g&&(T=t(T,1/0));var F=L.length+T.length+X.length,Q=F<b?new Array(b-F+1).join(p):"";switch(m&&g&&(T=t(Q+T,Q.length?b-X.length:1/0),Q=""),v){case"<":T=L+T+X+Q;break;case"=":T=L+Q+T+X;break;case"^":T=Q.slice(0,F=Q.length>>1)+L+T+X+Q.slice(F);break;default:T=Q+L+T+X;break}return i(T)}return O.toString=function(){return d+""},O}function f(d,h){var p=Math.max(-8,Math.min(8,Math.floor(Il(h)/3)))*3,v=Math.pow(10,-p),x=u((d=ff(d),d.type="f",d),{suffix:zS[8+p/3]});return function(y){return x(v*y)}}return{format:u,formatPrefix:f}}var q0,_b,SO;rq({thousands:",",grouping:[3],currency:["$",""]});function rq(e){return q0=tq(e),_b=q0.format,SO=q0.formatPrefix,q0}function nq(e){return Math.max(0,-Il(Math.abs(e)))}function aq(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Il(t)/3)))*3-Il(Math.abs(e)))}function iq(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Il(t)-Il(e))+1}function kO(e,t,r,n){var a=$g(e,t,r),i;switch(n=ff(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=aq(a,s))&&(n.precision=i),SO(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=iq(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=nq(a))&&(n.precision=i-(n.type==="%")*2);break}}return _b(n)}function vs(e){var t=e.domain;return e.ticks=function(r){var n=t();return Ig(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return kO(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,f=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);f-- >0;){if(u=Rg(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function Sh(){var e=bb();return e.copy=function(){return o0(e,Sh())},ua.apply(e,arguments),vs(e)}function NO(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return NO(e).unknown(t)},e=arguments.length?Array.from(e,bh):[0,1],vs(r)}function jO(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function WS(e){return Math.log(e)}function HS(e){return Math.exp(e)}function sq(e){return-Math.log(-e)}function oq(e){return-Math.exp(-e)}function lq(e){return isFinite(e)?+("1e"+e):e<0?0:e}function cq(e){return e===10?lq:e===Math.E?Math.exp:t=>Math.pow(e,t)}function uq(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function VS(e){return(t,r)=>-e(-t,r)}function Sb(e){const t=e(WS,HS),r=t.domain;let n=10,a,i;function s(){return a=uq(n),i=cq(n),r()[0]<0?(a=VS(a),i=VS(i),e(sq,oq)):e(WS,HS),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],f=c[c.length-1];const d=f<u;d&&([u,f]=[f,u]);let h=a(u),p=a(f),v,x;const y=o==null?10:+o;let g=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(v=1;v<n;++v)if(x=h<0?v/i(-h):v*i(h),!(x<u)){if(x>f)break;g.push(x)}}else for(;h<=p;++h)for(v=n-1;v>=1;--v)if(x=h>0?v/i(-h):v*i(h),!(x<u)){if(x>f)break;g.push(x)}g.length*2<y&&(g=Ig(u,f,y))}else g=Ig(h,p,Math.min(p-h,y)).map(i);return d?g.reverse():g},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=ff(c)).precision==null&&(c.trim=!0),c=_b(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=u?c(f):""}},t.nice=()=>r(jO(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function EO(){const e=Sb(mm()).domain([1,10]);return e.copy=()=>o0(e,EO()).base(e.base()),ua.apply(e,arguments),e}function GS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function XS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function kb(e){var t=1,r=e(GS(t),XS(t));return r.constant=function(n){return arguments.length?e(GS(t=+n),XS(t)):t},vs(r)}function TO(){var e=kb(mm());return e.copy=function(){return o0(e,TO()).constant(e.constant())},ua.apply(e,arguments)}function KS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fq(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function dq(e){return e<0?-e*e:e*e}function Nb(e){var t=e(tn,tn),r=1;function n(){return r===1?e(tn,tn):r===.5?e(fq,dq):e(KS(r),KS(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},vs(t)}function jb(){var e=Nb(mm());return e.copy=function(){return o0(e,jb()).exponent(e.exponent())},ua.apply(e,arguments),e}function hq(){return jb.apply(null,arguments).exponent(.5)}function qS(e){return Math.sign(e)*e*e}function pq(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AO(){var e=bb(),t=[0,1],r=!1,n;function a(i){var s=pq(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(qS(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,bh)).map(qS)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return AO(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},ua.apply(a,arguments),vs(a)}function OO(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=yK(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[i0(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(rs),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return OO().domain(e).range(t).unknown(n)},ua.apply(i,arguments)}function CO(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[i0(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return CO().domain([e,t]).range(a).unknown(i)},ua.apply(vs(s),arguments)}function PO(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[i0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return PO().domain(e).range(t).unknown(r)},ua.apply(a,arguments)}const $x=new Date,Lx=new Date;function fr(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>fr(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>($x.setTime(+i),Lx.setTime(+s),e($x),e(Lx),Math.floor(r($x,Lx))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const kh=fr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);kh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?fr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):kh);kh.range;const li=1e3,Jn=li*60,ci=Jn*60,_i=ci*24,Eb=_i*7,YS=_i*30,Bx=_i*365,Hs=fr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*li)},(e,t)=>(t-e)/li,e=>e.getUTCSeconds());Hs.range;const Tb=fr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*li)},(e,t)=>{e.setTime(+e+t*Jn)},(e,t)=>(t-e)/Jn,e=>e.getMinutes());Tb.range;const Ab=fr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Jn)},(e,t)=>(t-e)/Jn,e=>e.getUTCMinutes());Ab.range;const Ob=fr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*li-e.getMinutes()*Jn)},(e,t)=>{e.setTime(+e+t*ci)},(e,t)=>(t-e)/ci,e=>e.getHours());Ob.range;const Cb=fr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ci)},(e,t)=>(t-e)/ci,e=>e.getUTCHours());Cb.range;const l0=fr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Jn)/_i,e=>e.getDate()-1);l0.range;const xm=fr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/_i,e=>e.getUTCDate()-1);xm.range;const MO=fr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/_i,e=>Math.floor(e/_i));MO.range;function ko(e){return fr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Jn)/Eb)}const vm=ko(0),Nh=ko(1),mq=ko(2),xq=ko(3),Rl=ko(4),vq=ko(5),gq=ko(6);vm.range;Nh.range;mq.range;xq.range;Rl.range;vq.range;gq.range;function No(e){return fr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Eb)}const gm=No(0),jh=No(1),yq=No(2),bq=No(3),$l=No(4),wq=No(5),_q=No(6);gm.range;jh.range;yq.range;bq.range;$l.range;wq.range;_q.range;const Pb=fr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Pb.range;const Mb=fr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Mb.range;const Si=fr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Si.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:fr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Si.range;const ki=fr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ki.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:fr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ki.range;function FO(e,t,r,n,a,i){const s=[[Hs,1,li],[Hs,5,5*li],[Hs,15,15*li],[Hs,30,30*li],[i,1,Jn],[i,5,5*Jn],[i,15,15*Jn],[i,30,30*Jn],[a,1,ci],[a,3,3*ci],[a,6,6*ci],[a,12,12*ci],[n,1,_i],[n,2,2*_i],[r,1,Eb],[t,1,YS],[t,3,3*YS],[e,1,Bx]];function o(u,f,d){const h=f<u;h&&([u,f]=[f,u]);const p=d&&typeof d.range=="function"?d:c(u,f,d),v=p?p.range(u,+f+1):[];return h?v.reverse():v}function c(u,f,d){const h=Math.abs(f-u)/d,p=mb(([,,y])=>y).right(s,h);if(p===s.length)return e.every($g(u/Bx,f/Bx,d));if(p===0)return kh.every(Math.max($g(u,f,d),1));const[v,x]=s[h/s[p-1][2]<s[p][2]/h?p-1:p];return v.every(x)}return[o,c]}const[Sq,kq]=FO(ki,Mb,gm,MO,Cb,Ab),[Nq,jq]=FO(Si,Pb,vm,l0,Ob,Tb);function Ux(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function zx(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Gc(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Eq(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=Xc(a),f=Kc(a),d=Xc(i),h=Kc(i),p=Xc(s),v=Kc(s),x=Xc(o),y=Kc(o),g=Xc(c),b=Kc(c),m={a:q,A:K,b:F,B:Q,c:null,d:rk,e:rk,f:Yq,g:sY,G:lY,H:Xq,I:Kq,j:qq,L:DO,m:Qq,M:Zq,p:ie,q:A,Q:ik,s:sk,S:Jq,u:eY,U:tY,V:rY,w:nY,W:aY,x:null,X:null,y:iY,Y:oY,Z:cY,"%":ak},S={a:R,A:D,b:H,B:J,c:null,d:nk,e:nk,f:hY,g:SY,G:NY,H:uY,I:fY,j:dY,L:RO,m:pY,M:mY,p:ue,q:le,Q:ik,s:sk,S:xY,u:vY,U:gY,V:yY,w:bY,W:wY,x:null,X:null,y:_Y,Y:kY,Z:jY,"%":ak},w={a:E,A:O,b:T,B:L,c:X,d:ek,e:ek,f:Wq,g:JS,G:ZS,H:tk,I:tk,j:Lq,L:zq,m:$q,M:Bq,p:j,q:Rq,Q:Vq,s:Gq,S:Uq,u:Pq,U:Mq,V:Fq,w:Cq,W:Dq,x:M,X:U,y:JS,Y:ZS,Z:Iq,"%":Hq};m.x=_(r,m),m.X=_(n,m),m.c=_(t,m),S.x=_(r,S),S.X=_(n,S),S.c=_(t,S);function _(Z,ee){return function(fe){var P=[],ke=-1,be=0,Te=Z.length,Ae,he,We;for(fe instanceof Date||(fe=new Date(+fe));++ke<Te;)Z.charCodeAt(ke)===37&&(P.push(Z.slice(be,ke)),(he=QS[Ae=Z.charAt(++ke)])!=null?Ae=Z.charAt(++ke):he=Ae==="e"?" ":"0",(We=ee[Ae])&&(Ae=We(fe,he)),P.push(Ae),be=ke+1);return P.push(Z.slice(be,ke)),P.join("")}}function k(Z,ee){return function(fe){var P=Gc(1900,void 0,1),ke=N(P,Z,fe+="",0),be,Te;if(ke!=fe.length)return null;if("Q"in P)return new Date(P.Q);if("s"in P)return new Date(P.s*1e3+("L"in P?P.L:0));if(ee&&!("Z"in P)&&(P.Z=0),"p"in P&&(P.H=P.H%12+P.p*12),P.m===void 0&&(P.m="q"in P?P.q:0),"V"in P){if(P.V<1||P.V>53)return null;"w"in P||(P.w=1),"Z"in P?(be=zx(Gc(P.y,0,1)),Te=be.getUTCDay(),be=Te>4||Te===0?jh.ceil(be):jh(be),be=xm.offset(be,(P.V-1)*7),P.y=be.getUTCFullYear(),P.m=be.getUTCMonth(),P.d=be.getUTCDate()+(P.w+6)%7):(be=Ux(Gc(P.y,0,1)),Te=be.getDay(),be=Te>4||Te===0?Nh.ceil(be):Nh(be),be=l0.offset(be,(P.V-1)*7),P.y=be.getFullYear(),P.m=be.getMonth(),P.d=be.getDate()+(P.w+6)%7)}else("W"in P||"U"in P)&&("w"in P||(P.w="u"in P?P.u%7:"W"in P?1:0),Te="Z"in P?zx(Gc(P.y,0,1)).getUTCDay():Ux(Gc(P.y,0,1)).getDay(),P.m=0,P.d="W"in P?(P.w+6)%7+P.W*7-(Te+5)%7:P.w+P.U*7-(Te+6)%7);return"Z"in P?(P.H+=P.Z/100|0,P.M+=P.Z%100,zx(P)):Ux(P)}}function N(Z,ee,fe,P){for(var ke=0,be=ee.length,Te=fe.length,Ae,he;ke<be;){if(P>=Te)return-1;if(Ae=ee.charCodeAt(ke++),Ae===37){if(Ae=ee.charAt(ke++),he=w[Ae in QS?ee.charAt(ke++):Ae],!he||(P=he(Z,fe,P))<0)return-1}else if(Ae!=fe.charCodeAt(P++))return-1}return P}function j(Z,ee,fe){var P=u.exec(ee.slice(fe));return P?(Z.p=f.get(P[0].toLowerCase()),fe+P[0].length):-1}function E(Z,ee,fe){var P=p.exec(ee.slice(fe));return P?(Z.w=v.get(P[0].toLowerCase()),fe+P[0].length):-1}function O(Z,ee,fe){var P=d.exec(ee.slice(fe));return P?(Z.w=h.get(P[0].toLowerCase()),fe+P[0].length):-1}function T(Z,ee,fe){var P=g.exec(ee.slice(fe));return P?(Z.m=b.get(P[0].toLowerCase()),fe+P[0].length):-1}function L(Z,ee,fe){var P=x.exec(ee.slice(fe));return P?(Z.m=y.get(P[0].toLowerCase()),fe+P[0].length):-1}function X(Z,ee,fe){return N(Z,t,ee,fe)}function M(Z,ee,fe){return N(Z,r,ee,fe)}function U(Z,ee,fe){return N(Z,n,ee,fe)}function q(Z){return s[Z.getDay()]}function K(Z){return i[Z.getDay()]}function F(Z){return c[Z.getMonth()]}function Q(Z){return o[Z.getMonth()]}function ie(Z){return a[+(Z.getHours()>=12)]}function A(Z){return 1+~~(Z.getMonth()/3)}function R(Z){return s[Z.getUTCDay()]}function D(Z){return i[Z.getUTCDay()]}function H(Z){return c[Z.getUTCMonth()]}function J(Z){return o[Z.getUTCMonth()]}function ue(Z){return a[+(Z.getUTCHours()>=12)]}function le(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var ee=_(Z+="",m);return ee.toString=function(){return Z},ee},parse:function(Z){var ee=k(Z+="",!1);return ee.toString=function(){return Z},ee},utcFormat:function(Z){var ee=_(Z+="",S);return ee.toString=function(){return Z},ee},utcParse:function(Z){var ee=k(Z+="",!0);return ee.toString=function(){return Z},ee}}}var QS={"-":"",_:" ",0:"0"},wr=/^\s*\d+/,Tq=/^%/,Aq=/[\\^$*+?|[\]().{}]/g;function et(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Oq(e){return e.replace(Aq,"\\$&")}function Xc(e){return new RegExp("^(?:"+e.map(Oq).join("|")+")","i")}function Kc(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Cq(e,t,r){var n=wr.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Pq(e,t,r){var n=wr.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Mq(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Fq(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Dq(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function ZS(e,t,r){var n=wr.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function JS(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Iq(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Rq(e,t,r){var n=wr.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function $q(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function ek(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Lq(e,t,r){var n=wr.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function tk(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Bq(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Uq(e,t,r){var n=wr.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function zq(e,t,r){var n=wr.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Wq(e,t,r){var n=wr.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Hq(e,t,r){var n=Tq.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Vq(e,t,r){var n=wr.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function Gq(e,t,r){var n=wr.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function rk(e,t){return et(e.getDate(),t,2)}function Xq(e,t){return et(e.getHours(),t,2)}function Kq(e,t){return et(e.getHours()%12||12,t,2)}function qq(e,t){return et(1+l0.count(Si(e),e),t,3)}function DO(e,t){return et(e.getMilliseconds(),t,3)}function Yq(e,t){return DO(e,t)+"000"}function Qq(e,t){return et(e.getMonth()+1,t,2)}function Zq(e,t){return et(e.getMinutes(),t,2)}function Jq(e,t){return et(e.getSeconds(),t,2)}function eY(e){var t=e.getDay();return t===0?7:t}function tY(e,t){return et(vm.count(Si(e)-1,e),t,2)}function IO(e){var t=e.getDay();return t>=4||t===0?Rl(e):Rl.ceil(e)}function rY(e,t){return e=IO(e),et(Rl.count(Si(e),e)+(Si(e).getDay()===4),t,2)}function nY(e){return e.getDay()}function aY(e,t){return et(Nh.count(Si(e)-1,e),t,2)}function iY(e,t){return et(e.getFullYear()%100,t,2)}function sY(e,t){return e=IO(e),et(e.getFullYear()%100,t,2)}function oY(e,t){return et(e.getFullYear()%1e4,t,4)}function lY(e,t){var r=e.getDay();return e=r>=4||r===0?Rl(e):Rl.ceil(e),et(e.getFullYear()%1e4,t,4)}function cY(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+et(t/60|0,"0",2)+et(t%60,"0",2)}function nk(e,t){return et(e.getUTCDate(),t,2)}function uY(e,t){return et(e.getUTCHours(),t,2)}function fY(e,t){return et(e.getUTCHours()%12||12,t,2)}function dY(e,t){return et(1+xm.count(ki(e),e),t,3)}function RO(e,t){return et(e.getUTCMilliseconds(),t,3)}function hY(e,t){return RO(e,t)+"000"}function pY(e,t){return et(e.getUTCMonth()+1,t,2)}function mY(e,t){return et(e.getUTCMinutes(),t,2)}function xY(e,t){return et(e.getUTCSeconds(),t,2)}function vY(e){var t=e.getUTCDay();return t===0?7:t}function gY(e,t){return et(gm.count(ki(e)-1,e),t,2)}function $O(e){var t=e.getUTCDay();return t>=4||t===0?$l(e):$l.ceil(e)}function yY(e,t){return e=$O(e),et($l.count(ki(e),e)+(ki(e).getUTCDay()===4),t,2)}function bY(e){return e.getUTCDay()}function wY(e,t){return et(jh.count(ki(e)-1,e),t,2)}function _Y(e,t){return et(e.getUTCFullYear()%100,t,2)}function SY(e,t){return e=$O(e),et(e.getUTCFullYear()%100,t,2)}function kY(e,t){return et(e.getUTCFullYear()%1e4,t,4)}function NY(e,t){var r=e.getUTCDay();return e=r>=4||r===0?$l(e):$l.ceil(e),et(e.getUTCFullYear()%1e4,t,4)}function jY(){return"+0000"}function ak(){return"%"}function ik(e){return+e}function sk(e){return Math.floor(+e/1e3)}var Io,LO,BO;EY({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EY(e){return Io=Eq(e),LO=Io.format,Io.parse,BO=Io.utcFormat,Io.utcParse,Io}function TY(e){return new Date(e)}function AY(e){return e instanceof Date?+e:+new Date(+e)}function Fb(e,t,r,n,a,i,s,o,c,u){var f=bb(),d=f.invert,h=f.domain,p=u(".%L"),v=u(":%S"),x=u("%I:%M"),y=u("%I %p"),g=u("%a %d"),b=u("%b %d"),m=u("%B"),S=u("%Y");function w(_){return(c(_)<_?p:o(_)<_?v:s(_)<_?x:i(_)<_?y:n(_)<_?a(_)<_?g:b:r(_)<_?m:S)(_)}return f.invert=function(_){return new Date(d(_))},f.domain=function(_){return arguments.length?h(Array.from(_,AY)):h().map(TY)},f.ticks=function(_){var k=h();return e(k[0],k[k.length-1],_??10)},f.tickFormat=function(_,k){return k==null?w:u(k)},f.nice=function(_){var k=h();return(!_||typeof _.range!="function")&&(_=t(k[0],k[k.length-1],_??10)),_?h(jO(k,_)):f},f.copy=function(){return o0(f,Fb(e,t,r,n,a,i,s,o,c,u))},f}function OY(){return ua.apply(Fb(Nq,jq,Si,Pb,vm,l0,Ob,Tb,Hs,LO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function CY(){return ua.apply(Fb(Sq,kq,ki,Mb,gm,xm,Cb,Ab,Hs,BO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ym(){var e=0,t=1,r,n,a,i,s=tn,o=!1,c;function u(d){return d==null||isNaN(d=+d)?c:s(a===0?.5:(d=(i(d)-r)*a,o?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(d){return arguments.length?(o=!!d,u):o},u.interpolator=function(d){return arguments.length?(s=d,u):s};function f(d){return function(h){var p,v;return arguments.length?([p,v]=h,s=d(p,v),u):[s(0),s(1)]}}return u.range=f(_c),u.rangeRound=f(yb),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return i=d,r=d(e),n=d(t),a=r===n?0:1/(n-r),u}}function gs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function UO(){var e=vs(ym()(tn));return e.copy=function(){return gs(e,UO())},Ci.apply(e,arguments)}function zO(){var e=Sb(ym()).domain([1,10]);return e.copy=function(){return gs(e,zO()).base(e.base())},Ci.apply(e,arguments)}function WO(){var e=kb(ym());return e.copy=function(){return gs(e,WO()).constant(e.constant())},Ci.apply(e,arguments)}function Db(){var e=Nb(ym());return e.copy=function(){return gs(e,Db()).exponent(e.exponent())},Ci.apply(e,arguments)}function PY(){return Db.apply(null,arguments).exponent(.5)}function HO(){var e=[],t=tn;function r(n){if(n!=null&&!isNaN(n=+n))return t((i0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(rs),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>gK(e,i/n))},r.copy=function(){return HO(t).domain(e)},Ci.apply(r,arguments)}function bm(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=tn,f,d=!1,h;function p(x){return isNaN(x=+x)?h:(x=.5+((x=+f(x))-i)*(n*x<n*i?o:c),u(d?Math.max(0,Math.min(1,x)):x))}p.domain=function(x){return arguments.length?([e,t,r]=x,a=f(e=+e),i=f(t=+t),s=f(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p):[e,t,r]},p.clamp=function(x){return arguments.length?(d=!!x,p):d},p.interpolator=function(x){return arguments.length?(u=x,p):u};function v(x){return function(y){var g,b,m;return arguments.length?([g,b,m]=y,u=HK(x,[g,b,m]),p):[u(0),u(.5),u(1)]}}return p.range=v(_c),p.rangeRound=v(yb),p.unknown=function(x){return arguments.length?(h=x,p):h},function(x){return f=x,a=x(e),i=x(t),s=x(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,p}}function VO(){var e=vs(bm()(tn));return e.copy=function(){return gs(e,VO())},Ci.apply(e,arguments)}function GO(){var e=Sb(bm()).domain([.1,1,10]);return e.copy=function(){return gs(e,GO()).base(e.base())},Ci.apply(e,arguments)}function XO(){var e=kb(bm());return e.copy=function(){return gs(e,XO()).constant(e.constant())},Ci.apply(e,arguments)}function Ib(){var e=Nb(bm());return e.copy=function(){return gs(e,Ib()).exponent(e.exponent())},Ci.apply(e,arguments)}function MY(){return Ib.apply(null,arguments).exponent(.5)}const ok=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:of,scaleDiverging:VO,scaleDivergingLog:GO,scaleDivergingPow:Ib,scaleDivergingSqrt:MY,scaleDivergingSymlog:XO,scaleIdentity:NO,scaleImplicit:Lg,scaleLinear:Sh,scaleLog:EO,scaleOrdinal:xb,scalePoint:_u,scalePow:jb,scaleQuantile:OO,scaleQuantize:CO,scaleRadial:AO,scaleSequential:UO,scaleSequentialLog:zO,scaleSequentialPow:Db,scaleSequentialQuantile:HO,scaleSequentialSqrt:PY,scaleSequentialSymlog:WO,scaleSqrt:hq,scaleSymlog:TO,scaleThreshold:PO,scaleTime:OY,scaleUtc:CY,tickFormat:kO},Symbol.toStringTag,{value:"Module"}));var FY=hc;function DY(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(o===void 0?s===s&&!FY(s):r(s,o)))var o=s,c=i}return c}var wm=DY;function IY(e,t){return e>t}var KO=IY,RY=wm,$Y=KO,LY=wc;function BY(e){return e&&e.length?RY(e,LY,$Y):void 0}var UY=BY;const _m=st(UY);function zY(e,t){return e<t}var qO=zY,WY=wm,HY=qO,VY=wc;function GY(e){return e&&e.length?WY(e,VY,HY):void 0}var XY=GY;const Sm=st(XY);var KY=Yy,qY=Za,YY=aO,QY=bn;function ZY(e,t){var r=QY(e)?KY:YY;return r(e,qY(t))}var JY=ZY,eQ=rO,tQ=JY;function rQ(e,t){return eQ(tQ(e,t),1)}var nQ=rQ;const aQ=st(nQ);var iQ=fb;function sQ(e,t){return iQ(e,t)}var oQ=sQ;const c0=st(oQ);var Sc=1e9,lQ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},$b,Nt=!0,oa="[DecimalError] ",Ys=oa+"Invalid argument: ",Rb=oa+"Exponent out of range: ",kc=Math.floor,Is=Math.pow,cQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Tn,hr=1e7,yt=7,YO=9007199254740991,Eh=kc(YO/yt),je={};je.absoluteValue=je.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};je.comparedTo=je.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};je.decimalPlaces=je.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*yt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};je.dividedBy=je.div=function(e){return pi(this,new this.constructor(e))};je.dividedToIntegerBy=je.idiv=function(e){var t=this,r=t.constructor;return ut(pi(t,new r(e),0,1),r.precision)};je.equals=je.eq=function(e){return!this.cmp(e)};je.exponent=function(){return tr(this)};je.greaterThan=je.gt=function(e){return this.cmp(e)>0};je.greaterThanOrEqualTo=je.gte=function(e){return this.cmp(e)>=0};je.isInteger=je.isint=function(){return this.e>this.d.length-2};je.isNegative=je.isneg=function(){return this.s<0};je.isPositive=je.ispos=function(){return this.s>0};je.isZero=function(){return this.s===0};je.lessThan=je.lt=function(e){return this.cmp(e)<0};je.lessThanOrEqualTo=je.lte=function(e){return this.cmp(e)<1};je.logarithm=je.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Tn))throw Error(oa+"NaN");if(r.s<1)throw Error(oa+(r.s?"NaN":"-Infinity"));return r.eq(Tn)?new n(0):(Nt=!1,t=pi(df(r,i),df(e,i),i),Nt=!0,ut(t,a))};je.minus=je.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JO(t,e):QO(t,(e.s=-e.s,e))};je.modulo=je.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(oa+"NaN");return r.s?(Nt=!1,t=pi(r,e,0,1).times(e),Nt=!0,r.minus(t)):ut(new n(r),a)};je.naturalExponential=je.exp=function(){return ZO(this)};je.naturalLogarithm=je.ln=function(){return df(this)};je.negated=je.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};je.plus=je.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?QO(t,e):JO(t,(e.s=-e.s,e))};je.precision=je.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ys+e);if(t=tr(a)+1,n=a.d.length-1,r=n*yt+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};je.squareRoot=je.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(oa+"NaN")}for(e=tr(o),Nt=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=Ba(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=kc((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(pi(o,i,s+2)).times(.5),Ba(i.d).slice(0,s)===(t=Ba(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(ut(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Nt=!0,ut(n,r)};je.times=je.mul=function(e){var t,r,n,a,i,s,o,c,u,f=this,d=f.constructor,h=f.d,p=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,r=f.e+e.e,c=h.length,u=p.length,c<u&&(i=h,h=p,p=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+p[n]*h[a-n-1]+t,i[a--]=o%hr|0,t=o/hr|0;i[a]=(i[a]+t)%hr|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Nt?ut(e,d.precision):e};je.toDecimalPlaces=je.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Xa(e,0,Sc),t===void 0?t=n.rounding:Xa(t,0,8),ut(r,e+tr(r)+1,t))};je.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=co(n,!0):(Xa(e,0,Sc),t===void 0?t=a.rounding:Xa(t,0,8),n=ut(new a(n),e+1,t),r=co(n,!0,e+1)),r};je.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?co(a):(Xa(e,0,Sc),t===void 0?t=i.rounding:Xa(t,0,8),n=ut(new i(a),e+tr(a)+1,t),r=co(n.abs(),!1,e+tr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};je.toInteger=je.toint=function(){var e=this,t=e.constructor;return ut(new t(e),tr(e)+1,t.rounding)};je.toNumber=function(){return+this};je.toPower=je.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,f=+(e=new c(e));if(!e.s)return new c(Tn);if(o=new c(o),!o.s){if(e.s<1)throw Error(oa+"Infinity");return o}if(o.eq(Tn))return o;if(n=c.precision,e.eq(Tn))return ut(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=f<0?-f:f)<=YO){for(a=new c(Tn),t=Math.ceil(n/yt+4),Nt=!1;r%2&&(a=a.times(o),ck(a.d,t)),r=kc(r/2),r!==0;)o=o.times(o),ck(o.d,t);return Nt=!0,e.s<0?new c(Tn).div(a):ut(a,n)}}else if(i<0)throw Error(oa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Nt=!1,a=e.times(df(o,n+u)),Nt=!0,a=ZO(a),a.s=i,a};je.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=tr(a),n=co(a,r<=i.toExpNeg||r>=i.toExpPos)):(Xa(e,1,Sc),t===void 0?t=i.rounding:Xa(t,0,8),a=ut(new i(a),e,t),r=tr(a),n=co(a,e<=r||r<=i.toExpNeg,e)),n};je.toSignificantDigits=je.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Xa(e,1,Sc),t===void 0?t=n.rounding:Xa(t,0,8)),ut(new n(r),e,t)};je.toString=je.valueOf=je.val=je.toJSON=je[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=tr(e),r=e.constructor;return co(e,t<=r.toExpNeg||t>=r.toExpPos)};function QO(e,t){var r,n,a,i,s,o,c,u,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),Nt?ut(t,d):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(d/yt),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/hr|0,c[i]%=hr;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,Nt?ut(t,d):t}function Xa(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ys+e)}function Ba(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=yt-n.length,r&&(i+=Li(r)),i+=n;s=e[t],n=s+"",r=yt-n.length,r&&(i+=Li(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var pi=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%hr|0,s=i/hr|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*hr+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,f,d,h,p,v,x,y,g,b,m,S,w,_,k,N,j=n.constructor,E=n.s==a.s?1:-1,O=n.d,T=a.d;if(!n.s)return new j(n);if(!a.s)throw Error(oa+"Division by zero");for(c=n.e-a.e,k=T.length,w=O.length,p=new j(E),v=p.d=[],u=0;T[u]==(O[u]||0);)++u;if(T[u]>(O[u]||0)&&--c,i==null?b=i=j.precision:s?b=i+(tr(n)-tr(a))+1:b=i,b<0)return new j(0);if(b=b/yt+2|0,u=0,k==1)for(f=0,T=T[0],b++;(u<w||f)&&b--;u++)m=f*hr+(O[u]||0),v[u]=m/T|0,f=m%T|0;else{for(f=hr/(T[0]+1)|0,f>1&&(T=e(T,f),O=e(O,f),k=T.length,w=O.length),S=k,x=O.slice(0,k),y=x.length;y<k;)x[y++]=0;N=T.slice(),N.unshift(0),_=T[0],T[1]>=hr/2&&++_;do f=0,o=t(T,x,k,y),o<0?(g=x[0],k!=y&&(g=g*hr+(x[1]||0)),f=g/_|0,f>1?(f>=hr&&(f=hr-1),d=e(T,f),h=d.length,y=x.length,o=t(d,x,h,y),o==1&&(f--,r(d,k<h?N:T,h))):(f==0&&(o=f=1),d=T.slice()),h=d.length,h<y&&d.unshift(0),r(x,d,y),o==-1&&(y=x.length,o=t(T,x,k,y),o<1&&(f++,r(x,k<y?N:T,y))),y=x.length):o===0&&(f++,x=[0]),v[u++]=f,o&&x[0]?x[y++]=O[S]||0:(x=[O[S]],y=1);while((S++<w||x[0]!==void 0)&&b--)}return v[0]||v.shift(),p.e=c,ut(p,s?i+tr(p)+1:i)}}();function ZO(e,t){var r,n,a,i,s,o,c=0,u=0,f=e.constructor,d=f.precision;if(tr(e)>16)throw Error(Rb+tr(e));if(!e.s)return new f(Tn);for(Nt=!1,o=d,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(Is(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new f(Tn),f.precision=o;;){if(a=ut(a.times(e),o),r=r.times(++c),s=i.plus(pi(a,r,o)),Ba(s.d).slice(0,o)===Ba(i.d).slice(0,o)){for(;u--;)i=ut(i.times(i),o);return f.precision=d,t==null?(Nt=!0,ut(i,d)):i}i=s}}function tr(e){for(var t=e.e*yt,r=e.d[0];r>=10;r/=10)t++;return t}function Wx(e,t,r){if(t>e.LN10.sd())throw Nt=!0,r&&(e.precision=r),Error(oa+"LN10 precision limit exceeded");return ut(new e(e.LN10),t)}function Li(e){for(var t="";e--;)t+="0";return t}function df(e,t){var r,n,a,i,s,o,c,u,f,d=1,h=10,p=e,v=p.d,x=p.constructor,y=x.precision;if(p.s<1)throw Error(oa+(p.s?"NaN":"-Infinity"));if(p.eq(Tn))return new x(0);if(t==null?(Nt=!1,u=y):u=t,p.eq(10))return t==null&&(Nt=!0),Wx(x,u);if(u+=h,x.precision=u,r=Ba(v),n=r.charAt(0),i=tr(p),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Ba(p.d),n=r.charAt(0),d++;i=tr(p),n>1?(p=new x("0."+r),i++):p=new x(n+"."+r.slice(1))}else return c=Wx(x,u+2,y).times(i+""),p=df(new x(n+"."+r.slice(1)),u-h).plus(c),x.precision=y,t==null?(Nt=!0,ut(p,y)):p;for(o=s=p=pi(p.minus(Tn),p.plus(Tn),u),f=ut(p.times(p),u),a=3;;){if(s=ut(s.times(f),u),c=o.plus(pi(s,new x(a),u)),Ba(c.d).slice(0,u)===Ba(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(Wx(x,u+2,y).times(i+""))),o=pi(o,new x(d),u),x.precision=y,t==null?(Nt=!0,ut(o,y)):o;o=c,a+=2}}function lk(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=kc(r/yt),e.d=[],n=(r+1)%yt,r<0&&(n+=yt),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=yt;n<a;)e.d.push(+t.slice(n,n+=yt));t=t.slice(n),n=yt-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Nt&&(e.e>Eh||e.e<-Eh))throw Error(Rb+r)}else e.s=0,e.e=0,e.d=[0];return e}function ut(e,t,r){var n,a,i,s,o,c,u,f,d=e.d;for(s=1,i=d[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=yt,a=t,u=d[f=0];else{if(f=Math.ceil((n+1)/yt),i=d.length,f>=i)return e;for(u=i=d[f],s=1;i>=10;i/=10)s++;n%=yt,a=n-yt+s}if(r!==void 0&&(i=Is(10,s-a-1),o=u/i%10|0,c=t<0||d[f+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/Is(10,s-a):0:d[f-1])%10&1||r==(e.s<0?8:7))),t<1||!d[0])return c?(i=tr(e),d.length=1,t=t-i-1,d[0]=Is(10,(yt-t%yt)%yt),e.e=kc(-t/yt)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=Is(10,yt-n),d[f]=a>0?(u/Is(10,s-a)%Is(10,a)|0)*i:0),c)for(;;)if(f==0){(d[0]+=i)==hr&&(d[0]=1,++e.e);break}else{if(d[f]+=i,d[f]!=hr)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(Nt&&(e.e>Eh||e.e<-Eh))throw Error(Rb+tr(e));return e}function JO(e,t){var r,n,a,i,s,o,c,u,f,d,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Nt?ut(t,p):t;if(c=e.d,d=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(f=s<0,f?(r=c,s=-s,o=d.length):(r=d,n=u,o=c.length),a=Math.max(Math.ceil(p/yt),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=d.length,f=a<o,f&&(o=a),a=0;a<o;a++)if(c[a]!=d[a]){f=c[a]<d[a];break}s=0}for(f&&(r=c,c=d,d=r,t.s=-t.s),o=c.length,a=d.length-o;a>0;--a)c[o++]=0;for(a=d.length;a>s;){if(c[--a]<d[a]){for(i=a;i&&c[--i]===0;)c[i]=hr-1;--c[i],c[a]+=hr}c[a]-=d[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Nt?ut(t,p):t):new h(0)}function co(e,t,r){var n,a=tr(e),i=Ba(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+Li(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Li(-a-1)+i,r&&(n=r-s)>0&&(i+=Li(n))):a>=s?(i+=Li(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+Li(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=Li(n))),e.s<0?"-"+i:i}function ck(e,t){if(e.length>t)return e.length=t,!0}function e3(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ys+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return lk(s,i.toString())}else if(typeof i!="string")throw Error(Ys+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,cQ.test(i))lk(s,i);else throw Error(Ys+i)}if(a.prototype=je,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=e3,a.config=a.set=uQ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function uQ(e){if(!e||typeof e!="object")throw Error(oa+"Object expected");var t,r,n,a=["precision",1,Sc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(kc(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ys+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ys+r+": "+n);return this}var $b=e3(lQ);Tn=new $b(1);const lt=$b;function fQ(e){return mQ(e)||pQ(e)||hQ(e)||dQ()}function dQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hQ(e,t){if(e){if(typeof e=="string")return Wg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Wg(e,t)}}function pQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function mQ(e){if(Array.isArray(e))return Wg(e)}function Wg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xQ=function(t){return t},t3={},r3=function(t){return t===t3},uk=function(t){return function r(){return arguments.length===0||arguments.length===1&&r3(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},vQ=function e(t,r){return t===1?r:uk(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(o){return o!==t3}).length;return s>=t?r.apply(void 0,a):e(t-s,uk(function(){for(var o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];var f=a.map(function(d){return r3(d)?c.shift():d});return r.apply(void 0,fQ(f).concat(c))}))})},km=function(t){return vQ(t.length,t)},Hg=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},gQ=km(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),yQ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return xQ;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(o,c){return c(o)},i.apply(void 0,arguments))}},Vg=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},n3=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(o,c){return o===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function bQ(e){var t;return e===0?t=1:t=Math.floor(new lt(e).abs().log(10).toNumber())+1,t}function wQ(e,t,r){for(var n=new lt(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var _Q=km(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),SQ=km(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),kQ=km(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Nm={rangeStep:wQ,getDigitCount:bQ,interpolateNumber:_Q,uninterpolateNumber:SQ,uninterpolateTruncation:kQ};function Gg(e){return EQ(e)||jQ(e)||a3(e)||NQ()}function NQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jQ(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function EQ(e){if(Array.isArray(e))return Xg(e)}function hf(e,t){return OQ(e)||AQ(e,t)||a3(e,t)||TQ()}function TQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a3(e,t){if(e){if(typeof e=="string")return Xg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xg(e,t)}}function Xg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AQ(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),o;!(n=(o=s.next()).done)&&(r.push(o.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function OQ(e){if(Array.isArray(e))return e}function i3(e){var t=hf(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function s3(e,t,r){if(e.lte(0))return new lt(0);var n=Nm.getDigitCount(e.toNumber()),a=new lt(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new lt(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?c:new lt(Math.ceil(c))}function CQ(e,t,r){var n=1,a=new lt(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new lt(10).pow(Nm.getDigitCount(e)-1),a=new lt(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new lt(Math.floor(e)))}else e===0?a=new lt(Math.floor((t-1)/2)):r||(a=new lt(Math.floor(e)));var s=Math.floor((t-1)/2),o=yQ(gQ(function(c){return a.add(new lt(c-s).mul(n)).toNumber()}),Hg);return o(0,t)}function o3(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new lt(0),tickMin:new lt(0),tickMax:new lt(0)};var i=s3(new lt(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new lt(0):(s=new lt(e).add(t).div(2),s=s.sub(new lt(s).mod(i)));var o=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new lt(t).sub(s).div(i).toNumber()),u=o+c+1;return u>r?o3(e,t,r,n,a+1):(u<r&&(c=t>0?c+(r-u):c,o=t>0?o:o+(r-u)),{step:i,tickMin:s.sub(new lt(o).mul(i)),tickMax:s.add(new lt(c).mul(i))})}function PQ(e){var t=hf(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),o=i3([r,n]),c=hf(o,2),u=c[0],f=c[1];if(u===-1/0||f===1/0){var d=f===1/0?[u].concat(Gg(Hg(0,a-1).map(function(){return 1/0}))):[].concat(Gg(Hg(0,a-1).map(function(){return-1/0})),[f]);return r>n?Vg(d):d}if(u===f)return CQ(u,a,i);var h=o3(u,f,s,i),p=h.step,v=h.tickMin,x=h.tickMax,y=Nm.rangeStep(v,x.add(new lt(.1).mul(p)),p);return r>n?Vg(y):y}function MQ(e,t){var r=hf(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=i3([n,a]),o=hf(s,2),c=o[0],u=o[1];if(c===-1/0||u===1/0)return[n,a];if(c===u)return[c];var f=Math.max(t,2),d=s3(new lt(u).sub(c).div(f-1),i,0),h=[].concat(Gg(Nm.rangeStep(new lt(c),new lt(u).sub(new lt(.99).mul(d)),d)),[u]);return n>a?Vg(h):h}var FQ=n3(PQ),DQ=n3(MQ),IQ="Invariant failed";function uo(e,t){throw new Error(IQ)}var RQ=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(this,arguments)}function $Q(e,t){return zQ(e)||UQ(e,t)||BQ(e,t)||LQ()}function LQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BQ(e,t){if(e){if(typeof e=="string")return fk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fk(e,t)}}function fk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function zQ(e){if(Array.isArray(e))return e}function WQ(e,t){if(e==null)return{};var r=HQ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HQ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function VQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GQ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u3(n.key),n)}}function XQ(e,t,r){return t&&GQ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function KQ(e,t,r){return t=Ah(t),qQ(e,l3()?Reflect.construct(t,r||[],Ah(e).constructor):t.apply(e,r))}function qQ(e,t){if(t&&(Ll(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YQ(e)}function YQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(l3=function(){return!!e})()}function Ah(e){return Ah=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ah(e)}function QQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kg(e,t)}function Kg(e,t){return Kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Kg(e,t)}function c3(e,t,r){return t=u3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u3(e){var t=ZQ(e,"string");return Ll(t)=="symbol"?t:t+""}function ZQ(e,t){if(Ll(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ll(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var u0=function(e){function t(){return VQ(this,t),KQ(this,t,arguments)}return QQ(t,e),XQ(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,o=n.dataKey,c=n.data,u=n.dataPointFormatter,f=n.xAxis,d=n.yAxis,h=WQ(n,RQ),p=Ce(h,!1);this.props.direction==="x"&&f.type!=="number"&&uo();var v=c.map(function(x){var y=u(x,o),g=y.x,b=y.y,m=y.value,S=y.errorVal;if(!S)return null;var w=[],_,k;if(Array.isArray(S)){var N=$Q(S,2);_=N[0],k=N[1]}else _=k=S;if(i==="vertical"){var j=f.scale,E=b+a,O=E+s,T=E-s,L=j(m-_),X=j(m+k);w.push({x1:X,y1:O,x2:X,y2:T}),w.push({x1:L,y1:E,x2:X,y2:E}),w.push({x1:L,y1:O,x2:L,y2:T})}else if(i==="horizontal"){var M=d.scale,U=g+a,q=U-s,K=U+s,F=M(m-_),Q=M(m+k);w.push({x1:q,y1:Q,x2:K,y2:Q}),w.push({x1:U,y1:F,x2:U,y2:Q}),w.push({x1:q,y1:F,x2:K,y2:F})}return Y.createElement(Je,Th({className:"recharts-errorBar",key:"bar-".concat(w.map(function(ie){return"".concat(ie.x1,"-").concat(ie.x2,"-").concat(ie.y1,"-").concat(ie.y2)}))},p),w.map(function(ie){return Y.createElement("line",Th({},ie,{key:"line-".concat(ie.x1,"-").concat(ie.x2,"-").concat(ie.y1,"-").concat(ie.y2)}))}))});return Y.createElement(Je,{className:"recharts-errorBars"},v)}}])}(Y.Component);c3(u0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});c3(u0,"displayName","ErrorBar");function pf(e){"@babel/helpers - typeof";return pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(e)}function dk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ns(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dk(Object(r),!0).forEach(function(n){JQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JQ(e,t,r){return t=eZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eZ(e){var t=tZ(e,"string");return pf(t)=="symbol"?t:t+""}function tZ(e,t){if(pf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f3=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=kn(r,Aa);if(!s)return null;var o=Aa.defaultProps,c=o!==void 0?Ns(Ns({},o),s.props):{},u;return s.props&&s.props.payload?u=s.props&&s.props.payload:i==="children"?u=(n||[]).reduce(function(f,d){var h=d.item,p=d.props,v=p.sectors||p.data||[];return f.concat(v.map(function(x){return{type:s.props.iconType||h.props.legendType,value:x.name,color:x.fill,payload:x}}))},[]):u=(n||[]).map(function(f){var d=f.item,h=d.type.defaultProps,p=h!==void 0?Ns(Ns({},h),d.props):{},v=p.dataKey,x=p.name,y=p.legendType,g=p.hide;return{inactive:g,dataKey:v,type:c.iconType||y||"square",color:Lb(d),value:x||v,payload:p}}),Ns(Ns(Ns({},c),Aa.getWithHeight(s,a)),{},{payload:u,item:s})};function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function hk(e){return iZ(e)||aZ(e)||nZ(e)||rZ()}function rZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nZ(e,t){if(e){if(typeof e=="string")return qg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qg(e,t)}}function aZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function iZ(e){if(Array.isArray(e))return qg(e)}function qg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pk(Object(r),!0).forEach(function(n){yl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yl(e,t,r){return t=sZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sZ(e){var t=oZ(e,"string");return mf(t)=="symbol"?t:t+""}function oZ(e,t){if(mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sr(e,t,r){return $e(e)||$e(t)?r:cr(t)?Mn(e,t,r):Ie(t)?t(e):r}function Su(e,t,r,n){var a=aQ(e,function(o){return sr(o,t)});if(r==="number"){var i=a.filter(function(o){return ve(o)||parseFloat(o)});return i.length?[Sm(i),_m(i)]:[1/0,-1/0]}var s=n?a.filter(function(o){return!$e(o)}):a;return s.map(function(o){return cr(o)||o instanceof Date?o:""})}var lZ=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,o=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(o<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<o;u++){var f=u>0?a[u-1].coordinate:a[o-1].coordinate,d=a[u].coordinate,h=u>=o-1?a[0].coordinate:a[u+1].coordinate,p=void 0;if(Jr(d-f)!==Jr(h-d)){var v=[];if(Jr(h-d)===Jr(c[1]-c[0])){p=h;var x=d+c[1]-c[0];v[0]=Math.min(x,(x+f)/2),v[1]=Math.max(x,(x+f)/2)}else{p=f;var y=h+c[1]-c[0];v[0]=Math.min(d,(y+d)/2),v[1]=Math.max(d,(y+d)/2)}var g=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(t>g[0]&&t<=g[1]||t>=v[0]&&t<=v[1]){s=a[u].index;break}}else{var b=Math.min(f,h),m=Math.max(f,h);if(t>(b+d)/2&&t<=(m+d)/2){s=a[u].index;break}}}else for(var S=0;S<o;S++)if(S===0&&t<=(n[S].coordinate+n[S+1].coordinate)/2||S>0&&S<o-1&&t>(n[S].coordinate+n[S-1].coordinate)/2&&t<=(n[S].coordinate+n[S+1].coordinate)/2||S===o-1&&t>(n[S].coordinate+n[S-1].coordinate)/2){s=n[S].index;break}return s},Lb=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Rt(Rt({},t.type.defaultProps),t.props):t.props,s=i.stroke,o=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:o;break;default:c=o;break}return c},cZ=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},o=Object.keys(i),c=0,u=o.length;c<u;c++)for(var f=i[o[c]].stackGroups,d=Object.keys(f),h=0,p=d.length;h<p;h++){var v=f[d[h]],x=v.items,y=v.cateAxisId,g=x.filter(function(k){return hi(k.type).indexOf("Bar")>=0});if(g&&g.length){var b=g[0].type.defaultProps,m=b!==void 0?Rt(Rt({},b),g[0].props):g[0].props,S=m.barSize,w=m[y];s[w]||(s[w]=[]);var _=$e(S)?r:S;s[w].push({item:g[0],stackList:g.slice(1),barSize:$e(_)?void 0:en(_,n,0)})}}return s},uZ=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,o=t.maxBarSize,c=s.length;if(c<1)return null;var u=en(r,a,0,!0),f,d=[];if(s[0].barSize===+s[0].barSize){var h=!1,p=a/c,v=s.reduce(function(S,w){return S+w.barSize||0},0);v+=(c-1)*u,v>=a&&(v-=(c-1)*u,u=0),v>=a&&p>0&&(h=!0,p*=.9,v=c*p);var x=(a-v)/2>>0,y={offset:x-u,size:0};f=s.reduce(function(S,w){var _={item:w.item,position:{offset:y.offset+y.size+u,size:h?p:w.barSize}},k=[].concat(hk(S),[_]);return y=k[k.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(N){k.push({item:N,position:y})}),k},d)}else{var g=en(n,a,0,!0);a-2*g-(c-1)*u<=0&&(u=0);var b=(a-2*g-(c-1)*u)/c;b>1&&(b>>=0);var m=o===+o?Math.min(b,o):b;f=s.reduce(function(S,w,_){var k=[].concat(hk(S),[{item:w.item,position:{offset:g+(b+u)*_+(b-m)/2,size:m}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(N){k.push({item:N,position:k[k.length-1].position})}),k},d)}return f},fZ=function(t,r,n,a){var i=n.children,s=n.width,o=n.margin,c=s-(o.left||0)-(o.right||0),u=f3({children:i,legendWidth:c});if(u){var f=a||{},d=f.width,h=f.height,p=u.align,v=u.verticalAlign,x=u.layout;if((x==="vertical"||x==="horizontal"&&v==="middle")&&p!=="center"&&ve(t[p]))return Rt(Rt({},t),{},yl({},p,t[p]+(d||0)));if((x==="horizontal"||x==="vertical"&&p==="center")&&v!=="middle"&&ve(t[v]))return Rt(Rt({},t),{},yl({},v,t[v]+(h||0)))}return t},dZ=function(t,r,n){return $e(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},d3=function(t,r,n,a,i){var s=r.props.children,o=Fn(s,u0).filter(function(u){return dZ(a,i,u.props.direction)});if(o&&o.length){var c=o.map(function(u){return u.props.dataKey});return t.reduce(function(u,f){var d=sr(f,n);if($e(d))return u;var h=Array.isArray(d)?[Sm(d),_m(d)]:[d,d],p=c.reduce(function(v,x){var y=sr(f,x,0),g=h[0]-Math.abs(Array.isArray(y)?y[0]:y),b=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(g,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},hZ=function(t,r,n,a,i){var s=r.map(function(o){return d3(t,o,n,i,a)}).filter(function(o){return!$e(o)});return s&&s.length?s.reduce(function(o,c){return[Math.min(o[0],c[0]),Math.max(o[1],c[1])]},[1/0,-1/0]):null},h3=function(t,r,n,a,i){var s=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&d3(t,c,u,a)||Su(t,u,n,i)});if(n==="number")return s.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var o={};return s.reduce(function(c,u){for(var f=0,d=u.length;f<d;f++)o[u[f]]||(o[u[f]]=!0,c.push(u[f]));return c},[])},p3=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},m3=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,o=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||o.push(r),s||o.push(n),o},ui=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,o=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,u=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?Jr(o[0]-o[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var f=(t.ticks||t.niceTicks).map(function(d){var h=i?i.indexOf(d):d;return{coordinate:a(h)+u,value:d,offset:u}});return f.filter(function(d){return!n0(d.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(d,h){return{coordinate:a(d)+u,value:d,index:h,offset:u}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(d){return{coordinate:a(d)+u,value:d,offset:u}}):a.domain().map(function(d,h){return{coordinate:a(d)+u,value:i?i[d]:d,index:h,offset:u}})},Hx=new WeakMap,Y0=function(t,r){if(typeof r!="function")return t;Hx.has(t)||Hx.set(t,new WeakMap);var n=Hx.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},x3=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,o=t.axisType;if(a==="auto")return s==="radial"&&o==="radiusAxis"?{scale:of(),realScaleType:"band"}:s==="radial"&&o==="angleAxis"?{scale:Sh(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:_u(),realScaleType:"point"}:i==="category"?{scale:of(),realScaleType:"band"}:{scale:Sh(),realScaleType:"linear"};if(so(a)){var c="scale".concat(lm(a));return{scale:(ok[c]||_u)(),realScaleType:ok[c]?c:"point"}}return Ie(a)?{scale:a}:{scale:_u(),realScaleType:"point"}},mk=1e-4,v3=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-mk,s=Math.max(a[0],a[1])+mk,o=t(r[0]),c=t(r[n-1]);(o<i||o>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},pZ=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},mZ=function(t,r){if(!r||r.length!==2||!ve(r[0])||!ve(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!ve(t[0])||t[0]<n)&&(i[0]=n),(!ve(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},xZ=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,o=0;o<r;++o){var c=n0(t[o][n][1])?t[o][n][0]:t[o][n][1];c>=0?(t[o][n][0]=i,t[o][n][1]=i+c,i=t[o][n][1]):(t[o][n][0]=s,t[o][n][1]=s+c,s=t[o][n][1])}},vZ=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var o=n0(t[s][n][1])?t[s][n][0]:t[s][n][1];o>=0?(t[s][n][0]=i,t[s][n][1]=i+o,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},gZ={sign:xZ,expand:RB,none:Cl,silhouette:$B,wiggle:LB,positive:vZ},yZ=function(t,r,n){var a=r.map(function(o){return o.props.dataKey}),i=gZ[n],s=IB().keys(a).value(function(o,c){return+sr(o,c,0)}).order(bg).offset(i);return s(t)},bZ=function(t,r,n,a,i,s){if(!t)return null;var o=s?r.reverse():r,c={},u=o.reduce(function(d,h){var p,v=(p=h.type)!==null&&p!==void 0&&p.defaultProps?Rt(Rt({},h.type.defaultProps),h.props):h.props,x=v.stackId,y=v.hide;if(y)return d;var g=v[n],b=d[g]||{hasStack:!1,stackGroups:{}};if(cr(x)){var m=b.stackGroups[x]||{numericAxisId:n,cateAxisId:a,items:[]};m.items.push(h),b.hasStack=!0,b.stackGroups[x]=m}else b.stackGroups[gc("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[h]};return Rt(Rt({},d),{},yl({},g,b))},c),f={};return Object.keys(u).reduce(function(d,h){var p=u[h];if(p.hasStack){var v={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(x,y){var g=p.stackGroups[y];return Rt(Rt({},x),{},yl({},y,{numericAxisId:n,cateAxisId:a,items:g.items,stackedData:yZ(t,g.items,i)}))},v)}return Rt(Rt({},d),{},yl({},h,p))},f)},g3=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,o=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var u=t.domain();if(!u.length)return null;var f=FQ(u,i,o);return t.domain([Sm(f),_m(f)]),{niceTicks:f}}if(i&&a==="number"){var d=t.domain(),h=DQ(d,i,o);return{niceTicks:h}}return null};function xk(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!$e(a[t.dataKey])){var o=th(r,"value",a[t.dataKey]);if(o)return o.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=sr(a,$e(s)?t.dataKey:s);return $e(c)?null:t.scale(c)}var vk=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,o=t.index;if(r.type==="category")return n[o]?n[o].coordinate+a:null;var c=sr(s,r.dataKey,r.domain[o]);return $e(c)?null:r.scale(c)-i/2+a},wZ=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},_Z=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Rt(Rt({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(cr(i)){var s=r[i];if(s){var o=s.items.indexOf(t);return o>=0?s.stackedData[o]:null}}return null},SZ=function(t){return t.reduce(function(r,n){return[Sm(n.concat([r[0]]).filter(ve)),_m(n.concat([r[1]]).filter(ve))]},[1/0,-1/0])},y3=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],o=s.stackedData,c=o.reduce(function(u,f){var d=SZ(f.slice(r,n+1));return[Math.min(u[0],d[0]),Math.max(u[1],d[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},gk=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,yk=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Yg=function(t,r,n){if(Ie(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(ve(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(gk.test(t[0])){var i=+gk.exec(t[0])[1];a[0]=r[0]-i}else Ie(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(ve(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(yk.test(t[1])){var s=+yk.exec(t[1])[1];a[1]=r[1]+s}else Ie(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},Oh=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=hb(r,function(d){return d.coordinate}),s=1/0,o=1,c=i.length;o<c;o++){var u=i[o],f=i[o-1];s=Math.min((u.coordinate||0)-(f.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},bk=function(t,r,n){return!t||!t.length||c0(t,Mn(n,"type.defaultProps.domain"))?r:t},b3=function(t,r){var n=t.type.defaultProps?Rt(Rt({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,o=n.formatter,c=n.tooltipType,u=n.chartType,f=n.hide;return Rt(Rt({},Ce(t,!1)),{},{dataKey:a,unit:s,formatter:o,name:i||a,color:Lb(t),value:sr(r,a),type:c,payload:r,chartType:u,hide:f})};function xf(e){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xf(e)}function wk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wk(Object(r),!0).forEach(function(n){w3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w3(e,t,r){return t=kZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kZ(e){var t=NZ(e,"string");return xf(t)=="symbol"?t:t+""}function NZ(e,t){if(xf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jZ(e,t){return OZ(e)||AZ(e,t)||TZ(e,t)||EZ()}function EZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TZ(e,t){if(e){if(typeof e=="string")return _k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _k(e,t)}}function _k(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function AZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function OZ(e){if(Array.isArray(e))return e}var Ch=Math.PI/180,CZ=function(t){return t*180/Math.PI},pt=function(t,r,n,a){return{x:t+Math.cos(-Ch*a)*n,y:r+Math.sin(-Ch*a)*n}},_3=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},PZ=function(t,r,n,a,i){var s=t.width,o=t.height,c=t.startAngle,u=t.endAngle,f=en(t.cx,s,s/2),d=en(t.cy,o,o/2),h=_3(s,o,n),p=en(t.innerRadius,h,0),v=en(t.outerRadius,h,h*.8),x=Object.keys(r);return x.reduce(function(y,g){var b=r[g],m=b.domain,S=b.reversed,w;if($e(b.range))a==="angleAxis"?w=[c,u]:a==="radiusAxis"&&(w=[p,v]),S&&(w=[w[1],w[0]]);else{w=b.range;var _=w,k=jZ(_,2);c=k[0],u=k[1]}var N=x3(b,i),j=N.realScaleType,E=N.scale;E.domain(m).range(w),v3(E);var O=g3(E,ai(ai({},b),{},{realScaleType:j})),T=ai(ai(ai({},b),O),{},{range:w,radius:v,realScaleType:j,scale:E,cx:f,cy:d,innerRadius:p,outerRadius:v,startAngle:c,endAngle:u});return ai(ai({},y),{},w3({},g,T))},{})},MZ=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},FZ=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,o=MZ({x:n,y:a},{x:i,y:s});if(o<=0)return{radius:o};var c=(n-i)/o,u=Math.acos(c);return a>s&&(u=2*Math.PI-u),{radius:o,angle:CZ(u),angleInRadian:u}},DZ=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},IZ=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),o=Math.min(i,s);return t+o*360},Sk=function(t,r){var n=t.x,a=t.y,i=FZ({x:n,y:a},r),s=i.radius,o=i.angle,c=r.innerRadius,u=r.outerRadius;if(s<c||s>u)return!1;if(s===0)return!0;var f=DZ(r),d=f.startAngle,h=f.endAngle,p=o,v;if(d<=h){for(;p>h;)p-=360;for(;p<d;)p+=360;v=p>=d&&p<=h}else{for(;p>d;)p-=360;for(;p<h;)p+=360;v=p>=h&&p<=d}return v?ai(ai({},r),{},{radius:s,angle:IZ(p,r)}):null},S3=function(t){return!G.isValidElement(t)&&!Ie(t)&&typeof t!="boolean"?t.className:""};function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}var RZ=["offset"];function $Z(e){return zZ(e)||UZ(e)||BZ(e)||LZ()}function LZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BZ(e,t){if(e){if(typeof e=="string")return Qg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qg(e,t)}}function UZ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zZ(e){if(Array.isArray(e))return Qg(e)}function Qg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WZ(e,t){if(e==null)return{};var r=HZ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function HZ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kk(Object(r),!0).forEach(function(n){VZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VZ(e,t,r){return t=GZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GZ(e){var t=XZ(e,"string");return vf(t)=="symbol"?t:t+""}function XZ(e,t){if(vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gf(){return gf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gf.apply(this,arguments)}var KZ=function(t){var r=t.value,n=t.formatter,a=$e(t.children)?r:t.children;return Ie(n)?n(a):a},qZ=function(t,r){var n=Jr(r-t),a=Math.min(Math.abs(r-t),360);return n*a},YZ=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,o=t.className,c=i,u=c.cx,f=c.cy,d=c.innerRadius,h=c.outerRadius,p=c.startAngle,v=c.endAngle,x=c.clockWise,y=(d+h)/2,g=qZ(p,v),b=g>=0?1:-1,m,S;a==="insideStart"?(m=p+b*s,S=x):a==="insideEnd"?(m=v-b*s,S=!x):a==="end"&&(m=v+b*s,S=x),S=g<=0?S:!S;var w=pt(u,f,y,m),_=pt(u,f,y,m+(S?1:-1)*359),k="M".concat(w.x,",").concat(w.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(S?0:1,`,
    `).concat(_.x,",").concat(_.y),N=$e(t.id)?gc("recharts-radial-line-"):t.id;return Y.createElement("text",gf({},n,{dominantBaseline:"central",className:ze("recharts-radial-bar-label",o)}),Y.createElement("defs",null,Y.createElement("path",{id:N,d:k})),Y.createElement("textPath",{xlinkHref:"#".concat(N)},r))},QZ=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,o=i.cy,c=i.innerRadius,u=i.outerRadius,f=i.startAngle,d=i.endAngle,h=(f+d)/2;if(a==="outside"){var p=pt(s,o,u+n,h),v=p.x,x=p.y;return{x:v,y:x,textAnchor:v>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:o,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,g=pt(s,o,y,h),b=g.x,m=g.y;return{x:b,y:m,textAnchor:"middle",verticalAnchor:"middle"}},ZZ=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,o=s.x,c=s.y,u=s.width,f=s.height,d=f>=0?1:-1,h=d*a,p=d>0?"end":"start",v=d>0?"start":"end",x=u>=0?1:-1,y=x*a,g=x>0?"end":"start",b=x>0?"start":"end";if(i==="top"){var m={x:o+u/2,y:c-d*a,textAnchor:"middle",verticalAnchor:p};return ar(ar({},m),n?{height:Math.max(c-n.y,0),width:u}:{})}if(i==="bottom"){var S={x:o+u/2,y:c+f+h,textAnchor:"middle",verticalAnchor:v};return ar(ar({},S),n?{height:Math.max(n.y+n.height-(c+f),0),width:u}:{})}if(i==="left"){var w={x:o-y,y:c+f/2,textAnchor:g,verticalAnchor:"middle"};return ar(ar({},w),n?{width:Math.max(w.x-n.x,0),height:f}:{})}if(i==="right"){var _={x:o+u+y,y:c+f/2,textAnchor:b,verticalAnchor:"middle"};return ar(ar({},_),n?{width:Math.max(n.x+n.width-_.x,0),height:f}:{})}var k=n?{width:u,height:f}:{};return i==="insideLeft"?ar({x:o+y,y:c+f/2,textAnchor:b,verticalAnchor:"middle"},k):i==="insideRight"?ar({x:o+u-y,y:c+f/2,textAnchor:g,verticalAnchor:"middle"},k):i==="insideTop"?ar({x:o+u/2,y:c+h,textAnchor:"middle",verticalAnchor:v},k):i==="insideBottom"?ar({x:o+u/2,y:c+f-h,textAnchor:"middle",verticalAnchor:p},k):i==="insideTopLeft"?ar({x:o+y,y:c+h,textAnchor:b,verticalAnchor:v},k):i==="insideTopRight"?ar({x:o+u-y,y:c+h,textAnchor:g,verticalAnchor:v},k):i==="insideBottomLeft"?ar({x:o+y,y:c+f-h,textAnchor:b,verticalAnchor:p},k):i==="insideBottomRight"?ar({x:o+u-y,y:c+f-h,textAnchor:g,verticalAnchor:p},k):pc(i)&&(ve(i.x)||zs(i.x))&&(ve(i.y)||zs(i.y))?ar({x:o+en(i.x,u),y:c+en(i.y,f),textAnchor:"end",verticalAnchor:"end"},k):ar({x:o+u/2,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},k)},JZ=function(t){return"cx"in t&&ve(t.cx)};function xr(e){var t=e.offset,r=t===void 0?5:t,n=WZ(e,RZ),a=ar({offset:r},n),i=a.viewBox,s=a.position,o=a.value,c=a.children,u=a.content,f=a.className,d=f===void 0?"":f,h=a.textBreakAll;if(!i||$e(o)&&$e(c)&&!G.isValidElement(u)&&!Ie(u))return null;if(G.isValidElement(u))return G.cloneElement(u,a);var p;if(Ie(u)){if(p=G.createElement(u,a),G.isValidElement(p))return p}else p=KZ(a);var v=JZ(i),x=Ce(a,!0);if(v&&(s==="insideStart"||s==="insideEnd"||s==="end"))return YZ(a,p,x);var y=v?QZ(a):ZZ(a);return Y.createElement(lo,gf({className:ze("recharts-label",d)},x,y,{breakAll:h}),p)}xr.displayName="Label";var k3=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,o=t.r,c=t.radius,u=t.innerRadius,f=t.outerRadius,d=t.x,h=t.y,p=t.top,v=t.left,x=t.width,y=t.height,g=t.clockWise,b=t.labelViewBox;if(b)return b;if(ve(x)&&ve(y)){if(ve(d)&&ve(h))return{x:d,y:h,width:x,height:y};if(ve(p)&&ve(v))return{x:p,y:v,width:x,height:y}}return ve(d)&&ve(h)?{x:d,y:h,width:0,height:0}:ve(r)&&ve(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:u||0,outerRadius:f||c||o||0,clockWise:g}:t.viewBox?t.viewBox:{}},eJ=function(t,r){return t?t===!0?Y.createElement(xr,{key:"label-implicit",viewBox:r}):cr(t)?Y.createElement(xr,{key:"label-implicit",viewBox:r,value:t}):G.isValidElement(t)?t.type===xr?G.cloneElement(t,{key:"label-implicit",viewBox:r}):Y.createElement(xr,{key:"label-implicit",content:t,viewBox:r}):Ie(t)?Y.createElement(xr,{key:"label-implicit",content:t,viewBox:r}):pc(t)?Y.createElement(xr,gf({viewBox:r},t,{key:"label-implicit"})):null:null},tJ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=k3(t),s=Fn(a,xr).map(function(c,u){return G.cloneElement(c,{viewBox:r||i,key:"label-".concat(u)})});if(!n)return s;var o=eJ(t.label,r||i);return[o].concat($Z(s))};xr.parseViewBox=k3;xr.renderCallByParent=tJ;function rJ(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var nJ=rJ;const aJ=st(nJ);function yf(e){"@babel/helpers - typeof";return yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yf(e)}var iJ=["valueAccessor"],sJ=["data","dataKey","clockWise","id","textBreakAll"];function oJ(e){return fJ(e)||uJ(e)||cJ(e)||lJ()}function lJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cJ(e,t){if(e){if(typeof e=="string")return Zg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zg(e,t)}}function uJ(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function fJ(e){if(Array.isArray(e))return Zg(e)}function Zg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ph.apply(this,arguments)}function Nk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nk(Object(r),!0).forEach(function(n){dJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dJ(e,t,r){return t=hJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hJ(e){var t=pJ(e,"string");return yf(t)=="symbol"?t:t+""}function pJ(e,t){if(yf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ek(e,t){if(e==null)return{};var r=mJ(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var xJ=function(t){return Array.isArray(t.value)?aJ(t.value):t.value};function ta(e){var t=e.valueAccessor,r=t===void 0?xJ:t,n=Ek(e,iJ),a=n.data,i=n.dataKey,s=n.clockWise,o=n.id,c=n.textBreakAll,u=Ek(n,sJ);return!a||!a.length?null:Y.createElement(Je,{className:"recharts-label-list"},a.map(function(f,d){var h=$e(i)?r(f,d):sr(f&&f.payload,i),p=$e(o)?{}:{id:"".concat(o,"-").concat(d)};return Y.createElement(xr,Ph({},Ce(f,!0),u,p,{parentViewBox:f.parentViewBox,value:h,textBreakAll:c,viewBox:xr.parseViewBox($e(s)?f:jk(jk({},f),{},{clockWise:s})),key:"label-".concat(d),index:d}))}))}ta.displayName="LabelList";function vJ(e,t){return e?e===!0?Y.createElement(ta,{key:"labelList-implicit",data:t}):Y.isValidElement(e)||Ie(e)?Y.createElement(ta,{key:"labelList-implicit",data:t,content:e}):pc(e)?Y.createElement(ta,Ph({data:t},e,{key:"labelList-implicit"})):null:null}function gJ(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Fn(n,ta).map(function(s,o){return G.cloneElement(s,{data:t,key:"labelList-".concat(o)})});if(!r)return a;var i=vJ(e.label,t);return[i].concat(oJ(a))}ta.renderCallByParent=gJ;function bf(e){"@babel/helpers - typeof";return bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bf(e)}function Jg(){return Jg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jg.apply(this,arguments)}function Tk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ak(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tk(Object(r),!0).forEach(function(n){yJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yJ(e,t,r){return t=bJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bJ(e){var t=wJ(e,"string");return bf(t)=="symbol"?t:t+""}function wJ(e,t){if(bf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _J=function(t,r){var n=Jr(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Q0=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,o=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,f=c*(o?1:-1)+a,d=Math.asin(c/f)/Ch,h=u?i:i+s*d,p=pt(r,n,f,h),v=pt(r,n,a,h),x=u?i-s*d:i,y=pt(r,n,f*Math.cos(d*Ch),x);return{center:p,circleTangency:v,lineTangency:y,theta:d}},N3=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,o=t.endAngle,c=_J(s,o),u=s+c,f=pt(r,n,i,s),d=pt(r,n,i,u),h="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>u),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(a>0){var p=pt(r,n,a,s),v=pt(r,n,a,u);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},SJ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,o=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,f=t.endAngle,d=Jr(f-u),h=Q0({cx:r,cy:n,radius:i,angle:u,sign:d,cornerRadius:s,cornerIsExternal:c}),p=h.circleTangency,v=h.lineTangency,x=h.theta,y=Q0({cx:r,cy:n,radius:i,angle:f,sign:-d,cornerRadius:s,cornerIsExternal:c}),g=y.circleTangency,b=y.lineTangency,m=y.theta,S=c?Math.abs(u-f):Math.abs(u-f)-x-m;if(S<0)return o?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):N3({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:f});var w="M ".concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(S>180),",").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(b.x,",").concat(b.y,`
  `);if(a>0){var _=Q0({cx:r,cy:n,radius:a,angle:u,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),k=_.circleTangency,N=_.lineTangency,j=_.theta,E=Q0({cx:r,cy:n,radius:a,angle:f,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),O=E.circleTangency,T=E.lineTangency,L=E.theta,X=c?Math.abs(u-f):Math.abs(u-f)-j-L;if(X<0&&s===0)return"".concat(w,"L").concat(r,",").concat(n,"Z");w+="L".concat(T.x,",").concat(T.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(X>180),",").concat(+(d>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else w+="L".concat(r,",").concat(n,"Z");return w},kJ={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},j3=function(t){var r=Ak(Ak({},kJ),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,o=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,f=r.startAngle,d=r.endAngle,h=r.className;if(s<i||f===d)return null;var p=ze("recharts-sector",h),v=s-i,x=en(o,v,0,!0),y;return x>0&&Math.abs(f-d)<360?y=SJ({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(x,v/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:f,endAngle:d}):y=N3({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:f,endAngle:d}),Y.createElement("path",Jg({},Ce(r,!0),{className:p,d:y,role:"img"}))};function wf(e){"@babel/helpers - typeof";return wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wf(e)}function e1(){return e1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e1.apply(this,arguments)}function Ok(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ck(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ok(Object(r),!0).forEach(function(n){NJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ok(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NJ(e,t,r){return t=jJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jJ(e){var t=EJ(e,"string");return wf(t)=="symbol"?t:t+""}function EJ(e,t){if(wf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pk={curveBasisClosed:NB,curveBasisOpen:jB,curveBasis:kB,curveBumpX:uB,curveBumpY:fB,curveLinearClosed:EB,curveLinear:um,curveMonotoneX:TB,curveMonotoneY:AB,curveNatural:OB,curveStep:CB,curveStepAfter:MB,curveStepBefore:PB},Z0=function(t){return t.x===+t.x&&t.y===+t.y},qc=function(t){return t.x},Yc=function(t){return t.y},TJ=function(t,r){if(Ie(t))return t;var n="curve".concat(lm(t));return(n==="curveMonotone"||n==="curveBump")&&r?Pk["".concat(n).concat(r==="vertical"?"Y":"X")]:Pk[n]||um},AJ=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,o=t.layout,c=t.connectNulls,u=c===void 0?!1:c,f=TJ(n,o),d=u?i.filter(function(x){return Z0(x)}):i,h;if(Array.isArray(s)){var p=u?s.filter(function(x){return Z0(x)}):s,v=d.map(function(x,y){return Ck(Ck({},x),{},{base:p[y]})});return o==="vertical"?h=z0().y(Yc).x1(qc).x0(function(x){return x.base.x}):h=z0().x(qc).y1(Yc).y0(function(x){return x.base.y}),h.defined(Z0).curve(f),h(v)}return o==="vertical"&&ve(s)?h=z0().y(Yc).x1(qc).x0(s):ve(s)?h=z0().x(qc).y1(Yc).y0(s):h=wA().x(qc).y(Yc),h.defined(Z0).curve(f),h(d)},Mh=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?AJ(t):a;return G.createElement("path",e1({},Ce(t,!1),rh(t),{className:ze("recharts-curve",r),d:s,ref:i}))},E3={exports:{}},OJ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",CJ=OJ,PJ=CJ;function T3(){}function A3(){}A3.resetWarningCache=T3;var MJ=function(){function e(n,a,i,s,o,c){if(c!==PJ){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:A3,resetWarningCache:T3};return r.PropTypes=r,r};E3.exports=MJ();var FJ=E3.exports;const tt=st(FJ),{getOwnPropertyNames:DJ,getOwnPropertySymbols:IJ}=Object,{hasOwnProperty:RJ}=Object.prototype;function Vx(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function J0(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);const{cache:i}=a,s=i.get(r),o=i.get(n);if(s&&o)return s===n&&o===r;i.set(r,n),i.set(n,r);const c=e(r,n,a);return i.delete(r),i.delete(n),c}}function $J(e){return e!=null?e[Symbol.toStringTag]:void 0}function Mk(e){return DJ(e).concat(IJ(e))}const LJ=Object.hasOwn||((e,t)=>RJ.call(e,t));function jo(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const BJ="__v",UJ="__o",zJ="_owner",{getOwnPropertyDescriptor:Fk,keys:Dk}=Object;function WJ(e,t){return e.byteLength===t.byteLength&&Fh(new Uint8Array(e),new Uint8Array(t))}function HJ(e,t,r){let n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function VJ(e,t){return e.byteLength===t.byteLength&&Fh(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function GJ(e,t){return jo(e.getTime(),t.getTime())}function XJ(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function KJ(e,t){return e===t}function Ik(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.entries();let s,o,c=0;for(;(s=i.next())&&!s.done;){const u=t.entries();let f=!1,d=0;for(;(o=u.next())&&!o.done;){if(a[d]){d++;continue}const h=s.value,p=o.value;if(r.equals(h[0],p[0],c,d,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){f=a[d]=!0;break}d++}if(!f)return!1;c++}return!0}const qJ=jo;function YJ(e,t,r){const n=Dk(e);let a=n.length;if(Dk(t).length!==a)return!1;for(;a-- >0;)if(!O3(e,t,r,n[a]))return!1;return!0}function Qc(e,t,r){const n=Mk(e);let a=n.length;if(Mk(t).length!==a)return!1;let i,s,o;for(;a-- >0;)if(i=n[a],!O3(e,t,r,i)||(s=Fk(e,i),o=Fk(t,i),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function QJ(e,t){return jo(e.valueOf(),t.valueOf())}function ZJ(e,t){return e.source===t.source&&e.flags===t.flags}function Rk(e,t,r){const n=e.size;if(n!==t.size)return!1;if(!n)return!0;const a=new Array(n),i=e.values();let s,o;for(;(s=i.next())&&!s.done;){const c=t.values();let u=!1,f=0;for(;(o=c.next())&&!o.done;){if(!a[f]&&r.equals(s.value,o.value,s.value,o.value,e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1}return!0}function Fh(e,t){let r=e.byteLength;if(t.byteLength!==r||e.byteOffset!==t.byteOffset)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function JJ(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function O3(e,t,r,n){return(n===zJ||n===UJ||n===BJ)&&(e.$$typeof||t.$$typeof)?!0:LJ(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}const eee="[object ArrayBuffer]",tee="[object Arguments]",ree="[object Boolean]",nee="[object DataView]",aee="[object Date]",iee="[object Error]",see="[object Map]",oee="[object Number]",lee="[object Object]",cee="[object RegExp]",uee="[object Set]",fee="[object String]",dee={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},hee="[object URL]",pee=Object.prototype.toString;function mee({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:a,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:c,arePrimitiveWrappersEqual:u,areRegExpsEqual:f,areSetsEqual:d,areTypedArraysEqual:h,areUrlsEqual:p,unknownTagComparators:v}){return function(y,g,b){if(y===g)return!0;if(y==null||g==null)return!1;const m=typeof y;if(m!==typeof g)return!1;if(m!=="object")return m==="number"?o(y,g,b):m==="function"?i(y,g,b):!1;const S=y.constructor;if(S!==g.constructor)return!1;if(S===Object)return c(y,g,b);if(Array.isArray(y))return t(y,g,b);if(S===Date)return n(y,g,b);if(S===RegExp)return f(y,g,b);if(S===Map)return s(y,g,b);if(S===Set)return d(y,g,b);const w=pee.call(y);if(w===aee)return n(y,g,b);if(w===cee)return f(y,g,b);if(w===see)return s(y,g,b);if(w===uee)return d(y,g,b);if(w===lee)return typeof y.then!="function"&&typeof g.then!="function"&&c(y,g,b);if(w===hee)return p(y,g,b);if(w===iee)return a(y,g,b);if(w===tee)return c(y,g,b);if(dee[w])return h(y,g,b);if(w===eee)return e(y,g,b);if(w===nee)return r(y,g,b);if(w===ree||w===oee||w===fee)return u(y,g,b);if(v){let _=v[w];if(!_){const k=$J(y);k&&(_=v[k])}if(_)return _(y,g,b)}return!1}}function xee({circular:e,createCustomConfig:t,strict:r}){let n={areArrayBuffersEqual:WJ,areArraysEqual:r?Qc:HJ,areDataViewsEqual:VJ,areDatesEqual:GJ,areErrorsEqual:XJ,areFunctionsEqual:KJ,areMapsEqual:r?Vx(Ik,Qc):Ik,areNumbersEqual:qJ,areObjectsEqual:r?Qc:YJ,arePrimitiveWrappersEqual:QJ,areRegExpsEqual:ZJ,areSetsEqual:r?Vx(Rk,Qc):Rk,areTypedArraysEqual:r?Vx(Fh,Qc):Fh,areUrlsEqual:JJ,unknownTagComparators:void 0};if(t&&(n=Object.assign({},n,t(n))),e){const a=J0(n.areArraysEqual),i=J0(n.areMapsEqual),s=J0(n.areObjectsEqual),o=J0(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:a,areMapsEqual:i,areObjectsEqual:s,areSetsEqual:o})}return n}function vee(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}function gee({circular:e,comparator:t,createState:r,equals:n,strict:a}){if(r)return function(o,c){const{cache:u=e?new WeakMap:void 0,meta:f}=r();return t(o,c,{cache:u,equals:n,meta:f,strict:a})};if(e)return function(o,c){return t(o,c,{cache:new WeakMap,equals:n,meta:void 0,strict:a})};const i={cache:void 0,equals:n,meta:void 0,strict:a};return function(o,c){return t(o,c,i)}}const yee=ys();ys({strict:!0});ys({circular:!0});ys({circular:!0,strict:!0});ys({createInternalComparator:()=>jo});ys({strict:!0,createInternalComparator:()=>jo});ys({circular:!0,createInternalComparator:()=>jo});ys({circular:!0,createInternalComparator:()=>jo,strict:!0});function ys(e={}){const{circular:t=!1,createInternalComparator:r,createState:n,strict:a=!1}=e,i=xee(e),s=mee(i),o=r?r(s):vee(s);return gee({circular:t,comparator:s,createState:n,equals:o,strict:a})}function bee(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function $k(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):bee(a)};requestAnimationFrame(n)}function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}function wee(e){return Nee(e)||kee(e)||See(e)||_ee()}function _ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function See(e,t){if(e){if(typeof e=="string")return Lk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lk(e,t)}}function Lk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Nee(e){if(Array.isArray(e))return e}function jee(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,o=wee(s),c=o[0],u=o.slice(1);if(typeof c=="number"){$k(a.bind(null,u),c);return}a(c),$k(a.bind(null,u));return}t1(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function Bk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bk(Object(r),!0).forEach(function(n){C3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C3(e,t,r){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eee(e){var t=Tee(e,"string");return _f(t)==="symbol"?t:String(t)}function Tee(e,t){if(_f(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aee=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},Oee=function(t){return t},Cee=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},ku=function(t,r){return Object.keys(r).reduce(function(n,a){return Uk(Uk({},n),{},C3({},a,t(a,r[a])))},{})},zk=function(t,r,n){return t.map(function(a){return"".concat(Cee(a)," ").concat(r,"ms ").concat(n)}).join(",")};function Pee(e,t){return Dee(e)||Fee(e,t)||P3(e,t)||Mee()}function Mee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Dee(e){if(Array.isArray(e))return e}function Iee(e){return Lee(e)||$ee(e)||P3(e)||Ree()}function Ree(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P3(e,t){if(e){if(typeof e=="string")return r1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r1(e,t)}}function $ee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lee(e){if(Array.isArray(e))return r1(e)}function r1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Dh=1e-4,M3=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},F3=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Wk=function(t,r){return function(n){var a=M3(t,r);return F3(a,n)}},Bee=function(t,r){return function(n){var a=M3(t,r),i=[].concat(Iee(a.map(function(s,o){return s*o}).slice(1)),[0]);return F3(i,n)}},Hk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],o=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,o=1;break;case"ease":a=.25,i=.1,s=.25,o=1;break;case"ease-in":a=.42,i=0,s=1,o=1;break;case"ease-out":a=.42,i=0,s=.58,o=1;break;case"ease-in-out":a=0,i=0,s=.58,o=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),f=Pee(u,4);a=f[0],i=f[1],s=f[2],o=f[3]}}}var d=Wk(a,s),h=Wk(i,o),p=Bee(a,s),v=function(g){return g>1?1:g<0?0:g},x=function(g){for(var b=g>1?1:g,m=b,S=0;S<8;++S){var w=d(m)-b,_=p(m);if(Math.abs(w-b)<Dh||_<Dh)return h(m);m=v(m-w/_)}return h(m)};return x.isStepper=!1,x},Uee=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,o=s===void 0?17:s,c=function(f,d,h){var p=-(f-d)*n,v=h*i,x=h+(p-v)*o/1e3,y=h*o/1e3+f;return Math.abs(y-d)<Dh&&Math.abs(x)<Dh?[d,0]:[y,x]};return c.isStepper=!0,c.dt=o,c},zee=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Hk(a);case"spring":return Uee();default:if(a.split("(")[0]==="cubic-bezier")return Hk(a)}return typeof a=="function"?a:null};function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function Vk(e){return Vee(e)||Hee(e)||D3(e)||Wee()}function Wee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Vee(e){if(Array.isArray(e))return a1(e)}function Gk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gk(Object(r),!0).forEach(function(n){n1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n1(e,t,r){return t=Gee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gee(e){var t=Xee(e,"string");return Sf(t)==="symbol"?t:String(t)}function Xee(e,t){if(Sf(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kee(e,t){return Qee(e)||Yee(e,t)||D3(e,t)||qee()}function qee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D3(e,t){if(e){if(typeof e=="string")return a1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a1(e,t)}}function a1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Qee(e){if(Array.isArray(e))return e}var Ih=function(t,r,n){return t+(r-t)*n},i1=function(t){var r=t.from,n=t.to;return r!==n},Zee=function e(t,r,n){var a=ku(function(i,s){if(i1(s)){var o=t(s.from,s.to,s.velocity),c=Kee(o,2),u=c[0],f=c[1];return kr(kr({},s),{},{from:u,velocity:f})}return s},r);return n<1?ku(function(i,s){return i1(s)?kr(kr({},s),{},{velocity:Ih(s.velocity,a[i].velocity,n),from:Ih(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const Jee=function(e,t,r,n,a){var i=Aee(e,t),s=i.reduce(function(y,g){return kr(kr({},y),{},n1({},g,[e[g],t[g]]))},{}),o=i.reduce(function(y,g){return kr(kr({},y),{},n1({},g,{from:e[g],velocity:0,to:t[g]}))},{}),c=-1,u,f,d=function(){return null},h=function(){return ku(function(g,b){return b.from},o)},p=function(){return!Object.values(o).filter(i1).length},v=function(g){u||(u=g);var b=g-u,m=b/r.dt;o=Zee(r,o,m),a(kr(kr(kr({},e),t),h())),u=g,p()||(c=requestAnimationFrame(d))},x=function(g){f||(f=g);var b=(g-f)/n,m=ku(function(w,_){return Ih.apply(void 0,Vk(_).concat([r(b)]))},s);if(a(kr(kr(kr({},e),t),m)),b<1)c=requestAnimationFrame(d);else{var S=ku(function(w,_){return Ih.apply(void 0,Vk(_).concat([r(1)]))},s);a(kr(kr(kr({},e),t),S))}};return d=r.isStepper?v:x,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(c)}}};function Bl(e){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bl(e)}var ete=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function tte(e,t){if(e==null)return{};var r=rte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rte(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Gx(e){return ste(e)||ite(e)||ate(e)||nte()}function nte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ate(e,t){if(e){if(typeof e=="string")return s1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s1(e,t)}}function ite(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ste(e){if(Array.isArray(e))return s1(e)}function s1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xk(Object(r),!0).forEach(function(n){lu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lu(e,t,r){return t=I3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lte(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,I3(n.key),n)}}function cte(e,t,r){return t&&lte(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function I3(e){var t=ute(e,"string");return Bl(t)==="symbol"?t:String(t)}function ute(e,t){if(Bl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fte(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o1(e,t)}function o1(e,t){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},o1(e,t)}function dte(e){var t=hte();return function(){var n=Rh(e),a;if(t){var i=Rh(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return l1(this,a)}}function l1(e,t){if(t&&(Bl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c1(e)}function c1(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hte(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rh(e){return Rh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rh(e)}var Ka=function(e){fte(r,e);var t=dte(r);function r(n,a){var i;ote(this,r),i=t.call(this,n,a);var s=i.props,o=s.isActive,c=s.attributeName,u=s.from,f=s.to,d=s.steps,h=s.children,p=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(c1(i)),i.changeStyle=i.changeStyle.bind(c1(i)),!o||p<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:f}),l1(i);if(d&&d.length)i.state={style:d[0].style};else if(u){if(typeof h=="function")return i.state={style:u},l1(i);i.state={style:c?lu({},c,u):u}}else i.state={style:{}};return i}return cte(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,o=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,f=i.to,d=i.from,h=this.state.style;if(o){if(!s){var p={style:c?lu({},c,f):f};this.state&&h&&(c&&h[c]!==f||!c&&h!==f)&&this.setState(p);return}if(!(yee(a.to,f)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var x=v||u?d:a.to;if(this.state&&h){var y={style:c?lu({},c,x):x};(c&&h[c]!==x||!c&&h!==x)&&this.setState(y)}this.runAnimation(xa(xa({},this.props),{},{from:x,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,o=a.to,c=a.duration,u=a.easing,f=a.begin,d=a.onAnimationEnd,h=a.onAnimationStart,p=Jee(s,o,zee(u),c,this.changeStyle),v=function(){i.stopJSAnimation=p()};this.manager.start([h,f,v,c,d])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,o=a.begin,c=a.onAnimationStart,u=s[0],f=u.style,d=u.duration,h=d===void 0?0:d,p=function(x,y,g){if(g===0)return x;var b=y.duration,m=y.easing,S=m===void 0?"ease":m,w=y.style,_=y.properties,k=y.onAnimationEnd,N=g>0?s[g-1]:y,j=_||Object.keys(w);if(typeof S=="function"||S==="spring")return[].concat(Gx(x),[i.runJSAnimation.bind(i,{from:N.style,to:w,duration:b,easing:S}),b]);var E=zk(j,b,S),O=xa(xa(xa({},N.style),w),{},{transition:E});return[].concat(Gx(x),[O,b,k]).filter(Oee)};return this.manager.start([c].concat(Gx(s.reduce(p,[f,Math.max(h,o)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=jee());var i=a.begin,s=a.duration,o=a.attributeName,c=a.to,u=a.easing,f=a.onAnimationStart,d=a.onAnimationEnd,h=a.steps,p=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(a);return}if(h.length>1){this.runStepAnimation(a);return}var x=o?lu({},o,c):c,y=zk(Object.keys(x),s,u);v.start([f,i,xa(xa({},x),{},{transition:y}),s,d])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var o=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=tte(a,ete),u=G.Children.count(i),f=this.state.style;if(typeof i=="function")return i(f);if(!o||u===0||s<=0)return i;var d=function(p){var v=p.props,x=v.style,y=x===void 0?{}:x,g=v.className,b=G.cloneElement(p,xa(xa({},c),{},{style:xa(xa({},y),f),className:g}));return b};return u===1?d(G.Children.only(i)):Y.createElement("div",null,G.Children.map(i,function(h){return d(h)}))}}]),r}(G.PureComponent);Ka.displayName="Animate";Ka.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Ka.propTypes={from:tt.oneOfType([tt.object,tt.string]),to:tt.oneOfType([tt.object,tt.string]),attributeName:tt.string,duration:tt.number,begin:tt.number,easing:tt.oneOfType([tt.string,tt.func]),steps:tt.arrayOf(tt.shape({duration:tt.number.isRequired,style:tt.object.isRequired,easing:tt.oneOfType([tt.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),tt.func]),properties:tt.arrayOf("string"),onAnimationEnd:tt.func})),children:tt.oneOfType([tt.node,tt.func]),isActive:tt.bool,canBegin:tt.bool,onAnimationEnd:tt.func,shouldReAnimate:tt.bool,onAnimationStart:tt.func,onAnimationReStart:tt.func};function kf(e){"@babel/helpers - typeof";return kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kf(e)}function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$h.apply(this,arguments)}function pte(e,t){return gte(e)||vte(e,t)||xte(e,t)||mte()}function mte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xte(e,t){if(e){if(typeof e=="string")return Kk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kk(e,t)}}function Kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vte(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function gte(e){if(Array.isArray(e))return e}function qk(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qk(Object(r),!0).forEach(function(n){yte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qk(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yte(e,t,r){return t=bte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bte(e){var t=wte(e,"string");return kf(t)=="symbol"?t:t+""}function wte(e,t){if(kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qk=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),o=a>=0?1:-1,c=n>=0?1:-1,u=a>=0&&n>=0||a<0&&n<0?1:0,f;if(s>0&&i instanceof Array){for(var d=[0,0,0,0],h=0,p=4;h<p;h++)d[h]=i[h]>s?s:i[h];f="M".concat(t,",").concat(r+o*d[0]),d[0]>0&&(f+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(u,",").concat(t+c*d[0],",").concat(r)),f+="L ".concat(t+n-c*d[1],",").concat(r),d[1]>0&&(f+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+o*d[1])),f+="L ".concat(t+n,",").concat(r+a-o*d[2]),d[2]>0&&(f+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(u,`,
        `).concat(t+n-c*d[2],",").concat(r+a)),f+="L ".concat(t+c*d[3],",").concat(r+a),d[3]>0&&(f+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+a-o*d[3])),f+="Z"}else if(s>0&&i===+i&&i>0){var v=Math.min(s,i);f="M ".concat(t,",").concat(r+o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n,",").concat(r+o*v,`
            L `).concat(t+n,",").concat(r+a-o*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(u,",").concat(t,",").concat(r+a-o*v," Z")}else f="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return f},_te=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,o=r.width,c=r.height;if(Math.abs(o)>0&&Math.abs(c)>0){var u=Math.min(i,i+o),f=Math.max(i,i+o),d=Math.min(s,s+c),h=Math.max(s,s+c);return n>=u&&n<=f&&a>=d&&a<=h}return!1},Ste={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Bb=function(t){var r=Yk(Yk({},Ste),t),n=G.useRef(),a=G.useState(-1),i=pte(a,2),s=i[0],o=i[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var S=n.current.getTotalLength();S&&o(S)}catch{}},[]);var c=r.x,u=r.y,f=r.width,d=r.height,h=r.radius,p=r.className,v=r.animationEasing,x=r.animationDuration,y=r.animationBegin,g=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||u!==+u||f!==+f||d!==+d||f===0||d===0)return null;var m=ze("recharts-rectangle",p);return b?Y.createElement(Ka,{canBegin:s>0,from:{width:f,height:d,x:c,y:u},to:{width:f,height:d,x:c,y:u},duration:x,animationEasing:v,isActive:b},function(S){var w=S.width,_=S.height,k=S.x,N=S.y;return Y.createElement(Ka,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:x,isActive:g,easing:v},Y.createElement("path",$h({},Ce(r,!0),{className:m,d:Qk(k,N,w,_,h),ref:n})))}):Y.createElement("path",$h({},Ce(r,!0),{className:m,d:Qk(c,u,f,d,h)}))},kte=["points","className","baseLinePoints","connectNulls"];function sl(){return sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sl.apply(this,arguments)}function Nte(e,t){if(e==null)return{};var r=jte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Zk(e){return Ote(e)||Ate(e)||Tte(e)||Ete()}function Ete(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tte(e,t){if(e){if(typeof e=="string")return u1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u1(e,t)}}function Ate(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ote(e){if(Array.isArray(e))return u1(e)}function u1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Jk=function(t){return t&&t.x===+t.x&&t.y===+t.y},Cte=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){Jk(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Jk(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Nu=function(t,r){var n=Cte(t);r&&(n=[n.reduce(function(i,s){return[].concat(Zk(i),Zk(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,o,c){return"".concat(s).concat(c===0?"M":"L").concat(o.x,",").concat(o.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},Pte=function(t,r,n){var a=Nu(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Nu(r.reverse(),n).slice(1))},Mte=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=Nte(t,kte);if(!r||!r.length)return null;var o=ze("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",u=Pte(r,a,i);return Y.createElement("g",{className:o},Y.createElement("path",sl({},Ce(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:u})),c?Y.createElement("path",sl({},Ce(s,!0),{fill:"none",d:Nu(r,i)})):null,c?Y.createElement("path",sl({},Ce(s,!0),{fill:"none",d:Nu(a,i)})):null)}var f=Nu(r,i);return Y.createElement("path",sl({},Ce(s,!0),{fill:f.slice(-1)==="Z"?s.fill:"none",className:o,d:f}))};function f1(){return f1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f1.apply(this,arguments)}var jm=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ze("recharts-dot",i);return r===+r&&n===+n&&a===+a?G.createElement("circle",f1({},Ce(t,!1),rh(t),{className:s,cx:r,cy:n,r:a})):null};function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}var Fte=["x","y","top","left","width","height","className"];function d1(){return d1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d1.apply(this,arguments)}function eN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eN(Object(r),!0).forEach(function(n){Ite(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ite(e,t,r){return t=Rte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rte(e){var t=$te(e,"string");return Nf(t)=="symbol"?t:t+""}function $te(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lte(e,t){if(e==null)return{};var r=Bte(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Bte(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ute=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},zte=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,o=s===void 0?0:s,c=t.left,u=c===void 0?0:c,f=t.width,d=f===void 0?0:f,h=t.height,p=h===void 0?0:h,v=t.className,x=Lte(t,Fte),y=Dte({x:n,y:i,top:o,left:u,width:d,height:p},x);return!ve(n)||!ve(i)||!ve(d)||!ve(p)||!ve(o)||!ve(u)?null:Y.createElement("path",d1({},Ce(y,!0),{className:ze("recharts-cross",v),d:Ute(n,i,d,p,o,u)}))},Wte=wm,Hte=KO,Vte=Za;function Gte(e,t){return e&&e.length?Wte(e,Vte(t),Hte):void 0}var Xte=Gte;const Kte=st(Xte);var qte=wm,Yte=Za,Qte=qO;function Zte(e,t){return e&&e.length?qte(e,Yte(t),Qte):void 0}var Jte=Zte;const ere=st(Jte);var tre=["cx","cy","angle","ticks","axisLine"],rre=["ticks","tick","angle","tickFormatter","stroke"];function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function ju(){return ju=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ju.apply(this,arguments)}function tN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function js(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tN(Object(r),!0).forEach(function(n){Em(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rN(e,t){if(e==null)return{};var r=nre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function are(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$3(n.key),n)}}function ire(e,t,r){return t&&nN(e.prototype,t),r&&nN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sre(e,t,r){return t=Lh(t),ore(e,R3()?Reflect.construct(t,r||[],Lh(e).constructor):t.apply(e,r))}function ore(e,t){if(t&&(Ul(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lre(e)}function lre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(R3=function(){return!!e})()}function Lh(e){return Lh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Lh(e)}function cre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h1(e,t)}function h1(e,t){return h1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},h1(e,t)}function Em(e,t,r){return t=$3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3(e){var t=ure(e,"string");return Ul(t)=="symbol"?t:t+""}function ure(e,t){if(Ul(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tm=function(e){function t(){return are(this,t),sre(this,t,arguments)}return cre(t,e),ire(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,o=i.cx,c=i.cy;return pt(o,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=Kte(o,function(f){return f.coordinate||0}),u=ere(o,function(f){return f.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,o=n.ticks,c=n.axisLine,u=rN(n,tre),f=o.reduce(function(v,x){return[Math.min(v[0],x.coordinate),Math.max(v[1],x.coordinate)]},[1/0,-1/0]),d=pt(a,i,f[0],s),h=pt(a,i,f[1],s),p=js(js(js({},Ce(u,!1)),{},{fill:"none"},Ce(c,!1)),{},{x1:d.x,y1:d.y,x2:h.x,y2:h.y});return Y.createElement("line",ju({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.angle,c=a.tickFormatter,u=a.stroke,f=rN(a,rre),d=this.getTickTextAnchor(),h=Ce(f,!1),p=Ce(s,!1),v=i.map(function(x,y){var g=n.getTickValueCoord(x),b=js(js(js(js({textAnchor:d,transform:"rotate(".concat(90-o,", ").concat(g.x,", ").concat(g.y,")")},h),{},{stroke:"none",fill:u},p),{},{index:y},g),{},{payload:x});return Y.createElement(Je,ju({className:ze("recharts-polar-radius-axis-tick",S3(s)),key:"tick-".concat(x.coordinate)},oo(n.props,x,y)),t.renderTickItem(s,b,c?c(x.value,y):x.value))});return Y.createElement(Je,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:Y.createElement(Je,{className:ze("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),xr.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return Y.isValidElement(n)?s=Y.cloneElement(n,a):Ie(n)?s=n(a):s=Y.createElement(lo,ju({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])}(G.PureComponent);Em(Tm,"displayName","PolarRadiusAxis");Em(Tm,"axisType","radiusAxis");Em(Tm,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function Rs(){return Rs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rs.apply(this,arguments)}function aN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aN(Object(r),!0).forEach(function(n){Am(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fre(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,B3(n.key),n)}}function dre(e,t,r){return t&&iN(e.prototype,t),r&&iN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hre(e,t,r){return t=Bh(t),pre(e,L3()?Reflect.construct(t,r||[],Bh(e).constructor):t.apply(e,r))}function pre(e,t){if(t&&(zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mre(e)}function mre(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L3=function(){return!!e})()}function Bh(e){return Bh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Bh(e)}function xre(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p1(e,t)}function p1(e,t){return p1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p1(e,t)}function Am(e,t,r){return t=B3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B3(e){var t=vre(e,"string");return zl(t)=="symbol"?t:t+""}function vre(e,t){if(zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gre=Math.PI/180,sN=1e-5,Om=function(e){function t(){return fre(this,t),hre(this,t,arguments)}return xre(t,e),dre(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,o=a.radius,c=a.orientation,u=a.tickSize,f=u||8,d=pt(i,s,o,n.coordinate),h=pt(i,s,o+(c==="inner"?-1:1)*f,n.coordinate);return{x1:d.x,y1:d.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*gre),s;return i>sN?s=a==="outer"?"start":"end":i<-sN?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,o=n.axisLine,c=n.axisLineType,u=Es(Es({},Ce(this.props,!1)),{},{fill:"none"},Ce(o,!1));if(c==="circle")return Y.createElement(jm,Rs({className:"recharts-polar-angle-axis-line"},u,{cx:a,cy:i,r:s}));var f=this.props.ticks,d=f.map(function(h){return pt(a,i,s,h.coordinate)});return Y.createElement(Mte,Rs({className:"recharts-polar-angle-axis-line"},u,{points:d}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,o=a.tickLine,c=a.tickFormatter,u=a.stroke,f=Ce(this.props,!1),d=Ce(s,!1),h=Es(Es({},f),{},{fill:"none"},Ce(o,!1)),p=i.map(function(v,x){var y=n.getTickLineCoord(v),g=n.getTickTextAnchor(v),b=Es(Es(Es({textAnchor:g},f),{},{stroke:"none",fill:u},d),{},{index:x,payload:v,x:y.x2,y:y.y2});return Y.createElement(Je,Rs({className:ze("recharts-polar-angle-axis-tick",S3(s)),key:"tick-".concat(v.coordinate)},oo(n.props,v,x)),o&&Y.createElement("line",Rs({className:"recharts-polar-angle-axis-tick-line"},h,y)),s&&t.renderTickItem(s,b,c?c(v.value,x):v.value))});return Y.createElement(Je,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:Y.createElement(Je,{className:ze("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return Y.isValidElement(n)?s=Y.cloneElement(n,a):Ie(n)?s=n(a):s=Y.createElement(lo,Rs({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])}(G.PureComponent);Am(Om,"displayName","PolarAngleAxis");Am(Om,"axisType","angleAxis");Am(Om,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var yre=VA,bre=yre(Object.getPrototypeOf,Object),wre=bre,_re=Ti,Sre=wre,kre=Ai,Nre="[object Object]",jre=Function.prototype,Ere=Object.prototype,U3=jre.toString,Tre=Ere.hasOwnProperty,Are=U3.call(Object);function Ore(e){if(!kre(e)||_re(e)!=Nre)return!1;var t=Sre(e);if(t===null)return!0;var r=Tre.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&U3.call(r)==Are}var Cre=Ore;const Pre=st(Cre);var Mre=Ti,Fre=Ai,Dre="[object Boolean]";function Ire(e){return e===!0||e===!1||Fre(e)&&Mre(e)==Dre}var Rre=Ire;const $re=st(Rre);function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function Uh(){return Uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uh.apply(this,arguments)}function Lre(e,t){return Wre(e)||zre(e,t)||Ure(e,t)||Bre()}function Bre(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ure(e,t){if(e){if(typeof e=="string")return oN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oN(e,t)}}function oN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zre(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Wre(e){if(Array.isArray(e))return e}function lN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lN(Object(r),!0).forEach(function(n){Hre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hre(e,t,r){return t=Vre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vre(e){var t=Gre(e,"string");return jf(t)=="symbol"?t:t+""}function Gre(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uN=function(t,r,n,a,i){var s=n-a,o;return o="M ".concat(t,",").concat(r),o+="L ".concat(t+n,",").concat(r),o+="L ".concat(t+n-s/2,",").concat(r+i),o+="L ".concat(t+n-s/2-a,",").concat(r+i),o+="L ".concat(t,",").concat(r," Z"),o},Xre={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Kre=function(t){var r=cN(cN({},Xre),t),n=G.useRef(),a=G.useState(-1),i=Lre(a,2),s=i[0],o=i[1];G.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var m=n.current.getTotalLength();m&&o(m)}catch{}},[]);var c=r.x,u=r.y,f=r.upperWidth,d=r.lowerWidth,h=r.height,p=r.className,v=r.animationEasing,x=r.animationDuration,y=r.animationBegin,g=r.isUpdateAnimationActive;if(c!==+c||u!==+u||f!==+f||d!==+d||h!==+h||f===0&&d===0||h===0)return null;var b=ze("recharts-trapezoid",p);return g?Y.createElement(Ka,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:u},to:{upperWidth:f,lowerWidth:d,height:h,x:c,y:u},duration:x,animationEasing:v,isActive:g},function(m){var S=m.upperWidth,w=m.lowerWidth,_=m.height,k=m.x,N=m.y;return Y.createElement(Ka,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:x,easing:v},Y.createElement("path",Uh({},Ce(r,!0),{className:b,d:uN(k,N,S,w,_),ref:n})))}):Y.createElement("g",null,Y.createElement("path",Uh({},Ce(r,!0),{className:b,d:uN(c,u,f,d,h)})))},qre=["option","shapeType","propTransformer","activeClassName","isActive"];function Ef(e){"@babel/helpers - typeof";return Ef=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ef(e)}function Yre(e,t){if(e==null)return{};var r=Qre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Qre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(r),!0).forEach(function(n){Zre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zre(e,t,r){return t=Jre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jre(e){var t=ene(e,"string");return Ef(t)=="symbol"?t:t+""}function ene(e,t){if(Ef(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ef(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tne(e,t){return zh(zh({},t),e)}function rne(e,t){return e==="symbols"}function dN(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Y.createElement(Bb,r);case"trapezoid":return Y.createElement(Kre,r);case"sector":return Y.createElement(j3,r);case"symbols":if(rne(t))return Y.createElement(ib,r);break;default:return null}}function nne(e){return G.isValidElement(e)?e.props:e}function z3(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?tne:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,o=e.isActive,c=Yre(e,qre),u;if(G.isValidElement(t))u=G.cloneElement(t,zh(zh({},c),nne(t)));else if(Ie(t))u=t(c);else if(Pre(t)&&!$re(t)){var f=a(t,c);u=Y.createElement(dN,{shapeType:r,elementProps:f})}else{var d=c;u=Y.createElement(dN,{shapeType:r,elementProps:d})}return o?Y.createElement(Je,{className:s},u):u}function Cm(e,t){return t!=null&&"trapezoids"in e.props}function Pm(e,t){return t!=null&&"sectors"in e.props}function Tf(e,t){return t!=null&&"points"in e.props}function ane(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function ine(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function sne(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function one(e,t){var r;return Cm(e,t)?r=ane:Pm(e,t)?r=ine:Tf(e,t)&&(r=sne),r}function lne(e,t){var r;return Cm(e,t)?r="trapezoids":Pm(e,t)?r="sectors":Tf(e,t)&&(r="points"),r}function cne(e,t){if(Cm(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Pm(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Tf(e,t)?t.payload:{}}function une(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=lne(r,t),i=cne(r,t),s=n.filter(function(c,u){var f=c0(i,c),d=r.props[a].filter(function(v){var x=one(r,t);return x(v,t)}),h=r.props[a].indexOf(d[d.length-1]),p=u===h;return f&&p}),o=n.indexOf(s[s.length-1]);return o}var jd;function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ol.apply(this,arguments)}function hN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hN(Object(r),!0).forEach(function(n){Qn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H3(n.key),n)}}function dne(e,t,r){return t&&pN(e.prototype,t),r&&pN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hne(e,t,r){return t=Wh(t),pne(e,W3()?Reflect.construct(t,r||[],Wh(e).constructor):t.apply(e,r))}function pne(e,t){if(t&&(Wl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mne(e)}function mne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(W3=function(){return!!e})()}function Wh(e){return Wh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wh(e)}function xne(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m1(e,t)}function m1(e,t){return m1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},m1(e,t)}function Qn(e,t,r){return t=H3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H3(e){var t=vne(e,"string");return Wl(t)=="symbol"?t:t+""}function vne(e,t){if(Wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fa=function(e){function t(r){var n;return fne(this,t),n=hne(this,t,[r]),Qn(n,"pieRef",null),Qn(n,"sectorRefs",[]),Qn(n,"id",gc("recharts-pie-")),Qn(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Ie(a)&&a()}),Qn(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Ie(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return xne(t,e),dne(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,o=i.labelLine,c=i.dataKey,u=i.valueKey,f=Ce(this.props,!1),d=Ce(s,!1),h=Ce(o,!1),p=s&&s.offsetRadius||20,v=n.map(function(x,y){var g=(x.startAngle+x.endAngle)/2,b=pt(x.cx,x.cy,x.outerRadius+p,g),m=ft(ft(ft(ft({},f),x),{},{stroke:"none"},d),{},{index:y,textAnchor:t.getTextAnchor(b.x,x.cx)},b),S=ft(ft(ft(ft({},f),x),{},{fill:"none",stroke:x.fill},h),{},{index:y,points:[pt(x.cx,x.cy,x.outerRadius,g),b]}),w=c;return $e(c)&&$e(u)?w="value":$e(c)&&(w=u),Y.createElement(Je,{key:"label-".concat(x.startAngle,"-").concat(x.endAngle,"-").concat(x.midAngle,"-").concat(y)},o&&t.renderLabelLineItem(o,S,"line"),t.renderLabelItem(s,m,sr(x,w)))});return Y.createElement(Je,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,o=i.blendStroke,c=i.inactiveShape;return n.map(function(u,f){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var d=a.isActiveIndex(f),h=c&&a.hasActiveIndex()?c:null,p=d?s:h,v=ft(ft({},u),{},{stroke:o?u.fill:u.stroke,tabIndex:-1});return Y.createElement(Je,ol({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},oo(a.props,u,f),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(f)}),Y.createElement(z3,ol({option:p,isActive:d,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,o=a.animationBegin,c=a.animationDuration,u=a.animationEasing,f=a.animationId,d=this.state,h=d.prevSectors,p=d.prevIsAnimationActive;return Y.createElement(Ka,{begin:o,duration:c,isActive:s,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var x=v.t,y=[],g=i&&i[0],b=g.startAngle;return i.forEach(function(m,S){var w=h&&h[S],_=S>0?Mn(m,"paddingAngle",0):0;if(w){var k=Nn(w.endAngle-w.startAngle,m.endAngle-m.startAngle),N=ft(ft({},m),{},{startAngle:b+_,endAngle:b+k(x)+_});y.push(N),b=N.endAngle}else{var j=m.endAngle,E=m.startAngle,O=Nn(0,j-E),T=O(x),L=ft(ft({},m),{},{startAngle:b+_,endAngle:b+T+_});y.push(L),b=L.endAngle}}),Y.createElement(Je,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var o=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!c0(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,o=a.className,c=a.label,u=a.cx,f=a.cy,d=a.innerRadius,h=a.outerRadius,p=a.isAnimationActive,v=this.state.isAnimationFinished;if(i||!s||!s.length||!ve(u)||!ve(f)||!ve(d)||!ve(h))return null;var x=ze("recharts-pie",o);return Y.createElement(Je,{tabIndex:this.props.rootTabIndex,className:x,ref:function(g){n.pieRef=g}},this.renderSectors(),c&&this.renderLabels(s),xr.renderCallByParent(this.props,null,!1),(!p||v)&&ta.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(Y.isValidElement(n))return Y.cloneElement(n,a);if(Ie(n))return n(a);var s=ze("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Y.createElement(Mh,ol({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(Y.isValidElement(n))return Y.cloneElement(n,a);var s=i;if(Ie(n)&&(s=n(a),Y.isValidElement(s)))return s;var o=ze("recharts-pie-label-text",typeof n!="boolean"&&!Ie(n)?n.className:"");return Y.createElement(lo,ol({},a,{alignmentBaseline:"middle",className:o}),s)}}])}(G.PureComponent);jd=fa;Qn(fa,"displayName","Pie");Qn(fa,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!So.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Qn(fa,"parseDeltaAngle",function(e,t){var r=Jr(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Qn(fa,"getRealPieData",function(e){var t=e.data,r=e.children,n=Ce(e,!1),a=Fn(r,Oi);return t&&t.length?t.map(function(i,s){return ft(ft(ft({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return ft(ft({},n),i.props)}):[]});Qn(fa,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=_3(a,i),o=n+en(e.cx,a,a/2),c=r+en(e.cy,i,i/2),u=en(e.innerRadius,s,0),f=en(e.outerRadius,s,s*.8),d=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:o,cy:c,innerRadius:u,outerRadius:f,maxRadius:d}});Qn(fa,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?ft(ft({},t.type.defaultProps),t.props):t.props,a=jd.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,o=n.endAngle,c=n.paddingAngle,u=n.dataKey,f=n.nameKey,d=n.valueKey,h=n.tooltipType,p=Math.abs(n.minAngle),v=jd.parseCoordinateOfPie(n,r),x=jd.parseDeltaAngle(s,o),y=Math.abs(x),g=u;$e(u)&&$e(d)?(Ta(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),g="value"):$e(u)&&(Ta(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),g=d);var b=a.filter(function(N){return sr(N,g,0)!==0}).length,m=(y>=360?b:b-1)*c,S=y-b*p-m,w=a.reduce(function(N,j){var E=sr(j,g,0);return N+(ve(E)?E:0)},0),_;if(w>0){var k;_=a.map(function(N,j){var E=sr(N,g,0),O=sr(N,f,j),T=(ve(E)?E:0)/w,L;j?L=k.endAngle+Jr(x)*c*(E!==0?1:0):L=s;var X=L+Jr(x)*((E!==0?p:0)+T*S),M=(L+X)/2,U=(v.innerRadius+v.outerRadius)/2,q=[{name:O,value:E,payload:N,dataKey:g,type:h}],K=pt(v.cx,v.cy,U,M);return k=ft(ft(ft({percent:T,cornerRadius:i,name:O,tooltipPayload:q,midAngle:M,middleRadius:U,tooltipPosition:K},N),v),{},{value:sr(N,g),startAngle:L,endAngle:X,payload:N,paddingAngle:Jr(x)*c}),k})}return ft(ft({},v),{},{sectors:_,data:a})});var gne=Math.ceil,yne=Math.max;function bne(e,t,r,n){for(var a=-1,i=yne(gne((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var wne=bne,_ne=uO,mN=1/0,Sne=17976931348623157e292;function kne(e){if(!e)return e===0?e:0;if(e=_ne(e),e===mN||e===-mN){var t=e<0?-1:1;return t*Sne}return e===e?e:0}var V3=kne,Nne=wne,jne=pm,Xx=V3;function Ene(e){return function(t,r,n){return n&&typeof n!="number"&&jne(t,r,n)&&(r=n=void 0),t=Xx(t),r===void 0?(r=t,t=0):r=Xx(r),n=n===void 0?t<r?1:-1:Xx(n),Nne(t,r,n,e)}}var Tne=Ene,Ane=Tne,One=Ane(),Cne=One;const Hh=st(Cne);function Af(e){"@babel/helpers - typeof";return Af=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(e)}function xN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xN(Object(r),!0).forEach(function(n){G3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function G3(e,t,r){return t=Pne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pne(e){var t=Mne(e,"string");return Af(t)=="symbol"?t:t+""}function Mne(e,t){if(Af(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Af(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fne=["Webkit","Moz","O","ms"],Dne=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=Fne.reduce(function(i,s){return vN(vN({},i),{},G3({},s+n,r))},{});return a[t]=r,a};function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function Vh(){return Vh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vh.apply(this,arguments)}function gN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gN(Object(r),!0).forEach(function(n){_n(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ine(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,K3(n.key),n)}}function Rne(e,t,r){return t&&yN(e.prototype,t),r&&yN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $ne(e,t,r){return t=Gh(t),Lne(e,X3()?Reflect.construct(t,r||[],Gh(e).constructor):t.apply(e,r))}function Lne(e,t){if(t&&(Hl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bne(e)}function Bne(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(X3=function(){return!!e})()}function Gh(e){return Gh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gh(e)}function Une(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&x1(e,t)}function x1(e,t){return x1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},x1(e,t)}function _n(e,t,r){return t=K3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K3(e){var t=zne(e,"string");return Hl(t)=="symbol"?t:t+""}function zne(e,t){if(Hl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Wne=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,o=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=_u().domain(Hh(0,c)).range([i,i+s-o]),f=u.domain().map(function(d){return u(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(a),scale:u,scaleValues:f}},bN=function(t){return t.changedTouches&&!!t.changedTouches.length},Vl=function(e){function t(r){var n;return Ine(this,t),n=$ne(this,t,[r]),_n(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),_n(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),_n(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,o=a.startIndex;s==null||s({endIndex:i,startIndex:o})}),n.detachDragEndListener()}),_n(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),_n(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),_n(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),_n(n,"handleSlideDragStart",function(a){var i=bN(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return Une(t,e),Rne(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,o=this.props,c=o.gap,u=o.data,f=u.length-1,d=Math.min(a,i),h=Math.max(a,i),p=t.getIndexInRange(s,d),v=t.getIndexInRange(s,h);return{startIndex:p-p%c,endIndex:v===f?f:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,o=a.dataKey,c=sr(i[n],o,n);return Ie(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,o=a.endX,c=this.props,u=c.x,f=c.width,d=c.travellerWidth,h=c.startIndex,p=c.endIndex,v=c.onChange,x=n.pageX-i;x>0?x=Math.min(x,u+f-d-o,u+f-d-s):x<0&&(x=Math.max(x,u-s,u-o));var y=this.getIndex({startX:s+x,endX:o+x});(y.startIndex!==h||y.endIndex!==p)&&v&&v(y),this.setState({startX:s+x,endX:o+x,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=bN(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,o=a.endX,c=a.startX,u=this.state[s],f=this.props,d=f.x,h=f.width,p=f.travellerWidth,v=f.onChange,x=f.gap,y=f.data,g={startX:this.state.startX,endX:this.state.endX},b=n.pageX-i;b>0?b=Math.min(b,d+h-p-u):b<0&&(b=Math.max(b,d-u)),g[s]=u+b;var m=this.getIndex(g),S=m.startIndex,w=m.endIndex,_=function(){var N=y.length-1;return s==="startX"&&(o>c?S%x===0:w%x===0)||o<c&&w===N||s==="endX"&&(o>c?w%x===0:S%x===0)||o>c&&w===N};this.setState(_n(_n({},s,u+b),"brushMoveStartX",n.pageX),function(){v&&_()&&v(m)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,o=s.scaleValues,c=s.startX,u=s.endX,f=this.state[a],d=o.indexOf(f);if(d!==-1){var h=d+n;if(!(h===-1||h>=o.length)){var p=o[h];a==="startX"&&p>=u||a==="endX"&&p<=c||this.setState(_n({},a,p),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.fill,u=n.stroke;return Y.createElement("rect",{stroke:u,fill:c,x:a,y:i,width:s,height:o})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.data,u=n.children,f=n.padding,d=G.Children.only(u);return d?Y.cloneElement(d,{x:a,y:i,width:s,height:o,margin:f,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,o=this,c=this.props,u=c.y,f=c.travellerWidth,d=c.height,h=c.traveller,p=c.ariaLabel,v=c.data,x=c.startIndex,y=c.endIndex,g=Math.max(n,this.props.x),b=Kx(Kx({},Ce(this.props,!1)),{},{x:g,y:u,width:f,height:d}),m=p||"Min value: ".concat((i=v[x])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=v[y])===null||s===void 0?void 0:s.name);return Y.createElement(Je,{tabIndex:0,role:"slider","aria-label":m,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),o.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,a))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,o=i.height,c=i.stroke,u=i.travellerWidth,f=Math.min(n,a)+u,d=Math.max(Math.abs(a-n)-u,0);return Y.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:f,y:s,width:d,height:o})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,o=n.height,c=n.travellerWidth,u=n.stroke,f=this.state,d=f.startX,h=f.endX,p=5,v={pointerEvents:"none",fill:u};return Y.createElement(Je,{className:"recharts-brush-texts"},Y.createElement(lo,Vh({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,h)-p,y:s+o/2},v),this.getTextOfTick(a)),Y.createElement(lo,Vh({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,h)+c+p,y:s+o/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,o=n.x,c=n.y,u=n.width,f=n.height,d=n.alwaysShowText,h=this.state,p=h.startX,v=h.endX,x=h.isTextActive,y=h.isSlideMoving,g=h.isTravellerMoving,b=h.isTravellerFocused;if(!a||!a.length||!ve(o)||!ve(c)||!ve(u)||!ve(f)||u<=0||f<=0)return null;var m=ze("recharts-brush",i),S=Y.Children.count(s)===1,w=Dne("userSelect","none");return Y.createElement(Je,{className:m,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),S&&this.renderPanorama(),this.renderSlide(p,v),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(v,"endX"),(x||y||g||b||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,o=n.height,c=n.stroke,u=Math.floor(i+o/2)-1;return Y.createElement(Y.Fragment,null,Y.createElement("rect",{x:a,y:i,width:s,height:o,fill:c,stroke:"none"}),Y.createElement("line",{x1:a+1,y1:u,x2:a+s-1,y2:u,fill:"none",stroke:"#fff"}),Y.createElement("line",{x1:a+1,y1:u+2,x2:a+s-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return Y.isValidElement(n)?i=Y.cloneElement(n,a):Ie(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,o=n.x,c=n.travellerWidth,u=n.updateId,f=n.startIndex,d=n.endIndex;if(i!==a.prevData||u!==a.prevUpdateId)return Kx({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s},i&&i.length?Wne({data:i,width:s,x:o,travellerWidth:c,startIndex:f,endIndex:d}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||o!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([o,o+s-c]);var h=a.scale.domain().map(function(p){return a.scale(p)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:o,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,o=i-1;o-s>1;){var c=Math.floor((s+o)/2);n[c]>a?o=c:s=c}return a>=n[o]?o:s}}])}(G.PureComponent);_n(Vl,"displayName","Brush");_n(Vl,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Hne=db;function Vne(e,t){var r;return Hne(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var Gne=Vne,Xne=RA,Kne=Za,qne=Gne,Yne=bn,Qne=pm;function Zne(e,t,r){var n=Yne(e)?Xne:qne;return r&&Qne(e,t,r)&&(t=void 0),n(e,Kne(t))}var Jne=Zne;const eae=st(Jne);var Va=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},wN=iO;function tae(e,t,r){t=="__proto__"&&wN?wN(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var rae=tae,nae=rae,aae=nO,iae=Za;function sae(e,t){var r={};return t=iae(t),aae(e,function(n,a,i){nae(r,a,t(n,a,i))}),r}var oae=sae;const lae=st(oae);function cae(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var uae=cae,fae=db;function dae(e,t){var r=!0;return fae(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var hae=dae,pae=uae,mae=hae,xae=Za,vae=bn,gae=pm;function yae(e,t,r){var n=vae(e)?pae:mae;return r&&gae(e,t,r)&&(t=void 0),n(e,xae(t))}var bae=yae;const q3=st(bae);var wae=["x","y"];function Of(e){"@babel/helpers - typeof";return Of=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(e)}function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v1.apply(this,arguments)}function _N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_N(Object(r),!0).forEach(function(n){_ae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_N(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ae(e,t,r){return t=Sae(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sae(e){var t=kae(e,"string");return Of(t)=="symbol"?t:t+""}function kae(e,t){if(Of(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Of(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nae(e,t){if(e==null)return{};var r=jae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Eae(e,t){var r=e.x,n=e.y,a=Nae(e,wae),i="".concat(r),s=parseInt(i,10),o="".concat(n),c=parseInt(o,10),u="".concat(t.height||a.height),f=parseInt(u,10),d="".concat(t.width||a.width),h=parseInt(d,10);return Zc(Zc(Zc(Zc(Zc({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:f,width:h,name:t.name,radius:t.radius})}function SN(e){return Y.createElement(z3,v1({shapeType:"rectangle",propTransformer:Eae,activeClassName:"recharts-active-bar"},e))}var Tae=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=ve(n)||q$(n);return i?t(n,a):(i||uo(),r)}},Aae=["value","background"],Y3;function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}function Oae(e,t){if(e==null)return{};var r=Cae(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cae(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Xh(){return Xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xh.apply(this,arguments)}function kN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kN(Object(r),!0).forEach(function(n){Vi(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z3(n.key),n)}}function Mae(e,t,r){return t&&NN(e.prototype,t),r&&NN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fae(e,t,r){return t=Kh(t),Dae(e,Q3()?Reflect.construct(t,r||[],Kh(e).constructor):t.apply(e,r))}function Dae(e,t){if(t&&(Gl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Iae(e)}function Iae(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q3(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Q3=function(){return!!e})()}function Kh(e){return Kh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Kh(e)}function Rae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g1(e,t)}function g1(e,t){return g1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},g1(e,t)}function Vi(e,t,r){return t=Z3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z3(e){var t=$ae(e,"string");return Gl(t)=="symbol"?t:t+""}function $ae(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var da=function(e){function t(){var r;Pae(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Fae(this,t,[].concat(a)),Vi(r,"state",{isAnimationFinished:!1}),Vi(r,"id",gc("recharts-bar-")),Vi(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Vi(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return Rae(t,e),Mae(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,o=i.dataKey,c=i.activeIndex,u=i.activeBar,f=Ce(this.props,!1);return n&&n.map(function(d,h){var p=h===c,v=p?u:s,x=Yt(Yt(Yt({},f),d),{},{isActive:p,option:v,index:h,dataKey:o,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Y.createElement(Je,Xh({className:"recharts-bar-rectangle"},oo(a.props,d,h),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(h)}),Y.createElement(SN,x))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,o=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,f=a.animationEasing,d=a.animationId,h=this.state.prevData;return Y.createElement(Ka,{begin:c,duration:u,isActive:o,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var v=p.t,x=i.map(function(y,g){var b=h&&h[g];if(b){var m=Nn(b.x,y.x),S=Nn(b.y,y.y),w=Nn(b.width,y.width),_=Nn(b.height,y.height);return Yt(Yt({},y),{},{x:m(v),y:S(v),width:w(v),height:_(v)})}if(s==="horizontal"){var k=Nn(0,y.height),N=k(v);return Yt(Yt({},y),{},{y:y.y+y.height-N,height:N})}var j=Nn(0,y.width),E=j(v);return Yt(Yt({},y),{},{width:E})});return Y.createElement(Je,null,n.renderRectanglesStatically(x))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!c0(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,o=a.activeIndex,c=Ce(this.props.background,!1);return i.map(function(u,f){u.value;var d=u.background,h=Oae(u,Aae);if(!d)return null;var p=Yt(Yt(Yt(Yt(Yt({},h),{},{fill:"#eee"},d),c),oo(n.props,u,f)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:f,className:"recharts-bar-background-rectangle"});return Y.createElement(SN,Xh({key:"background-bar-".concat(f),option:n.props.background,isActive:f===o},p))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,o=i.xAxis,c=i.yAxis,u=i.layout,f=i.children,d=Fn(f,u0);if(!d)return null;var h=u==="vertical"?s[0].height/2:s[0].width/2,p=function(y,g){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:sr(y,g)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Y.createElement(Je,v,d.map(function(x){return Y.cloneElement(x,{key:"error-bar-".concat(a,"-").concat(x.props.dataKey),data:s,xAxis:o,yAxis:c,layout:u,offset:h,dataPointFormatter:p})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,o=n.xAxis,c=n.yAxis,u=n.left,f=n.top,d=n.width,h=n.height,p=n.isAnimationActive,v=n.background,x=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,g=ze("recharts-bar",s),b=o&&o.allowDataOverflow,m=c&&c.allowDataOverflow,S=b||m,w=$e(x)?this.id:x;return Y.createElement(Je,{className:g},b||m?Y.createElement("defs",null,Y.createElement("clipPath",{id:"clipPath-".concat(w)},Y.createElement("rect",{x:b?u:u-d/2,y:m?f:f-h/2,width:b?d:d*2,height:m?h:h*2}))):null,Y.createElement(Je,{className:"recharts-bar-rectangles",clipPath:S?"url(#clipPath-".concat(w,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(S,w),(!p||y)&&ta.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(G.PureComponent);Y3=da;Vi(da,"displayName","Bar");Vi(da,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!So.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Vi(da,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,o=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,f=e.dataStartIndex,d=e.displayedData,h=e.offset,p=pZ(n,r);if(!p)return null;var v=t.layout,x=r.type.defaultProps,y=x!==void 0?Yt(Yt({},x),r.props):r.props,g=y.dataKey,b=y.children,m=y.minPointSize,S=v==="horizontal"?s:i,w=u?S.scale.domain():null,_=wZ({numericAxis:S}),k=Fn(b,Oi),N=d.map(function(j,E){var O,T,L,X,M,U;u?O=mZ(u[f+E],w):(O=sr(j,g),Array.isArray(O)||(O=[_,O]));var q=Tae(m,Y3.defaultProps.minPointSize)(O[1],E);if(v==="horizontal"){var K,F=[s.scale(O[0]),s.scale(O[1])],Q=F[0],ie=F[1];T=vk({axis:i,ticks:o,bandSize:a,offset:p.offset,entry:j,index:E}),L=(K=ie??Q)!==null&&K!==void 0?K:void 0,X=p.size;var A=Q-ie;if(M=Number.isNaN(A)?0:A,U={x:T,y:s.y,width:X,height:s.height},Math.abs(q)>0&&Math.abs(M)<Math.abs(q)){var R=Jr(M||q)*(Math.abs(q)-Math.abs(M));L-=R,M+=R}}else{var D=[i.scale(O[0]),i.scale(O[1])],H=D[0],J=D[1];if(T=H,L=vk({axis:s,ticks:c,bandSize:a,offset:p.offset,entry:j,index:E}),X=J-H,M=p.size,U={x:i.x,y:L,width:i.width,height:M},Math.abs(q)>0&&Math.abs(X)<Math.abs(q)){var ue=Jr(X||q)*(Math.abs(q)-Math.abs(X));X+=ue}}return Yt(Yt(Yt({},j),{},{x:T,y:L,width:X,height:M,value:u?O:O[1],payload:j,background:U},k&&k[E]&&k[E].props),{},{tooltipPayload:[b3(r,j)],tooltipPosition:{x:T+X/2,y:L+M/2}})});return Yt({data:N,layout:v},h)});function Cf(e){"@babel/helpers - typeof";return Cf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(e)}function Lae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,J3(n.key),n)}}function Bae(e,t,r){return t&&jN(e.prototype,t),r&&jN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function EN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EN(Object(r),!0).forEach(function(n){Mm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mm(e,t,r){return t=J3(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J3(e){var t=Uae(e,"string");return Cf(t)=="symbol"?t:t+""}function Uae(e,t){if(Cf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eC=function(t,r,n,a,i){var s=t.width,o=t.height,c=t.layout,u=t.children,f=Object.keys(r),d={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:o-n.bottom,bottomMirror:o-n.bottom},h=!!kn(u,da);return f.reduce(function(p,v){var x=r[v],y=x.orientation,g=x.domain,b=x.padding,m=b===void 0?{}:b,S=x.mirror,w=x.reversed,_="".concat(y).concat(S?"Mirror":""),k,N,j,E,O;if(x.type==="number"&&(x.padding==="gap"||x.padding==="no-gap")){var T=g[1]-g[0],L=1/0,X=x.categoricalDomain.sort(Z$);if(X.forEach(function(D,H){H>0&&(L=Math.min((D||0)-(X[H-1]||0),L))}),Number.isFinite(L)){var M=L/T,U=x.layout==="vertical"?n.height:n.width;if(x.padding==="gap"&&(k=M*U/2),x.padding==="no-gap"){var q=en(t.barCategoryGap,M*U),K=M*U/2;k=K-q-(K-q)/U*q}}}a==="xAxis"?N=[n.left+(m.left||0)+(k||0),n.left+n.width-(m.right||0)-(k||0)]:a==="yAxis"?N=c==="horizontal"?[n.top+n.height-(m.bottom||0),n.top+(m.top||0)]:[n.top+(m.top||0)+(k||0),n.top+n.height-(m.bottom||0)-(k||0)]:N=x.range,w&&(N=[N[1],N[0]]);var F=x3(x,i,h),Q=F.scale,ie=F.realScaleType;Q.domain(g).range(N),v3(Q);var A=g3(Q,ba(ba({},x),{},{realScaleType:ie}));a==="xAxis"?(O=y==="top"&&!S||y==="bottom"&&S,j=n.left,E=d[_]-O*x.height):a==="yAxis"&&(O=y==="left"&&!S||y==="right"&&S,j=d[_]-O*x.width,E=n.top);var R=ba(ba(ba({},x),A),{},{realScaleType:ie,x:j,y:E,scale:Q,width:a==="xAxis"?n.width:x.width,height:a==="yAxis"?n.height:x.height});return R.bandSize=Oh(R,A),!x.hide&&a==="xAxis"?d[_]+=(O?-1:1)*R.height:x.hide||(d[_]+=(O?-1:1)*R.width),ba(ba({},p),{},Mm({},v,R))},{})},tC=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},zae=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return tC({x:r,y:n},{x:a,y:i})},rC=function(){function e(t){Lae(this,e),this.scale=t}return Bae(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(r)+o}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();Mm(rC,"EPS",1e-4);var Ub=function(t){var r=Object.keys(t).reduce(function(n,a){return ba(ba({},n),{},Mm({},a,rC.create(t[a])))},{});return ba(ba({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,o=i.position;return lae(a,function(c,u){return r[u].apply(c,{bandAware:s,position:o})})},isInRange:function(a){return q3(a,function(i,s){return r[s].isInRange(i)})}})};function Wae(e){return(e%180+180)%180}var Hae=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Wae(a),s=i*Math.PI/180,o=Math.atan(n/r),c=s>o&&s<Math.PI-o?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},Vae=Za,Gae=a0,Xae=dm;function Kae(e){return function(t,r,n){var a=Object(t);if(!Gae(t)){var i=Vae(r);t=Xae(t),r=function(o){return i(a[o],o,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var qae=Kae,Yae=V3;function Qae(e){var t=Yae(e),r=t%1;return t===t?r?t-r:t:0}var Zae=Qae,Jae=QA,eie=Za,tie=Zae,rie=Math.max;function nie(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:tie(r);return a<0&&(a=rie(n+a,0)),Jae(e,eie(t),a)}var aie=nie,iie=qae,sie=aie,oie=iie(sie),lie=oie;const cie=st(lie);var uie=t$(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),zb=G.createContext(void 0),Wb=G.createContext(void 0),nC=G.createContext(void 0),aC=G.createContext({}),iC=G.createContext(void 0),sC=G.createContext(0),oC=G.createContext(0),TN=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,o=t.children,c=t.width,u=t.height,f=uie(i);return Y.createElement(zb.Provider,{value:n},Y.createElement(Wb.Provider,{value:a},Y.createElement(aC.Provider,{value:i},Y.createElement(nC.Provider,{value:f},Y.createElement(iC.Provider,{value:s},Y.createElement(sC.Provider,{value:u},Y.createElement(oC.Provider,{value:c},o)))))))},fie=function(){return G.useContext(iC)},lC=function(t){var r=G.useContext(zb);r==null&&uo();var n=r[t];return n==null&&uo(),n},die=function(){var t=G.useContext(zb);return zi(t)},hie=function(){var t=G.useContext(Wb),r=cie(t,function(n){return q3(n.domain,Number.isFinite)});return r||zi(t)},cC=function(t){var r=G.useContext(Wb);r==null&&uo();var n=r[t];return n==null&&uo(),n},pie=function(){var t=G.useContext(nC);return t},mie=function(){return G.useContext(aC)},Hb=function(){return G.useContext(oC)},Vb=function(){return G.useContext(sC)};function Xl(e){"@babel/helpers - typeof";return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xl(e)}function xie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fC(n.key),n)}}function gie(e,t,r){return t&&vie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yie(e,t,r){return t=qh(t),bie(e,uC()?Reflect.construct(t,r||[],qh(e).constructor):t.apply(e,r))}function bie(e,t){if(t&&(Xl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wie(e)}function wie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uC=function(){return!!e})()}function qh(e){return qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qh(e)}function _ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y1(e,t)}function y1(e,t){return y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},y1(e,t)}function AN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ON(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AN(Object(r),!0).forEach(function(n){Gb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gb(e,t,r){return t=fC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fC(e){var t=Sie(e,"string");return Xl(t)=="symbol"?t:t+""}function Sie(e,t){if(Xl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function kie(e,t){return Tie(e)||Eie(e,t)||jie(e,t)||Nie()}function Nie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jie(e,t){if(e){if(typeof e=="string")return CN(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CN(e,t)}}function CN(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Eie(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Tie(e){if(Array.isArray(e))return e}function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(this,arguments)}var Aie=function(t,r){var n;return Y.isValidElement(t)?n=Y.cloneElement(t,r):Ie(t)?n=t(r):n=Y.createElement("line",b1({},r,{className:"recharts-reference-line-line"})),n},Oie=function(t,r,n,a,i,s,o,c,u){var f=i.x,d=i.y,h=i.width,p=i.height;if(n){var v=u.y,x=t.y.apply(v,{position:s});if(Va(u,"discard")&&!t.y.isInRange(x))return null;var y=[{x:f+h,y:x},{x:f,y:x}];return c==="left"?y.reverse():y}if(r){var g=u.x,b=t.x.apply(g,{position:s});if(Va(u,"discard")&&!t.x.isInRange(b))return null;var m=[{x:b,y:d+p},{x:b,y:d}];return o==="top"?m.reverse():m}if(a){var S=u.segment,w=S.map(function(_){return t.apply(_,{position:s})});return Va(u,"discard")&&eae(w,function(_){return!t.isInRange(_)})?null:w}return null};function Cie(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,o=e.className,c=e.alwaysShow,u=fie(),f=lC(a),d=cC(i),h=pie();if(!u||!h)return null;Ta(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=Ub({x:f.scale,y:d.scale}),v=cr(t),x=cr(r),y=n&&n.length===2,g=Oie(p,v,x,y,h,e.position,f.orientation,d.orientation,e);if(!g)return null;var b=kie(g,2),m=b[0],S=m.x,w=m.y,_=b[1],k=_.x,N=_.y,j=Va(e,"hidden")?"url(#".concat(u,")"):void 0,E=ON(ON({clipPath:j},Ce(e,!0)),{},{x1:S,y1:w,x2:k,y2:N});return Y.createElement(Je,{className:ze("recharts-reference-line",o)},Aie(s,E),xr.renderCallByParent(e,zae({x1:S,y1:w,x2:k,y2:N})))}var f0=function(e){function t(){return xie(this,t),yie(this,t,arguments)}return _ie(t,e),gie(t,[{key:"render",value:function(){return Y.createElement(Cie,this.props)}}])}(Y.Component);Gb(f0,"displayName","ReferenceLine");Gb(f0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function w1(){return w1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w1.apply(this,arguments)}function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function PN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function MN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PN(Object(r),!0).forEach(function(n){Fm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hC(n.key),n)}}function Fie(e,t,r){return t&&Mie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Die(e,t,r){return t=Yh(t),Iie(e,dC()?Reflect.construct(t,r||[],Yh(e).constructor):t.apply(e,r))}function Iie(e,t){if(t&&(Kl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rie(e)}function Rie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dC=function(){return!!e})()}function Yh(e){return Yh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yh(e)}function $ie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_1(e,t)}function _1(e,t){return _1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_1(e,t)}function Fm(e,t,r){return t=hC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hC(e){var t=Lie(e,"string");return Kl(t)=="symbol"?t:t+""}function Lie(e,t){if(Kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Bie=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=Ub({x:a.scale,y:i.scale}),o=s.apply({x:r,y:n},{bandAware:!0});return Va(t,"discard")&&!s.isInRange(o)?null:o},Dm=function(e){function t(){return Pie(this,t),Die(this,t,arguments)}return $ie(t,e),Fie(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,o=n.alwaysShow,c=n.clipPathId,u=cr(a),f=cr(i);if(Ta(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!f)return null;var d=Bie(this.props);if(!d)return null;var h=d.x,p=d.y,v=this.props,x=v.shape,y=v.className,g=Va(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=MN(MN({clipPath:g},Ce(this.props,!0)),{},{cx:h,cy:p});return Y.createElement(Je,{className:ze("recharts-reference-dot",y)},t.renderDot(x,b),xr.renderCallByParent(this.props,{x:h-s,y:p-s,width:2*s,height:2*s}))}}])}(Y.Component);Fm(Dm,"displayName","ReferenceDot");Fm(Dm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Fm(Dm,"renderDot",function(e,t){var r;return Y.isValidElement(e)?r=Y.cloneElement(e,t):Ie(e)?r=e(t):r=Y.createElement(jm,w1({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function S1(){return S1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S1.apply(this,arguments)}function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function FN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FN(Object(r),!0).forEach(function(n){Im(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mC(n.key),n)}}function Wie(e,t,r){return t&&zie(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hie(e,t,r){return t=Qh(t),Vie(e,pC()?Reflect.construct(t,r||[],Qh(e).constructor):t.apply(e,r))}function Vie(e,t){if(t&&(ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gie(e)}function Gie(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pC=function(){return!!e})()}function Qh(e){return Qh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qh(e)}function Xie(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k1(e,t)}function k1(e,t){return k1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},k1(e,t)}function Im(e,t,r){return t=mC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mC(e){var t=Kie(e,"string");return ql(t)=="symbol"?t:t+""}function Kie(e,t){if(ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qie=function(t,r,n,a,i){var s=i.x1,o=i.x2,c=i.y1,u=i.y2,f=i.xAxis,d=i.yAxis;if(!f||!d)return null;var h=Ub({x:f.scale,y:d.scale}),p={x:t?h.x.apply(s,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(o,{position:"end"}):h.x.rangeMax,y:a?h.y.apply(u,{position:"end"}):h.y.rangeMax};return Va(i,"discard")&&(!h.isInRange(p)||!h.isInRange(v))?null:tC(p,v)},Rm=function(e){function t(){return Uie(this,t),Hie(this,t,arguments)}return Xie(t,e),Wie(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,o=n.y2,c=n.className,u=n.alwaysShow,f=n.clipPathId;Ta(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=cr(a),h=cr(i),p=cr(s),v=cr(o),x=this.props.shape;if(!d&&!h&&!p&&!v&&!x)return null;var y=qie(d,h,p,v,this.props);if(!y&&!x)return null;var g=Va(this.props,"hidden")?"url(#".concat(f,")"):void 0;return Y.createElement(Je,{className:ze("recharts-reference-area",c)},t.renderRect(x,DN(DN({clipPath:g},Ce(this.props,!0)),y)),xr.renderCallByParent(this.props,y))}}])}(Y.Component);Im(Rm,"displayName","ReferenceArea");Im(Rm,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Im(Rm,"renderRect",function(e,t){var r;return Y.isValidElement(e)?r=Y.cloneElement(e,t):Ie(e)?r=e(t):r=Y.createElement(Bb,S1({},t,{className:"recharts-reference-area-rect"})),r});function xC(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function Yie(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Hae(n,r)}function Qie(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,o=e.height;return t===1?{start:n?a:i,end:n?a+s:i+o}:{start:n?a+s:i+o,end:n?a:i}}function Zh(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Zie(e,t){return xC(e,t+1)}function Jie(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,o=t.end,c=0,u=1,f=s,d=function(){var v=n==null?void 0:n[c];if(v===void 0)return{v:xC(n,u)};var x=c,y,g=function(){return y===void 0&&(y=r(v,x)),y},b=v.coordinate,m=c===0||Zh(e,b,g,f,o);m||(c=0,f=s,u+=1),m&&(f=b+e*(g()/2+a),c+=u)},h;u<=i.length;)if(h=d(),h)return h.v;return[]}function Pf(e){"@babel/helpers - typeof";return Pf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pf(e)}function IN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ir(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IN(Object(r),!0).forEach(function(n){ese(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ese(e,t,r){return t=tse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tse(e){var t=rse(e,"string");return Pf(t)=="symbol"?t:t+""}function rse(e,t){if(Pf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nse(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,o=t.start,c=t.end,u=function(h){var p=i[h],v,x=function(){return v===void 0&&(v=r(p,h)),v};if(h===s-1){var y=e*(p.coordinate+e*x()/2-c);i[h]=p=Ir(Ir({},p),{},{tickCoord:y>0?p.coordinate-y*e:p.coordinate})}else i[h]=p=Ir(Ir({},p),{},{tickCoord:p.coordinate});var g=Zh(e,p.tickCoord,x,o,c);g&&(c=p.tickCoord-e*(x()/2+a),i[h]=Ir(Ir({},p),{},{isShow:!0}))},f=s-1;f>=0;f--)u(f);return i}function ase(e,t,r,n,a,i){var s=(n||[]).slice(),o=s.length,c=t.start,u=t.end;if(i){var f=n[o-1],d=r(f,o-1),h=e*(f.coordinate+e*d/2-u);s[o-1]=f=Ir(Ir({},f),{},{tickCoord:h>0?f.coordinate-h*e:f.coordinate});var p=Zh(e,f.tickCoord,function(){return d},c,u);p&&(u=f.tickCoord-e*(d/2+a),s[o-1]=Ir(Ir({},f),{},{isShow:!0}))}for(var v=i?o-1:o,x=function(b){var m=s[b],S,w=function(){return S===void 0&&(S=r(m,b)),S};if(b===0){var _=e*(m.coordinate-e*w()/2-c);s[b]=m=Ir(Ir({},m),{},{tickCoord:_<0?m.coordinate-_*e:m.coordinate})}else s[b]=m=Ir(Ir({},m),{},{tickCoord:m.coordinate});var k=Zh(e,m.tickCoord,w,c,u);k&&(c=m.tickCoord+e*(w()/2+a),s[b]=Ir(Ir({},m),{},{isShow:!0}))},y=0;y<v;y++)x(y);return s}function Xb(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,o=e.orientation,c=e.interval,u=e.tickFormatter,f=e.unit,d=e.angle;if(!a||!a.length||!n)return[];if(ve(c)||So.isSsr)return Zie(a,typeof c=="number"&&ve(c)?c:0);var h=[],p=o==="top"||o==="bottom"?"width":"height",v=f&&p==="width"?wu(f,{fontSize:t,letterSpacing:r}):{width:0,height:0},x=function(m,S){var w=Ie(u)?u(m.value,S):m.value;return p==="width"?Yie(wu(w,{fontSize:t,letterSpacing:r}),v,d):wu(w,{fontSize:t,letterSpacing:r})[p]},y=a.length>=2?Jr(a[1].coordinate-a[0].coordinate):1,g=Qie(i,y,p);return c==="equidistantPreserveStart"?Jie(y,g,x,a,s):(c==="preserveStart"||c==="preserveStartEnd"?h=ase(y,g,x,a,s,c==="preserveStartEnd"):h=nse(y,g,x,a,s),h.filter(function(b){return b.isShow}))}var ise=["viewBox"],sse=["viewBox"],ose=["ticks"];function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function ll(){return ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ll.apply(this,arguments)}function RN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RN(Object(r),!0).forEach(function(n){Kb(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qx(e,t){if(e==null)return{};var r=lse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function lse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function cse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gC(n.key),n)}}function use(e,t,r){return t&&$N(e.prototype,t),r&&$N(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fse(e,t,r){return t=Jh(t),dse(e,vC()?Reflect.construct(t,r||[],Jh(e).constructor):t.apply(e,r))}function dse(e,t){if(t&&(Yl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hse(e)}function hse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vC=function(){return!!e})()}function Jh(e){return Jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Jh(e)}function pse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N1(e,t)}function N1(e,t){return N1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},N1(e,t)}function Kb(e,t,r){return t=gC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gC(e){var t=mse(e,"string");return Yl(t)=="symbol"?t:t+""}function mse(e,t){if(Yl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Nc=function(e){function t(r){var n;return cse(this,t),n=fse(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return pse(t,e),use(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=qx(n,ise),o=this.props,c=o.viewBox,u=qx(o,sse);return!vl(i,c)||!vl(s,u)||!vl(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,o=a.width,c=a.height,u=a.orientation,f=a.tickSize,d=a.mirror,h=a.tickMargin,p,v,x,y,g,b,m=d?-1:1,S=n.tickSize||f,w=ve(n.tickCoord)?n.tickCoord:n.coordinate;switch(u){case"top":p=v=n.coordinate,y=s+ +!d*c,x=y-m*S,b=x-m*h,g=w;break;case"left":x=y=n.coordinate,v=i+ +!d*o,p=v-m*S,g=p-m*h,b=w;break;case"right":x=y=n.coordinate,v=i+ +d*o,p=v+m*S,g=p+m*h,b=w;break;default:p=v=n.coordinate,y=s+ +d*c,x=y+m*S,b=x+m*h,g=w;break}return{line:{x1:p,y1:x,x2:v,y2:y},tick:{x:g,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,o=n.height,c=n.orientation,u=n.mirror,f=n.axisLine,d=nr(nr(nr({},Ce(this.props,!1)),Ce(f,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!u||c==="bottom"&&u);d=nr(nr({},d),{},{x1:a,y1:i+h*o,x2:a+s,y2:i+h*o})}else{var p=+(c==="left"&&!u||c==="right"&&u);d=nr(nr({},d),{},{x1:a+p*s,y1:i,x2:a+p*s,y2:i+o})}return Y.createElement("line",ll({},d,{className:ze("recharts-cartesian-axis-line",Mn(f,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,o=this.props,c=o.tickLine,u=o.stroke,f=o.tick,d=o.tickFormatter,h=o.unit,p=Xb(nr(nr({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),x=this.getTickVerticalAnchor(),y=Ce(this.props,!1),g=Ce(f,!1),b=nr(nr({},y),{},{fill:"none"},Ce(c,!1)),m=p.map(function(S,w){var _=s.getTickLineCoord(S),k=_.line,N=_.tick,j=nr(nr(nr(nr({textAnchor:v,verticalAnchor:x},y),{},{stroke:"none",fill:u},g),N),{},{index:w,payload:S,visibleTicksCount:p.length,tickFormatter:d});return Y.createElement(Je,ll({className:"recharts-cartesian-axis-tick",key:"tick-".concat(S.value,"-").concat(S.coordinate,"-").concat(S.tickCoord)},oo(s.props,S,w)),c&&Y.createElement("line",ll({},b,k,{className:ze("recharts-cartesian-axis-tick-line",Mn(c,"className"))})),f&&t.renderTickItem(f,j,"".concat(Ie(d)?d(S.value,w):S.value).concat(h||"")))});return Y.createElement("g",{className:"recharts-cartesian-axis-ticks"},m)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,o=a.height,c=a.ticksGenerator,u=a.className,f=a.hide;if(f)return null;var d=this.props,h=d.ticks,p=qx(d,ose),v=h;return Ie(c)&&(v=h&&h.length>0?c(this.props):c(p)),s<=0||o<=0||!v||!v.length?null:Y.createElement(Je,{className:ze("recharts-cartesian-axis",u),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),xr.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,o=ze(a.className,"recharts-cartesian-axis-tick-value");return Y.isValidElement(n)?s=Y.cloneElement(n,nr(nr({},a),{},{className:o})):Ie(n)?s=n(nr(nr({},a),{},{className:o})):s=Y.createElement(lo,ll({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(G.Component);Kb(Nc,"displayName","CartesianAxis");Kb(Nc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var xse=["x1","y1","x2","y2","key"],vse=["offset"];function fo(e){"@babel/helpers - typeof";return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(e)}function LN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LN(Object(r),!0).forEach(function(n){gse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gse(e,t,r){return t=yse(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yse(e){var t=bse(e,"string");return fo(t)=="symbol"?t:t+""}function bse(e,t){if(fo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fo(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vs(){return Vs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vs.apply(this,arguments)}function BN(e,t){if(e==null)return{};var r=wse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var _se=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,o=t.height,c=t.ry;return Y.createElement("rect",{x:a,y:i,ry:c,width:s,height:o,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function yC(e,t){var r;if(Y.isValidElement(e))r=Y.cloneElement(e,t);else if(Ie(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,o=t.key,c=BN(t,xse),u=Ce(c,!1);u.offset;var f=BN(u,vse);r=Y.createElement("line",Vs({},f,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:o}))}return r}function Sse(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,c){var u=Br(Br({},e),{},{x1:t,y1:o,x2:t+r,y2:o,key:"line-".concat(c),index:c});return yC(a,u)});return Y.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function kse(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(o,c){var u=Br(Br({},e),{},{x1:o,y1:t,x2:o,y2:t+r,key:"line-".concat(c),index:c});return yC(a,u)});return Y.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function Nse(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,o=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var f=o.map(function(h){return Math.round(h+a-a)}).sort(function(h,p){return h-p});a!==f[0]&&f.unshift(0);var d=f.map(function(h,p){var v=!f[p+1],x=v?a+s-h:f[p+1]-h;if(x<=0)return null;var y=p%t.length;return Y.createElement("rect",{key:"react-".concat(p),y:h,x:n,height:x,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Y.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function jse(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,o=e.width,c=e.height,u=e.verticalPoints;if(!r||!n||!n.length)return null;var f=u.map(function(h){return Math.round(h+i-i)}).sort(function(h,p){return h-p});i!==f[0]&&f.unshift(0);var d=f.map(function(h,p){var v=!f[p+1],x=v?i+o-h:f[p+1]-h;if(x<=0)return null;var y=p%n.length;return Y.createElement("rect",{key:"react-".concat(p),x:h,y:s,width:x,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Y.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var Ese=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return m3(Xb(Br(Br(Br({},Nc.defaultProps),n),{},{ticks:ui(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},Tse=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return m3(Xb(Br(Br(Br({},Nc.defaultProps),n),{},{ticks:ui(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},Ro={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function ho(e){var t,r,n,a,i,s,o=Hb(),c=Vb(),u=mie(),f=Br(Br({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Ro.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Ro.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Ro.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Ro.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Ro.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Ro.verticalFill,x:ve(e.x)?e.x:u.left,y:ve(e.y)?e.y:u.top,width:ve(e.width)?e.width:u.width,height:ve(e.height)?e.height:u.height}),d=f.x,h=f.y,p=f.width,v=f.height,x=f.syncWithTicks,y=f.horizontalValues,g=f.verticalValues,b=die(),m=hie();if(!ve(p)||p<=0||!ve(v)||v<=0||!ve(d)||d!==+d||!ve(h)||h!==+h)return null;var S=f.verticalCoordinatesGenerator||Ese,w=f.horizontalCoordinatesGenerator||Tse,_=f.horizontalPoints,k=f.verticalPoints;if((!_||!_.length)&&Ie(w)){var N=y&&y.length,j=w({yAxis:m?Br(Br({},m),{},{ticks:N?y:m.ticks}):void 0,width:o,height:c,offset:u},N?!0:x);Ta(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(fo(j),"]")),Array.isArray(j)&&(_=j)}if((!k||!k.length)&&Ie(S)){var E=g&&g.length,O=S({xAxis:b?Br(Br({},b),{},{ticks:E?g:b.ticks}):void 0,width:o,height:c,offset:u},E?!0:x);Ta(Array.isArray(O),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(fo(O),"]")),Array.isArray(O)&&(k=O)}return Y.createElement("g",{className:"recharts-cartesian-grid"},Y.createElement(_se,{fill:f.fill,fillOpacity:f.fillOpacity,x:f.x,y:f.y,width:f.width,height:f.height,ry:f.ry}),Y.createElement(Sse,Vs({},f,{offset:u,horizontalPoints:_,xAxis:b,yAxis:m})),Y.createElement(kse,Vs({},f,{offset:u,verticalPoints:k,xAxis:b,yAxis:m})),Y.createElement(Nse,Vs({},f,{horizontalPoints:_})),Y.createElement(jse,Vs({},f,{verticalPoints:k})))}ho.displayName="CartesianGrid";var Ase=["type","layout","connectNulls","ref"],Ose=["key"];function Ql(e){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(e)}function UN(e,t){if(e==null)return{};var r=Cse(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Cse(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Eu(){return Eu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eu.apply(this,arguments)}function zN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zN(Object(r),!0).forEach(function(n){wa(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $o(e){return Dse(e)||Fse(e)||Mse(e)||Pse()}function Pse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mse(e,t){if(e){if(typeof e=="string")return j1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j1(e,t)}}function Fse(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dse(e){if(Array.isArray(e))return j1(e)}function j1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ise(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WN(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wC(n.key),n)}}function Rse(e,t,r){return t&&WN(e.prototype,t),r&&WN(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $se(e,t,r){return t=ep(t),Lse(e,bC()?Reflect.construct(t,r||[],ep(e).constructor):t.apply(e,r))}function Lse(e,t){if(t&&(Ql(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bse(e)}function Bse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bC=function(){return!!e})()}function ep(e){return ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ep(e)}function Use(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E1(e,t)}function E1(e,t){return E1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},E1(e,t)}function wa(e,t,r){return t=wC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wC(e){var t=zse(e,"string");return Ql(t)=="symbol"?t:t+""}function zse(e,t){if(Ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var jc=function(e){function t(){var r;Ise(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=$se(this,t,[].concat(a)),wa(r,"state",{isAnimationFinished:!0,totalLength:0}),wa(r,"generateSimpleStrokeDasharray",function(s,o){return"".concat(o,"px ").concat(s-o,"px")}),wa(r,"getStrokeDasharray",function(s,o,c){var u=c.reduce(function(g,b){return g+b});if(!u)return r.generateSimpleStrokeDasharray(o,s);for(var f=Math.floor(s/u),d=s%u,h=o-s,p=[],v=0,x=0;v<c.length;x+=c[v],++v)if(x+c[v]>d){p=[].concat($o(c.slice(0,v)),[d-x]);break}var y=p.length%2===0?[0,h]:[h];return[].concat($o(t.repeat(c,f)),$o(p),y).map(function(g){return"".concat(g,"px")}).join(", ")}),wa(r,"id",gc("recharts-line-")),wa(r,"pathRef",function(s){r.mainCurve=s}),wa(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),wa(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Use(t,e),Rse(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,o=i.xAxis,c=i.yAxis,u=i.layout,f=i.children,d=Fn(f,u0);if(!d)return null;var h=function(x,y){return{x:x.x,y:x.y,value:x.value,errorVal:sr(x.payload,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Y.createElement(Je,p,d.map(function(v){return Y.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:s,xAxis:o,yAxis:c,layout:u,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,c=o.dot,u=o.points,f=o.dataKey,d=Ce(this.props,!1),h=Ce(c,!0),p=u.map(function(x,y){var g=wn(wn(wn({key:"dot-".concat(y),r:3},d),h),{},{index:y,cx:x.x,cy:x.y,value:x.value,dataKey:f,payload:x.payload,points:u});return t.renderDotItem(c,g)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return Y.createElement(Je,Eu({className:"recharts-line-dots",key:"dots"},v),p)}},{key:"renderCurveStatically",value:function(n,a,i,s){var o=this.props,c=o.type,u=o.layout,f=o.connectNulls;o.ref;var d=UN(o,Ase),h=wn(wn(wn({},Ce(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:u,connectNulls:f});return Y.createElement(Mh,Eu({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,o=s.points,c=s.strokeDasharray,u=s.isAnimationActive,f=s.animationBegin,d=s.animationDuration,h=s.animationEasing,p=s.animationId,v=s.animateNewValues,x=s.width,y=s.height,g=this.state,b=g.prevPoints,m=g.totalLength;return Y.createElement(Ka,{begin:f,duration:d,isActive:u,easing:h,from:{t:0},to:{t:1},key:"line-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(S){var w=S.t;if(b){var _=b.length/o.length,k=o.map(function(T,L){var X=Math.floor(L*_);if(b[X]){var M=b[X],U=Nn(M.x,T.x),q=Nn(M.y,T.y);return wn(wn({},T),{},{x:U(w),y:q(w)})}if(v){var K=Nn(x*2,T.x),F=Nn(y/2,T.y);return wn(wn({},T),{},{x:K(w),y:F(w)})}return wn(wn({},T),{},{x:T.x,y:T.y})});return i.renderCurveStatically(k,n,a)}var N=Nn(0,m),j=N(w),E;if(c){var O="".concat(c).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});E=i.getStrokeDasharray(j,m,O)}else E=i.generateSimpleStrokeDasharray(m,j);return i.renderCurveStatically(o,n,a,{strokeDasharray:E})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,o=i.isAnimationActive,c=this.state,u=c.prevPoints,f=c.totalLength;return o&&s&&s.length&&(!u&&f>0||!c0(u,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,o=a.points,c=a.className,u=a.xAxis,f=a.yAxis,d=a.top,h=a.left,p=a.width,v=a.height,x=a.isAnimationActive,y=a.id;if(i||!o||!o.length)return null;var g=this.state.isAnimationFinished,b=o.length===1,m=ze("recharts-line",c),S=u&&u.allowDataOverflow,w=f&&f.allowDataOverflow,_=S||w,k=$e(y)?this.id:y,N=(n=Ce(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},j=N.r,E=j===void 0?3:j,O=N.strokeWidth,T=O===void 0?2:O,L=oL(s)?s:{},X=L.clipDot,M=X===void 0?!0:X,U=E*2+T;return Y.createElement(Je,{className:m},S||w?Y.createElement("defs",null,Y.createElement("clipPath",{id:"clipPath-".concat(k)},Y.createElement("rect",{x:S?h:h-p/2,y:w?d:d-v/2,width:S?p:p*2,height:w?v:v*2})),!M&&Y.createElement("clipPath",{id:"clipPath-dots-".concat(k)},Y.createElement("rect",{x:h-U/2,y:d-U/2,width:p+U,height:v+U}))):null,!b&&this.renderCurve(_,k),this.renderErrorBar(_,k),(b||s)&&this.renderDots(_,M,k),(!x||g)&&ta.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat($o(n),[0]):n,s=[],o=0;o<a;++o)s=[].concat($o(s),$o(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(Y.isValidElement(n))i=Y.cloneElement(n,a);else if(Ie(n))i=n(a);else{var s=a.key,o=UN(a,Ose),c=ze("recharts-line-dot",typeof n!="boolean"?n.className:"");i=Y.createElement(jm,Eu({key:s},o,{className:c}))}return i}}])}(G.PureComponent);wa(jc,"displayName","Line");wa(jc,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!So.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});wa(jc,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,o=e.bandSize,c=e.displayedData,u=e.offset,f=t.layout,d=c.map(function(h,p){var v=sr(h,s);return f==="horizontal"?{x:xk({axis:r,ticks:a,bandSize:o,entry:h,index:p}),y:$e(v)?null:n.scale(v),value:v,payload:h}:{x:$e(v)?null:r.scale(v),y:xk({axis:n,ticks:i,bandSize:o,entry:h,index:p}),value:v,payload:h}});return wn({points:d,layout:f},u)});function Zl(e){"@babel/helpers - typeof";return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function Wse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kC(n.key),n)}}function Vse(e,t,r){return t&&Hse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gse(e,t,r){return t=tp(t),Xse(e,_C()?Reflect.construct(t,r||[],tp(e).constructor):t.apply(e,r))}function Xse(e,t){if(t&&(Zl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kse(e)}function Kse(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_C=function(){return!!e})()}function tp(e){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tp(e)}function qse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T1(e,t)}function T1(e,t){return T1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},T1(e,t)}function SC(e,t,r){return t=kC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kC(e){var t=Yse(e,"string");return Zl(t)=="symbol"?t:t+""}function Yse(e,t){if(Zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function A1(){return A1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A1.apply(this,arguments)}function Qse(e){var t=e.xAxisId,r=Hb(),n=Vb(),a=lC(t);return a==null?null:G.createElement(Nc,A1({},a,{className:ze("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return ui(s,!0)}}))}var vn=function(e){function t(){return Wse(this,t),Gse(this,t,arguments)}return qse(t,e),Vse(t,[{key:"render",value:function(){return G.createElement(Qse,this.props)}}])}(G.Component);SC(vn,"displayName","XAxis");SC(vn,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Jl(e){"@babel/helpers - typeof";return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(e)}function Zse(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jse(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,EC(n.key),n)}}function eoe(e,t,r){return t&&Jse(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function toe(e,t,r){return t=rp(t),roe(e,NC()?Reflect.construct(t,r||[],rp(e).constructor):t.apply(e,r))}function roe(e,t){if(t&&(Jl(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return noe(e)}function noe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NC=function(){return!!e})()}function rp(e){return rp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rp(e)}function aoe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O1(e,t)}function O1(e,t){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},O1(e,t)}function jC(e,t,r){return t=EC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EC(e){var t=ioe(e,"string");return Jl(t)=="symbol"?t:t+""}function ioe(e,t){if(Jl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function C1(){return C1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C1.apply(this,arguments)}var soe=function(t){var r=t.yAxisId,n=Hb(),a=Vb(),i=cC(r);return i==null?null:G.createElement(Nc,C1({},i,{className:ze("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(o){return ui(o,!0)}}))},gn=function(e){function t(){return Zse(this,t),toe(this,t,arguments)}return aoe(t,e),eoe(t,[{key:"render",value:function(){return G.createElement(soe,this.props)}}])}(G.Component);jC(gn,"displayName","YAxis");jC(gn,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function HN(e){return uoe(e)||coe(e)||loe(e)||ooe()}function ooe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function loe(e,t){if(e){if(typeof e=="string")return P1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P1(e,t)}}function coe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uoe(e){if(Array.isArray(e))return P1(e)}function P1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var M1=function(t,r,n,a,i){var s=Fn(t,f0),o=Fn(t,Dm),c=[].concat(HN(s),HN(o)),u=Fn(t,Rm),f="".concat(a,"Id"),d=a[0],h=r;if(c.length&&(h=c.reduce(function(x,y){if(y.props[f]===n&&Va(y.props,"extendDomain")&&ve(y.props[d])){var g=y.props[d];return[Math.min(x[0],g),Math.max(x[1],g)]}return x},h)),u.length){var p="".concat(d,"1"),v="".concat(d,"2");h=u.reduce(function(x,y){if(y.props[f]===n&&Va(y.props,"extendDomain")&&ve(y.props[p])&&ve(y.props[v])){var g=y.props[p],b=y.props[v];return[Math.min(x[0],g,b),Math.max(x[1],g,b)]}return x},h)}return i&&i.length&&(h=i.reduce(function(x,y){return ve(y)?[Math.min(x[0],y),Math.max(x[1],y)]:x},h)),h},TC={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function i(c,u,f,d,h){if(typeof f!="function")throw new TypeError("The listener must be a function");var p=new a(f,d||c,h),v=r?r+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],p]:c._events[v].push(p):(c._events[v]=p,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)t.call(f,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},o.prototype.listeners=function(u){var f=r?r+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,v=new Array(p);h<p;h++)v[h]=d[h].fn;return v},o.prototype.listenerCount=function(u){var f=r?r+u:u,d=this._events[f];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,f,d,h,p,v){var x=r?r+u:u;if(!this._events[x])return!1;var y=this._events[x],g=arguments.length,b,m;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),g){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,d),!0;case 4:return y.fn.call(y.context,f,d,h),!0;case 5:return y.fn.call(y.context,f,d,h,p),!0;case 6:return y.fn.call(y.context,f,d,h,p,v),!0}for(m=1,b=new Array(g-1);m<g;m++)b[m-1]=arguments[m];y.fn.apply(y.context,b)}else{var S=y.length,w;for(m=0;m<S;m++)switch(y[m].once&&this.removeListener(u,y[m].fn,void 0,!0),g){case 1:y[m].fn.call(y[m].context);break;case 2:y[m].fn.call(y[m].context,f);break;case 3:y[m].fn.call(y[m].context,f,d);break;case 4:y[m].fn.call(y[m].context,f,d,h);break;default:if(!b)for(w=1,b=new Array(g-1);w<g;w++)b[w-1]=arguments[w];y[m].fn.apply(y[m].context,b)}}return!0},o.prototype.on=function(u,f,d){return i(this,u,f,d,!1)},o.prototype.once=function(u,f,d){return i(this,u,f,d,!0)},o.prototype.removeListener=function(u,f,d,h){var p=r?r+u:u;if(!this._events[p])return this;if(!f)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===f&&(!h||v.once)&&(!d||v.context===d)&&s(this,p);else{for(var x=0,y=[],g=v.length;x<g;x++)(v[x].fn!==f||h&&!v[x].once||d&&v[x].context!==d)&&y.push(v[x]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},o.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(TC);var foe=TC.exports;const doe=st(foe);var Yx=new doe,Qx="recharts.syncMouseEvents";function Mf(e){"@babel/helpers - typeof";return Mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mf(e)}function hoe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function poe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AC(n.key),n)}}function moe(e,t,r){return t&&poe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zx(e,t,r){return t=AC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AC(e){var t=xoe(e,"string");return Mf(t)=="symbol"?t:t+""}function xoe(e,t){if(Mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var voe=function(){function e(){hoe(this,e),Zx(this,"activeIndex",0),Zx(this,"coordinateList",[]),Zx(this,"layout","horizontal")}return moe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,o=s===void 0?null:s,c=r.layout,u=c===void 0?null:c,f=r.offset,d=f===void 0?null:f,h=r.mouseHandlerCallback,p=h===void 0?null:h;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=o??this.container,this.layout=u??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,o=a.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,f=((n=window)===null||n===void 0?void 0:n.scrollY)||0,d=i+c+u,h=s+this.offset.top+o/2+f;this.mouseHandlerCallback({pageX:d,pageY:h})}}}])}();function goe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&ve(n)&&ve(a))return!0}return!1}function yoe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function OC(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=pt(t,r,n,a),o=pt(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function boe(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var o=t.cx,c=t.cy,u=t.innerRadius,f=t.outerRadius,d=t.angle,h=pt(o,c,u,d),p=pt(o,c,f,d);n=h.x,a=h.y,i=p.x,s=p.y}else return OC(t);return[{x:n,y:a},{x:i,y:s}]}function Ff(e){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ff(e)}function VN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ed(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VN(Object(r),!0).forEach(function(n){woe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function woe(e,t,r){return t=_oe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _oe(e){var t=Soe(e,"string");return Ff(t)=="symbol"?t:t+""}function Soe(e,t){if(Ff(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ff(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function koe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,o=e.activePayload,c=e.offset,u=e.activeTooltipIndex,f=e.tooltipAxisBandSize,d=e.layout,h=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!i||!s||h!=="ScatterChart"&&a!=="axis")return null;var v,x=Mh;if(h==="ScatterChart")v=s,x=zte;else if(h==="BarChart")v=yoe(d,s,c,f),x=Bb;else if(d==="radial"){var y=OC(s),g=y.cx,b=y.cy,m=y.radius,S=y.startAngle,w=y.endAngle;v={cx:g,cy:b,startAngle:S,endAngle:w,innerRadius:m,outerRadius:m},x=j3}else v={points:boe(d,s,c)},x=Mh;var _=ed(ed(ed(ed({stroke:"#ccc",pointerEvents:"none"},c),v),Ce(p,!1)),{},{payload:o,payloadIndex:u,className:ze("recharts-tooltip-cursor",p.className)});return G.isValidElement(p)?G.cloneElement(p,_):G.createElement(x,_)}var Noe=["item"],joe=["children","className","width","height","style","compact","title","desc"];function ec(e){"@babel/helpers - typeof";return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ec(e)}function cl(){return cl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cl.apply(this,arguments)}function GN(e,t){return Aoe(e)||Toe(e,t)||PC(e,t)||Eoe()}function Eoe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Toe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function Aoe(e){if(Array.isArray(e))return e}function XN(e,t){if(e==null)return{};var r=Ooe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ooe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Coe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Poe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MC(n.key),n)}}function Moe(e,t,r){return t&&Poe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Foe(e,t,r){return t=np(t),Doe(e,CC()?Reflect.construct(t,r||[],np(e).constructor):t.apply(e,r))}function Doe(e,t){if(t&&(ec(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ioe(e)}function Ioe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CC(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CC=function(){return!!e})()}function np(e){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},np(e)}function Roe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F1(e,t)}function F1(e,t){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},F1(e,t)}function tc(e){return Boe(e)||Loe(e)||PC(e)||$oe()}function $oe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PC(e,t){if(e){if(typeof e=="string")return D1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D1(e,t)}}function Loe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Boe(e){if(Array.isArray(e))return D1(e)}function D1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KN(Object(r),!0).forEach(function(n){Pe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pe(e,t,r){return t=MC(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MC(e){var t=Uoe(e,"string");return ec(t)=="symbol"?t:t+""}function Uoe(e,t){if(ec(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ec(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zoe={xAxis:["bottom","top"],yAxis:["left","right"]},Woe={width:"100%",height:"100%"},FC={x:0,y:0};function td(e){return e}var Hoe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Voe=function(t,r,n,a){var i=r.find(function(f){return f&&f.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,o=a.radius;return oe(oe(oe({},a),pt(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var c=i.coordinate,u=a.angle;return oe(oe(oe({},a),pt(a.cx,a.cy,c,u)),{},{angle:u,radius:c})}return FC},$m=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(o,c){var u=c.props.data;return u&&u.length?[].concat(tc(o),tc(u)):o},[]);return s.length>0?s:t&&t.length&&ve(a)&&ve(i)?t.slice(a,i+1):[]};function DC(e){return e==="number"?[0,"auto"]:void 0}var I1=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,o=$m(r,t);return n<0||!i||!i.length||n>=o.length?null:i.reduce(function(c,u){var f,d=(f=u.props.data)!==null&&f!==void 0?f:r;d&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(d=d.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(s.dataKey&&!s.allowDuplicatedCategory){var p=d===void 0?o:d;h=th(p,s.dataKey,a)}else h=d&&d[n]||o[n];return h?[].concat(tc(c),[b3(u,h)]):c},[])},qN=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=Hoe(i,n),o=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,f=lZ(s,o,u,c);if(f>=0&&u){var d=u[f]&&u[f].value,h=I1(t,r,f,d),p=Voe(n,o,f,i);return{activeTooltipIndex:f,activeLabel:d,activePayload:h,activeCoordinate:p}}return null},Goe=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,h=t.stackOffset,p=p3(f,i);return n.reduce(function(v,x){var y,g=x.type.defaultProps!==void 0?oe(oe({},x.type.defaultProps),x.props):x.props,b=g.type,m=g.dataKey,S=g.allowDataOverflow,w=g.allowDuplicatedCategory,_=g.scale,k=g.ticks,N=g.includeHidden,j=g[s];if(v[j])return v;var E=$m(t.data,{graphicalItems:a.filter(function(A){var R,D=s in A.props?A.props[s]:(R=A.type.defaultProps)===null||R===void 0?void 0:R[s];return D===j}),dataStartIndex:c,dataEndIndex:u}),O=E.length,T,L,X;goe(g.domain,S,b)&&(T=Yg(g.domain,null,S),p&&(b==="number"||_!=="auto")&&(X=Su(E,m,"category")));var M=DC(b);if(!T||T.length===0){var U,q=(U=g.domain)!==null&&U!==void 0?U:M;if(m){if(T=Su(E,m,b),b==="category"&&p){var K=Q$(T);w&&K?(L=T,T=Hh(0,O)):w||(T=bk(q,T,x).reduce(function(A,R){return A.indexOf(R)>=0?A:[].concat(tc(A),[R])},[]))}else if(b==="category")w?T=T.filter(function(A){return A!==""&&!$e(A)}):T=bk(q,T,x).reduce(function(A,R){return A.indexOf(R)>=0||R===""||$e(R)?A:[].concat(tc(A),[R])},[]);else if(b==="number"){var F=hZ(E,a.filter(function(A){var R,D,H=s in A.props?A.props[s]:(R=A.type.defaultProps)===null||R===void 0?void 0:R[s],J="hide"in A.props?A.props.hide:(D=A.type.defaultProps)===null||D===void 0?void 0:D.hide;return H===j&&(N||!J)}),m,i,f);F&&(T=F)}p&&(b==="number"||_!=="auto")&&(X=Su(E,m,"category"))}else p?T=Hh(0,O):o&&o[j]&&o[j].hasStack&&b==="number"?T=h==="expand"?[0,1]:y3(o[j].stackGroups,c,u):T=h3(E,a.filter(function(A){var R=s in A.props?A.props[s]:A.type.defaultProps[s],D="hide"in A.props?A.props.hide:A.type.defaultProps.hide;return R===j&&(N||!D)}),b,f,!0);if(b==="number")T=M1(d,T,j,i,k),q&&(T=Yg(q,T,S));else if(b==="category"&&q){var Q=q,ie=T.every(function(A){return Q.indexOf(A)>=0});ie&&(T=Q)}}return oe(oe({},v),{},Pe({},j,oe(oe({},g),{},{axisType:i,domain:T,categoricalDomain:X,duplicateDomain:L,originalDomain:(y=g.domain)!==null&&y!==void 0?y:M,isCategorical:p,layout:f})))},{})},Xoe=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.layout,d=t.children,h=$m(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=h.length,v=p3(f,i),x=-1;return n.reduce(function(y,g){var b=g.type.defaultProps!==void 0?oe(oe({},g.type.defaultProps),g.props):g.props,m=b[s],S=DC("number");if(!y[m]){x++;var w;return v?w=Hh(0,p):o&&o[m]&&o[m].hasStack?(w=y3(o[m].stackGroups,c,u),w=M1(d,w,m,i)):(w=Yg(S,h3(h,n.filter(function(_){var k,N,j=s in _.props?_.props[s]:(k=_.type.defaultProps)===null||k===void 0?void 0:k[s],E="hide"in _.props?_.props.hide:(N=_.type.defaultProps)===null||N===void 0?void 0:N.hide;return j===m&&!E}),"number",f),a.defaultProps.allowDataOverflow),w=M1(d,w,m,i)),oe(oe({},y),{},Pe({},m,oe(oe({axisType:i},a.defaultProps),{},{hide:!0,orientation:Mn(zoe,"".concat(i,".").concat(x%2),null),domain:w,originalDomain:S,isCategorical:v,layout:f})))}return y},{})},Koe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,o=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,f=t.children,d="".concat(a,"Id"),h=Fn(f,i),p={};return h&&h.length?p=Goe(t,{axes:h,graphicalItems:s,axisType:a,axisIdKey:d,stackGroups:o,dataStartIndex:c,dataEndIndex:u}):s&&s.length&&(p=Xoe(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:d,stackGroups:o,dataStartIndex:c,dataEndIndex:u})),p},qoe=function(t){var r=zi(t),n=ui(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:hb(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Oh(r,n)}},YN=function(t){var r=t.children,n=t.defaultShowTooltip,a=kn(r,Vl),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},Yoe=function(t){return!t||!t.length?!1:t.some(function(r){var n=hi(r&&r.type);return n&&n.indexOf("Bar")>=0})},QN=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Qoe=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,o=t.yAxisMap,c=o===void 0?{}:o,u=n.width,f=n.height,d=n.children,h=n.margin||{},p=kn(d,Vl),v=kn(d,Aa),x=Object.keys(c).reduce(function(w,_){var k=c[_],N=k.orientation;return!k.mirror&&!k.hide?oe(oe({},w),{},Pe({},N,w[N]+k.width)):w},{left:h.left||0,right:h.right||0}),y=Object.keys(s).reduce(function(w,_){var k=s[_],N=k.orientation;return!k.mirror&&!k.hide?oe(oe({},w),{},Pe({},N,Mn(w,"".concat(N))+k.height)):w},{top:h.top||0,bottom:h.bottom||0}),g=oe(oe({},y),x),b=g.bottom;p&&(g.bottom+=p.props.height||Vl.defaultProps.height),v&&r&&(g=fZ(g,a,n,r));var m=u-g.left-g.right,S=f-g.top-g.bottom;return oe(oe({brushBottom:b},g),{},{width:Math.max(m,0),height:Math.max(S,0)})},Zoe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},qb=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,o=s===void 0?["axis"]:s,c=t.axisComponents,u=t.legendContent,f=t.formatAxisMap,d=t.defaultProps,h=function(g,b){var m=b.graphicalItems,S=b.stackGroups,w=b.offset,_=b.updateId,k=b.dataStartIndex,N=b.dataEndIndex,j=g.barSize,E=g.layout,O=g.barGap,T=g.barCategoryGap,L=g.maxBarSize,X=QN(E),M=X.numericAxisName,U=X.cateAxisName,q=Yoe(m),K=[];return m.forEach(function(F,Q){var ie=$m(g.data,{graphicalItems:[F],dataStartIndex:k,dataEndIndex:N}),A=F.type.defaultProps!==void 0?oe(oe({},F.type.defaultProps),F.props):F.props,R=A.dataKey,D=A.maxBarSize,H=A["".concat(M,"Id")],J=A["".concat(U,"Id")],ue={},le=c.reduce(function(Ut,_r){var Xt=b["".concat(_r.axisType,"Map")],Dt=A["".concat(_r.axisType,"Id")];Xt&&Xt[Dt]||_r.axisType==="zAxis"||uo();var Kt=Xt[Dt];return oe(oe({},Ut),{},Pe(Pe({},_r.axisType,Kt),"".concat(_r.axisType,"Ticks"),ui(Kt)))},ue),Z=le[U],ee=le["".concat(U,"Ticks")],fe=S&&S[H]&&S[H].hasStack&&_Z(F,S[H].stackGroups),P=hi(F.type).indexOf("Bar")>=0,ke=Oh(Z,ee),be=[],Te=q&&cZ({barSize:j,stackGroups:S,totalSize:Zoe(le,U)});if(P){var Ae,he,We=$e(D)?L:D,mt=(Ae=(he=Oh(Z,ee,!0))!==null&&he!==void 0?he:We)!==null&&Ae!==void 0?Ae:0;be=uZ({barGap:O,barCategoryGap:T,bandSize:mt!==ke?mt:ke,sizeList:Te[J],maxBarSize:We}),mt!==ke&&(be=be.map(function(Ut){return oe(oe({},Ut),{},{position:oe(oe({},Ut.position),{},{offset:Ut.position.offset-mt/2})})}))}var rr=F&&F.type&&F.type.getComposedData;rr&&K.push({props:oe(oe({},rr(oe(oe({},le),{},{displayedData:ie,props:g,dataKey:R,item:F,bandSize:ke,barPosition:be,offset:w,stackedData:fe,layout:E,dataStartIndex:k,dataEndIndex:N}))),{},Pe(Pe(Pe({key:F.key||"item-".concat(Q)},M,le[M]),U,le[U]),"animationId",_)),childIndex:uL(F,g.children),item:F})}),K},p=function(g,b){var m=g.props,S=g.dataStartIndex,w=g.dataEndIndex,_=g.updateId;if(!h_({props:m}))return null;var k=m.children,N=m.layout,j=m.stackOffset,E=m.data,O=m.reverseStackOrder,T=QN(N),L=T.numericAxisName,X=T.cateAxisName,M=Fn(k,n),U=bZ(E,M,"".concat(L,"Id"),"".concat(X,"Id"),j,O),q=c.reduce(function(A,R){var D="".concat(R.axisType,"Map");return oe(oe({},A),{},Pe({},D,Koe(m,oe(oe({},R),{},{graphicalItems:M,stackGroups:R.axisType===L&&U,dataStartIndex:S,dataEndIndex:w}))))},{}),K=Qoe(oe(oe({},q),{},{props:m,graphicalItems:M}),b==null?void 0:b.legendBBox);Object.keys(q).forEach(function(A){q[A]=f(m,q[A],K,A.replace("Map",""),r)});var F=q["".concat(X,"Map")],Q=qoe(F),ie=h(m,oe(oe({},q),{},{dataStartIndex:S,dataEndIndex:w,updateId:_,graphicalItems:M,stackGroups:U,offset:K}));return oe(oe({formattedGraphicalItems:ie,graphicalItems:M,offset:K,stackGroups:U},Q),q)},v=function(y){function g(b){var m,S,w;return Coe(this,g),w=Foe(this,g,[b]),Pe(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Pe(w,"accessibilityManager",new voe),Pe(w,"handleLegendBBoxUpdate",function(_){if(_){var k=w.state,N=k.dataStartIndex,j=k.dataEndIndex,E=k.updateId;w.setState(oe({legendBBox:_},p({props:w.props,dataStartIndex:N,dataEndIndex:j,updateId:E},oe(oe({},w.state),{},{legendBBox:_}))))}}),Pe(w,"handleReceiveSyncEvent",function(_,k,N){if(w.props.syncId===_){if(N===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(k)}}),Pe(w,"handleBrushChange",function(_){var k=_.startIndex,N=_.endIndex;if(k!==w.state.dataStartIndex||N!==w.state.dataEndIndex){var j=w.state.updateId;w.setState(function(){return oe({dataStartIndex:k,dataEndIndex:N},p({props:w.props,dataStartIndex:k,dataEndIndex:N,updateId:j},w.state))}),w.triggerSyncEvent({dataStartIndex:k,dataEndIndex:N})}}),Pe(w,"handleMouseEnter",function(_){var k=w.getMouseInfo(_);if(k){var N=oe(oe({},k),{},{isTooltipActive:!0});w.setState(N),w.triggerSyncEvent(N);var j=w.props.onMouseEnter;Ie(j)&&j(N,_)}}),Pe(w,"triggeredAfterMouseMove",function(_){var k=w.getMouseInfo(_),N=k?oe(oe({},k),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(N),w.triggerSyncEvent(N);var j=w.props.onMouseMove;Ie(j)&&j(N,_)}),Pe(w,"handleItemMouseEnter",function(_){w.setState(function(){return{isTooltipActive:!0,activeItem:_,activePayload:_.tooltipPayload,activeCoordinate:_.tooltipPosition||{x:_.cx,y:_.cy}}})}),Pe(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),Pe(w,"handleMouseMove",function(_){_.persist(),w.throttleTriggeredAfterMouseMove(_)}),Pe(w,"handleMouseLeave",function(_){w.throttleTriggeredAfterMouseMove.cancel();var k={isTooltipActive:!1};w.setState(k),w.triggerSyncEvent(k);var N=w.props.onMouseLeave;Ie(N)&&N(k,_)}),Pe(w,"handleOuterEvent",function(_){var k=cL(_),N=Mn(w.props,"".concat(k));if(k&&Ie(N)){var j,E;/.*touch.*/i.test(k)?E=w.getMouseInfo(_.changedTouches[0]):E=w.getMouseInfo(_),N((j=E)!==null&&j!==void 0?j:{},_)}}),Pe(w,"handleClick",function(_){var k=w.getMouseInfo(_);if(k){var N=oe(oe({},k),{},{isTooltipActive:!0});w.setState(N),w.triggerSyncEvent(N);var j=w.props.onClick;Ie(j)&&j(N,_)}}),Pe(w,"handleMouseDown",function(_){var k=w.props.onMouseDown;if(Ie(k)){var N=w.getMouseInfo(_);k(N,_)}}),Pe(w,"handleMouseUp",function(_){var k=w.props.onMouseUp;if(Ie(k)){var N=w.getMouseInfo(_);k(N,_)}}),Pe(w,"handleTouchMove",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(_.changedTouches[0])}),Pe(w,"handleTouchStart",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.handleMouseDown(_.changedTouches[0])}),Pe(w,"handleTouchEnd",function(_){_.changedTouches!=null&&_.changedTouches.length>0&&w.handleMouseUp(_.changedTouches[0])}),Pe(w,"handleDoubleClick",function(_){var k=w.props.onDoubleClick;if(Ie(k)){var N=w.getMouseInfo(_);k(N,_)}}),Pe(w,"handleContextMenu",function(_){var k=w.props.onContextMenu;if(Ie(k)){var N=w.getMouseInfo(_);k(N,_)}}),Pe(w,"triggerSyncEvent",function(_){w.props.syncId!==void 0&&Yx.emit(Qx,w.props.syncId,_,w.eventEmitterSymbol)}),Pe(w,"applySyncEvent",function(_){var k=w.props,N=k.layout,j=k.syncMethod,E=w.state.updateId,O=_.dataStartIndex,T=_.dataEndIndex;if(_.dataStartIndex!==void 0||_.dataEndIndex!==void 0)w.setState(oe({dataStartIndex:O,dataEndIndex:T},p({props:w.props,dataStartIndex:O,dataEndIndex:T,updateId:E},w.state)));else if(_.activeTooltipIndex!==void 0){var L=_.chartX,X=_.chartY,M=_.activeTooltipIndex,U=w.state,q=U.offset,K=U.tooltipTicks;if(!q)return;if(typeof j=="function")M=j(K,_);else if(j==="value"){M=-1;for(var F=0;F<K.length;F++)if(K[F].value===_.activeLabel){M=F;break}}var Q=oe(oe({},q),{},{x:q.left,y:q.top}),ie=Math.min(L,Q.x+Q.width),A=Math.min(X,Q.y+Q.height),R=K[M]&&K[M].value,D=I1(w.state,w.props.data,M),H=K[M]?{x:N==="horizontal"?K[M].coordinate:ie,y:N==="horizontal"?A:K[M].coordinate}:FC;w.setState(oe(oe({},_),{},{activeLabel:R,activeCoordinate:H,activePayload:D,activeTooltipIndex:M}))}else w.setState(_)}),Pe(w,"renderCursor",function(_){var k,N=w.state,j=N.isTooltipActive,E=N.activeCoordinate,O=N.activePayload,T=N.offset,L=N.activeTooltipIndex,X=N.tooltipAxisBandSize,M=w.getTooltipEventType(),U=(k=_.props.active)!==null&&k!==void 0?k:j,q=w.props.layout,K=_.key||"_recharts-cursor";return Y.createElement(koe,{key:K,activeCoordinate:E,activePayload:O,activeTooltipIndex:L,chartName:r,element:_,isActive:U,layout:q,offset:T,tooltipAxisBandSize:X,tooltipEventType:M})}),Pe(w,"renderPolarAxis",function(_,k,N){var j=Mn(_,"type.axisType"),E=Mn(w.state,"".concat(j,"Map")),O=_.type.defaultProps,T=O!==void 0?oe(oe({},O),_.props):_.props,L=E&&E[T["".concat(j,"Id")]];return G.cloneElement(_,oe(oe({},L),{},{className:ze(j,L.className),key:_.key||"".concat(k,"-").concat(N),ticks:ui(L,!0)}))}),Pe(w,"renderPolarGrid",function(_){var k=_.props,N=k.radialLines,j=k.polarAngles,E=k.polarRadius,O=w.state,T=O.radiusAxisMap,L=O.angleAxisMap,X=zi(T),M=zi(L),U=M.cx,q=M.cy,K=M.innerRadius,F=M.outerRadius;return G.cloneElement(_,{polarAngles:Array.isArray(j)?j:ui(M,!0).map(function(Q){return Q.coordinate}),polarRadius:Array.isArray(E)?E:ui(X,!0).map(function(Q){return Q.coordinate}),cx:U,cy:q,innerRadius:K,outerRadius:F,key:_.key||"polar-grid",radialLines:N})}),Pe(w,"renderLegend",function(){var _=w.state.formattedGraphicalItems,k=w.props,N=k.children,j=k.width,E=k.height,O=w.props.margin||{},T=j-(O.left||0)-(O.right||0),L=f3({children:N,formattedGraphicalItems:_,legendWidth:T,legendContent:u});if(!L)return null;var X=L.item,M=XN(L,Noe);return G.cloneElement(X,oe(oe({},M),{},{chartWidth:j,chartHeight:E,margin:O,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),Pe(w,"renderTooltip",function(){var _,k=w.props,N=k.children,j=k.accessibilityLayer,E=kn(N,Wt);if(!E)return null;var O=w.state,T=O.isTooltipActive,L=O.activeCoordinate,X=O.activePayload,M=O.activeLabel,U=O.offset,q=(_=E.props.active)!==null&&_!==void 0?_:T;return G.cloneElement(E,{viewBox:oe(oe({},U),{},{x:U.left,y:U.top}),active:q,label:M,payload:q?X:[],coordinate:L,accessibilityLayer:j})}),Pe(w,"renderBrush",function(_){var k=w.props,N=k.margin,j=k.data,E=w.state,O=E.offset,T=E.dataStartIndex,L=E.dataEndIndex,X=E.updateId;return G.cloneElement(_,{key:_.key||"_recharts-brush",onChange:Y0(w.handleBrushChange,_.props.onChange),data:j,x:ve(_.props.x)?_.props.x:O.left,y:ve(_.props.y)?_.props.y:O.top+O.height+O.brushBottom-(N.bottom||0),width:ve(_.props.width)?_.props.width:O.width,startIndex:T,endIndex:L,updateId:"brush-".concat(X)})}),Pe(w,"renderReferenceElement",function(_,k,N){if(!_)return null;var j=w,E=j.clipPathId,O=w.state,T=O.xAxisMap,L=O.yAxisMap,X=O.offset,M=_.type.defaultProps||{},U=_.props,q=U.xAxisId,K=q===void 0?M.xAxisId:q,F=U.yAxisId,Q=F===void 0?M.yAxisId:F;return G.cloneElement(_,{key:_.key||"".concat(k,"-").concat(N),xAxis:T[K],yAxis:L[Q],viewBox:{x:X.left,y:X.top,width:X.width,height:X.height},clipPathId:E})}),Pe(w,"renderActivePoints",function(_){var k=_.item,N=_.activePoint,j=_.basePoint,E=_.childIndex,O=_.isRange,T=[],L=k.props.key,X=k.item.type.defaultProps!==void 0?oe(oe({},k.item.type.defaultProps),k.item.props):k.item.props,M=X.activeDot,U=X.dataKey,q=oe(oe({index:E,dataKey:U,cx:N.x,cy:N.y,r:4,fill:Lb(k.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value},Ce(M,!1)),rh(M));return T.push(g.renderActiveDot(M,q,"".concat(L,"-activePoint-").concat(E))),j?T.push(g.renderActiveDot(M,oe(oe({},q),{},{cx:j.x,cy:j.y}),"".concat(L,"-basePoint-").concat(E))):O&&T.push(null),T}),Pe(w,"renderGraphicChild",function(_,k,N){var j=w.filterFormatItem(_,k,N);if(!j)return null;var E=w.getTooltipEventType(),O=w.state,T=O.isTooltipActive,L=O.tooltipAxis,X=O.activeTooltipIndex,M=O.activeLabel,U=w.props.children,q=kn(U,Wt),K=j.props,F=K.points,Q=K.isRange,ie=K.baseLine,A=j.item.type.defaultProps!==void 0?oe(oe({},j.item.type.defaultProps),j.item.props):j.item.props,R=A.activeDot,D=A.hide,H=A.activeBar,J=A.activeShape,ue=!!(!D&&T&&q&&(R||H||J)),le={};E!=="axis"&&q&&q.props.trigger==="click"?le={onClick:Y0(w.handleItemMouseEnter,_.props.onClick)}:E!=="axis"&&(le={onMouseLeave:Y0(w.handleItemMouseLeave,_.props.onMouseLeave),onMouseEnter:Y0(w.handleItemMouseEnter,_.props.onMouseEnter)});var Z=G.cloneElement(_,oe(oe({},j.props),le));function ee(_r){return typeof L.dataKey=="function"?L.dataKey(_r.payload):null}if(ue)if(X>=0){var fe,P;if(L.dataKey&&!L.allowDuplicatedCategory){var ke=typeof L.dataKey=="function"?ee:"payload.".concat(L.dataKey.toString());fe=th(F,ke,M),P=Q&&ie&&th(ie,ke,M)}else fe=F==null?void 0:F[X],P=Q&&ie&&ie[X];if(J||H){var be=_.props.activeIndex!==void 0?_.props.activeIndex:X;return[G.cloneElement(_,oe(oe(oe({},j.props),le),{},{activeIndex:be})),null,null]}if(!$e(fe))return[Z].concat(tc(w.renderActivePoints({item:j,activePoint:fe,basePoint:P,childIndex:X,isRange:Q})))}else{var Te,Ae=(Te=w.getItemByXY(w.state.activeCoordinate))!==null&&Te!==void 0?Te:{graphicalItem:Z},he=Ae.graphicalItem,We=he.item,mt=We===void 0?_:We,rr=he.childIndex,Ut=oe(oe(oe({},j.props),le),{},{activeIndex:rr});return[G.cloneElement(mt,Ut),null,null]}return Q?[Z,null,null]:[Z,null]}),Pe(w,"renderCustomized",function(_,k,N){return G.cloneElement(_,oe(oe({key:"recharts-customized-".concat(N)},w.props),w.state))}),Pe(w,"renderMap",{CartesianGrid:{handler:td,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:td},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:td},YAxis:{handler:td},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((m=b.id)!==null&&m!==void 0?m:gc("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=fO(w.triggeredAfterMouseMove,(S=b.throttleDelay)!==null&&S!==void 0?S:1e3/60),w.state={},w}return Roe(g,y),Moe(g,[{key:"componentDidMount",value:function(){var m,S;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(m=this.props.margin.left)!==null&&m!==void 0?m:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var m=this.props,S=m.children,w=m.data,_=m.height,k=m.layout,N=kn(S,Wt);if(N){var j=N.props.defaultIndex;if(!(typeof j!="number"||j<0||j>this.state.tooltipTicks.length-1)){var E=this.state.tooltipTicks[j]&&this.state.tooltipTicks[j].value,O=I1(this.state,w,j,E),T=this.state.tooltipTicks[j].coordinate,L=(this.state.offset.top+_)/2,X=k==="horizontal",M=X?{x:T,y:L}:{y:T,x:L},U=this.state.formattedGraphicalItems.find(function(K){var F=K.item;return F.type.name==="Scatter"});U&&(M=oe(oe({},M),U.props.points[j].tooltipPosition),O=U.props.points[j].tooltipPayload);var q={activeTooltipIndex:j,isTooltipActive:!0,activeLabel:E,activePayload:O,activeCoordinate:M};this.setState(q),this.renderCursor(N),this.accessibilityManager.setIndex(j)}}}},{key:"getSnapshotBeforeUpdate",value:function(m,S){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==S.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==m.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==m.margin){var w,_;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0}})}return null}},{key:"componentDidUpdate",value:function(m){fg([kn(m.children,Wt)],[kn(this.props.children,Wt)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var m=kn(this.props.children,Wt);if(m&&typeof m.props.shared=="boolean"){var S=m.props.shared?"axis":"item";return o.indexOf(S)>=0?S:i}return i}},{key:"getMouseInfo",value:function(m){if(!this.container)return null;var S=this.container,w=S.getBoundingClientRect(),_=IX(w),k={chartX:Math.round(m.pageX-_.left),chartY:Math.round(m.pageY-_.top)},N=w.width/S.offsetWidth||1,j=this.inRange(k.chartX,k.chartY,N);if(!j)return null;var E=this.state,O=E.xAxisMap,T=E.yAxisMap,L=this.getTooltipEventType(),X=qN(this.state,this.props.data,this.props.layout,j);if(L!=="axis"&&O&&T){var M=zi(O).scale,U=zi(T).scale,q=M&&M.invert?M.invert(k.chartX):null,K=U&&U.invert?U.invert(k.chartY):null;return oe(oe({},k),{},{xValue:q,yValue:K},X)}return X?oe(oe({},k),X):null}},{key:"inRange",value:function(m,S){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,_=this.props.layout,k=m/w,N=S/w;if(_==="horizontal"||_==="vertical"){var j=this.state.offset,E=k>=j.left&&k<=j.left+j.width&&N>=j.top&&N<=j.top+j.height;return E?{x:k,y:N}:null}var O=this.state,T=O.angleAxisMap,L=O.radiusAxisMap;if(T&&L){var X=zi(T);return Sk({x:k,y:N},X)}return null}},{key:"parseEventsOfWrapper",value:function(){var m=this.props.children,S=this.getTooltipEventType(),w=kn(m,Wt),_={};w&&S==="axis"&&(w.props.trigger==="click"?_={onClick:this.handleClick}:_={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var k=rh(this.props,this.handleOuterEvent);return oe(oe({},k),_)}},{key:"addListener",value:function(){Yx.on(Qx,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Yx.removeListener(Qx,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(m,S,w){for(var _=this.state.formattedGraphicalItems,k=0,N=_.length;k<N;k++){var j=_[k];if(j.item===m||j.props.key===m.key||S===hi(j.item.type)&&w===j.childIndex)return j}return null}},{key:"renderClipPath",value:function(){var m=this.clipPathId,S=this.state.offset,w=S.left,_=S.top,k=S.height,N=S.width;return Y.createElement("defs",null,Y.createElement("clipPath",{id:m},Y.createElement("rect",{x:w,y:_,height:k,width:N})))}},{key:"getXScales",value:function(){var m=this.state.xAxisMap;return m?Object.entries(m).reduce(function(S,w){var _=GN(w,2),k=_[0],N=_[1];return oe(oe({},S),{},Pe({},k,N.scale))},{}):null}},{key:"getYScales",value:function(){var m=this.state.yAxisMap;return m?Object.entries(m).reduce(function(S,w){var _=GN(w,2),k=_[0],N=_[1];return oe(oe({},S),{},Pe({},k,N.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(m){var S;return(S=this.state.xAxisMap)===null||S===void 0||(S=S[m])===null||S===void 0?void 0:S.scale}},{key:"getYScaleByAxisId",value:function(m){var S;return(S=this.state.yAxisMap)===null||S===void 0||(S=S[m])===null||S===void 0?void 0:S.scale}},{key:"getItemByXY",value:function(m){var S=this.state,w=S.formattedGraphicalItems,_=S.activeItem;if(w&&w.length)for(var k=0,N=w.length;k<N;k++){var j=w[k],E=j.props,O=j.item,T=O.type.defaultProps!==void 0?oe(oe({},O.type.defaultProps),O.props):O.props,L=hi(O.type);if(L==="Bar"){var X=(E.data||[]).find(function(K){return _te(m,K)});if(X)return{graphicalItem:j,payload:X}}else if(L==="RadialBar"){var M=(E.data||[]).find(function(K){return Sk(m,K)});if(M)return{graphicalItem:j,payload:M}}else if(Cm(j,_)||Pm(j,_)||Tf(j,_)){var U=une({graphicalItem:j,activeTooltipItem:_,itemData:T.data}),q=T.activeIndex===void 0?U:T.activeIndex;return{graphicalItem:oe(oe({},j),{},{childIndex:q}),payload:Tf(j,_)?T.data[U]:j.props.data[U]}}}return null}},{key:"render",value:function(){var m=this;if(!h_(this))return null;var S=this.props,w=S.children,_=S.className,k=S.width,N=S.height,j=S.style,E=S.compact,O=S.title,T=S.desc,L=XN(S,joe),X=Ce(L,!1);if(E)return Y.createElement(TN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Y.createElement(hg,cl({},X,{width:k,height:N,title:O,desc:T}),this.renderClipPath(),m_(w,this.renderMap)));if(this.props.accessibilityLayer){var M,U;X.tabIndex=(M=this.props.tabIndex)!==null&&M!==void 0?M:0,X.role=(U=this.props.role)!==null&&U!==void 0?U:"application",X.onKeyDown=function(K){m.accessibilityManager.keyboardEvent(K)},X.onFocus=function(){m.accessibilityManager.focus()}}var q=this.parseEventsOfWrapper();return Y.createElement(TN,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Y.createElement("div",cl({className:ze("recharts-wrapper",_),style:oe({position:"relative",cursor:"default",width:k,height:N},j)},q,{ref:function(F){m.container=F}}),Y.createElement(hg,cl({},X,{width:k,height:N,title:O,desc:T,style:Woe}),this.renderClipPath(),m_(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(G.Component);Pe(v,"displayName",r),Pe(v,"defaultProps",oe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),Pe(v,"getDerivedStateFromProps",function(y,g){var b=y.dataKey,m=y.data,S=y.children,w=y.width,_=y.height,k=y.layout,N=y.stackOffset,j=y.margin,E=g.dataStartIndex,O=g.dataEndIndex;if(g.updateId===void 0){var T=YN(y);return oe(oe(oe({},T),{},{updateId:0},p(oe(oe({props:y},T),{},{updateId:0}),g)),{},{prevDataKey:b,prevData:m,prevWidth:w,prevHeight:_,prevLayout:k,prevStackOffset:N,prevMargin:j,prevChildren:S})}if(b!==g.prevDataKey||m!==g.prevData||w!==g.prevWidth||_!==g.prevHeight||k!==g.prevLayout||N!==g.prevStackOffset||!vl(j,g.prevMargin)){var L=YN(y),X={chartX:g.chartX,chartY:g.chartY,isTooltipActive:g.isTooltipActive},M=oe(oe({},qN(g,m,k)),{},{updateId:g.updateId+1}),U=oe(oe(oe({},L),X),M);return oe(oe(oe({},U),p(oe({props:y},U),g)),{},{prevDataKey:b,prevData:m,prevWidth:w,prevHeight:_,prevLayout:k,prevStackOffset:N,prevMargin:j,prevChildren:S})}if(!fg(S,g.prevChildren)){var q,K,F,Q,ie=kn(S,Vl),A=ie&&(q=(K=ie.props)===null||K===void 0?void 0:K.startIndex)!==null&&q!==void 0?q:E,R=ie&&(F=(Q=ie.props)===null||Q===void 0?void 0:Q.endIndex)!==null&&F!==void 0?F:O,D=A!==E||R!==O,H=!$e(m),J=H&&!D?g.updateId:g.updateId+1;return oe(oe({updateId:J},p(oe(oe({props:y},g),{},{updateId:J,dataStartIndex:A,dataEndIndex:R}),g)),{},{prevChildren:S,dataStartIndex:A,dataEndIndex:R})}return null}),Pe(v,"renderActiveDot",function(y,g,b){var m;return G.isValidElement(y)?m=G.cloneElement(y,g):Ie(y)?m=y(g):m=Y.createElement(jm,g),Y.createElement(Je,{className:"recharts-active-dot",key:b},m)});var x=G.forwardRef(function(g,b){return Y.createElement(v,cl({},g,{ref:b}))});return x.displayName=v.displayName,x},IC=qb({chartName:"LineChart",GraphicalChild:jc,axisComponents:[{axisType:"xAxis",AxisComp:vn},{axisType:"yAxis",AxisComp:gn}],formatAxisMap:eC}),Ec=qb({chartName:"BarChart",GraphicalChild:da,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:vn},{axisType:"yAxis",AxisComp:gn}],formatAxisMap:eC}),Lm=qb({chartName:"PieChart",GraphicalChild:fa,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Om},{axisType:"radiusAxis",AxisComp:Tm}],formatAxisMap:PZ,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Yb=({data:e,groups:t,unit:r,height:n="100%",showLegend:a=!0,layout:i="vertical",barSize:s=40,maxCategories:o=6,showLabels:c=!0})=>{const{chartData:u,activeGroups:f}=G.useMemo(()=>{let h=t;if(t.length>o){const v=t.slice(0,o-1),x={id:"_other",name:"Other",color:"#94a3b8",items:[]};h=[...v,x]}return{chartData:e.map(v=>{const x={...v,_total:0};let y=0;if(t.forEach(g=>{v[g.id]&&(y+=v[g.id])}),t.length>o){t.slice(0,o-1);const g=t.slice(o-1);let b=0;g.forEach(m=>{x[m.id]!==void 0&&(b+=x[m.id],delete x[m.id])}),x._other=b}return x._total=y,x}),activeGroups:h}},[e,t,o]),d=h=>{const{x:p,y:v,width:x,height:y,value:g,payload:b}=h,m=b&&typeof b._total=="number"?b._total:0,S=m>0?g/m:0;if(S<.05)return null;const w=i==="vertical",_=20;return w&&x<_||!w&&y<_?null:l.jsx("text",{x:p+x/2,y:v+y/2,fill:"#fff",textAnchor:"middle",dominantBaseline:"middle",fontSize:10,fontWeight:"bold",style:{pointerEvents:"none",textShadow:"0px 0px 3px rgba(0,0,0,0.6)"},children:`${(S*100).toFixed(0)}%`})};return l.jsx(sa,{width:"100%",height:n,children:l.jsxs(Ec,{data:u,layout:i,barSize:s,margin:{top:20,right:30,left:20,bottom:5},children:[i==="vertical"?l.jsxs(l.Fragment,{children:[l.jsx(vn,{type:"number",hide:!0}),l.jsx(gn,{type:"category",dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"},width:100})]}):l.jsxs(l.Fragment,{children:[l.jsx(vn,{dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"}}),l.jsx(gn,{type:"number",hide:!0})]}),l.jsx(Wt,{cursor:{fill:"transparent"},content:({active:h,payload:p})=>{if(h&&p&&p.length&&p[0].payload){const v=p[0].payload._total||0;return l.jsxs("div",{className:"bg-white p-3 border border-slate-200 rounded-lg shadow-xl text-xs z-50",children:[l.jsxs("div",{className:"font-bold text-slate-800 mb-2 border-b border-slate-100 pb-1",children:[p[0].payload.name," Total: ",Math.round(v).toLocaleString()," ",r]}),p.map((x,y)=>l.jsxs("div",{className:"flex justify-between items-center gap-4 mb-1",children:[l.jsxs("span",{style:{color:x.color},className:"font-semibold",children:[x.name,":"]}),l.jsxs("span",{className:"text-slate-600 font-mono",children:[Math.round(x.value).toLocaleString()," (",v>0?(x.value/v*100).toFixed(1):0,"%)"]})]},y))]})}return null}}),a&&l.jsx(Aa,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}}),f.map(h=>l.jsx(da,{dataKey:h.id,name:h.name,stackId:"a",fill:h.color,radius:[0,0,0,0],children:c&&l.jsx(ta,{dataKey:h.id,content:d})},h.id))]})})},Joe=[{id:"work_open",label:"Fixed Workstations"},{id:"work_enclosed",label:"Enclosed Offices (Private)"},{id:"work_alt",label:"Alternative Workpoints"},{id:"meet",label:"Meeting Rooms (Enclosed)"},{id:"phone",label:"Phone Booths"},{id:"circ",label:"Circulation"}],ZN=["#6366f1","#ec4899","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#64748b"],ele=({groups:e,supportSpaces:t,onSave:r,onClose:n})=>{const[a,i]=G.useState(JSON.parse(JSON.stringify(e))),s=[...Joe,...t.map(p=>({id:p.id,label:p.name}))],o=()=>{const p=`g-${Date.now()}`,v=ZN[a.length%ZN.length];i([...a,{id:p,name:"New Category",color:v,items:[]}])},c=p=>{if(a.length<=1)return;const v=a.find(g=>g.id===p),x=a.find(g=>g.id!==p);if(!x)return;const y=a.filter(g=>g.id!==p).map(g=>g.id===x.id?{...g,items:[...g.items,...(v==null?void 0:v.items)||[]]}:g);i(y)},u=(p,v)=>{const x=a.map(y=>({...y,items:y.id===v?[...y.items,p]:y.items.filter(g=>g!==p)}));i(x)},f=(p,v)=>{i(a.map(x=>x.id===p?{...x,color:v}:x))},d=(p,v)=>{i(a.map(x=>x.id===p?{...x,name:v}:x))},h=a.length>6;return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/30 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[85vh]",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Configure Program Structure"}),l.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Define how space types are categorized for visual analysis and reporting."})]}),l.jsx("button",{onClick:n,children:l.jsx(xn,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[h&&l.jsxs("div",{className:"mb-6 flex items-start gap-3 bg-amber-50 border border-amber-200 p-3 rounded-lg text-sm text-amber-800",children:[l.jsx(Or,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold",children:"Recommendation:"})," You have defined ",a.length,' categories. For optimal clarity in client presentations, we recommend sticking to 4-6 distinct program categories. Excess categories will be automatically collapsed into "Other" in some summary charts.']})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(p=>l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b border-slate-100 pb-3",children:[l.jsx("input",{type:"color",value:p.color,onChange:v=>f(p.id,v.target.value),className:"w-6 h-6 rounded cursor-pointer border-0 p-0 overflow-hidden"}),l.jsx("input",{type:"text",value:p.name,onChange:v=>d(p.id,v.target.value),className:"font-bold text-sm bg-transparent border-b border-transparent focus:border-indigo-500 outline-none text-slate-800 flex-grow",placeholder:"Category Name"}),a.length>1&&l.jsx("button",{onClick:()=>c(p.id),className:"text-slate-300 hover:text-rose-500 transition-colors",title:"Delete Category (Items will be moved)",children:l.jsx(ms,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"space-y-2",children:p.items.length===0?l.jsx("div",{className:"text-xs text-slate-400 italic py-4 text-center border-2 border-dashed border-slate-100 rounded",children:"No items assigned"}):p.items.map(v=>{const x=s.find(y=>y.id===v);return l.jsxs("div",{className:"relative group flex items-center bg-slate-50 border border-slate-200 rounded px-3 py-2 text-xs hover:border-indigo-300 transition-colors",children:[l.jsx("span",{className:"mr-2 text-slate-700 font-medium truncate flex-grow",title:x==null?void 0:x.label,children:(x==null?void 0:x.label)||v}),l.jsxs("div",{className:"relative",children:[l.jsx(Ga,{className:"w-3 h-3 text-slate-300 group-hover:text-indigo-600"}),l.jsx("select",{className:"absolute right-0 top-0 w-6 h-6 opacity-0 cursor-pointer",value:p.id,onChange:y=>u(v,y.target.value),children:a.map(y=>l.jsxs("option",{value:y.id,children:["Move to ",y.name]},y.id))})]})]},v)})})]},p.id)),l.jsxs("button",{onClick:o,className:"flex flex-col items-center justify-center gap-2 p-6 rounded-xl border-2 border-dashed border-slate-300 text-slate-400 hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all min-h-[200px]",children:[l.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:l.jsx(Ya,{className:"w-6 h-6"})}),l.jsx("span",{className:"text-sm font-bold",children:"Add Category"})]})]})]}),l.jsxs("div",{className:"p-5 border-t border-slate-200 flex justify-between items-center bg-white",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[l.jsx("strong",{children:"Integrity Check:"})," All space types must belong to exactly one category."]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:n,className:"px-5 py-2.5 text-sm font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),l.jsx("button",{onClick:()=>r(a),className:"px-6 py-2.5 bg-indigo-600 text-white text-sm font-bold rounded-lg hover:bg-indigo-700 shadow-md transition-all transform hover:scale-105",children:"Apply Configuration"})]})]})]})})},RC=({metrics:e,project:t,strategy:r,mode:n="default",onUpdateProject:a})=>{const[i,s]=G.useState(n==="review"?"visual":"summary"),[o,c]=G.useState("qty"),[u,f]=G.useState(!1),[d,h]=G.useState(!1),[p,v]=G.useState(!1),[x,y]=G.useState(t.programStructure||t0(t.projectType));G.useEffect(()=>{t.programStructure&&y(t.programStructure)},[t.programStructure]);const g=E=>{y(E),a&&a({...t,programStructure:E}),v(!1)},b=t.unit.toUpperCase(),m=t.floors,S=()=>{const E=["Space Type",...m.map(L=>L.name),"Total"].join("	"),O=[["Headcount",...e.floorMetrics.map(L=>L.headcount),e.totalHeadcountWithGrowth],["Total Seats",...e.floorMetrics.map(L=>L.totalDesks),e.requiredDesks],["Used Area",...e.floorMetrics.map(L=>Math.round(L.areaUsed)),Math.round(e.totalUsedArea)]],T=[E,...O.map(L=>L.join("	"))].join(`
`);navigator.clipboard.writeText(T),f(!0),setTimeout(()=>f(!1),2e3)},w=()=>h(!d),_=G.useMemo(()=>{const E=e0(t.unit);return m.map(O=>{const T=e.floorMetrics.find(X=>X.floorId===O.id);if(!T)return{name:O.name};const L={name:O.name};return x.forEach(X=>{let M=0;X.items.forEach(U=>{if(U==="work_open")M+=T.openDesks*E.deskOpen;else if(U==="work_enclosed")M+=T.enclosedOffices*E.deskEnclosed;else if(U==="work_alt")M+=T.altDesks*E.deskAlt;else if(U==="meet")M+=T.areaMeeting;else if(U==="phone")M+=T.areaPhone;else if(U==="circ")M+=T.areaCirculation;else{const q=r.supportSpaces.find(K=>K.id===U);if(q){const K=T.supportSummary.find(F=>F.name===q.name);K&&(M+=K.area)}}}),L[X.id]=M}),L})},[e,t,x,r]),k=d?"fixed inset-0 z-50 bg-white flex flex-col":"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full",N=({val:E,isTotal:O=!1,type:T="number"})=>l.jsx("td",{className:`px-4 py-3 text-right text-xs whitespace-nowrap ${O?"font-bold bg-indigo-50 text-indigo-900 border-l border-slate-200 sticky right-0 z-10":"text-slate-600 border-b border-slate-50"}`,children:T==="area"?Math.round(E).toLocaleString():T==="percent"?`${E.toFixed(0)}%`:E.toLocaleString()}),j=({label:E,isGroup:O=!1})=>l.jsx("td",{className:`sticky left-0 bg-white z-10 px-4 py-3 text-xs border-r border-slate-100 ${O?"font-bold text-slate-800 bg-slate-50 uppercase tracking-wide":"font-medium text-slate-600"}`,children:E});return l.jsxs("div",{className:k,children:[l.jsxs("div",{className:"p-3 border-b border-slate-200 bg-slate-50 flex justify-between items-center flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(ia,{className:"w-4 h-4 text-indigo-600"}),d?"Stacking Plan (Full Screen)":"Stacking Plan"]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4 bg-white border border-slate-200 rounded-lg p-0.5",children:[l.jsxs("button",{onClick:()=>s("summary"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="summary"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(LT,{className:"w-3 h-3"})," Summary"]}),l.jsxs("button",{onClick:()=>s("matrix"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="matrix"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx($p,{className:"w-3 h-3"})," Matrix"]}),l.jsxs("button",{onClick:()=>s("visual"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="visual"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Ip,{className:"w-3 h-3"})," Program Mix"]})]}),i==="visual"&&l.jsx(l.Fragment,{children:l.jsxs("button",{onClick:()=>v(!0),className:"ml-2 flex items-center gap-1 px-3 py-1.5 text-xs font-bold text-slate-600 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition border border-transparent hover:border-slate-200",children:[l.jsx(Hp,{className:"w-3 h-3"})," Structure"]})}),i==="matrix"&&l.jsxs("div",{className:"flex bg-white border border-slate-200 rounded-lg p-0.5 ml-2",children:[l.jsx("button",{onClick:()=>c("qty"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="qty"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Qty"}),l.jsx("button",{onClick:()=>c("area"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="area"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Area"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:S,className:"flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-300 rounded-lg text-xs font-bold text-slate-700 hover:bg-slate-50 transition",children:[u?l.jsx(uc,{className:"w-3 h-3 text-emerald-600"}):l.jsx(Lp,{className:"w-3 h-3"}),u?"Copied":"Export"]}),l.jsx("button",{onClick:w,className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition",title:d?"Exit Full Screen":"Expand to Full Screen",children:d?l.jsx(WT,{className:"w-4 h-4"}):l.jsx(UT,{className:"w-4 h-4"})}),d&&l.jsx("button",{onClick:w,className:"ml-2 p-1 text-slate-400 hover:text-slate-700",children:l.jsx(xn,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:`flex-grow overflow-auto relative custom-scrollbar ${d?"p-6 bg-slate-100":""}`,children:i==="visual"?l.jsx("div",{className:`h-full flex flex-col ${d?"bg-white shadow-sm rounded-lg p-6":"p-4"}`,children:l.jsx("div",{className:"flex-grow w-full min-h-[300px]",children:l.jsx(Yb,{data:_,groups:x,unit:b,layout:"vertical",showLabels:!0})})}):l.jsx("div",{className:d?"bg-white shadow-sm rounded-lg overflow-hidden":"",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{className:"sticky top-0 bg-white z-20 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"sticky left-0 z-30 bg-white border-b border-slate-200 px-4 py-3 text-xs font-bold text-slate-500 uppercase tracking-wider min-w-[160px] border-r border-slate-100",children:"Space Type"}),m.map(E=>l.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200 bg-slate-50 min-w-[100px]",children:E.name},E.id)),l.jsx("th",{className:"sticky right-0 z-30 bg-indigo-50 border-b border-l border-slate-200 px-4 py-3 text-right text-xs font-bold text-indigo-800 uppercase tracking-wider min-w-[100px]",children:"Total"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i==="summary"?l.jsxs(l.Fragment,{children:[l.jsxs("tr",{children:[l.jsx(j,{label:"Headcount (Capacity)",isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.headcount},E.floorId)),l.jsx(N,{val:e.totalHeadcountWithGrowth,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Workpoints (Seats)"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.totalDesks},E.floorId)),l.jsx(N,{val:e.requiredDesks,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting Rooms"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.meetingRoomsTotal},E.floorId)),l.jsx(N,{val:e.totalMeetingRooms,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:`Total Area (${b})`,isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.areaUsed,type:"area"},E.floorId)),l.jsx(N,{val:e.totalUsedArea,isTotal:!0,type:"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Space Utilization Index"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.utilization,type:"percent"},E.floorId)),l.jsx(N,{val:e.fitFactor,isTotal:!0,type:"percent"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"WORKSTATIONS",isGroup:!0}),l.jsx("td",{colSpan:m.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Enclosed Offices"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.enclosedOffices:E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.enclosedOffices:e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Fixed Workstations"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.openDesks:E.areaWorkstations-E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.openDesks:e.areaWorkstations-e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Alternative Workpoints"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.altDesks:E.altDesks*3,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.altDesks:e.altDesks*3,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"MEETING ROOMS",isGroup:!0}),l.jsx("td",{colSpan:m.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.meetingRoomsTotal:E.areaMeeting,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.totalMeetingRooms:e.areaMeeting,isTotal:!0,type:o==="qty"?"number":"area"})]})]})})]})})}),p&&l.jsx(ele,{groups:x,supportSpaces:r.supportSpaces,onSave:g,onClose:()=>v(!1)})]})},tle=({metrics:e,strategy:t,project:r})=>{var f;const n=r.programStructure||t0(r.projectType),a=e0(r.unit),i=G.useMemo(()=>n.map(d=>{let h=0;return e.floorMetrics.forEach(p=>{d.items.forEach(v=>{if(v==="work_open")h+=p.openDesks*a.deskOpen;else if(v==="work_enclosed")h+=p.enclosedOffices*a.deskEnclosed;else if(v==="work_alt")h+=p.altDesks*a.deskAlt;else if(v==="meet")h+=p.areaMeeting;else if(v==="phone")h+=p.areaPhone;else if(v==="circ")h+=p.areaCirculation;else{const x=t.supportSpaces.find(y=>y.id===v);if(x){const y=p.supportSummary.find(g=>g.name===x.name);y&&(h+=y.area)}}})}),{name:d.name,value:h,color:d.color}}).filter(d=>d.value>0),[e,n,t,a]),s=r.unit.toUpperCase(),o=e.fitFactor>100?"text-rose-600":"text-emerald-600",c=({cx:d,cy:h,midAngle:p,innerRadius:v,outerRadius:x,percent:y})=>{if(y<.05)return null;const g=Math.PI/180,b=v+(x-v)*.5,m=d+b*Math.cos(-p*g),S=h+b*Math.sin(-p*g);return l.jsx("text",{x:m,y:S,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:"bold",style:{textShadow:"0px 0px 3px rgba(0,0,0,0.5)",pointerEvents:"none"},children:`${(y*100).toFixed(0)}%`})},u=d=>{const h=i.find(p=>p.name===d);return h?Math.round(h.value).toLocaleString():"0"};return l.jsxs("div",{className:"h-full flex flex-col gap-6",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-shrink-0",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Capacity"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.totalHeadcountWithGrowth}),l.jsx("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:"Total People (w/ Growth)"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(In,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Workpoints"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.requiredDesks}),l.jsxs("div",{className:"text-xs text-slate-400 flex gap-2 mt-1 font-medium",children:[l.jsxs("span",{children:[e.openDesks," Open"]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:[e.enclosedOffices," Enc"]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Meeting Rms"})]}),l.jsxs("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:[e.totalMeetingRooms," ",l.jsx("span",{className:"text-lg font-normal text-slate-400",children:"rms"})]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:["Ratio 1 : ",e.derivedMeetingRatio.toFixed(1)]})]}),l.jsxs("div",{className:`bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-shadow ${e.fitFactor>100?"border-l-4 border-l-rose-500":"border-l-4 border-l-emerald-500"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(zp,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Space Utilization Index"})]}),l.jsxs("div",{className:`text-3xl font-bold tracking-tight ${o}`,children:[e.fitFactor.toFixed(0),"%"]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:[Math.round(e.totalUsedArea).toLocaleString()," / ",Math.round(r.calculatedNia).toLocaleString()," ",s]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 flex-grow min-h-0",children:[l.jsxs("div",{className:"flex flex-col gap-6 min-h-0",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-64 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-white flex justify-between items-center rounded-t-xl",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Strategic Metrics Overview"}),l.jsxs("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-0.5 rounded",children:[e.density.toFixed(1)," ",s,"/p"]})]}),l.jsx("div",{className:"flex-grow p-2",children:l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Lm,{children:[l.jsx(fa,{data:i,innerRadius:60,outerRadius:80,paddingAngle:2,dataKey:"value",label:c,labelLine:!1,children:i.map((d,h)=>l.jsx(Oi,{fill:d.color,stroke:"none"},`cell-${h}`))}),l.jsx(Wt,{formatter:d=>[`${Math.round(d).toLocaleString()} ${s}`,"Area"],contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),l.jsx(Aa,{iconType:"circle",layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col flex-grow overflow-hidden",children:[l.jsx("div",{className:"p-4 border-b border-slate-100 bg-white rounded-t-xl",children:l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Program Budget"})}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Workstations"}),l.jsx("span",{children:u("Workstations")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Open (",e.openDesks,")"]})," ",l.jsx("span",{children:"Fixed Points"})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Enclosed (",e.enclosedOffices,")"]})," ",l.jsx("span",{children:"Fixed Points"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Meeting Rooms"}),l.jsx("span",{children:u("Meeting Rooms")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Rooms"})," ",l.jsx("span",{children:e.totalMeetingRooms})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Ratio"})," ",l.jsxs("span",{children:["1:",e.derivedMeetingRatio.toFixed(0)]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Collaboration"}),l.jsx("span",{children:u("Collaboration")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Open Zones"})," ",l.jsx("span",{className:"text-[10px] text-slate-400",children:"Calculated"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Support"}),l.jsx("span",{children:u("Support")})]}),(f=e.floorMetrics[0])==null?void 0:f.supportSummary.filter(d=>d.name!=="Open Collaboration").map((d,h)=>l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:d.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"Included"})]},h))]})]})]})]}),l.jsx("div",{className:"min-h-0 h-full",children:l.jsx(RC,{metrics:e,project:r,strategy:t})})]})]})},rle=({scenarios:e,activeId:t,project:r,metrics:n,onActivate:a,onAdd:i,onDuplicate:s,onDelete:o,onRename:c,compareId:u,onCompare:f,compareMetrics:d,onGoToDecision:h})=>{const p=e.find(b=>b.id===t),v=e.find(b=>b.id===u),x=({label:b,v1:m,v2:S,unit:w="",inverse:_=!1})=>{const k=m-S,N=k===0,j=k>0,E=N?"text-slate-300":j?"text-blue-600":"text-orange-600",O=j?"+":"";return l.jsxs("div",{className:"flex justify-between items-center text-xs py-1 border-b border-slate-50 last:border-0",children:[l.jsx("span",{className:"text-slate-500",children:b}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-bold text-slate-800",children:m.toLocaleString()}),!N&&l.jsxs("span",{className:`font-mono text-[10px] ${E}`,children:[O,k.toLocaleString()]})]})]})},g=d?((b,m)=>{const S=b.requiredDesks-m.requiredDesks,w=b.totalUsedArea-m.totalUsedArea,_=b.density-m.density;let k="";S>0?k=`Increases capacity by ${S} workpoints (+${(S/m.requiredDesks*100).toFixed(0)}%).`:S<0?k=`Reduces capacity by ${Math.abs(S)} workpoints.`:k="Maintains equivalent workpoint capacity.";let N="";w>0?N=`Requires ${Math.round(w)} ${r.unit} additional area, putting pressure on the spatial budget.`:w<0?N=`Recovers ${Math.round(Math.abs(w))} ${r.unit} of area, improving spatial efficiency.`:N="Neutral impact on overall area consumption.";let j="";return _<-1?j="Consider: Does the higher density impact acoustic comfort?":_>1?j="Consider: Is the generous density essential for experience targets?":j="Consider: Trade-off lies primarily in operational style rather than space.",{varianceText:k,impactText:N,decisionText:j}})(n,d):null;return l.jsxs("div",{className:"bg-white border-l border-slate-200 h-full flex flex-col w-80",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:"Scenarios"}),l.jsxs("button",{onClick:i,className:"text-xs flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-bold",children:[l.jsx(Ya,{className:"w-3 h-3"})," New"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(b=>l.jsx("div",{onClick:()=>a(b.id),className:`group p-2 rounded-lg border cursor-pointer transition-all ${t===b.id?"bg-white border-indigo-500 shadow-sm ring-1 ring-indigo-500":"bg-white border-slate-200 hover:border-indigo-300"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[t===b.id?l.jsx("input",{value:b.name,onChange:m=>c(b.id,m.target.value),className:"text-sm font-bold text-indigo-700 bg-transparent outline-none w-full",onClick:m=>m.stopPropagation()}):l.jsx("span",{className:"text-sm font-medium text-slate-600 group-hover:text-indigo-600",children:b.name}),t===b.id&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:m=>{m.stopPropagation(),s()},className:"p-1 text-slate-400 hover:text-indigo-600",title:"Duplicate",children:l.jsx(Lp,{className:"w-3 h-3"})}),e.length>1&&l.jsx("button",{onClick:m=>{m.stopPropagation(),o(b.id)},className:"p-1 text-slate-400 hover:text-rose-500",title:"Delete",children:l.jsx(ms,{className:"w-3 h-3"})})]})]})},b.id))}),l.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:l.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-lg text-xs font-bold transition-colors border border-indigo-200",children:[l.jsx(ps,{className:"w-4 h-4"})," Compare & Decide"]})})]}),l.jsxs("div",{className:"p-4 border-b border-slate-200",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-2 block flex items-center gap-2",children:[l.jsx(Ga,{className:"w-3 h-3"})," Quick Comparison"]}),l.jsxs("select",{className:"w-full text-sm p-2 border border-slate-200 rounded-md bg-slate-50 focus:outline-none",value:u||"",onChange:b=>f(b.target.value||null),children:[l.jsx("option",{value:"",children:"None (Single View)"}),e.filter(b=>b.id!==t).map(b=>l.jsx("option",{value:b.id,children:b.name},b.id))]})]}),d&&v&&g?l.jsxs("div",{className:"flex-grow overflow-y-auto p-4 bg-slate-50",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-600 truncate max-w-[100px]",children:p==null?void 0:p.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"vs"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 truncate max-w-[100px]",children:v.name})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Seating"}),l.jsx(x,{label:"Open Seats",v1:n.openDesks,v2:d.openDesks}),l.jsx(x,{label:"Alt Seats",v1:n.altDesks,v2:d.altDesks}),l.jsx(x,{label:"Total",v1:n.requiredDesks,v2:d.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Spaces"}),l.jsx(x,{label:"Meeting Rms",v1:n.totalMeetingRooms,v2:d.totalMeetingRooms}),l.jsx(x,{label:"Phone Booths",v1:n.totalPhoneBooths,v2:d.totalPhoneBooths})]}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:["Area (",r.unit,")"]}),l.jsx(x,{label:"Used Area",v1:Math.round(n.totalUsedArea),v2:Math.round(d.totalUsedArea)}),l.jsxs("div",{className:"flex justify-between items-center text-xs py-1",children:[l.jsx("span",{className:"text-slate-500",children:"Utilization Index"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:`font-bold ${n.fitFactor>100?"text-rose-600":"text-emerald-600"}`,children:[n.fitFactor.toFixed(0),"%"]}),l.jsx("span",{className:"text-slate-300",children:"/"}),l.jsxs("span",{className:"text-slate-400",children:[d.fitFactor.toFixed(0),"%"]})]})]})]})]}),l.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-100 rounded-lg text-xs text-blue-800",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(fc,{className:"w-4 h-4 mt-0.5 text-blue-600"}),l.jsx("span",{className:"font-bold uppercase text-[10px] text-blue-500 mt-0.5",children:"Analysis"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Variance"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:g.varianceText})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Strategic Impact"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:g.impactText})]}),l.jsx("div",{className:"pt-2 border-t border-blue-100 mt-1",children:l.jsx("span",{className:"leading-tight block text-blue-700 italic",children:g.decisionText})})]})]})]}):l.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-slate-400 p-8 text-center",children:[l.jsx(Ga,{className:"w-8 h-8 mb-2 opacity-20"}),l.jsx("p",{className:"text-xs",children:"Select a scenario above to compare metrics."})]})]})},Jc={s:4,m:8,l:14,b:20,t:40},eu={s:10,m:18,l:25,b:40,t:80},R1=(e,t)=>{var K,F,Q,ie;const r=e0(e.unit),n=e.calculatedNia;let a=0,i=0,s=0,o=0,c=0,u=0,f=0,d=0,h=0,p=0,v=0,x=0,y=0,g=0;const b={small:0,medium:0,large:0,board:0,townhall:0},m=[],S=e.floors.reduce((A,R)=>A+R.headcount,0)||e.headcount,w=((K=t.workpoints)==null?void 0:K.fixed)||0,_=((F=t.workpoints)==null?void 0:F.alternative)||0,k=t.enclosedOfficeCount||0,N=Math.max(0,w-k);e.floors.forEach(A=>{const R=Math.ceil(A.headcount*(1+t.growthBuffer/100));a+=R;const D=S>0?A.headcount/S:0,H=Math.round(k*D),J=Math.round(N*D),ue=Math.round(_*D),le=H+J+ue;c+=H,s+=J,o+=ue,i+=le;const Z=t.meetingRatios.small>0?Math.ceil(R/t.meetingRatios.small):0,ee=t.meetingRatios.medium>0?Math.ceil(R/t.meetingRatios.medium):0,fe=t.meetingRatios.large>0?Math.ceil(R/t.meetingRatios.large):0,P=t.meetingRatios.board>0?Math.ceil(R/t.meetingRatios.board):0,ke=t.meetingRatios.townhall>0?Math.ceil(R/t.meetingRatios.townhall):0,be=Z+ee+fe+P+ke,Te=Z*Jc.s+ee*Jc.m+fe*Jc.l+P*Jc.b+ke*Jc.t;u+=be,f+=Te,b.small+=Z,b.medium+=ee,b.large+=fe,b.board+=P,b.townhall+=ke;const Ae=Math.max(1,t.phoneBoothRatio),he=Math.ceil(R/Ae);d+=he;let We=0;const mt=[];t.supportSpaces.forEach(He=>{let Ke=0,Et=0;if(He.logic==="ratio")Ke=Math.ceil(R/Math.max(1,He.value)),Et=Ke*(He.areaPerUnit||0);else if(He.logic==="fixed_count"){const Ss=He.value*D;Et=Ss*(He.areaPerUnit||0),Ke=Ss}else He.logic==="area_per_person"?(Et=R*He.value,Ke=0):He.logic==="pct_nia"?(Et=n*D*(He.value/100),Ke=0):He.logic==="fixed_area"&&(Et=He.value*D,Ke=0);We+=Et,mt.push({name:He.name,count:Ke,area:Et})});const rr=H*r.deskEnclosed,Ut=J*r.deskOpen,_r=ue*r.deskAlt,Xt=rr+Ut+_r;let Dt=Z*eu.s+ee*eu.m+fe*eu.l+P*eu.b+ke*eu.t;const Kt=e.unit==="sqft"?Dt*10.76:Dt,Cr=he*r.phoneBooth,pa=Xt+Kt+Cr+We,jt=pa*(t.circulationPct/100),dr=pa+jt,Re=n*D,xt=Re>0?dr/Re*100:0;h+=Xt,p+=Kt,v+=Cr,x+=We,y+=jt,g+=dr,m.push({floorId:A.id,name:A.name,headcount:R,enclosedOffices:H,openDesks:J,altDesks:ue,totalDesks:le,meetingRoomsTotal:be,roomsSmall:Z,roomsMedium:ee,roomsLarge:fe,roomsBoard:P,roomsTownhall:ke,phoneBooths:he,supportSummary:mt,areaUsed:dr,areaWorkstations:Xt,areaMeeting:Kt,areaPhone:Cr,areaSupport:We,areaCirculation:jt,utilization:xt})});const j=e.departments,E=j.length,O=[],T={};j.forEach(A=>{T[A.id]={},A.collaborators.forEach(R=>{R.deptId&&(T[A.id][R.deptId]=R.strength)})});let L=0,X=0;for(let A=0;A<E;A++)for(let R=A+1;R<E;R++){const D=j[A],H=j[R],J=((Q=T[D.id])==null?void 0:Q[H.id])||0,ue=((ie=T[H.id])==null?void 0:ie[D.id])||0,le=J+ue;if(le>0){const Z=D.pinnedFloor,ee=H.pinnedFloor;let fe=0;!Z&&!ee||Z===ee?fe=1:fe=0;const P=1-fe,ke=le/2,be=ke*P;L+=ke,X+=be;let Te="Low";le>=160?Te="Critical":le>=100?Te="High":le>=50&&(Te="Medium"),O.push({dept1:D,dept2:H,score:le,strengthLabel:Te,isCrossFloor:P===1,asymmetry:Math.abs(J-ue),friction:be,overlap:fe})}}const M=L>0?X/L*100:0,U=u>0?a/u:0,q=i>0?a/i:0;return{totalHeadcountWithGrowth:a,totalOpenPlanPeople:a-c,requiredDesks:i,openDesks:s,altDesks:o,enclosedOffices:c,totalMeetingRooms:u,totalMeetingSeats:f,totalPhoneBooths:d,derivedMeetingRatio:U,effectiveDeskRatio:q,areaWorkstations:h,areaMeeting:p,areaPhone:v,areaSupport:x,areaCirculation:y,totalUsedArea:g,remainingArea:n-g,density:a>0?n/a:0,occupancyRatio:i>0?n/i:0,fitFactor:g/n*100,roomMix:b,floorMetrics:m,adjacencyStats:{stressScore:M,topFrictionPairs:O.filter(A=>A.friction>0).sort((A,R)=>R.friction-A.friction),allPairs:O.sort((A,R)=>R.score-A.score),matrix:T}}},nle=(e,t=!1)=>{const r=Math.min(...e),n=Math.max(...e);if(r===0&&n===0)return null;if(r===n)return l.jsx("span",{className:"text-[10px] text-slate-400 font-medium px-2",children:"No Variance"});const a=n-r,i=r===0?100:a/r*100;return l.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${i>15?"text-amber-600 bg-amber-50 border-amber-100":"text-slate-600 bg-slate-100 border-slate-200"}`,children:[i>100?">100%":`${i.toFixed(0)}%`," "]})},ale=e=>{const t={};return e.floorMetrics.forEach(r=>{r.supportSummary.forEach(n=>{t[n.name]||(t[n.name]={count:0,area:0}),t[n.name].count+=n.count,t[n.name].area+=n.area})}),t},Ts=({title:e,icon:t,isOpen:r,onToggle:n,children:a,deltaValues:i})=>l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-4 ${r?"bg-slate-50 border-b border-slate-100":"bg-white hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`p-1.5 rounded-lg ${r?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}`,children:l.jsx(t,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide",children:e})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[!r&&i&&nle(i),r?l.jsx(pn,{className:"w-4 h-4 text-slate-400"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400"})]})]}),r&&l.jsx("div",{className:"p-5 animate-in slide-in-from-top-2 duration-200",children:a})]}),Jx=({scenarios:e,rows:t})=>l.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-3 pl-4 text-xs font-bold text-slate-400 uppercase w-1/3",children:"Metric / Driver"}),e.map(r=>l.jsx("th",{className:"text-right py-3 px-4 text-xs font-bold text-indigo-800 uppercase w-32",children:r.name},r.id))]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:t.map((r,n)=>l.jsxs("tr",{className:`hover:bg-slate-50/80 ${r.highlight?"bg-indigo-50/30":""}`,children:[l.jsxs("td",{className:"py-3 pl-4",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700",children:r.label}),r.subLabel&&l.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:r.subLabel})]}),r.values.map((a,i)=>l.jsx("td",{className:"py-3 px-4 text-right text-sm font-medium text-slate-700",children:a},i))]},n))})]})}),ile=({scenario:e,metrics:t,project:r,isActive:n,onSelect:a,onDeepDive:i})=>{const s=t.fitFactor<=100,o=r.unit.toUpperCase();return l.jsxs("div",{className:`relative flex flex-col p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md h-full ${n?"bg-white border-indigo-600 shadow-lg z-10":"bg-white border-slate-200 hover:border-indigo-300"}`,onClick:a,children:[n&&l.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:"Selected Direction"}),l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsx("h3",{className:`text-base font-bold truncate ${n?"text-indigo-800":"text-slate-700"}`,title:e.name,children:e.name}),l.jsx("div",{className:`flex-shrink-0 flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${s?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:s?l.jsx(qa,{className:"w-3 h-3"}):l.jsx(AT,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-y-3 gap-x-2 mb-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Total Headcount"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.totalHeadcountWithGrowth})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Workpoints"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Density"}),l.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[t.density.toFixed(1)," ",l.jsxs("span",{className:"text-[10px] font-normal text-slate-400",children:[o,"/p"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Space Utilization Index"}),l.jsxs("div",{className:`text-sm font-bold ${t.fitFactor>100?"text-rose-600":"text-slate-800"}`,children:[t.fitFactor.toFixed(0),"%"]})]})]}),l.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Meeting Ratio"}),l.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:["1 : ",t.derivedMeetingRatio.toFixed(0)]})]}),l.jsxs("button",{onClick:c=>{c.stopPropagation(),i()},className:"text-[10px] flex items-center gap-1 bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1.5 rounded-md font-bold transition-colors border border-slate-200",children:[l.jsx(GT,{className:"w-3 h-3"})," Details"]})]})]})},sle=({project:e,scenarios:t,metricsMap:r,programGroups:n})=>{const a=e0(e.unit);return l.jsx("div",{className:"space-y-6",children:e.floors.map(i=>{const s=t.map(o=>{const c=r[o.id].floorMetrics.find(f=>f.floorId===i.id),u={name:o.name};return c&&n.forEach(f=>{let d=0;f.items.forEach(h=>{if(h==="work_open")d+=c.openDesks*a.deskOpen;else if(h==="work_enclosed")d+=c.enclosedOffices*a.deskEnclosed;else if(h==="work_alt")d+=c.altDesks*a.deskAlt;else if(h==="meet")d+=c.areaMeeting;else if(h==="phone")d+=c.areaPhone;else if(h==="circ")d+=c.areaCirculation;else{const p=o.supportSpaces.find(v=>v.id===h);if(p){const v=c.supportSummary.find(x=>x.name===p.name);v&&(d+=v.area)}}}),u[f.id]=d}),u});return l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-3 flex justify-between",children:[l.jsx("span",{children:i.name}),l.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:[i.headcount," HC"]})]}),l.jsx("div",{className:"h-24",children:l.jsx(Yb,{data:s,groups:n,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:30,showLegend:!1,showLabels:!0})})]},i.id)})})},ole=({scenario:e,metrics:t,project:r,programGroups:n})=>{const a=()=>t.effectiveDeskRatio<=1?"Assignments: Traditional 1:1 model ensures dedicated seating for all, minimizing change management but maximizing area consumption.":t.effectiveDeskRatio<1.4?"Assignments: Hybrid approach introduces sharing while maintaining team anchors. Requires team-level zoning.":"Assignments: High-agility model assumes mostly mobile workforce. Relies heavily on alternative settings to absorb overflow.",i=()=>t.derivedMeetingRatio>25?"Collaboration: Lean meeting ratio may cause room scarcity during peak hours. Focus on bookable open collab zones.":t.derivedMeetingRatio<15?"Collaboration: High provision of enclosed meeting spaces supports intensive privacy needs but impacts open plan capacity.":"Collaboration: Balanced meeting supply aligns with standard benchmarks.",s=()=>t.areaSupport/t.totalUsedArea*100>15?"Experience: Amenity-rich environment emphasizes social connection and wellness over density.":"Experience: Functional approach to amenities prioritizes operational efficiency.";return l.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200 h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3 border-b border-slate-200 pb-2",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 truncate pr-2",children:e.name}),l.jsx("div",{className:"text-[9px] px-1.5 py-0.5 rounded font-bold uppercase bg-slate-200 text-slate-600",children:"Strategy Profile"})]}),l.jsx("ul",{className:"space-y-3 flex-grow",children:[{label:"Workstations",text:a()},{label:"Meeting & Collab",text:i()},{label:"Support",text:s()}].map((o,c)=>l.jsxs("li",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:o.label}),l.jsx("span",{className:"text-xs text-slate-600 leading-snug",children:o.text})]},c))})]})},lle=({project:e,scenarios:t,activeScenarioId:r,onActivateScenario:n,onProceed:a})=>{const[i,s]=G.useState(null),[o,c]=G.useState([]),[u,f]=G.useState(["metrics","implications"]);G.useEffect(()=>{const m=[r];t.filter(w=>w.id!==r).slice(0,2).forEach(w=>m.push(w.id)),c(m)},[t,r]);const d=m=>{f(S=>S.includes(m)?S.filter(w=>w!==m):[...S,m])},h=G.useMemo(()=>t.reduce((m,S)=>(m[S.id]=R1(e,S),m),{}),[e,t]),p=t.filter(m=>o.includes(m.id)),v=t.find(m=>m.id===r),x=v?h[r]:null,y=e.programStructure||t0(e.projectType),g=G.useMemo(()=>{const m=e0(e.unit);return p.map(S=>{const w=h[S.id],_={name:S.name};return y.forEach(k=>{let N=0;w.floorMetrics.forEach(j=>{k.items.forEach(E=>{if(E==="work_open")N+=j.openDesks*m.deskOpen;else if(E==="work_enclosed")N+=j.enclosedOffices*m.deskEnclosed;else if(E==="work_alt")N+=j.altDesks*m.deskAlt;else if(E==="meet")N+=j.areaMeeting;else if(E==="phone")N+=j.areaPhone;else if(E==="circ")N+=j.areaCirculation;else{const O=S.supportSpaces.find(T=>T.id===E);if(O){const T=j.supportSummary.find(L=>L.name===O.name);T&&(N+=T.area)}}})}),_[k.id]=N}),_})},[p,h,e,y]),b=m=>{o.includes(m)?o.length>1&&c(o.filter(S=>S!==m)):o.length<3&&c([...o,m])};return i?l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"max-w-3xl mx-auto bg-amber-50 border border-amber-200 rounded-xl p-5 text-amber-900",children:[l.jsx("div",{className:"font-bold mb-2",children:"Deep Dive (temporary placeholder)"}),l.jsxs("div",{className:"text-sm",children:["This prototype references ",l.jsx("span",{className:"font-mono",children:"ScenarioDeepDive"}),", but the component isnt present in the codebase, so Deep Dive is disabled for build/deploy."]}),l.jsx("button",{className:"mt-4 px-3 py-2 rounded-lg border border-amber-300 bg-white hover:bg-amber-100 font-bold text-sm",onClick:()=>s(null),children:"Back"})]})}):l.jsxs("div",{className:"flex h-full bg-slate-50 overflow-hidden",children:[l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col z-10 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(Ga,{className:"w-4 h-4 text-indigo-600"})," Compare"]}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Select up to 3 scenarios."})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:t.map(m=>{const S=o.includes(m.id),w=r===m.id;return l.jsxs("div",{className:`p-3 rounded-lg border transition-all cursor-pointer ${S?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200 hover:border-indigo-200"}`,onClick:()=>b(m.id),children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${S?"bg-indigo-600 border-indigo-600":"border-slate-300"}`,children:S&&l.jsx(qa,{className:"w-3 h-3 text-white"})}),l.jsx("span",{className:`text-sm font-bold ${S?"text-indigo-900":"text-slate-600"}`,children:m.name})]}),w&&l.jsx("div",{className:"ml-6 text-[10px] font-bold text-indigo-600 uppercase tracking-wider",children:"Current Selection"})]},m.id)})})]}),l.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden relative",children:[l.jsx("div",{className:"flex-grow overflow-y-auto p-8 custom-scrollbar bg-slate-50/50",children:l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-32",children:[l.jsx("div",{className:"mb-8",children:l.jsx("div",{className:"flex justify-between items-end",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Strategic Decision Framework"}),l.jsxs("p",{className:"text-slate-500",children:["Evaluating strategies for ",e.projectName,"."]})]})})}),l.jsx(Ts,{title:"Strategic Metrics Overview",icon:In,isOpen:u.includes("metrics"),onToggle:()=>d("metrics"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(m=>l.jsx(ile,{scenario:m,metrics:h[m.id],project:e,isActive:r===m.id,onSelect:()=>n(m.id),onDeepDive:()=>s(m.id)},m.id))})}),l.jsx(Ts,{title:"Workstation Strategy",icon:HT,isOpen:u.includes("workpoints"),onToggle:()=>d("workpoints"),deltaValues:p.map(m=>h[m.id].requiredDesks),children:l.jsx(Jx,{scenarios:p,rows:[{label:"Total Workpoints (Seats)",values:p.map(m=>h[m.id].requiredDesks.toLocaleString()),highlight:!0},{label:"Open Workstations",values:p.map(m=>h[m.id].openDesks)},{label:"Enclosed Offices (Private)",values:p.map(m=>h[m.id].enclosedOffices)},{label:"Alternative Workpoints",values:p.map(m=>h[m.id].altDesks)},{label:"Effective Sharing Ratio",subLabel:"Total HC / Total Seats",values:p.map(m=>`1 : ${h[m.id].effectiveDeskRatio.toFixed(2)}`)}]})}),l.jsx(Ts,{title:"Meeting Rooms",icon:Xr,isOpen:u.includes("meeting"),onToggle:()=>d("meeting"),deltaValues:p.map(m=>h[m.id].totalMeetingRooms),children:l.jsx(Jx,{scenarios:p,rows:[{label:"Total Enclosed Meeting Rooms",values:p.map(m=>h[m.id].totalMeetingRooms),highlight:!0},{label:"Total Meeting Capacity (Seats)",values:p.map(m=>h[m.id].totalMeetingSeats)},{label:"Effective Meeting Ratio",subLabel:"Headcount per Room",values:p.map(m=>`1 : ${h[m.id].derivedMeetingRatio.toFixed(1)}`)},{label:"Small Meeting Rooms (4p)",values:p.map(m=>h[m.id].roomMix.small)},{label:"Medium Meeting Rooms (8p)",values:p.map(m=>h[m.id].roomMix.medium)},{label:"Large Meeting Rooms (14p)",values:p.map(m=>h[m.id].roomMix.large)},{label:"Boardrooms (20p)",values:p.map(m=>h[m.id].roomMix.board)},{label:"Phone Booths (1p)",values:p.map(m=>h[m.id].totalPhoneBooths)}]})}),l.jsx(Ts,{title:"Support & Amenity Allocation",icon:Rp,isOpen:u.includes("support"),onToggle:()=>d("support"),deltaValues:p.map(m=>Math.round(h[m.id].areaSupport)),children:l.jsx(Jx,{scenarios:p,rows:[{label:"Total Support Area",values:p.map(m=>`${Math.round(h[m.id].areaSupport).toLocaleString()} ${e.unit.toUpperCase()}`),highlight:!0},{label:"% of NIA",values:p.map(m=>`${(h[m.id].areaSupport/e.calculatedNia*100).toFixed(1)}%`)},...(()=>{const m=new Set;return p.forEach(S=>S.supportSpaces.forEach(w=>m.add(w.name))),Array.from(m).map(S=>({label:S,values:p.map(w=>{const _=w.supportSpaces.find(E=>E.name===S),N=ale(h[w.id])[S];if(!_||!N)return"-";const j=_.logic==="ratio"?`1:${_.value}`:_.logic==="pct_nia"?`${_.value}%`:"Fixed";return N.count>0?`${N.count} (${j})`:`${Math.round(N.area)} ${e.unit==="sqm"?"m":"ft"} (${j})`})}))})()]})}),l.jsx(Ts,{title:"Program Mix (Space Distribution)",icon:Ip,isOpen:u.includes("space_mix"),onToggle:()=>d("space_mix"),children:l.jsx("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-72",children:l.jsx(Yb,{data:g,groups:y,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:60,showLabels:!0})})}),l.jsx(Ts,{title:"Floor-by-Floor Breakdown",icon:ia,isOpen:u.includes("floors"),onToggle:()=>d("floors"),children:l.jsx(sle,{project:e,scenarios:p,metricsMap:h,programGroups:y})}),l.jsx(Ts,{title:"Strategic Implications & Recommendations",icon:XT,isOpen:u.includes("implications"),onToggle:()=>d("implications"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(m=>l.jsx(ole,{scenario:m,metrics:h[m.id],project:e,programGroups:y},m.id))})})]})}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-2xl flex justify-between items-center z-20 px-8",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:l.jsx(ps,{className:"w-5 h-5 text-indigo-700"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Selected Strategy"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:v==null?void 0:v.name})]}),x&&l.jsxs("div",{className:`ml-4 px-3 py-1 rounded text-xs font-bold ${x.fitFactor<=100?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[x.fitFactor.toFixed(0),"% Utilization"]})]}),l.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-bold shadow-md transition-all hover:translate-x-1",children:["Proceed to Stacking Plan ",l.jsx(ia,{className:"w-4 h-4"})]})]})]})]})},cle=({project:e,activeStrategy:t,handleStrategyChange:r,activeMetrics:n,scenarios:a,activeScenarioId:i,setActiveScenarioId:s,addScenario:o,duplicateScenario:c,deleteScenario:u,renameScenario:f,compareScenarioId:d,setCompareScenarioId:h,compareMetrics:p,onNavigate:v})=>{const[x,y]=G.useState("planning");return l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-6 py-2 flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center bg-slate-100 p-1 rounded-lg",children:[l.jsxs("button",{onClick:()=>y("planning"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${x==="planning"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ds,{className:"w-3 h-3"})," Detailed Planning"]}),l.jsxs("button",{onClick:()=>y("decision"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${x==="decision"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ps,{className:"w-3 h-3"})," Decision Framework"]})]})}),l.jsx("div",{className:"flex-grow overflow-hidden relative",children:x==="decision"?l.jsx(lle,{project:e,scenarios:a,activeScenarioId:i,onActivateScenario:s,onProceed:()=>v("stacking")}):l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[340px] flex-shrink-0 flex flex-col border-r border-slate-200 bg-white z-10",children:l.jsx("div",{className:"flex-grow overflow-hidden",children:l.jsx(gD,{strategy:t,onChange:r,title:t.name,baseHeadcount:e.headcount})})}),l.jsx("div",{className:"flex-grow overflow-y-auto bg-slate-50/50 p-6",children:l.jsx(tle,{metrics:n,strategy:t,project:e})}),l.jsx("div",{className:"w-80 flex-shrink-0 bg-white border-l border-slate-200 z-10",children:l.jsx(rle,{scenarios:a,activeId:i,project:e,metrics:n,onActivate:s,onAdd:o,onDuplicate:c,onDelete:u,onRename:f,compareId:d,onCompare:h,compareMetrics:p,onGoToDecision:()=>y("decision")})})]})})]})},ule=({project:e,onChange:t,selectedDeptId:r,onSelectDept:n})=>{const a=(c,u)=>{const f=e.departments.map(d=>d.id===c?{...d,...u}:d);t({...e,departments:f})},i=()=>{const c=`d-${Date.now()}`,u={id:c,name:"New Dept",headcount:10,color:zr.departments[e.departments.length%zr.departments.length],collaborators:[]};t({...e,departments:[...e.departments,u]}),n(c)},s=c=>{const f=e.departments.filter(d=>d.id!==c).map(d=>({...d,collaborators:d.collaborators.filter(h=>h.deptId!==c)}));t({...e,departments:f}),r===c&&n(null)},o=(c,u,f)=>{const d=e.departments.find(v=>v.id===c);if(!d)return;let h=[...d.collaborators];const p=h.findIndex(v=>v.deptId===u);p>=0?f===0?h.splice(p,1):h[p]={...h[p],strength:f}:f>0&&h.push({deptId:u,strength:f}),a(c,{collaborators:h})};return e.departments.find(c=>c.id===r),l.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200 w-full",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(hs,{className:"w-4 h-4 text-orange-600"}),"Departments & Flows"]}),l.jsx("button",{onClick:i,className:"p-1.5 bg-white border border-slate-200 rounded hover:bg-orange-50 hover:text-orange-600 transition-colors",children:l.jsx(Ya,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx("div",{className:"divide-y divide-slate-100",children:e.departments.map(c=>{var f;const u=c.id===r;return l.jsxs("div",{className:`group transition-colors ${u?"bg-orange-50/50":"hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"p-3 flex items-center gap-3 cursor-pointer",onClick:()=>n(u?null:c.id),children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:c.color}}),l.jsx("input",{type:"color",className:"absolute inset-0 opacity-0 cursor-pointer",value:c.color,onChange:d=>a(c.id,{color:d.target.value}),onClick:d=>d.stopPropagation()})]}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("input",{className:`text-sm font-bold bg-transparent w-full outline-none truncate ${u?"text-orange-900":"text-slate-700"}`,value:c.name,onChange:d=>a(c.id,{name:d.target.value}),onClick:d=>d.stopPropagation()}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400 mt-0.5",children:[l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(qT,{className:"w-3 h-3"})," ",c.headcount]}),l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(ia,{className:"w-3 h-3"})," ",((f=e.floors.find(d=>d.id===c.pinnedFloor))==null?void 0:f.name)||"Unassigned"]})]})]}),l.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:d=>{d.stopPropagation(),s(c.id)},className:"p-1.5 text-slate-300 hover:text-rose-500",children:l.jsx(ms,{className:"w-3 h-3"})}),l.jsx(Gr,{className:`w-4 h-4 text-slate-300 transition-transform ${u?"rotate-90":""}`})]})]}),u&&l.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-1",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Headcount"}),l.jsx("input",{type:"number",className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.headcount,onChange:d=>a(c.id,{headcount:parseInt(d.target.value)||0})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Floor"}),l.jsxs("select",{className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.pinnedFloor||"",onChange:d=>a(c.id,{pinnedFloor:d.target.value||void 0}),children:[l.jsx("option",{value:"",children:"Unassigned"}),e.floors.map(d=>l.jsx("option",{value:d.id,children:d.name},d.id))]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2 flex justify-between",children:[l.jsx("span",{children:"Interaction Strength (0-100)"}),l.jsx("span",{className:"text-orange-600",children:"With..."})]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-1",children:e.departments.filter(d=>d.id!==c.id).map(d=>{const h=c.collaborators.find(v=>v.deptId===d.id),p=(h==null?void 0:h.strength)||0;return l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"w-20 truncate text-slate-600",title:d.name,children:d.name}),l.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"flex-grow h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-orange-500",value:p,onChange:v=>o(c.id,d.id,parseInt(v.target.value))}),l.jsx("span",{className:`w-8 text-right font-mono ${p>0?"text-slate-800 font-bold":"text-slate-300"}`,children:p})]},d.id)})})]})]})]},c.id)})}),e.departments.length===0&&l.jsxs("div",{className:"p-8 text-center text-slate-400 text-xs",children:["No departments defined.",l.jsx("br",{}),"Click + to add one."]})]})]})},fle=({matrix:e,onCellClick:t,hoveredLink:r,onHoverLink:n,sortedDepts:a})=>{const o=100+a.length*28;return l.jsx("div",{className:"w-full h-full overflow-auto flex justify-center items-center p-4 bg-slate-50/50",children:l.jsxs("div",{className:"relative bg-white shadow-sm border border-slate-200 p-2 rounded-lg",style:{width:o+20,height:o+20},children:[l.jsx("div",{className:"absolute left-[100px] top-0 flex pointer-events-none",children:a.map((c,u)=>l.jsx("div",{className:"relative h-[100px]",style:{width:28},children:l.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 origin-bottom-left -rotate-45 text-[10px] font-bold text-slate-600 whitespace-nowrap overflow-visible",style:{width:120},children:c.name})},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-0 flex flex-col pointer-events-none",children:a.map((c,u)=>l.jsxs("div",{className:"h-[28px] w-[100px] flex items-center justify-end pr-2 gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate max-w-[70px]",title:c.name,children:c.name}),l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:c.color}})]},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-[100px] flex flex-col border-t border-l border-slate-200",children:a.map(c=>l.jsx("div",{className:"flex",children:a.map(u=>{var p;if(c.id===u.id)return l.jsx("div",{className:"bg-slate-100 border-r border-b border-slate-200",style:{width:28,height:28}},u.id);const f=((p=e[c.id])==null?void 0:p[u.id])||0,d=f/100,h=r&&(r.d1===c.id&&r.d2===u.id||r.d1===u.id&&r.d2===c.id);return l.jsx("div",{className:`border-r border-b border-slate-200 flex items-center justify-center text-[9px] font-bold cursor-pointer transition-all duration-150 ${h?"ring-2 ring-indigo-500 z-10 scale-110":"hover:bg-slate-50"}`,style:{width:28,height:28,backgroundColor:f>0?`rgba(249, 115, 22, ${d})`:"transparent",color:f>50?"white":"#94a3b8"},onClick:()=>t(c,u),onMouseEnter:()=>n({d1:c.id,d2:u.id}),onMouseLeave:()=>n(null),title:`${c.name}  ${u.name}: ${f}`,children:f>0?f:""},u.id)})},c.id))})]})})},dle=({sortedDepts:e,pairs:t,onHoverLink:r,hoveredLink:n,project:a})=>{const f=m=>{var S;return((S=a.floors.find(w=>w.id===m))==null?void 0:S.name)||"Unassigned"},d=e.reduce((m,S)=>m+Math.max(S.headcount||0,5),0),h=.05,v=(2*Math.PI-h*e.length)/(d||1);let x=-Math.PI/2;const y=e.map(m=>{const w=Math.max(m.headcount||0,5)*v,_=x,k=x+w,N=(_+k)/2;x=k+h;const j=300+200*Math.cos(N),E=300+200*Math.sin(N);return{...m,start:_,end:k,mid:N,x:j,y:E}}),g=[];if(y.length>0){let m=y[0].pinnedFloor,S=0;y.forEach((w,_)=>{const k=_===y.length-1,N=k?null:y[_+1].pinnedFloor;if(N!==m||k){const j=y[S],E=w;g.push({name:f(m),start:j.start-.02,end:E.end+.02}),m=N,S=_+1}})}const b=(m,S,w,_=0)=>{const k=300+m*Math.cos(S),N=300+m*Math.sin(S),j=300+m*Math.cos(w),E=300+m*Math.sin(w),O=w-S<=Math.PI?0:1;return`M ${k} ${N} A ${m} ${m} 0 ${O} 1 ${j} ${E}`};return l.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:l.jsxs("svg",{viewBox:"0 0 600 600",className:"w-full h-full max-w-[600px] select-none",children:[g.map((m,S)=>{const w=(m.start+m.end)/2,_=300+275*Math.cos(w),k=300+275*Math.sin(w);return l.jsxs("g",{children:[l.jsx("path",{d:b(250,m.start,m.end),fill:"none",stroke:"#f1f5f9",strokeWidth:"20",strokeLinecap:"butt"}),l.jsx("text",{x:_,y:k,textAnchor:"middle",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-400 uppercase tracking-wide",style:{fontSize:"10px"},children:m.name})]},`floor-${S}`)}),t.map((m,S)=>{const w=y.find(j=>j.id===m.dept1.id),_=y.find(j=>j.id===m.dept2.id);if(!w||!_)return null;const k=n&&(n.d1===w.id&&n.d2===_.id||n.d1===_.id&&n.d2===w.id),N=n&&!k;return l.jsx("path",{d:`M ${w.x} ${w.y} Q 300 300 ${_.x} ${_.y}`,fill:"none",stroke:k?zr.primary:`url(#grad-${S})`,strokeWidth:k?4:Math.max(1,m.score/200*12),opacity:k?1:N?.05:.4,onMouseEnter:()=>r({d1:w.id,d2:_.id}),onMouseLeave:()=>r(null),className:"transition-all duration-300 cursor-pointer"},`link-${S}`)}),l.jsx("defs",{children:t.map((m,S)=>{const w=y.find(k=>k.id===m.dept1.id),_=y.find(k=>k.id===m.dept2.id);return!w||!_?null:l.jsxs("linearGradient",{id:`grad-${S}`,gradientUnits:"userSpaceOnUse",x1:w.x,y1:w.y,x2:_.x,y2:_.y,children:[l.jsx("stop",{offset:"0%",stopColor:w.color}),l.jsx("stop",{offset:"100%",stopColor:_.color})]},`grad-${S}`)})}),y.map(m=>{const S=n&&(n.d1===m.id||n.d2===m.id),w=n&&!S,_=m.mid,k=300+235*Math.cos(_),N=300+235*Math.sin(_),j=_*180/Math.PI+(k<300?180:0);return l.jsxs("g",{className:"transition-opacity duration-300",style:{opacity:w?.2:1},children:[l.jsx("path",{d:b(200,m.start,m.end),fill:"none",stroke:m.color,strokeWidth:"16",className:"cursor-pointer hover:brightness-110",onMouseEnter:()=>r({d1:m.id,d2:m.id}),onMouseLeave:()=>r(null)}),l.jsx("text",{x:k,y:N,textAnchor:k>300?"start":"end",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-700 pointer-events-none",transform:`rotate(${j-(k<300?180:0)}, ${k}, ${N})`,children:m.name})]},m.id)})]})})},hle=({project:e,onChange:t,metrics:r,onNavigateToStacking:n})=>{const[a,i]=G.useState(null),[s,o]=G.useState(null),[c,u]=G.useState(!0),{adjacencyStats:f}=r,d=G.useMemo(()=>{const p=v=>e.floors.findIndex(x=>x.id===v);return[...e.departments].sort((v,x)=>{const y=p(v.pinnedFloor),g=p(x.pinnedFloor);return y!==g?(y===-1?99:y)-(g===-1?99:g):x.headcount-v.headcount})},[e]),h=(p,v)=>{o(p.id),u(!0)};return l.jsxs("div",{className:"flex h-full bg-slate-100 overflow-hidden relative",children:[l.jsxs("div",{className:`transition-all duration-300 ease-in-out bg-white border-r border-slate-200 z-20 flex-shrink-0 flex flex-col absolute md:relative h-full ${c?"w-80 translate-x-0":"w-0 -translate-x-full md:translate-x-0 md:w-0"}`,children:[l.jsx("div",{className:"flex-grow overflow-hidden w-80",children:l.jsx(ule,{project:e,onChange:t,selectedDeptId:s,onSelectDept:o})}),l.jsx("button",{onClick:()=>u(!c),className:"absolute top-1/2 -right-8 bg-white border border-l-0 border-slate-200 p-1.5 rounded-r-lg shadow-sm text-slate-500 hover:text-indigo-600 z-30",title:c?"Collapse Panel":"Expand Panel",children:c?l.jsx(zT,{className:"w-4 h-4"}):l.jsx(Gr,{className:"w-4 h-4"})})]}),!c&&l.jsx("button",{onClick:()=>u(!0),className:"absolute top-4 left-4 bg-white p-2 rounded-lg shadow border border-slate-200 z-10 text-slate-600 hover:text-indigo-600",children:l.jsx($p,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-grow flex flex-col h-full overflow-hidden",children:[l.jsxs("div",{className:"bg-white p-4 border-b border-slate-200 shadow-sm flex justify-between items-center flex-shrink-0 z-10",children:[l.jsxs("div",{className:"ml-10 md:ml-0",children:[" ",l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(eh,{className:"w-5 h-5 text-orange-500"})," Team Adjacency Model"]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Define departmental flows to optimize stacking."})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"hidden sm:flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-100 text-xs text-slate-500",children:[l.jsx(dc,{className:"w-3 h-3 text-slate-400"}),l.jsx("span",{children:"Hover diagram to trace flows"})]}),l.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold shadow-sm transition-colors",children:["Go to Stacking ",l.jsx(Dp,{className:"w-3 h-3"})]})]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-4 md:p-8 bg-slate-50/50",children:l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 h-full min-h-[600px]",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(FT,{className:"w-4 h-4 text-slate-400"})," Interaction Matrix"]}),l.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"Click cell to edit flow"})]}),l.jsx("div",{className:"flex-grow relative",children:l.jsx(fle,{matrix:f.matrix,onCellClick:h,hoveredLink:a,onHoverLink:i,sortedDepts:d})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(eh,{className:"w-4 h-4 text-slate-400"})," Flow Network"]}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-300"})," Floor Ring"]})})]}),l.jsx("div",{className:"flex-grow relative flex items-center justify-center bg-white",children:l.jsx(dle,{sortedDepts:d,pairs:f.allPairs,onHoverLink:i,hoveredLink:a,project:e})})]})]})})]})]})},ev=({label:e,score:t,max:r,unit:n,inverse:a=!1,warning:i})=>{const s=Math.min(t/r*100,100),o=a?s<95:s>80,c=i?"text-amber-500":o?"text-emerald-600":"text-rose-600",u=i?"bg-amber-500":o?"bg-emerald-500":"bg-rose-500";return l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:e}),i?l.jsx(Or,{className:"w-4 h-4 text-amber-500"}):l.jsx(Fp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:`text-2xl font-bold ${c}`,children:[t.toLocaleString()," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:["/ ",r.toLocaleString()," ",n]})]}),l.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full mt-2 overflow-hidden",children:l.jsx("div",{className:`h-full ${u} transition-all duration-500`,style:{width:`${s}%`}})})]})]})},ple=({metrics:e,project:t})=>{const r=e.totalUsedArea/t.calculatedNia*100,n=e.adjacencyStats.stressScore;let a=100;r>100&&(a-=(r-100)*2),e.effectiveDeskRatio>1.8&&(a-=10),e.derivedMeetingRatio>25&&(a-=10),n>20&&(a-=(n-20)*.5),a=Math.max(0,Math.min(100,a));const i=a>85?"Excellent Fit":a>70?"Manageable with Compromise":"High Risk / Not Feasible",s=a>85?"bg-emerald-100 text-emerald-700":a>70?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700";return l.jsxs("div",{className:"flex flex-col h-full gap-6 max-w-5xl mx-auto w-full",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Spatial Stress Analysis"}),l.jsx("p",{className:"text-slate-500",children:"Automated assessment of project constraints vs strategic demand."})]}),l.jsxs("div",{className:`px-6 py-4 rounded-xl text-center ${s}`,children:[l.jsxs("div",{className:"text-3xl font-bold",children:[a.toFixed(0),"/100"]}),l.jsx("div",{className:"text-xs font-bold uppercase tracking-wide mt-1",children:i})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(ev,{label:"Space Utilization Index",score:Math.round(e.totalUsedArea),max:Math.round(t.calculatedNia),unit:t.unit.toUpperCase(),inverse:!0,warning:r>95&&r<=100}),l.jsx(ev,{label:"Operational Stress Index",score:Math.round(n),max:100,unit:"Score",inverse:!0}),l.jsx(ev,{label:"Headcount",score:e.totalHeadcountWithGrowth,max:t.headcount,unit:"ppl",inverse:!0}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Density"}),l.jsx(zp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:[e.density.toFixed(1)," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:[t.unit.toUpperCase(),"/p"]})]}),l.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Target: 8.0 - 12.0"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex-grow",children:[l.jsx("h3",{className:"text-sm font-bold text-slate-800 uppercase mb-4",children:"Strategic Stress Factors"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-4",children:[{label:"Circulation & Flow",val:e.areaCirculation,max:e.totalUsedArea*.35,desc:"Circulation ratio check."},{label:"Meeting Capacity",val:20,max:e.derivedMeetingRatio,desc:"Meeting capacity verification.",inverse:!0},{label:"Sharing Strategy Alignment",val:e.effectiveDeskRatio,max:1.5,desc:"Evaluates cultural readiness for shared desks."}].map((o,c)=>{const u=c===0?"Good":c===1?"Tight":"Aggressive",f=u==="Good"?"text-emerald-600":"text-amber-600";return l.jsxs("div",{className:"flex items-center p-3 bg-slate-50 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"p-2 bg-white rounded-md shadow-sm mr-4",children:c===0?l.jsx(MT,{className:"w-5 h-5 text-indigo-500"}):l.jsx(Xr,{className:"w-5 h-5 text-indigo-500"})}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("div",{className:"text-sm font-bold text-slate-700",children:o.label}),l.jsx("div",{className:"text-xs text-slate-500",children:o.desc})]}),l.jsx("div",{className:`text-right font-bold text-sm ${f}`,children:u})]},c)})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[l.jsx(hs,{className:"w-4 h-4 text-indigo-500"}),l.jsx("h4",{className:"text-sm font-bold text-slate-800",children:"Top Friction Drivers"}),l.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:"Impact Score (0-100)"})]}),l.jsx("div",{className:"space-y-2",children:e.adjacencyStats.topFrictionPairs.length>0?e.adjacencyStats.topFrictionPairs.slice(0,5).map((o,c)=>l.jsxs("div",{className:"flex justify-between items-center p-2 rounded hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:o.dept1.color}}),o.dept1.name," + ",o.dept2.name]}),l.jsx("div",{className:"text-[10px] text-amber-600 font-medium",children:"Split across floors"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Str: ",(o.score/2).toFixed(0)]}),l.jsx("div",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded text-xs font-bold w-12 text-center",children:o.friction.toFixed(0)})]})]},c)):l.jsxs("div",{className:"text-xs text-slate-500 italic flex items-center gap-2 p-4 bg-emerald-50 rounded border border-emerald-100",children:[l.jsx(qa,{className:"w-4 h-4 text-emerald-500"}),"No significant adjacency friction detected."]})})]})]})]})]})},mle=({project:e,scenarios:t,activeScenarioId:r})=>{const n=t.find(f=>f.id===r),[a,i]=G.useState(!1),[s,o]=G.useState("custom"),c=f=>{o(f),i(!0)},u=({preset:f,title:d,desc:h,icon:p,color:v,items:x,isCustom:y=!1})=>l.jsxs("div",{className:`relative bg-white p-6 rounded-xl border transition-all flex flex-col h-full group ${y?"border-dashed border-slate-300 hover:border-indigo-400":"border-slate-200 shadow-sm hover:shadow-md"}`,children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110 ${v}`,children:l.jsx(p,{className:`w-6 h-6 ${y?"text-indigo-600":"text-white"}`})}),l.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:d}),l.jsx("p",{className:"text-sm text-slate-500 mb-6 flex-grow",children:h}),l.jsx("ul",{className:"space-y-2 mb-6",children:x.map((g,b)=>l.jsxs("li",{className:"flex items-center gap-2 text-xs text-slate-600",children:[l.jsx(uc,{className:`w-3 h-3 ${y?"text-slate-400":"text-emerald-500"}`})," ",g]},b))}),l.jsxs("button",{onClick:()=>c(f),className:`w-full py-2.5 rounded-lg border font-bold text-sm flex items-center justify-center gap-2 transition-colors ${y?"border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,children:[y?l.jsx(Hp,{className:"w-4 h-4"}):l.jsx(Ei,{className:"w-4 h-4"}),y?"Open Builder":"Download Package"]})]});return l.jsxs("div",{className:"max-w-6xl mx-auto w-full h-full flex flex-col p-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Project Exports"}),l.jsx("p",{className:"text-slate-500 mt-1",children:"Generate documentation packages for different stakeholders."}),l.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-full border border-indigo-100",children:["Active Scenario: ",n==null?void 0:n.name]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(u,{preset:"client",title:"Client Presentation",desc:"Executive summary with transparent charts, strategic metrics, and comparisons.",icon:lc,color:"bg-indigo-600",items:["PDF Report","High-level KPIs","Strategic Insights"]}),l.jsx(u,{preset:"designer",title:"Designer Handoff",desc:"Technical data package for architectural teams to begin test fitting.",icon:In,color:"bg-pink-600",items:["Excel / CSV","Stacking Matrices","Room Quantities"]}),l.jsx(u,{preset:"internal",title:"Internal Record",desc:"Complete project dump containing all assumptions and metadata.",icon:Bp,color:"bg-emerald-600",items:["Excel Workbook","All Scenarios","Full Audit Log"]}),l.jsx(u,{preset:"custom",title:"Custom Builder",desc:"Build a specific export package by selecting content and formats manually.",icon:Ya,color:"bg-indigo-50",items:["Select Content","Choose Formats","Multi-Scenario"],isCustom:!0})]}),l.jsx(ExportModal,{isOpen:a,onClose:()=>i(!1),initialPreset:s,scenarios:t,activeScenarioId:r,project:e})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ap={};ap.version="0.18.5";var $C=1252,xle=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Qb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zb=function(e){xle.indexOf(e)!=-1&&($C=Qb[0]=e)};function vle(){Zb(1252)}var ka=function(e){Zb(e)};function Jb(){ka(1200),vle()}function JN(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function gle(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function LC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var cu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?gle(e.slice(2)):t==254&&r==255?LC(e.slice(2)):t==65279?e.slice(1):e},rd=function(t){return String.fromCharCode(t)},ej=function(t){return String.fromCharCode(t)},Df,Gi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function If(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Gi.charAt(i)+Gi.charAt(s)+Gi.charAt(o)+Gi.charAt(c);return t}function Rn(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=Gi.indexOf(e.charAt(u++)),s=Gi.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Gi.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Gi.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Ve=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function is(e){return Ve?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function tj(e){return Ve?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var An=function(t){return Ve?Pi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bm(e){if(typeof ArrayBuffer>"u")return An(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function bs(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function yle(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ew(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ew(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var vr=Ve?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function ble(e){for(var t=[],r=0,n=e.length+250,a=is(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=is(65535),n=65530)}return t.push(a.slice(0,r)),vr(t)}var nn=/\u0000/g,uu=/[\u0001-\u0006]/g;function bl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Na(e,t){var r=""+e;return r.length>=t?r:$t("0",t-r.length)+r}function tw(e,t){var r=""+e;return r.length>=t?r:$t(" ",t-r.length)+r}function ip(e,t){var r=""+e;return r.length>=t?r:r+$t(" ",t-r.length)}function wle(e,t){var r=""+Math.round(e);return r.length>=t?r:$t("0",t-r.length)+r}function _le(e,t){var r=""+e;return r.length>=t?r:$t("0",t-r.length)+r}var rj=Math.pow(2,32);function Lo(e,t){if(e>rj||e<-rj)return wle(e,t);var r=Math.round(e);return _le(r,t)}function sp(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var nj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],tv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Sle(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},aj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kle={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function op(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*s+i,f=d*u+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=i):(f=u,o=s)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function Gs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=Ole(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var BC=new Date(1899,11,31,0,0,0),Nle=BC.getTime(),jle=new Date(1900,2,1,0,0,0);function UC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jle&&(r+=24*60*60*1e3),(r-(Nle+(e.getTimezoneOffset()-BC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function rw(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ele(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Tle(e){var t=e<0?12:11,r=rw(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Ale(e){var t=rw(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Rf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Tle(e):t===10?r=e.toFixed(10).substr(0,12):r=Ale(e),rw(Ele(r.toUpperCase()))}function po(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Rf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return la(14,UC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ole(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Cle(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return tv[r.m-1][1];case 5:return tv[r.m-1][0];default:return tv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return nj[r.q][0];default:return nj[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Na(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Na(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?Na(c,u):"";return f}function Xi(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var zC=/%/g;function Ple(e,t,r){var n=t.replace(zC,""),a=t.length-n.length;return mi(e,n,r*Math.pow(10,2*a))+$t("%",a)}function Mle(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function WC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+WC(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var HC=/# (\?+)( ?)\/( ?)(\d+)/;function Fle(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?$t(" ",e[1].length+1+e[4].length):tw(s,e[1].length)+e[2]+"/"+e[3]+Na(o,e[4].length))}function Dle(e,t,r){return r+(t===0?"":""+t)+$t(" ",e[1].length+2+e[4].length)}var VC=/^#*0*\.([0#]+)/,GC=/\).*[0#]/,XC=/\(###\) ###\\?-####/;function Qr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ij(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function sj(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ile(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Rle(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Hn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hn("n",n,r):"("+Hn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mle(e,t,r);if(t.indexOf("%")!==-1)return Ple(e,t,r);if(t.indexOf("E")!==-1)return WC(t,r);if(t.charCodeAt(0)===36)return"$"+Hn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Lo(c,t.length);if(t.match(/^[#?]+$/))return a=Lo(r,0),a==="0"&&(a=""),a.length>t.length?a:Qr(t.substr(0,t.length-a.length))+a;if(i=t.match(HC))return Fle(i,c,u);if(t.match(/^#+0+$/))return u+Lo(c,t.length-t.indexOf("0"));if(i=t.match(VC))return a=ij(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Qr(i[1])).replace(/\.$/,"."+Qr(i[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+$t("0",Qr(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+ij(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Xi(Lo(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hn(e,t,-r):Xi(""+(Math.floor(r)+Ile(r,i[1].length)))+"."+Na(sj(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Hn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=bl(Hn(e,t.replace(/[\\-]/g,""),r)),s=0,bl(bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(XC))return a=Hn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=op(c,Math.pow(10,s)-1,!1),a=""+u,f=mi("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=ip(o[2],s),f.length<i[4].length&&(f=Qr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=op(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?tw(o[1],s)+i[2]+"/"+i[3]+ip(o[2],s):$t(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Lo(r,0),t.length<=a.length?a:Qr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Qr(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=sj(r,i[1].length),r<0?"-"+Hn(e,t,-r):Xi(Rle(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Na(0,3-v.length):"")+v})+"."+Na(s,i[1].length);switch(t){case"###,##0.00":return Hn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Xi(Lo(c,0));return p!=="0"?u+p:"";case"###,###.00":return Hn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Hn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function $le(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return mi(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Lle(e,t,r){var n=t.replace(zC,""),a=t.length-n.length;return mi(e,n,r*Math.pow(10,2*a))+$t("%",a)}function KC(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+KC(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(GC)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",n,r):"("+Ia("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $le(e,t,r);if(t.indexOf("%")!==-1)return Lle(e,t,r);if(t.indexOf("E")!==-1)return KC(t,r);if(t.charCodeAt(0)===36)return"$"+Ia(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Na(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Qr(t.substr(0,t.length-a.length))+a;if(i=t.match(HC))return Dle(i,c,u);if(t.match(/^#+0+$/))return u+Na(c,t.length-t.indexOf("0"));if(i=t.match(VC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Qr(i[1])).replace(/\.$/,"."+Qr(i[1])),a=a.replace(/\.(\d*)$/,function(v,x){return"."+x+$t("0",Qr(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Xi(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):Xi(""+r)+"."+$t("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ia(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=bl(Ia(e,t.replace(/[\\-]/g,""),r)),s=0,bl(bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<a.length?a.charAt(s++):v==="0"?"0":""}));if(t.match(XC))return a=Ia(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=op(c,Math.pow(10,s)-1,!1),a=""+u,f=mi("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=ip(o[2],s),f.length<i[4].length&&(f=Qr(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=op(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?tw(o[1],s)+i[2]+"/"+i[3]+ip(o[2],s):$t(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Qr(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,h=t.length-a.length-d;return Qr(t.substr(0,d)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):Xi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Na(0,3-v.length):"")+v})+"."+Na(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Xi(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Ia(e,t.slice(0,t.lastIndexOf(".")),r)+Qr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function mi(e,t,r){return(r|0)===r?Ia(e,t,r):Hn(e,t,r)}function Ble(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var qC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":sp(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(qC))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ule(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,f,d,h="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!sp(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var p=e.charAt(++s),v=p==="("||p===")"?p:"t";a[a.length]={t:v,v:p},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Gs(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Gs(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Gs(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",s+=5,h="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",s+=5,h="h"):(x.t="t",++s),u==null&&x.t==="T")return"";a[a.length]=x,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(qC)){if(u==null&&(u=Gs(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,g=0,b;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=h,c="h",y<1&&(y=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(g=Math.max(g,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var m="",S;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=Cle(a[s].t.charCodeAt(0),a[s].v,u,g),a[s].t="t";break;case"n":case"?":for(S=s+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[s].v+=a[S].v,a[S]={v:"",t:";"},++S;m+=a[s].v,s=S-1;break;case"G":a[s].t="t",a[s].v=po(t,r);break}var w="",_,k;if(m.length>0){m.charCodeAt(0)==40?(_=t<0&&m.charCodeAt(0)===45?-t:t,k=mi("n",m,_)):(_=t<0&&n>1?-t:t,k=mi("n",m,_),_<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),S=k.length-1;var N=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){N=s;break}var j=a.length;if(N===a.length&&k.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(S>=a[s].v.length-1?(S-=a[s].v.length,a[s].v=k.substr(S+1,a[s].v.length)):S<0?a[s].v="":(a[s].v=k.substr(0,S+1),S=-1),a[s].t="t",j=s);S>=0&&j<a.length&&(a[j].v=k.substr(0,S+1)+a[j].v)}else if(N!==a.length&&k.indexOf("E")===-1){for(S=k.indexOf(".")-1,s=N;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")-1:a[s].v.length-1,w=a[s].v.substr(f+1);f>=0;--f)S>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(w=k.charAt(S--)+w);a[s].v=w,a[s].t="t",j=s}for(S>=0&&j<a.length&&(a[j].v=k.substr(0,S+1)+a[j].v),S=k.indexOf(".")+1,s=N;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==N)){for(f=a[s].v.indexOf(".")>-1&&s===N?a[s].v.indexOf(".")+1:0,w=a[s].v.substr(0,f);f<a[s].v.length;++f)S<k.length&&(w+=k.charAt(S++));a[s].v=w,a[s].t="t",j=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(_=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=mi(a[s].t,a[s].v,_),a[s].t="t");var E="";for(s=0;s!==a.length;++s)a[s]!=null&&(E+=a[s].v);return E}var oj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function lj(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function zle(e,t){var r=Ble(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(oj),o=r[1].match(oj);return lj(t,s)?[n,r[0]]:lj(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function la(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Me)[e],n==null&&(n=r.table&&r.table[aj[e]]||Me[aj[e]]),n==null&&(n=kle[e]||"General");break}if(sp(n,0))return po(t,r);t instanceof Date&&(t=UC(t,r.date1904));var a=zle(n,t);if(sp(a[1]))return po(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ule(a[1],t,r,a[0])}function xi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Me[r]==null){t<0&&(t=r);continue}if(Me[r]==e){t=r;break}}t<0&&(t=391)}return Me[t]=e,t}function Um(e){for(var t=0;t!=392;++t)e[t]!==void 0&&xi(e[t],t)}function Ac(){Me=Sle()}var Wle={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},YC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hle(e){var t=typeof e=="number"?Me[e]:e;return t=t.replace(YC,"(\\d+)"),new RegExp("^"+t+"$")}function Vle(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(YC)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":s=p;break;case"s":c=p;break;case"m":s>=0?o=p:a=p;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?f:u+"T"+f}var Gle=function(){var e={};e.version="1.2.0";function t(){for(var k=0,N=new Array(256),j=0;j!=256;++j)k=j,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,N[j]=k;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(k){var N=0,j=0,E=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(E=0;E!=256;++E)O[E]=k[E];for(E=0;E!=256;++E)for(j=k[E],N=256+E;N<4096;N+=256)j=O[N]=j>>>8^k[j&255];var T=[];for(E=1;E!=16;++E)T[E-1]=typeof Int32Array<"u"?O.subarray(E*256,E*256+256):O.slice(E*256,E*256+256);return T}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],f=a[5],d=a[6],h=a[7],p=a[8],v=a[9],x=a[10],y=a[11],g=a[12],b=a[13],m=a[14];function S(k,N){for(var j=N^-1,E=0,O=k.length;E<O;)j=j>>>8^r[(j^k.charCodeAt(E++))&255];return~j}function w(k,N){for(var j=N^-1,E=k.length-15,O=0;O<E;)j=m[k[O++]^j&255]^b[k[O++]^j>>8&255]^g[k[O++]^j>>16&255]^y[k[O++]^j>>>24]^x[k[O++]]^v[k[O++]]^p[k[O++]]^h[k[O++]]^d[k[O++]]^f[k[O++]]^u[k[O++]]^c[k[O++]]^o[k[O++]]^s[k[O++]]^i[k[O++]]^r[k[O++]];for(E+=15;O<E;)j=j>>>8^r[(j^k[O++])&255];return~j}function _(k,N){for(var j=N^-1,E=0,O=k.length,T=0,L=0;E<O;)T=k.charCodeAt(E++),T<128?j=j>>>8^r[(j^T)&255]:T<2048?(j=j>>>8^r[(j^(192|T>>6&31))&255],j=j>>>8^r[(j^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,L=k.charCodeAt(E++)&1023,j=j>>>8^r[(j^(240|T>>8&7))&255],j=j>>>8^r[(j^(128|T>>2&63))&255],j=j>>>8^r[(j^(128|L>>6&15|(T&3)<<4))&255],j=j>>>8^r[(j^(128|L&63))&255]):(j=j>>>8^r[(j^(224|T>>12&15))&255],j=j>>>8^r[(j^(128|T>>6&63))&255],j=j>>>8^r[(j^(128|T&63))&255]);return~j}return e.table=r,e.bstr=S,e.buf=w,e.str=_,e}(),Oe=function(){var t={};t.version="1.2.1";function r(C,z){for(var I=C.split("/"),B=z.split("/"),W=0,V=0,re=Math.min(I.length,B.length);W<re;++W){if(V=I[W].length-B[W].length)return V;if(I[W]!=B[W])return I[W]<B[W]?-1:1}return I.length-B.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(0,z+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(z+1)}function i(C,z){typeof z=="string"&&(z=new Date(z));var I=z.getHours();I=I<<6|z.getMinutes(),I=I<<5|z.getSeconds()>>>1,C.write_shift(2,I);var B=z.getFullYear()-1980;B=B<<4|z.getMonth()+1,B=B<<5|z.getDate(),C.write_shift(2,B)}function s(C){var z=C.read_shift(2)&65535,I=C.read_shift(2)&65535,B=new Date,W=I&31;I>>>=5;var V=I&15;I>>>=4,B.setMilliseconds(0),B.setFullYear(I+1980),B.setMonth(V-1),B.setDate(W);var re=z&31;z>>>=5;var ce=z&63;return z>>>=6,B.setHours(z),B.setMinutes(ce),B.setSeconds(re<<1),B}function o(C){jr(C,0);for(var z={},I=0;C.l<=C.length-4;){var B=C.read_shift(2),W=C.read_shift(2),V=C.l+W,re={};switch(B){case 21589:I=C.read_shift(1),I&1&&(re.mtime=C.read_shift(4)),W>5&&(I&2&&(re.atime=C.read_shift(4)),I&4&&(re.ctime=C.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}C.l=V,z[B]=re}return z}var c;function u(){return c||(c={})}function f(C,z){if(C[0]==80&&C[1]==75)return Uw(C,z);if((C[0]|32)==109&&(C[1]|32)==105)return uM(C,z);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var I=3,B=512,W=0,V=0,re=0,ce=0,te=0,ne=[],ae=C.slice(0,512);jr(ae,0);var pe=d(ae);switch(I=pe[0],I){case 3:B=512;break;case 4:B=4096;break;case 0:if(pe[1]==0)return Uw(C,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}B!==512&&(ae=C.slice(0,B),jr(ae,28));var we=C.slice(0,B);h(ae,I);var Se=ae.read_shift(4,"i");if(I===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);ae.l+=4,re=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),ce=ae.read_shift(4,"i"),W=ae.read_shift(4,"i"),te=ae.read_shift(4,"i"),V=ae.read_shift(4,"i");for(var xe=-1,_e=0;_e<109&&(xe=ae.read_shift(4,"i"),!(xe<0));++_e)ne[_e]=xe;var Le=p(C,B);y(te,V,Le,B,ne);var Tt=b(Le,re,ne,B);Tt[re].name="!Directory",W>0&&ce!==L&&(Tt[ce].name="!MiniFAT"),Tt[ne[0]].name="!FAT",Tt.fat_addrs=ne,Tt.ssz=B;var At={},Pr=[],Pc=[],Mc=[];m(re,Tt,Le,Pr,W,At,Pc,ce),v(Pc,Mc,Pr),Pr.shift();var Fc={FileIndex:Pc,FullPaths:Mc};return z&&z.raw&&(Fc.raw={header:we,sectors:Le}),Fc}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(X,"Header Signature: "),C.l+=16;var z=C.read_shift(2,"u");return[C.read_shift(2,"u"),z]}function h(C,z){var I=9;switch(C.l+=2,I=C.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,z){for(var I=Math.ceil(C.length/z)-1,B=[],W=1;W<I;++W)B[W-1]=C.slice(W*z,(W+1)*z);return B[I-1]=C.slice(I*z),B}function v(C,z,I){for(var B=0,W=0,V=0,re=0,ce=0,te=I.length,ne=[],ae=[];B<te;++B)ne[B]=ae[B]=B,z[B]=I[B];for(;ce<ae.length;++ce)B=ae[ce],W=C[B].L,V=C[B].R,re=C[B].C,ne[B]===B&&(W!==-1&&ne[W]!==W&&(ne[B]=ne[W]),V!==-1&&ne[V]!==V&&(ne[B]=ne[V])),re!==-1&&(ne[re]=B),W!==-1&&B!=ne[B]&&(ne[W]=ne[B],ae.lastIndexOf(W)<ce&&ae.push(W)),V!==-1&&B!=ne[B]&&(ne[V]=ne[B],ae.lastIndexOf(V)<ce&&ae.push(V));for(B=1;B<te;++B)ne[B]===B&&(V!==-1&&ne[V]!==V?ne[B]=ne[V]:W!==-1&&ne[W]!==W&&(ne[B]=ne[W]));for(B=1;B<te;++B)if(C[B].type!==0){if(ce=B,ce!=ne[ce])do ce=ne[ce],z[B]=z[ce]+"/"+z[B];while(ce!==0&&ne[ce]!==-1&&ce!=ne[ce]);ne[B]=-1}for(z[0]+="/",B=1;B<te;++B)C[B].type!==2&&(z[B]+="/")}function x(C,z,I){for(var B=C.start,W=C.size,V=[],re=B;I&&W>0&&re>=0;)V.push(z.slice(re*T,re*T+T)),W-=T,re=$s(I,re*4);return V.length===0?se(0):vr(V).slice(0,C.size)}function y(C,z,I,B,W){var V=L;if(C===L){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var re=I[C],ce=(B>>>2)-1;if(!re)return;for(var te=0;te<ce&&(V=$s(re,te*4))!==L;++te)W.push(V);y($s(re,B-4),z-1,I,B,W)}}function g(C,z,I,B,W){var V=[],re=[];W||(W=[]);var ce=B-1,te=0,ne=0;for(te=z;te>=0;){W[te]=!0,V[V.length]=te,re.push(C[te]);var ae=I[Math.floor(te*4/B)];if(ne=te*4&ce,B<4+ne)throw new Error("FAT boundary crossed: "+te+" 4 "+B);if(!C[ae])break;te=$s(C[ae],ne)}return{nodes:V,data:bj([re])}}function b(C,z,I,B){var W=C.length,V=[],re=[],ce=[],te=[],ne=B-1,ae=0,pe=0,we=0,Se=0;for(ae=0;ae<W;++ae)if(ce=[],we=ae+z,we>=W&&(we-=W),!re[we]){te=[];var xe=[];for(pe=we;pe>=0;){xe[pe]=!0,re[pe]=!0,ce[ce.length]=pe,te.push(C[pe]);var _e=I[Math.floor(pe*4/B)];if(Se=pe*4&ne,B<4+Se)throw new Error("FAT boundary crossed: "+pe+" 4 "+B);if(!C[_e]||(pe=$s(C[_e],Se),xe[pe]))break}V[we]={nodes:ce,data:bj([te])}}return V}function m(C,z,I,B,W,V,re,ce){for(var te=0,ne=B.length?2:0,ae=z[C].data,pe=0,we=0,Se;pe<ae.length;pe+=128){var xe=ae.slice(pe,pe+128);jr(xe,64),we=xe.read_shift(2),Se=cw(xe,0,we-ne),B.push(Se);var _e={name:Se,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Le=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Le!==0&&(_e.ct=S(xe,xe.l-8));var Tt=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Tt!==0&&(_e.mt=S(xe,xe.l-8)),_e.start=xe.read_shift(4,"i"),_e.size=xe.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=L,_e.name=""),_e.type===5?(te=_e.start,W>0&&te!==L&&(z[te].name="!StreamData")):_e.size>=4096?(_e.storage="fat",z[_e.start]===void 0&&(z[_e.start]=g(I,_e.start,z.fat_addrs,z.ssz)),z[_e.start].name=_e.name,_e.content=z[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:te!==L&&_e.start!==L&&z[te]&&(_e.content=x(_e,z[te].data,(z[ce]||{}).data))),_e.content&&jr(_e.content,0),V[Se]=_e,re.push(_e)}}function S(C,z){return new Date((En(C,z+4)/1e7*Math.pow(2,32)+En(C,z)/1e7-11644473600)*1e3)}function w(C,z){return u(),f(c.readFileSync(C),z)}function _(C,z){var I=z&&z.type;switch(I||Ve&&Buffer.isBuffer(C)&&(I="buffer"),I||"base64"){case"file":return w(C,z);case"base64":return f(An(Rn(C)),z);case"binary":return f(An(C),z)}return f(C,z)}function k(C,z){var I=z||{},B=I.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=B+"/",C.FileIndex[0]={name:B,type:5}),I.CLSID&&(C.FileIndex[0].clsid=I.CLSID),N(C)}function N(C){var z="Sh33tJ5";if(!Oe.find(C,"/"+z)){var I=se(4);I[0]=55,I[1]=I[3]=50,I[2]=54,C.FileIndex.push({name:z,type:2,content:I,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+z),j(C)}}function j(C,z){k(C);for(var I=!1,B=!1,W=C.FullPaths.length-1;W>=0;--W){var V=C.FileIndex[W];switch(V.type){case 0:B?I=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(V.R*V.L*V.C)&&(I=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!z)){var re=new Date(1987,1,19),ce=0,te=Object.create?Object.create(null):{},ne=[];for(W=0;W<C.FullPaths.length;++W)te[C.FullPaths[W]]=!0,C.FileIndex[W].type!==0&&ne.push([C.FullPaths[W],C.FileIndex[W]]);for(W=0;W<ne.length;++W){var ae=n(ne[W][0]);B=te[ae],B||(ne.push([ae,{name:a(ae).replace("/",""),type:1,clsid:U,ct:re,mt:re,content:null}]),te[ae]=!0)}for(ne.sort(function(Se,xe){return r(Se[0],xe[0])}),C.FullPaths=[],C.FileIndex=[],W=0;W<ne.length;++W)C.FullPaths[W]=ne[W][0],C.FileIndex[W]=ne[W][1];for(W=0;W<ne.length;++W){var pe=C.FileIndex[W],we=C.FullPaths[W];if(pe.name=a(we).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||U,W===0)pe.C=ne.length>1?1:-1,pe.size=0,pe.type=5;else if(we.slice(-1)=="/"){for(ce=W+1;ce<ne.length&&n(C.FullPaths[ce])!=we;++ce);for(pe.C=ce>=ne.length?-1:ce,ce=W+1;ce<ne.length&&n(C.FullPaths[ce])!=n(we);++ce);pe.R=ce>=ne.length?-1:ce,pe.type=1}else n(C.FullPaths[W+1]||"")==n(we)&&(pe.R=W+1),pe.type=2}}}function E(C,z){var I=z||{};if(I.fileType=="mad")return fM(C,I);switch(j(C),I.fileType){case"zip":return aM(C,I)}var B=function(Se){for(var xe=0,_e=0,Le=0;Le<Se.FileIndex.length;++Le){var Tt=Se.FileIndex[Le];if(Tt.content){var At=Tt.content.length;At>0&&(At<4096?xe+=At+63>>6:_e+=At+511>>9)}}for(var Pr=Se.FullPaths.length+3>>2,Pc=xe+7>>3,Mc=xe+127>>7,Fc=Pc+_e+Pr+Mc,ks=Fc+127>>7,Qm=ks<=109?0:Math.ceil((ks-109)/127);Fc+ks+Qm+127>>7>ks;)Qm=++ks<=109?0:Math.ceil((ks-109)/127);var ti=[1,Qm,ks,Mc,Pr,_e,xe,0];return Se.FileIndex[0].size=xe<<6,ti[7]=(Se.FileIndex[0].start=ti[0]+ti[1]+ti[2]+ti[3]+ti[4]+ti[5])+(ti[6]+7>>3),ti}(C),W=se(B[7]<<9),V=0,re=0;{for(V=0;V<8;++V)W.write_shift(1,M[V]);for(V=0;V<8;++V)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),V=0;V<3;++V)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,B[2]),W.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:L),W.write_shift(4,B[3]),W.write_shift(-4,B[1]?B[0]-1:L),W.write_shift(4,B[1]),V=0;V<109;++V)W.write_shift(-4,V<B[2]?B[1]+V:-1)}if(B[1])for(re=0;re<B[1];++re){for(;V<236+re*127;++V)W.write_shift(-4,V<B[2]?B[1]+V:-1);W.write_shift(-4,re===B[1]-1?L:re+1)}var ce=function(Se){for(re+=Se;V<re-1;++V)W.write_shift(-4,V+1);Se&&(++V,W.write_shift(-4,L))};for(re=V=0,re+=B[1];V<re;++V)W.write_shift(-4,q.DIFSECT);for(re+=B[2];V<re;++V)W.write_shift(-4,q.FATSECT);ce(B[3]),ce(B[4]);for(var te=0,ne=0,ae=C.FileIndex[0];te<C.FileIndex.length;++te)ae=C.FileIndex[te],ae.content&&(ne=ae.content.length,!(ne<4096)&&(ae.start=re,ce(ne+511>>9)));for(ce(B[6]+7>>3);W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(re=V=0,te=0;te<C.FileIndex.length;++te)ae=C.FileIndex[te],ae.content&&(ne=ae.content.length,!(!ne||ne>=4096)&&(ae.start=re,ce(ne+63>>6)));for(;W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(V=0;V<B[4]<<2;++V){var pe=C.FullPaths[V];if(!pe||pe.length===0){for(te=0;te<17;++te)W.write_shift(4,0);for(te=0;te<3;++te)W.write_shift(4,-1);for(te=0;te<12;++te)W.write_shift(4,0);continue}ae=C.FileIndex[V],V===0&&(ae.start=ae.size?ae.start-1:L);var we=V===0&&I.root||ae.name;if(ne=2*(we.length+1),W.write_shift(64,we,"utf16le"),W.write_shift(2,ne),W.write_shift(1,ae.type),W.write_shift(1,ae.color),W.write_shift(-4,ae.L),W.write_shift(-4,ae.R),W.write_shift(-4,ae.C),ae.clsid)W.write_shift(16,ae.clsid,"hex");else for(te=0;te<4;++te)W.write_shift(4,0);W.write_shift(4,ae.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,ae.start),W.write_shift(4,ae.size),W.write_shift(4,0)}for(V=1;V<C.FileIndex.length;++V)if(ae=C.FileIndex[V],ae.size>=4096)if(W.l=ae.start+1<<9,Ve&&Buffer.isBuffer(ae.content))ae.content.copy(W,W.l,0,ae.size),W.l+=ae.size+511&-512;else{for(te=0;te<ae.size;++te)W.write_shift(1,ae.content[te]);for(;te&511;++te)W.write_shift(1,0)}for(V=1;V<C.FileIndex.length;++V)if(ae=C.FileIndex[V],ae.size>0&&ae.size<4096)if(Ve&&Buffer.isBuffer(ae.content))ae.content.copy(W,W.l,0,ae.size),W.l+=ae.size+63&-64;else{for(te=0;te<ae.size;++te)W.write_shift(1,ae.content[te]);for(;te&63;++te)W.write_shift(1,0)}if(Ve)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function O(C,z){var I=C.FullPaths.map(function(te){return te.toUpperCase()}),B=I.map(function(te){var ne=te.split("/");return ne[ne.length-(te.slice(-1)=="/"?2:1)]}),W=!1;z.charCodeAt(0)===47?(W=!0,z=I[0].slice(0,-1)+z):W=z.indexOf("/")!==-1;var V=z.toUpperCase(),re=W===!0?I.indexOf(V):B.indexOf(V);if(re!==-1)return C.FileIndex[re];var ce=!V.match(uu);for(V=V.replace(nn,""),ce&&(V=V.replace(uu,"!")),re=0;re<I.length;++re)if((ce?I[re].replace(uu,"!"):I[re]).replace(nn,"")==V||(ce?B[re].replace(uu,"!"):B[re]).replace(nn,"")==V)return C.FileIndex[re];return null}var T=64,L=-2,X="d0cf11e0a1b11ae1",M=[208,207,17,224,161,177,26,225],U="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:U,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(C,z,I){u();var B=E(C,I);c.writeFileSync(z,B)}function F(C){for(var z=new Array(C.length),I=0;I<C.length;++I)z[I]=String.fromCharCode(C[I]);return z.join("")}function Q(C,z){var I=E(C,z);switch(z&&z.type||"buffer"){case"file":return u(),c.writeFileSync(z.filename,I),I;case"binary":return typeof I=="string"?I:F(I);case"base64":return If(typeof I=="string"?I:F(I));case"buffer":if(Ve)return Buffer.isBuffer(I)?I:Pi(I);case"array":return typeof I=="string"?An(I):I}return I}var ie;function A(C){try{var z=C.InflateRaw,I=new z;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)ie=C;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function R(C,z){if(!ie)return Lw(C,z);var I=ie.InflateRaw,B=new I,W=B._processChunk(C.slice(C.l),B._finishFlushFlag);return C.l+=B.bytesRead,W}function D(C){return ie?ie.deflateRawSync(C):Re(C)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(C){var z=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(z>>16|z>>8|z)&255}for(var Z=typeof Uint8Array<"u",ee=Z?new Uint8Array(256):[],fe=0;fe<256;++fe)ee[fe]=le(fe);function P(C,z){var I=ee[C&255];return z<=8?I>>>8-z:(I=I<<8|ee[C>>8&255],z<=16?I>>>16-z:(I=I<<8|ee[C>>16&255],I>>>24-z))}function ke(C,z){var I=z&7,B=z>>>3;return(C[B]|(I<=6?0:C[B+1]<<8))>>>I&3}function be(C,z){var I=z&7,B=z>>>3;return(C[B]|(I<=5?0:C[B+1]<<8))>>>I&7}function Te(C,z){var I=z&7,B=z>>>3;return(C[B]|(I<=4?0:C[B+1]<<8))>>>I&15}function Ae(C,z){var I=z&7,B=z>>>3;return(C[B]|(I<=3?0:C[B+1]<<8))>>>I&31}function he(C,z){var I=z&7,B=z>>>3;return(C[B]|(I<=1?0:C[B+1]<<8))>>>I&127}function We(C,z,I){var B=z&7,W=z>>>3,V=(1<<I)-1,re=C[W]>>>B;return I<8-B||(re|=C[W+1]<<8-B,I<16-B)||(re|=C[W+2]<<16-B,I<24-B)||(re|=C[W+3]<<24-B),re&V}function mt(C,z,I){var B=z&7,W=z>>>3;return B<=5?C[W]|=(I&7)<<B:(C[W]|=I<<B&255,C[W+1]=(I&7)>>8-B),z+3}function rr(C,z,I){var B=z&7,W=z>>>3;return I=(I&1)<<B,C[W]|=I,z+1}function Ut(C,z,I){var B=z&7,W=z>>>3;return I<<=B,C[W]|=I&255,I>>>=8,C[W+1]=I,z+8}function _r(C,z,I){var B=z&7,W=z>>>3;return I<<=B,C[W]|=I&255,I>>>=8,C[W+1]=I&255,C[W+2]=I>>>8,z+16}function Xt(C,z){var I=C.length,B=2*I>z?2*I:z+5,W=0;if(I>=z)return C;if(Ve){var V=tj(B);if(C.copy)C.copy(V);else for(;W<C.length;++W)V[W]=C[W];return V}else if(Z){var re=new Uint8Array(B);if(re.set)re.set(C);else for(;W<I;++W)re[W]=C[W];return re}return C.length=B,C}function Dt(C){for(var z=new Array(C),I=0;I<C;++I)z[I]=0;return z}function Kt(C,z,I){var B=1,W=0,V=0,re=0,ce=0,te=C.length,ne=Z?new Uint16Array(32):Dt(32);for(V=0;V<32;++V)ne[V]=0;for(V=te;V<I;++V)C[V]=0;te=C.length;var ae=Z?new Uint16Array(te):Dt(te);for(V=0;V<te;++V)ne[W=C[V]]++,B<W&&(B=W),ae[V]=0;for(ne[0]=0,V=1;V<=B;++V)ne[V+16]=ce=ce+ne[V-1]<<1;for(V=0;V<te;++V)ce=C[V],ce!=0&&(ae[V]=ne[ce+16]++);var pe=0;for(V=0;V<te;++V)if(pe=C[V],pe!=0)for(ce=P(ae[V],B)>>B-pe,re=(1<<B+4-pe)-1;re>=0;--re)z[ce|re<<pe]=pe&15|V<<4;return B}var Cr=Z?new Uint16Array(512):Dt(512),pa=Z?new Uint16Array(32):Dt(32);if(!Z){for(var jt=0;jt<512;++jt)Cr[jt]=0;for(jt=0;jt<32;++jt)pa[jt]=0}(function(){for(var C=[],z=0;z<32;z++)C.push(5);Kt(C,pa,32);var I=[];for(z=0;z<=143;z++)I.push(8);for(;z<=255;z++)I.push(9);for(;z<=279;z++)I.push(7);for(;z<=287;z++)I.push(8);Kt(I,Cr,288)})();var dr=function(){for(var z=Z?new Uint8Array(32768):[],I=0,B=0;I<ue.length-1;++I)for(;B<ue[I+1];++B)z[B]=I;for(;B<32768;++B)z[B]=29;var W=Z?new Uint8Array(259):[];for(I=0,B=0;I<J.length-1;++I)for(;B<J[I+1];++B)W[B]=I;function V(ce,te){for(var ne=0;ne<ce.length;){var ae=Math.min(65535,ce.length-ne),pe=ne+ae==ce.length;for(te.write_shift(1,+pe),te.write_shift(2,ae),te.write_shift(2,~ae&65535);ae-- >0;)te[te.l++]=ce[ne++]}return te.l}function re(ce,te){for(var ne=0,ae=0,pe=Z?new Uint16Array(32768):[];ae<ce.length;){var we=Math.min(65535,ce.length-ae);if(we<10){for(ne=mt(te,ne,+(ae+we==ce.length)),ne&7&&(ne+=8-(ne&7)),te.l=ne/8|0,te.write_shift(2,we),te.write_shift(2,~we&65535);we-- >0;)te[te.l++]=ce[ae++];ne=te.l*8;continue}ne=mt(te,ne,+(ae+we==ce.length)+2);for(var Se=0;we-- >0;){var xe=ce[ae];Se=(Se<<5^xe)&32767;var _e=-1,Le=0;if((_e=pe[Se])&&(_e|=ae&-32768,_e>ae&&(_e-=32768),_e<ae))for(;ce[_e+Le]==ce[ae+Le]&&Le<250;)++Le;if(Le>2){xe=W[Le],xe<=22?ne=Ut(te,ne,ee[xe+1]>>1)-1:(Ut(te,ne,3),ne+=5,Ut(te,ne,ee[xe-23]>>5),ne+=3);var Tt=xe<8?0:xe-4>>2;Tt>0&&(_r(te,ne,Le-J[xe]),ne+=Tt),xe=z[ae-_e],ne=Ut(te,ne,ee[xe]>>3),ne-=3;var At=xe<4?0:xe-2>>1;At>0&&(_r(te,ne,ae-_e-ue[xe]),ne+=At);for(var Pr=0;Pr<Le;++Pr)pe[Se]=ae&32767,Se=(Se<<5^ce[ae])&32767,++ae;we-=Le-1}else xe<=143?xe=xe+48:ne=rr(te,ne,1),ne=Ut(te,ne,ee[xe]),pe[Se]=ae&32767,++ae}ne=Ut(te,ne,0)-1}return te.l=(ne+7)/8|0,te.l}return function(te,ne){return te.length<8?V(te,ne):re(te,ne)}}();function Re(C){var z=se(50+Math.floor(C.length*1.1)),I=dr(C,z);return z.slice(0,I)}var xt=Z?new Uint16Array(32768):Dt(32768),He=Z?new Uint16Array(32768):Dt(32768),Ke=Z?new Uint16Array(128):Dt(128),Et=1,Mo=1;function Ss(C,z){var I=Ae(C,z)+257;z+=5;var B=Ae(C,z)+1;z+=5;var W=Te(C,z)+4;z+=4;for(var V=0,re=Z?new Uint8Array(19):Dt(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ne=Z?new Uint8Array(8):Dt(8),ae=Z?new Uint8Array(8):Dt(8),pe=re.length,we=0;we<W;++we)re[H[we]]=V=be(C,z),te<V&&(te=V),ne[V]++,z+=3;var Se=0;for(ne[0]=0,we=1;we<=te;++we)ae[we]=Se=Se+ne[we-1]<<1;for(we=0;we<pe;++we)(Se=re[we])!=0&&(ce[we]=ae[Se]++);var xe=0;for(we=0;we<pe;++we)if(xe=re[we],xe!=0){Se=ee[ce[we]]>>8-xe;for(var _e=(1<<7-xe)-1;_e>=0;--_e)Ke[Se|_e<<xe]=xe&7|we<<3}var Le=[];for(te=1;Le.length<I+B;)switch(Se=Ke[he(C,z)],z+=Se&7,Se>>>=3){case 16:for(V=3+ke(C,z),z+=2,Se=Le[Le.length-1];V-- >0;)Le.push(Se);break;case 17:for(V=3+be(C,z),z+=3;V-- >0;)Le.push(0);break;case 18:for(V=11+he(C,z),z+=7;V-- >0;)Le.push(0);break;default:Le.push(Se),te<Se&&(te=Se);break}var Tt=Le.slice(0,I),At=Le.slice(I);for(we=I;we<286;++we)Tt[we]=0;for(we=B;we<30;++we)At[we]=0;return Et=Kt(Tt,xt,286),Mo=Kt(At,He,30),z}function rM(C,z){if(C[0]==3&&!(C[1]&3))return[is(z),2];for(var I=0,B=0,W=tj(z||1<<18),V=0,re=W.length>>>0,ce=0,te=0;!(B&1);){if(B=be(C,I),I+=3,B>>>1)B>>1==1?(ce=9,te=5):(I=Ss(C,I),ce=Et,te=Mo);else{I&7&&(I+=8-(I&7));var ne=C[I>>>3]|C[(I>>>3)+1]<<8;if(I+=32,ne>0)for(!z&&re<V+ne&&(W=Xt(W,V+ne),re=W.length);ne-- >0;)W[V++]=C[I>>>3],I+=8;continue}for(;;){!z&&re<V+32767&&(W=Xt(W,V+32767),re=W.length);var ae=We(C,I,ce),pe=B>>>1==1?Cr[ae]:xt[ae];if(I+=pe&15,pe>>>=4,!(pe>>>8&255))W[V++]=pe;else{if(pe==256)break;pe-=257;var we=pe<8?0:pe-4>>2;we>5&&(we=0);var Se=V+J[pe];we>0&&(Se+=We(C,I,we),I+=we),ae=We(C,I,te),pe=B>>>1==1?pa[ae]:He[ae],I+=pe&15,pe>>>=4;var xe=pe<4?0:pe-2>>1,_e=ue[pe];for(xe>0&&(_e+=We(C,I,xe),I+=xe),!z&&re<Se&&(W=Xt(W,Se+100),re=W.length);V<Se;)W[V]=W[V-_e],++V}}}return z?[W,I+7>>>3]:[W.slice(0,V),I+7>>>3]}function Lw(C,z){var I=C.slice(C.l||0),B=rM(I,z);return C.l+=B[1],B[0]}function Bw(C,z){if(C)typeof console<"u"&&console.error(z);else throw new Error(z)}function Uw(C,z){var I=C;jr(I,0);var B=[],W=[],V={FileIndex:B,FullPaths:W};k(V,{root:z.root});for(var re=I.length-4;(I[re]!=80||I[re+1]!=75||I[re+2]!=5||I[re+3]!=6)&&re>=0;)--re;I.l=re+4,I.l+=4;var ce=I.read_shift(2);I.l+=6;var te=I.read_shift(4);for(I.l=te,re=0;re<ce;++re){I.l+=20;var ne=I.read_shift(4),ae=I.read_shift(4),pe=I.read_shift(2),we=I.read_shift(2),Se=I.read_shift(2);I.l+=8;var xe=I.read_shift(4),_e=o(I.slice(I.l+pe,I.l+pe+we));I.l+=pe+we+Se;var Le=I.l;I.l=xe+4,nM(I,ne,ae,V,_e),I.l=Le}return V}function nM(C,z,I,B,W){C.l+=2;var V=C.read_shift(2),re=C.read_shift(2),ce=s(C);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var te=C.read_shift(4),ne=C.read_shift(4),ae=C.read_shift(4),pe=C.read_shift(2),we=C.read_shift(2),Se="",xe=0;xe<pe;++xe)Se+=String.fromCharCode(C[C.l++]);if(we){var _e=o(C.slice(C.l,C.l+we));(_e[21589]||{}).mt&&(ce=_e[21589].mt),((W||{})[21589]||{}).mt&&(ce=W[21589].mt)}C.l+=we;var Le=C.slice(C.l,C.l+ne);switch(re){case 8:Le=R(C,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var Tt=!1;V&8&&(te=C.read_shift(4),te==134695760&&(te=C.read_shift(4),Tt=!0),ne=C.read_shift(4),ae=C.read_shift(4)),ne!=z&&Bw(Tt,"Bad compressed size: "+z+" != "+ne),ae!=I&&Bw(Tt,"Bad uncompressed size: "+I+" != "+ae),Ym(B,Se,Le,{unsafe:!0,mt:ce})}function aM(C,z){var I=z||{},B=[],W=[],V=se(1),re=I.compression?8:0,ce=0,te=0,ne=0,ae=0,pe=0,we=C.FullPaths[0],Se=we,xe=C.FileIndex[0],_e=[],Le=0;for(te=1;te<C.FullPaths.length;++te)if(Se=C.FullPaths[te].slice(we.length),xe=C.FileIndex[te],!(!xe.size||!xe.content||Se=="Sh33tJ5")){var Tt=ae,At=se(Se.length);for(ne=0;ne<Se.length;++ne)At.write_shift(1,Se.charCodeAt(ne)&127);At=At.slice(0,At.l),_e[pe]=Gle.buf(xe.content,0);var Pr=xe.content;re==8&&(Pr=D(Pr)),V=se(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,ce),V.write_shift(2,re),xe.mt?i(V,xe.mt):V.write_shift(4,0),V.write_shift(-4,_e[pe]),V.write_shift(4,Pr.length),V.write_shift(4,xe.content.length),V.write_shift(2,At.length),V.write_shift(2,0),ae+=V.length,B.push(V),ae+=At.length,B.push(At),ae+=Pr.length,B.push(Pr),V=se(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,ce),V.write_shift(2,re),V.write_shift(4,0),V.write_shift(-4,_e[pe]),V.write_shift(4,Pr.length),V.write_shift(4,xe.content.length),V.write_shift(2,At.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,Tt),Le+=V.l,W.push(V),Le+=At.length,W.push(At),++pe}return V=se(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,pe),V.write_shift(2,pe),V.write_shift(4,Le),V.write_shift(4,ae),V.write_shift(2,0),vr([vr(B),vr(W),V])}var _0={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function iM(C,z){if(C.ctype)return C.ctype;var I=C.name||"",B=I.match(/\.([^\.]+)$/);return B&&_0[B[1]]||z&&(B=(I=z).match(/[\.\\]([^\.\\])+$/),B&&_0[B[1]])?_0[B[1]]:"application/octet-stream"}function sM(C){for(var z=If(C),I=[],B=0;B<z.length;B+=76)I.push(z.slice(B,B+76));return I.join(`\r
`)+`\r
`}function oM(C){var z=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var ae=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],B=z.split(`\r
`),W=0;W<B.length;++W){var V=B[W];if(V.length==0){I.push("");continue}for(var re=0;re<V.length;){var ce=76,te=V.slice(re,re+ce);te.charAt(ce-1)=="="?ce--:te.charAt(ce-2)=="="?ce-=2:te.charAt(ce-3)=="="&&(ce-=3),te=V.slice(re,re+ce),re+=ce,re<V.length&&(te+="="),I.push(te)}}return I.join(`\r
`)}function lM(C){for(var z=[],I=0;I<C.length;++I){for(var B=C[I];I<=C.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+C[++I];z.push(B)}for(var W=0;W<z.length;++W)z[W]=z[W].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return An(z.join(`\r
`))}function cM(C,z,I){for(var B="",W="",V="",re,ce=0;ce<10;++ce){var te=z[ce];if(!te||te.match(/^\s*$/))break;var ne=te.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":B=ne[2].trim();break;case"content-type":V=ne[2].trim();break;case"content-transfer-encoding":W=ne[2].trim();break}}switch(++ce,W.toLowerCase()){case"base64":re=An(Rn(z.slice(ce).join("")));break;case"quoted-printable":re=lM(z.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var ae=Ym(C,B.slice(I.length),re,{unsafe:!0});V&&(ae.ctype=V)}function uM(C,z){if(F(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=z&&z.root||"",B=(Ve&&Buffer.isBuffer(C)?C.toString("binary"):F(C)).split(`\r
`),W=0,V="";for(W=0;W<B.length;++W)if(V=B[W],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),I||(I=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),V.slice(0,I.length)!=I););var re=(B[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var ce="--"+(re[1]||""),te=[],ne=[],ae={FileIndex:te,FullPaths:ne};k(ae);var pe,we=0;for(W=0;W<B.length;++W){var Se=B[W];Se!==ce&&Se!==ce+"--"||(we++&&cM(ae,B.slice(pe,W),I),pe=W)}return ae}function fM(C,z){var I=z||{},B=I.boundary||"SheetJS";B="------="+B;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],V=C.FullPaths[0],re=V,ce=C.FileIndex[0],te=1;te<C.FullPaths.length;++te)if(re=C.FullPaths[te].slice(V.length),ce=C.FileIndex[te],!(!ce.size||!ce.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var ne=ce.content,ae=Ve&&Buffer.isBuffer(ne)?ne.toString("binary"):F(ne),pe=0,we=Math.min(1024,ae.length),Se=0,xe=0;xe<=we;++xe)(Se=ae.charCodeAt(xe))>=32&&Se<128&&++pe;var _e=pe>=we*4/5;W.push(B),W.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+re),W.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),W.push("Content-Type: "+iM(ce,re)),W.push(""),W.push(_e?oM(ae):sM(ae))}return W.push(B+`--\r
`),W.join(`\r
`)}function dM(C){var z={};return k(z,C),z}function Ym(C,z,I,B){var W=B&&B.unsafe;W||k(C);var V=!W&&Oe.find(C,z);if(!V){var re=C.FullPaths[0];z.slice(0,re.length)==re?re=z:(re.slice(-1)!="/"&&(re+="/"),re=(re+z).replace("//","/")),V={name:a(z),type:2},C.FileIndex.push(V),C.FullPaths.push(re),W||Oe.utils.cfb_gc(C)}return V.content=I,V.size=I?I.length:0,B&&(B.CLSID&&(V.clsid=B.CLSID),B.mt&&(V.mt=B.mt),B.ct&&(V.ct=B.ct)),V}function hM(C,z){k(C);var I=Oe.find(C,z);if(I){for(var B=0;B<C.FileIndex.length;++B)if(C.FileIndex[B]==I)return C.FileIndex.splice(B,1),C.FullPaths.splice(B,1),!0}return!1}function pM(C,z,I){k(C);var B=Oe.find(C,z);if(B){for(var W=0;W<C.FileIndex.length;++W)if(C.FileIndex[W]==B)return C.FileIndex[W].name=a(I),C.FullPaths[W]=I,!0}return!1}function mM(C){j(C,!0)}return t.find=O,t.read=_,t.parse=f,t.write=Q,t.writeFile=K,t.utils={cfb_new:dM,cfb_add:Ym,cfb_del:hM,cfb_mov:pM,cfb_gc:mM,ReadShift:Tu,CheckField:gP,prep_blob:jr,bconcat:vr,use_zlib:A,_deflateRaw:Re,_inflateRaw:Lw,consts:q},t}();function Xle(e){return typeof e=="string"?Bm(e):Array.isArray(e)?yle(e):e}function d0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ua(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Xle(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=bs(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Kle(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function cj(e,t){for(var r=[],n=Bt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function zm(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Wm(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function qle(e){for(var t=[],r=Bt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var lp=new Date(1899,11,30,0,0,0);function ur(e,t){var r=e.getTime(),n=lp.getTime()+(e.getTimezoneOffset()-lp.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var QC=new Date,Yle=lp.getTime()+(QC.getTimezoneOffset()-lp.getTimezoneOffset())*6e4,uj=QC.getTimezoneOffset();function Hm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Yle),t.getTimezoneOffset()!==uj&&t.setTime(t.getTime()+(t.getTimezoneOffset()-uj)*6e4),t}function Qle(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var fj=new Date("2017-02-19T19:06:09.000Z"),ZC=isNaN(fj.getFullYear())?new Date("2/19/17"):fj,Zle=ZC.getFullYear()==2017;function _t(e,t){var r=new Date(e);if(Zle)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ZC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function mo(e,t){if(Ve&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ua(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ua(LC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ua(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ua(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function St(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=St(e[r]));return t}function $t(e,t){for(var r="";r.length<t;)r+=e;return r}function Oa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Jle=["january","february","march","april","may","june","july","august","september","october","november","december"];function rc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Jle.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var ece=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function JC(e){return e?e.content&&e.type?mo(e.content,!0):e.data?cu(e.data):e.asNodeBuffer&&Ve?cu(e.asNodeBuffer().toString("binary")):e.asBinary?cu(e.asBinary()):e._data&&e._data.getContent?cu(mo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function eP(e){if(!e)return null;if(e.data)return JN(e.data);if(e.asNodeBuffer&&Ve)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?JN(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function tce(e){return e&&e.name.slice(-4)===".bin"?eP(e):JC(e)}function Xn(e,t){for(var r=e.FullPaths||Bt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function nw(e,t){var r=Xn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qt(e,t,r){if(!r)return tce(nw(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function On(e,t,r){if(!r)return JC(nw(e,t));if(!t)return null;try{return On(e,t)}catch{return null}}function rce(e,t,r){return eP(nw(e,t))}function dj(e){for(var t=e.FullPaths||Bt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ue(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ve?n=Pi(r):n=ble(r),Oe.utils.cfb_add(e,t,n)}Oe.utils.cfb_add(e,t,r)}else e.file(t,r)}function aw(){return Oe.utils.cfb_new()}function tP(e,t){switch(t.type){case"base64":return Oe.read(e,{type:"base64"});case"binary":return Oe.read(e,{type:"binary"});case"buffer":case"array":return Oe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Gt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,nce=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,hj=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ace=/<[^>]*>/g,qr=Gt.match(hj)?hj:ace,ice=/<\w*:/,sce=/<(\/?)\w+:/;function De(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(nce),o=0,c="",u=0,f="",d="",h=1;if(s)for(u=0;u!=s.length;++u){for(d=s[u],i=0;i!=d.length&&d.charCodeAt(i)!==61;++i);for(f=d.slice(0,i).trim();d.charCodeAt(i+1)==32;)++i;for(h=(a=d.charCodeAt(i+1))==34||a==39?1:0,c=d.slice(i+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function Ja(e){return e.replace(sce,"<$1")}var rP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iw=zm(rP),Ye=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,c){return rP[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),sw=/[&<>'"]/g,oce=/[\u0000-\u0008\u000b-\u001f]/g;function at(e){var t=e+"";return t.replace(sw,function(r){return iw[r]}).replace(oce,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function pj(e){return at(e).replace(/ /g,"_x0020_")}var nP=/[\u0000-\u001f]/g;function ow(e){var t=e+"";return t.replace(sw,function(r){return iw[r]}).replace(/\n/g,"<br/>").replace(nP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function lce(e){var t=e+"";return t.replace(sw,function(r){return iw[r]}).replace(nP,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var mj=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function cce(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function bt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function rv(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function xj(e){var t=is(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function vj(e){return Pi(e,"binary").toString("utf8")}var nd="foo bar baz",ct=Ve&&(vj(nd)==rv(nd)&&vj||xj(nd)==rv(nd)&&xj)||rv,Ua=Ve?function(e){return Pi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$f=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),aP=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),uce=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),fce=/<\/?(?:vt:)?variant>/g,dce=/<(?:vt:)([^>]*)>([\s\S]*)</;function gj(e,t){var r=De(e),n=e.match(uce(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(fce,"").match(dce);s&&a.push({v:ct(s[2]),t:s[1]})}),a}var iP=/(^\s|\s$|\n)/;function Er(e,t){return"<"+e+(t.match(iP)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lf(e){return Bt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ge(e,t,r){return"<"+e+(r!=null?Lf(r):"")+(t!=null?(t.match(iP)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function $1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function hce(e,t){switch(typeof e){case"string":var r=ge("vt:lpwstr",at(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ge((e|0)==e?"vt:i4":"vt:r8",at(String(e)));case"boolean":return ge("vt:bool",e?"true":"false")}if(e instanceof Date)return ge("vt:filetime",$1(e));throw new Error("Unable to serialize "+e)}function lw(e){if(Ve&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ct(bs(ew(e)));throw new Error("Bad input format: expected Buffer or string")}var Bf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,or={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Eo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],jn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function pce(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function mce(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var yj=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},bj=Ve?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pi(t)})):yj(e)}:yj,wj=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(fi(e,a)));return n.join("").replace(nn,"")},cw=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(nn,""):wj(e,t,r)}:wj,_j=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},sP=Ve?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):_j(e,t,r)}:_j,Sj=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Ho(e,a)));return n.join("")},h0=Ve?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Sj(t,r,n)}:Sj,oP=function(e,t){var r=En(e,t);return r>0?h0(e,t+4,t+4+r-1):""},lP=oP,cP=function(e,t){var r=En(e,t);return r>0?h0(e,t+4,t+4+r-1):""},uP=cP,fP=function(e,t){var r=2*En(e,t);return r>0?h0(e,t+4,t+4+r-1):""},dP=fP,hP=function(t,r){var n=En(t,r);return n>0?cw(t,r+4,r+4+n):""},pP=hP,mP=function(e,t){var r=En(e,t);return r>0?h0(e,t+4,t+4+r):""},xP=mP,vP=function(e,t){return pce(e,t)},cp=vP,uw=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ve&&(lP=function(t,r){if(!Buffer.isBuffer(t))return oP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},uP=function(t,r){if(!Buffer.isBuffer(t))return cP(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},dP=function(t,r){if(!Buffer.isBuffer(t))return fP(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},pP=function(t,r){if(!Buffer.isBuffer(t))return hP(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},xP=function(t,r){if(!Buffer.isBuffer(t))return mP(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},cp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):vP(t,r)},uw=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ho=function(e,t){return e[t]},fi=function(e,t){return e[t+1]*256+e[t]},xce=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},En=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},vce=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tu(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,Ve&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(fi(this,u)),u+=2;e*=2;break;case"utf8":r=h0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=cw(this,this.l,this.l+e);break;case"wstr":return Tu.call(this,e,"dbcs");case"lpstr-ansi":r=lP(this,this.l),e=4+En(this,this.l);break;case"lpstr-cp":r=uP(this,this.l),e=4+En(this,this.l);break;case"lpwstr":r=dP(this,this.l),e=4+2*En(this,this.l);break;case"lpp4":e=4+En(this,this.l),r=pP(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+En(this,this.l),r=xP(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Ho(this,this.l+e++))!==0;)i.push(rd(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=fi(this,this.l+e))!==0;)i.push(rd(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Ho(this,u),this.l=u+1,o=Tu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(rd(fi(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Ho(this,u),this.l=u+1,o=Tu.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(rd(Ho(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=Ho(this,this.l),this.l++,n;case 2:return n=(t==="i"?xce:fi)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?$s:vce)(this,this.l),this.l+=4,n):(a=En(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=cp(this,this.l):a=cp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=sP(this,this.l,e);break}}return this.l+=e,r}var gce=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},yce=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},bce=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function wce(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)bce(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,gce(this,t,this.l);break;case 8:if(n=8,r==="f"){mce(this,t,this.l);break}case 16:break;case-4:n=4,yce(this,t,this.l);break}return this.l+=n,this}function gP(e,t){var r=sP(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function jr(e,t){e.l=t,e.read_shift=Tu,e.chk=gP,e.write_shift=wce}function Kr(e,t){e.l+=t}function se(e){var t=is(e);return jr(t,0),t}function Mi(e,t,r){if(e){var n,a,i;jr(e,e.l||0);for(var s=e.length,o=0,c=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Gf[o]||Gf[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;c=e.l+i;var f=u.f&&u.f(e,i,r);if(e.l=c,t(f,u,o))return}}}function mn(){var e=[],t=Ve?256:2048,r=function(u){var f=se(u);return jr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),vr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function de(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=Gf[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&uw(r)&&e.push(r)}}function Au(e,t,r){var n=St(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function kj(e,t,r){var n=St(e);return n.s=Au(n.s,t.s,r),n.e=Au(n.e,t.s,r),n}function Ou(e,t){if(e.cRel&&e.c<0)for(e=St(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=St(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Fe(e);return!e.cRel&&e.cRel!=null&&(r=kce(r)),!e.rRel&&e.rRel!=null&&(r=_ce(r)),r}function nv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ct(e.s.c)+":"+(e.e.cRel?"":"$")+Ct(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Vt(e.s.r)+":"+(e.e.rRel?"":"$")+Vt(e.e.r):Ou(e.s,t.biff)+":"+Ou(e.e,t.biff)}function fw(e){return parseInt(Sce(e),10)-1}function Vt(e){return""+(e+1)}function _ce(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Sce(e){return e.replace(/\$(\d+)$/,"$1")}function dw(e){for(var t=Nce(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ct(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function kce(e){return e.replace(/^([A-Z])/,"$$$1")}function Nce(e){return e.replace(/^\$([A-Z])/,"$1")}function jce(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Fe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yn(e){var t=e.indexOf(":");return t==-1?{s:Pt(e),e:Pt(e)}:{s:Pt(e.slice(0,t)),e:Pt(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Fe(e)),typeof t!="string"&&(t=Fe(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Nj(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=la(e.z,r?ur(t):t)}catch{}try{return e.w=la((e.XF||{}).numFmtId||(r?14:0),r?ur(t):t)}catch{return""+t}}function Ni(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Fi[e.v]||e.v:t==null?Nj(e,e.v):Nj(e,t))}function ws(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function yP(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=Qe(i["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(u.e.r=s=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},v=s+d,x=o+h;if(u.s.r>v&&(u.s.r=v),u.s.c>x&&(u.s.c=x),u.e.r<v&&(u.e.r=v),u.e.c<x&&(u.e.c=x),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Me[14],n.cellDates?(p.t="d",p.w=la(p.z,ur(p.v))):(p.t="n",p.v=ur(p.v),p.w=la(p.z,p.v))):p.t="s";if(a)i[v]||(i[v]=[]),i[v][x]&&i[v][x].z&&(p.z=i[v][x].z),i[v][x]=p;else{var y=Fe({c:x,r:v});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return u.s.c<1e7&&(i["!ref"]=Be(u)),i}function Oc(e,t){return yP(null,e,t)}function Ece(e){return e.read_shift(4,"i")}function Ca(e,t){return t||(t=se(4)),t.write_shift(4,e),t}function Hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yr(e,t){var r=!1;return t==null&&(r=!0,t=se(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Tce(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ace(e,t){return t||(t=se(4)),t.write_shift(2,0),t.write_shift(2,0),t}function hw(e,t){var r=e.l,n=e.read_shift(1),a=Hr(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(Tce(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Oce(e,t){var r=!1;return t==null&&(r=!0,t=se(15+4*e.t.length)),t.write_shift(1,0),yr(e.t,t),r?t.slice(0,t.l):t}var Cce=hw;function Pce(e,t){var r=!1;return t==null&&(r=!0,t=se(23+4*e.t.length)),t.write_shift(1,1),yr(e.t,t),t.write_shift(4,1),Ace({},t),r?t.slice(0,t.l):t}function ha(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function To(e,t){return t==null&&(t=se(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ao(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Oo(e,t){return t==null&&(t=se(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Mce=Hr,bP=yr;function pw(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function up(e,t){var r=!1;return t==null&&(r=!0,t=se(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Fce=Hr,L1=pw,mw=up;function xw(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?cp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$s(t,0)>>2;return r?a/100:a}function wP(e,t){t==null&&(t=se(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function _P(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Dce(e,t){return t||(t=se(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Co=_P,Cc=Dce;function Wr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function xo(e,t){return(t||se(8)).write_shift(8,e,"f")}function Ice(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Qs[a];u&&(t.rgb=zf(u));break;case 2:t.rgb=zf([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function fp(e,t){if(t||(t=se(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Rce(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function $ce(e,t){t||(t=se(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function SP(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Lce(e){return SP(e,1)}function Bce(e){return SP(e,2)}var vw=2,on=3,ad=11,jj=12,dp=19,id=64,Uce=65,zce=71,Wce=4108,Hce=4126,pr=80,kP=81,Vce=[pr,kP],B1={1:{n:"CodePage",t:vw},2:{n:"Category",t:pr},3:{n:"PresentationFormat",t:pr},4:{n:"ByteCount",t:on},5:{n:"LineCount",t:on},6:{n:"ParagraphCount",t:on},7:{n:"SlideCount",t:on},8:{n:"NoteCount",t:on},9:{n:"HiddenCount",t:on},10:{n:"MultimediaClipCount",t:on},11:{n:"ScaleCrop",t:ad},12:{n:"HeadingPairs",t:Wce},13:{n:"TitlesOfParts",t:Hce},14:{n:"Manager",t:pr},15:{n:"Company",t:pr},16:{n:"LinksUpToDate",t:ad},17:{n:"CharacterCount",t:on},19:{n:"SharedDoc",t:ad},22:{n:"HyperlinksChanged",t:ad},23:{n:"AppVersion",t:on,p:"version"},24:{n:"DigSig",t:Uce},26:{n:"ContentType",t:pr},27:{n:"ContentStatus",t:pr},28:{n:"Language",t:pr},29:{n:"Version",t:pr},255:{},2147483648:{n:"Locale",t:dp},2147483651:{n:"Behavior",t:dp},1919054434:{}},U1={1:{n:"CodePage",t:vw},2:{n:"Title",t:pr},3:{n:"Subject",t:pr},4:{n:"Author",t:pr},5:{n:"Keywords",t:pr},6:{n:"Comments",t:pr},7:{n:"Template",t:pr},8:{n:"LastAuthor",t:pr},9:{n:"RevNumber",t:pr},10:{n:"EditTime",t:id},11:{n:"LastPrinted",t:id},12:{n:"CreatedDate",t:id},13:{n:"ModifiedDate",t:id},14:{n:"PageCount",t:on},15:{n:"WordCount",t:on},16:{n:"CharCount",t:on},17:{n:"Thumbnail",t:zce},18:{n:"Application",t:pr},19:{n:"DocSecurity",t:on},255:{},2147483648:{n:"Locale",t:dp},2147483651:{n:"Behavior",t:dp},1919054434:{}},Ej={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Gce=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Xce(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Kce=Xce([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qs=St(Kce),Fi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},NP={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},z1={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},sd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gw(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qce(e){var t=gw();if(!e||!e.match)return t;var r={};if((e.match(qr)||[]).forEach(function(n){var a=De(n);switch(a[0].replace(ice,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[z1[a.ContentType]]!==void 0&&t[z1[a.ContentType]].push(a.PartName);break}}),t.xmlns!==or.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function jP(e,t){var r=qle(z1),n=[],a;n[n.length]=Gt,n[n.length]=ge("Types",null,{xmlns:or.CT,"xmlns:xsd":or.xsd,"xmlns:xsi":or.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ge("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=ge("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:sd[c][t.bookType]||sd[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:sd[c][t.bookType]||sd[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ge("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ge={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Uf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Cu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(qr)||[]).forEach(function(a){var i=De(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:fu(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}function wl(e){var t=[Gt,ge("Relationships",null,{xmlns:or.RELS})];return Bt(e["!id"]).forEach(function(r){t[t.length]=ge("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ge.HLINK,Ge.XPATH,Ge.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var Yce="application/vnd.oasis.opendocument.spreadsheet";function Qce(e,t){for(var r=lw(e),n,a;n=Bf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=De(n[0],!1),a.path=="/"&&a.type!==Yce)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Zce(e){var t=[Gt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Tj(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Jce(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function eue(e){var t=[Gt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Tj(e[r][0],e[r][1])),t.push(Jce("",e[r][0]));return t.push(Tj("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function EP(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ap.version+"</meta:generator></office:meta></office:document-meta>"}var ra=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tue=function(){for(var e=new Array(ra.length),t=0;t<ra.length;++t){var r=ra[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function TP(e){var t={};e=ct(e);for(var r=0;r<ra.length;++r){var n=ra[r],a=e.match(tue[r]);a!=null&&a.length>0&&(t[n[1]]=Ye(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=_t(t[n[1]]))}return t}function av(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=at(t),n[n.length]=r?ge(e,t,r):Er(e,t))}function AP(e,t){var r=t||{},n=[Gt,ge("cp:coreProperties",null,{"xmlns:cp":or.CORE_PROPS,"xmlns:dc":or.dc,"xmlns:dcterms":or.dcterms,"xmlns:dcmitype":or.dcmitype,"xmlns:xsi":or.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&av("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:$1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&av("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:$1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=ra.length;++i){var s=ra[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&av(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Zs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],OP=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function CP(e,t,r,n){var a=[];if(typeof e=="string")a=gj(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(f){return{v:f}}));var s=typeof t=="string"?gj(t,n).map(function(f){return f.v}):t,o=0,c=0;if(s.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=s.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=s.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=s.slice(o,o+c);break}o+=c}}function rue(e,t,r){var n={};return t||(t={}),e=ct(e),Zs.forEach(function(a){var i=(e.match($f(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Ye(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&CP(n.HeadingPairs,n.TitlesOfParts,t,r),t}function PP(e){var t=[],r=ge;return e||(e={}),e.Application="SheetJS",t[t.length]=Gt,t[t.length]=ge("Properties",null,{xmlns:or.EXT_PROPS,"xmlns:vt":or.vt}),Zs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=at(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+at(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nue=/<[^>]+>[^<]*/g;function aue(e,t){var r={},n="",a=e.match(nue);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=De(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ye(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ye(f);break;case"bool":r[n]=bt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=_t(f);break;case"cy":case"error":r[n]=Ye(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,u,c)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function MP(e){var t=[Gt,ge("Properties",null,{xmlns:or.CUST_PROPS,"xmlns:vt":or.vt})];if(!e)return t.join("");var r=1;return Bt(e).forEach(function(a){++r,t[t.length]=ge("property",hce(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:at(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},iv;function iue(e,t,r){iv||(iv=zm(W1)),t=iv[t]||t,e[t]=r}function sue(e,t){var r=[];return Bt(W1).map(function(n){for(var a=0;a<ra.length;++a)if(ra[a][1]==n)return ra[a];for(a=0;a<Zs.length;++a)if(Zs[a][1]==n)return Zs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Er(W1[n[1]]||n[1],a))}}),ge("DocumentProperties",r.join(""),{xmlns:jn.o})}function oue(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Bt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<ra.length;++s)if(i==ra[s][1])return;for(s=0;s<Zs.length;++s)if(i==Zs[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(ge(pj(i),o,{"dt:dt":c}))}}),t&&Bt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(ge(pj(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+jn.o+'">'+a.join("")+"</"+n+">"}function yw(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function lue(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=se(8);return s.write_shift(4,n),s.write_shift(4,a),s}function FP(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function DP(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function IP(e,t,r){return t===31?DP(e):FP(e,t,r)}function H1(e,t,r){return IP(e,t,r===!1?0:4)}function cue(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return IP(e,t,0)}function uue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(nn,""),e.l-a&2&&(e.l+=2)}return r}function fue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(nn,"");return r}function due(e){var t=e.l,r=hp(e,kP);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=hp(e,on);return[r,n]}function hue(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(due(e));return r}function Aj(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(nn,"").replace(uu,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function RP(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function pue(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function hp(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==jj&&n!==t&&Vce.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===jj?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return FP(e,n,4).replace(nn,"");case 31:return DP(e);case 64:return yw(e);case 65:return RP(e);case 71:return pue(e);case 80:return H1(e,n,!i.raw).replace(nn,"");case 81:return cue(e,n).replace(nn,"");case 4108:return hue(e);case 4126:case 4127:return n==4127?uue(e):fue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Oj(e,t){var r=se(4),n=se(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=se(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=lue(t);break;case 31:case 80:for(n=se(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return vr([r,n])}function Cj(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,c=-1,u={};for(s=0;s!=a;++s){var f=e.read_shift(4),d=e.read_shift(4);i[s]=[f,d+r]}i.sort(function(b,m){return b[1]-m[1]});var h={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var p=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,p=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],p=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(p=!1,e.l=i[s][1]),p)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var v=t[i[s][0]];if(h[v.n]=hp(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(o=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(i[s][0]===1){if(o=h.CodePage=hp(e,vw),ka(o),c!==-1){var x=e.l;e.l=i[c][1],u=Aj(e,o),e.l=x}}else if(i[s][0]===0){if(o===0){c=s,e.l=i[s+1][1];continue}u=Aj(e,o)}else{var y=u[i[s][0]],g;switch(e[e.l]){case 65:e.l+=4,g=RP(e);break;case 30:e.l+=4,g=H1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=H1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=zt(e,4);break;case 64:e.l+=4,g=_t(yw(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=g}}return e.l=r+n,h}var $P=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mue(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Pj(e,t,r){var n=se(8),a=[],i=[],s=8,o=0,c=se(8),u=se(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=se(8),u.write_shift(4,0),a.unshift(u);var f=[se(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=se(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=vr(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!($P.indexOf(e[o][0])>-1||OP.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var v=r[p];if(v.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=Oj(v.t,h)}else{var y=mue(h);y==-1&&(y=31,h=String(h)),c=Oj(y,h)}i.push(c),u=se(8),u.write_shift(4,t?p:2+o),a.push(u),s+=8+c.length}var g=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,g),g+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),vr([n].concat(a).concat(i))}function Mj(e,t,r){var n=e.content;if(!n)return{};jr(n,0);var a,i,s,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Oe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),c=n.read_shift(4));var d=Cj(n,t),h={SystemIdentifier:u};for(var p in d)h[p]=d[p];if(h.FMTID=i,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=Cj(n,null)}catch{}for(p in v)h[p]=v[p];return h.FMTID=[i,s],h}function Fj(e,t,r,n,a,i){var s=se(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Oe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=Pj(e,r,n);if(o.push(c),a){var u=Pj(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return vr(o)}function Ii(e,t){return e.read_shift(t),null}function xue(e,t){t||(t=se(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function vue(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function zt(e,t){return e.read_shift(t)===1}function Zr(e,t){return t||(t=se(2)),t.write_shift(2,+!!e),t}function Zt(e){return e.read_shift(2,"u")}function Kn(e,t){return t||(t=se(2)),t.write_shift(2,e),t}function LP(e,t){return vue(e,t,Zt)}function gue(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function BP(e,t,r){return r||(r=se(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function p0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function yue(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,c={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*s),n&&(e.l+=o),c.t=f,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function bue(e){var t=e.t||"",r=se(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=se(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return vr(a)}function vo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function m0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vo(e,n,r)}function Po(e,t,r){if(r.biff>5)return m0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function UP(e,t,r){return r||(r=se(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function wue(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function _ue(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(nn,"");return n&&(e.l+=24),a}function Sue(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(nn,"");return r+s}function kue(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return _ue(e);case"0303000000000000c000000000000046":return Sue(e);default:throw new Error("Unsupported Moniker "+r)}}function od(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(nn,""):"";return r}function Dj(e,t){t||(t=se(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Nue(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,c,u="",f,d;a&16&&(i=od(e,r-e.l)),a&128&&(s=od(e,r-e.l)),(a&257)===257&&(o=od(e,r-e.l)),(a&257)===1&&(c=kue(e,r-e.l)),a&8&&(u=od(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=yw(e)),e.l=r;var h=s||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),i&&(p.Tooltip=i),p}function jue(e){var t=se(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Dj(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Dj(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function zP(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function WP(e,t){var r=zP(e);return r[3]=0,r}function ei(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function go(e,t,r,n){return n||(n=se(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Eue(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Tue(e,t,r){return t===0?"":Po(e,t,r)}function Aue(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function HP(e){var t=e.read_shift(2),r=xw(e);return[t,r]}function Oue(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=p0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Vm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function VP(e,t){return t||(t=se(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function GP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var Cue=GP;function XP(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Pue(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Mue(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Dr(e){e.l+=2,e.l+=e.read_shift(2)}var Fue={0:Dr,4:Dr,5:Dr,6:Dr,7:Mue,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:Pue,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:XP};function Due(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(Fue[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function ld(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function bw(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=se(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Iue(e,t){return t===0||e.read_shift(2),1200}function Rue(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Po(e,0,r);return e.read_shift(t+n-e.l),a}function $ue(e,t){var r=!t||t.biff==8,n=se(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Lue(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Bue(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=p0(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function Uue(e,t){var r=!t||t.biff>=8?2:1,n=se(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function zue(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(yue(e));return i.Count=n,i.Unique=a,i}function Wue(e,t){var r=se(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=bue(e[a]);var i=vr([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Hue(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Vue(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Gue(e){var t=Eue(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Xue(e){return e.read_shift(2),e.read_shift(4)}function Ij(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function Kue(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:c,TabRatio:u}}function que(){var e=se(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Yue(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Que(e){var t=se(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Zue(){}function Jue(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=p0(e,0,r),n}function efe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=se(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function tfe(e){var t=ei(e);return t.isst=e.read_shift(4),t}function rfe(e,t,r,n){var a=se(10);return go(e,t,n,a),a.write_shift(4,r),a}function nfe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ei(e);r.biff==2&&e.l++;var i=m0(e,n-e.l,r);return a.val=i,a}function afe(e,t,r,n,a){var i=!a||a.biff==8,s=se(8+ +i+(1+i)*r.length);return go(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function ife(e,t,r){var n=e.read_shift(2),a=Po(e,0,r);return[n,a]}function sfe(e,t,r,n){var a=r&&r.biff==5;n||(n=se(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var ofe=Po;function Rj(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c}}}function lfe(e,t){var r=t.biff==8||!t.biff?4:2,n=se(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function cfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=HP(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ufe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(HP(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function ffe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function dfe(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=Gce[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function hfe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=dfe(e,t,n.fStyle,r),n}function $j(e,t,r,n){var a=r&&r.biff==5;n||(n=se(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function pfe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function mfe(e){var t=se(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Lj(e,t,r){var n=ei(e);(r.biff==2||t==9)&&++e.l;var a=gue(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function xfe(e,t,r,n,a,i){var s=se(8);return go(e,t,n,s),BP(r,i,s),s}function vfe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ei(e),a=Wr(e);return n.val=a,n}function gfe(e,t,r,n){var a=se(14);return go(e,t,n,a),xo(r,a),a}var Bj=Tue;function yfe(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=vo(e,i),o=[];n>e.l;)o.push(m0(e));return[i,a,s,o]}function Uj(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Oue(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var bfe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function zj(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=vo(e,s,r);a&32&&(u=bfe[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:Dpe(e,f,r,o);return{chKey:i,Name:u,itab:c,rgce:d}}function KP(e,t,r){if(r.biff<8)return wfe(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Aue(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function wfe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=p0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function _fe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=vo(e,n,r),s=vo(e,a,r);return[i,s]}function Sfe(e,t,r){var n=GP(e);e.l++;var a=e.read_shift(1);return t-=8,[Ipe(e,t,r),a,n]}function Wj(e,t,r){var n=Cue(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Mpe(e,t,r)]}function kfe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Nfe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Po(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function jfe(e,t,r){return Nfe(e,t,r)}function Efe(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Vm(e));return r}function Tfe(e){var t=se(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)VP(e[r],t);return t}function Afe(e,t,r){if(r&&r.biff<8)return Cfe(e,t,r);var n=XP(e),a=Due(e,t-22,n[1]);return{cmo:n,ft:a}}var Ofe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Cfe(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Ofe[n]||Kr)(e,t,r)),{cmo:[a,n,i],ft:s}}function Pfe(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=wue(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=vo(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Mfe(e,t){var r=Vm(e);e.l+=16;var n=Nue(e,t-24);return[r,n]}function Ffe(e){var t=se(24),r=Pt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return vr([t,jue(e[1])])}function Dfe(e,t){e.read_shift(2);var r=Vm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(nn,""),[r,n]}function Ife(e){var t=e[1].Tooltip,r=se(10+2*(t.length+1));r.write_shift(2,2048);var n=Pt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Rfe(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ej[r]||r,r=e.read_shift(2),t[1]=Ej[r]||r,t}function $fe(e){return e||(e=se(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Lfe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(WP(e));return r}function Bfe(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(WP(e));return r}function Ufe(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function qP(e,t,r){if(!r.cellStyles)return Kr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function zfe(e,t){var r=se(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Wfe(e,t){var r={};return t<32||(e.l+=16,r.header=Wr(e),r.footer=Wr(e),e.l+=2),r}function Hfe(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function Vfe(e){for(var t=se(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Gfe=ei,Xfe=LP,Kfe=m0;function qfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Yfe(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ei(e);++e.l;var a=Po(e,t-7,r);return n.t="str",n.val=a,n}function Qfe(e){var t=ei(e);++e.l;var r=Wr(e);return t.t="n",t.val=r,t}function Zfe(e,t,r){var n=se(15);return y0(n,e,t),n.write_shift(8,r,"f"),n}function Jfe(e){var t=ei(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function e0e(e,t,r){var n=se(9);return y0(n,e,t),n.write_shift(2,r),n}function t0e(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function r0e(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function n0e(e,t,r){var n=e.l+t,a=ei(e),i=e.read_shift(2),s=vo(e,i,r);return e.l=n,a.t="str",a.val=s,a}var a0e=[2,3,48,49,131,139,140,245],V1=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=zm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=is(1);switch(c.type){case"base64":f=An(Rn(o));break;case"binary":f=An(o);break;case"buffer":case"array":f=o;break}jr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var x=0,y=521;d==2&&(x=f.read_shift(2)),f.l+=3,d!=2&&(x=f.read_shift(4)),x>1048576&&(x=1e6),d!=2&&(y=f.read_shift(2));var g=f.read_shift(2),b=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(b=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var m=[],S={},w=Math.min(f.length,d==2?521:y-10-(p?264:0)),_=v?32:11;f.l<w&&f[f.l]!=13;)switch(S={},S.name=Df.utils.decode(b,f.slice(f.l,f.l+_)).replace(/[\u0000\r\n].*$/g,""),f.l+=_,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&m.push(S),d!=2&&(f.l+=v?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var k=0,N=0;for(u[0]=[],N=0;N!=m.length;++N)u[0][N]=m[N].name;for(;x-- >0;){if(f[f.l]===42){f.l+=g;continue}for(++f.l,u[++k]=[],N=0,N=0;N!=m.length;++N){var j=f.slice(f.l,f.l+m[N].len);f.l+=m[N].len,jr(j,0);var E=Df.utils.decode(b,j);switch(m[N].type){case"C":E.trim().length&&(u[k][N]=E.replace(/\s+$/,""));break;case"D":E.length===8?u[k][N]=new Date(+E.slice(0,4),+E.slice(4,6)-1,+E.slice(6,8)):u[k][N]=E;break;case"F":u[k][N]=parseFloat(E.trim());break;case"+":case"I":u[k][N]=v?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(E.trim().toUpperCase()){case"Y":case"T":u[k][N]=!0;break;case"N":case"F":u[k][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+E+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][N]="##MEMO##"+(v?parseInt(E.trim(),10):j.read_shift(4));break;case"N":E=E.replace(/\u0000/g,"").trim(),E&&E!="."&&(u[k][N]=+E||0);break;case"@":u[k][N]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[k][N]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[k][N]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][N]=-j.read_shift(-8,"f");break;case"B":if(p&&m[N].len==8){u[k][N]=j.read_shift(8,"f");break}case"G":case"P":j.l+=m[N].len;break;case"0":if(m[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+m[N].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=m,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Oc(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,c){try{return ws(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&ka(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=mn(),d=vp(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),v=o["!cols"]||[],x=0,y=0,g=0,b=1;for(x=0;x<h.length;++x){if(((v[x]||{}).DBF||{}).name){h[x]=v[x].DBF.name,++g;continue}if(h[x]!=null){if(++g,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(y=0;y<1024;++y)if(h.indexOf(h[x]+"_"+y)==-1){h[x]+="_"+y;break}}}}var m=Qe(o["!ref"]),S=[],w=[],_=[];for(x=0;x<=m.e.c-m.s.c;++x){var k="",N="",j=0,E=[];for(y=0;y<p.length;++y)p[y][x]!=null&&E.push(p[y][x]);if(E.length==0||h[x]==null){S[x]="?";continue}for(y=0;y<E.length;++y){switch(typeof E[y]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=E[y]instanceof Date?"D":"C";break;default:N="C"}j=Math.max(j,String(E[y]).length),k=k&&k!=N?"C":N}j>250&&(j=250),N=((v[x]||{}).DBF||{}).type,N=="C"&&v[x].DBF.len>j&&(j=v[x].DBF.len),k=="B"&&N=="N"&&(k="N",_[x]=v[x].DBF.dec,j=v[x].DBF.len),w[x]=k=="C"||N=="N"?j:i[k]||0,b+=w[x],S[x]=k}var O=f.next(32);for(O.write_shift(4,318902576),O.write_shift(4,p.length),O.write_shift(2,296+32*g),O.write_shift(2,b),x=0;x<4;++x)O.write_shift(4,0);for(O.write_shift(4,0|(+t[$C]||3)<<8),x=0,y=0;x<h.length;++x)if(h[x]!=null){var T=f.next(32),L=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,L,"sbcs"),T.write_shift(1,S[x]=="?"?"C":S[x],"sbcs"),T.write_shift(4,y),T.write_shift(1,w[x]||i[S[x]]||0),T.write_shift(1,_[x]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=w[x]||i[S[x]]||0}var X=f.next(264);for(X.write_shift(4,13),x=0;x<65;++x)X.write_shift(4,0);for(x=0;x<p.length;++x){var M=f.next(b);for(M.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(S[y]){case"L":M.write_shift(1,p[x][y]==null?63:p[x][y]?84:70);break;case"B":M.write_shift(8,p[x][y]||0,"f");break;case"N":var U="0";for(typeof p[x][y]=="number"&&(U=p[x][y].toFixed(_[y]||0)),g=0;g<w[y]-U.length;++g)M.write_shift(1,32);M.write_shift(1,U,"sbcs");break;case"D":p[x][y]?(M.write_shift(4,("0000"+p[x][y].getFullYear()).slice(-4),"sbcs"),M.write_shift(2,("00"+(p[x][y].getMonth()+1)).slice(-2),"sbcs"),M.write_shift(2,("00"+p[x][y].getDate()).slice(-2),"sbcs")):M.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[x][y]!=null?p[x][y]:"").slice(0,w[y]);for(M.write_shift(1,q,"sbcs"),g=0;g<w[y]-q.length;++g)M.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),YP=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var v=e[p];return typeof v=="number"?ej(v):v},n=function(h,p,v){var x=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?h:ej(x)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return i(Rn(h),p);case"binary":return i(h,p);case"buffer":return i(Ve&&Buffer.isBuffer(h)?h.toString("binary"):bs(h),p);case"array":return i(mo(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var v=h.split(/[\n\r]+/),x=-1,y=-1,g=0,b=0,m=[],S=[],w=null,_={},k=[],N=[],j=[],E=0,O;for(+p.codepage>=0&&ka(+p.codepage);g!==v.length;++g){E=0;var T=v[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),L=T.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),X=L[0],M;if(T.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&S.push(T.slice(3).replace(/;;/g,";"));break;case"C":var U=!1,q=!1,K=!1,F=!1,Q=-1,ie=-1;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"A":break;case"X":y=parseInt(L[b].slice(1))-1,q=!0;break;case"Y":for(x=parseInt(L[b].slice(1))-1,q||(y=0),O=m.length;O<=x;++O)m[O]=[];break;case"K":M=L[b].slice(1),M.charAt(0)==='"'?M=M.slice(1,M.length-1):M==="TRUE"?M=!0:M==="FALSE"?M=!1:isNaN(Oa(M))?isNaN(rc(M).getDate())||(M=_t(M)):(M=Oa(M),w!==null&&Tc(w)&&(M=Hm(M))),U=!0;break;case"E":F=!0;var A=_l(L[b].slice(1),{r:x,c:y});m[x][y]=[m[x][y],A];break;case"S":K=!0,m[x][y]=[m[x][y],"S5S"];break;case"G":break;case"R":Q=parseInt(L[b].slice(1))-1;break;case"C":ie=parseInt(L[b].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(U&&(m[x][y]&&m[x][y].length==2?m[x][y][0]=M:m[x][y]=M,w=null),K){if(F)throw new Error("SYLK shared formula cannot have own formula");var R=Q>-1&&m[Q][ie];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");m[x][y][1]=p5(R[1],{r:x-Q,c:y-ie})}break;case"F":var D=0;for(b=1;b<L.length;++b)switch(L[b].charAt(0)){case"X":y=parseInt(L[b].slice(1))-1,++D;break;case"Y":for(x=parseInt(L[b].slice(1))-1,O=m.length;O<=x;++O)m[O]=[];break;case"M":E=parseInt(L[b].slice(1))/20;break;case"F":break;case"G":break;case"P":w=S[parseInt(L[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=L[b].slice(1).split(" "),O=parseInt(j[0],10);O<=parseInt(j[1],10);++O)E=parseInt(j[2],10),N[O-1]=E===0?{hidden:!0}:{wch:E},ss(N[O-1]);break;case"C":y=parseInt(L[b].slice(1))-1,N[y]||(N[y]={});break;case"R":x=parseInt(L[b].slice(1))-1,k[x]||(k[x]={}),E>0?(k[x].hpt=E,k[x].hpx=ac(E)):E===0&&(k[x].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}D<1&&(w=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return k.length>0&&(_["!rows"]=k),N.length>0&&(_["!cols"]=N),p&&p.sheetRows&&(m=m.slice(0,p.sheetRows)),[m,_]}function s(h,p){var v=a(h,p),x=v[0],y=v[1],g=Oc(x,p);return Bt(y).forEach(function(b){g[b]=y[b]}),g}function o(h,p){return ws(s(h,p),p)}function c(h,p,v,x){var y="C;Y"+(v+1)+";X"+(x+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+jw(h.f,{r:v,c:x}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(v,x){var y="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Wf(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Hf(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function f(h,p){p.forEach(function(v,x){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*Vf(v.hpx)+";"),y.length>2&&h.push(y+"R"+(x+1))})}function d(h,p){var v=["ID;PWXL;N;E"],x=[],y=Qe(h["!ref"]),g,b=Array.isArray(h),m=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&u(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var w=y.s.c;w<=y.e.c;++w){var _=Fe({r:S,c:w});g=b?(h[S]||[])[w]:h[_],!(!g||g.v==null&&(!g.f||g.F))&&x.push(c(g,h,S,w))}return v.join(m)+m+x.join(m)+m+"E"+m}return{to_workbook:o,to_sheet:s,from_sheet:d}}(),QP=function(){function e(i,s){switch(s.type){case"base64":return t(Rn(i),s);case"binary":return t(i,s);case"buffer":return t(Ve&&Buffer.isBuffer(i)?i.toString("binary"):bs(i),s);case"array":return t(mo(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var h=o[f].trim().split(","),p=h[0],v=h[1];++f;for(var x=o[f]||"";(x.match(/["]/g)||[]).length&1&&f<o.length-1;)x+=`
`+o[++f];switch(x=x.trim(),+p){case-1:if(x==="BOT"){d[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?d[c][u]=!0:x==="FALSE"?d[c][u]=!1:isNaN(Oa(v))?isNaN(rc(v).getDate())?d[c][u]=v:d[c][u]=_t(v):d[c][u]=Oa(v),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),d[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(i,s){return Oc(e(i,s),s)}function n(i,s){return ws(r(i,s),s)}var a=function(){var i=function(c,u,f,d,h){c.push(u),c.push(f+","+d),c.push('"'+h.replace(/"/g,'""')+'"')},s=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=Qe(c["!ref"]),d,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,f.e.r-f.s.r+1,""),i(u,"TUPLES",0,f.e.c-f.s.c+1,""),i(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){s(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var x=Fe({r:p,c:v});if(d=h?(c[p]||[])[v]:c[x],!d){s(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,y,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=la(d.z||Me[14],ur(_t(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var g=`\r
`,b=u.join(g);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),ZP=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),v=-1,x=-1,y=0,g=[];y!==p.length;++y){var b=p[y].trim().split(":");if(b[0]==="cell"){var m=Pt(b[1]);if(g.length<=m.r)for(v=g.length;v<=m.r;++v)g[v]||(g[v]=[]);switch(v=m.r,x=m.c,b[2]){case"t":g[v][x]=e(b[3]);break;case"v":g[v][x]=+b[3];break;case"vtf":var S=b[b.length-1];case"vtc":switch(b[3]){case"nl":g[v][x]=!!+b[4];break;default:g[v][x]=+b[4];break}b[2]=="vtf"&&(g[v][x]=[g[v][x],S])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(d,h){return Oc(r(d,h),h)}function a(d,h){return ws(n(d,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],v,x="",y=yn(d["!ref"]),g=Array.isArray(d),b=y.s.r;b<=y.e.r;++b)for(var m=y.s.c;m<=y.e.c;++m)if(x=Fe({r:b,c:m}),v=g?(d[b]||[])[m]:d[x],!(!v||v.v==null||v.t==="z")){switch(p=["cell",x,"t"],v.t){case"s":case"str":p.push(t(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=t(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var S=ur(_t(v.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=v.w||la(v.z||Me[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[i,s,o,s,u(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),nc=function(){function e(f,d,h,p,v){v.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Oa(f))?isNaN(rc(f).getDate())?d[h][p]=f:d[h][p]=_t(f):d[h][p]=Oa(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var y=10,g=0,b=0;b<=x;++b)g=v[b].indexOf(" "),g==-1?g=v[b].length:g++,y=Math.max(y,g);for(b=0;b<=x;++b){p[b]=[];var m=0;for(e(v[b].slice(0,y).trim(),p,b,m,h),m=1;m<=(v[b].length-y)/10+1;++m)e(v[b].slice(y+(m-1)*10,y+m*10).trim(),p,b,m,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?h=!h:!h&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p]);if(!v.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p])}return v.sort(function(x,y){return x[0]-y[0]||n[x[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(f,d){var h=d||{},p="",v=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=a(f.slice(0,1024)):h&&h.FS?p=h.FS:p=a(f.slice(0,1024));var y=0,g=0,b=0,m=0,S=0,w=p.charCodeAt(0),_=!1,k=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=h.dateNF!=null?Hle(h.dateNF):null;function E(){var O=f.slice(m,S),T={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)T.t="z";else if(h.raw)T.t="s",T.v=O;else if(O.trim().length===0)T.t="s",T.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(T.t="s",T.v=O.slice(2,-1).replace(/""/g,'"')):yhe(O)?(T.t="n",T.f=O.slice(1)):(T.t="s",T.v=O);else if(O=="TRUE")T.t="b",T.v=!0;else if(O=="FALSE")T.t="b",T.v=!1;else if(!isNaN(b=Oa(O)))T.t="n",h.cellText!==!1&&(T.w=O),T.v=b;else if(!isNaN(rc(O).getDate())||j&&O.match(j)){T.z=h.dateNF||Me[14];var L=0;j&&O.match(j)&&(O=Vle(O,h.dateNF,O.match(j)||[]),L=1),h.cellDates?(T.t="d",T.v=_t(O,L)):(T.t="n",T.v=ur(_t(O,L))),h.cellText!==!1&&(T.w=la(T.z,T.v instanceof Date?ur(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=O;if(T.t=="z"||(h.dense?(v[y]||(v[y]=[]),v[y][g]=T):v[Fe({c:g,r:y})]=T),m=S+1,N=f.charCodeAt(m),x.e.c<g&&(x.e.c=g),x.e.r<y&&(x.e.r=y),k==w)++g;else if(g=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;S<f.length;++S)switch(k=f.charCodeAt(S)){case 34:N===34&&(_=!_);break;case w:case 10:case 13:if(!_&&E())break e;break}return S-m>0&&E(),v["!ref"]=Be(x),v}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):Oc(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:Fw(f,d);switch(d.type){case"base64":h=Rn(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Df<"u"||(h=Ve&&Buffer.isBuffer(f)?f.toString("binary"):bs(f));break;case"array":h=mo(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=ct(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ct(h):d.type=="binary"&&typeof Df<"u",h.slice(0,19)=="socialcalc:version:"?ZP.to_sheet(d.type=="string"?h:ct(h),d):s(h,d)}function c(f,d){return ws(o(f,d),d)}function u(f){for(var d=[],h=Qe(f["!ref"]),p,v=Array.isArray(f),x=h.s.r;x<=h.e.r;++x){for(var y=[],g=h.s.c;g<=h.e.c;++g){var b=Fe({r:x,c:g});if(p=v?(f[x]||[])[g]:f[b],!p||p.v==null){y.push("          ");continue}for(var m=(p.w||(Ni(p),p.w)||"").slice(0,10);m.length<10;)m+=" ";y.push(m+(g===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function i0e(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=YP.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return nc.to_workbook(e,t)}}var Js=function(){function e(A,R,D){if(A){jr(A,A.l||0);for(var H=D.Enum||Q;A.l<A.length;){var J=A.read_shift(2),ue=H[J]||H[65535],le=A.read_shift(2),Z=A.l+le,ee=ue.f&&ue.f(A,le,D);if(A.l=Z,R(ee,ue,J))return}}}function t(A,R){switch(R.type){case"base64":return r(An(Rn(A)),R);case"binary":return r(An(A),R);case"buffer":case"array":return r(A,R)}throw"Unsupported type "+R.type}function r(A,R){if(!A)return A;var D=R||{},H=D.dense?[]:{},J="Sheet1",ue="",le=0,Z={},ee=[],fe=[],P={s:{r:0,c:0},e:{r:0,c:0}},ke=D.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)D.Enum=Q,e(A,function(he,We,mt){switch(mt){case 0:D.vers=he,he>=4096&&(D.qpro=!0);break;case 6:P=he;break;case 204:he&&(ue=he);break;case 222:ue=he;break;case 15:case 51:D.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:mt==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=D.dateNF||Me[14],D.cellDates&&(he[1].t="d",he[1].v=Hm(he[1].v))),D.qpro&&he[3]>le&&(H["!ref"]=Be(P),Z[J]=H,ee.push(J),H=D.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},le=he[3],J=ue||"Sheet"+(le+1),ue="");var rr=D.dense?(H[he[0].r]||[])[he[0].c]:H[Fe(he[0])];if(rr){rr.t=he[1].t,rr.v=he[1].v,he[1].z!=null&&(rr.z=he[1].z),he[1].f!=null&&(rr.f=he[1].f);break}D.dense?(H[he[0].r]||(H[he[0].r]=[]),H[he[0].r][he[0].c]=he[1]):H[Fe(he[0])]=he[1];break}},D);else if(A[2]==26||A[2]==14)D.Enum=ie,A[2]==14&&(D.qpro=!0,A.l=0),e(A,function(he,We,mt){switch(mt){case 204:J=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>le&&(H["!ref"]=Be(P),Z[J]=H,ee.push(J),H=D.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},le=he[3],J="Sheet"+(le+1)),ke>0&&he[0].r>=ke)break;D.dense?(H[he[0].r]||(H[he[0].r]=[]),H[he[0].r][he[0].c]=he[1]):H[Fe(he[0])]=he[1],P.e.c<he[0].c&&(P.e.c=he[0].c),P.e.r<he[0].r&&(P.e.r=he[0].r);break;case 27:he[14e3]&&(fe[he[14e3][0]]=he[14e3][1]);break;case 1537:fe[he[0]]=he[1],he[0]==le&&(J=he[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(H["!ref"]=Be(P),Z[ue||J]=H,ee.push(ue||J),!fe.length)return{SheetNames:ee,Sheets:Z};for(var be={},Te=[],Ae=0;Ae<fe.length;++Ae)Z[ee[Ae]]?(Te.push(fe[Ae]||ee[Ae]),be[fe[Ae]]=Z[fe[Ae]]||Z[ee[Ae]]):(Te.push(fe[Ae]),be[fe[Ae]]={"!ref":"A1"});return{SheetNames:Te,Sheets:be}}function n(A,R){var D=R||{};if(+D.codepage>=0&&ka(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var H=mn(),J=Qe(A["!ref"]),ue=Array.isArray(A),le=[];ye(H,0,i(1030)),ye(H,6,c(J));for(var Z=Math.min(J.e.r,8191),ee=J.s.r;ee<=Z;++ee)for(var fe=Vt(ee),P=J.s.c;P<=J.e.c;++P){ee===J.s.r&&(le[P]=Ct(P));var ke=le[P]+fe,be=ue?(A[ee]||[])[P]:A[ke];if(!(!be||be.t=="z"))if(be.t=="n")(be.v|0)==be.v&&be.v>=-32768&&be.v<=32767?ye(H,13,p(ee,P,be.v)):ye(H,14,x(ee,P,be.v));else{var Te=Ni(be);ye(H,15,d(ee,P,Te.slice(0,239)))}}return ye(H,1),H.end()}function a(A,R){var D=R||{};if(+D.codepage>=0&&ka(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var H=mn();ye(H,0,s(A));for(var J=0,ue=0;J<A.SheetNames.length;++J)(A.Sheets[A.SheetNames[J]]||{})["!ref"]&&ye(H,27,F(A.SheetNames[J],ue++));var le=0;for(J=0;J<A.SheetNames.length;++J){var Z=A.Sheets[A.SheetNames[J]];if(!(!Z||!Z["!ref"])){for(var ee=Qe(Z["!ref"]),fe=Array.isArray(Z),P=[],ke=Math.min(ee.e.r,8191),be=ee.s.r;be<=ke;++be)for(var Te=Vt(be),Ae=ee.s.c;Ae<=ee.e.c;++Ae){be===ee.s.r&&(P[Ae]=Ct(Ae));var he=P[Ae]+Te,We=fe?(Z[be]||[])[Ae]:Z[he];if(!(!We||We.t=="z"))if(We.t=="n")ye(H,23,E(be,Ae,le,We.v));else{var mt=Ni(We);ye(H,22,k(be,Ae,le,mt.slice(0,239)))}}++le}}return ye(H,1),H.end()}function i(A){var R=se(2);return R.write_shift(2,A),R}function s(A){var R=se(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var D=0,H=0,J=0,ue=0;ue<A.SheetNames.length;++ue){var le=A.SheetNames[ue],Z=A.Sheets[le];if(!(!Z||!Z["!ref"])){++J;var ee=yn(Z["!ref"]);D<ee.e.r&&(D=ee.e.r),H<ee.e.c&&(H=ee.e.c)}}return D>8191&&(D=8191),R.write_shift(2,D),R.write_shift(1,J),R.write_shift(1,H),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(A,R,D){var H={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&D.qpro?(H.s.c=A.read_shift(1),A.l++,H.s.r=A.read_shift(2),H.e.c=A.read_shift(1),A.l++,H.e.r=A.read_shift(2),H):(H.s.c=A.read_shift(2),H.s.r=A.read_shift(2),R==12&&D.qpro&&(A.l+=2),H.e.c=A.read_shift(2),H.e.r=A.read_shift(2),R==12&&D.qpro&&(A.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(A){var R=se(8);return R.write_shift(2,A.s.c),R.write_shift(2,A.s.r),R.write_shift(2,A.e.c),R.write_shift(2,A.e.r),R}function u(A,R,D){var H=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(H[0].c=A.read_shift(1),H[3]=A.read_shift(1),H[0].r=A.read_shift(2),A.l+=2):(H[2]=A.read_shift(1),H[0].c=A.read_shift(2),H[0].r=A.read_shift(2)),H}function f(A,R,D){var H=A.l+R,J=u(A,R,D);if(J[1].t="s",D.vers==20768){A.l++;var ue=A.read_shift(1);return J[1].v=A.read_shift(ue,"utf8"),J}return D.qpro&&A.l++,J[1].v=A.read_shift(H-A.l,"cstr"),J}function d(A,R,D){var H=se(7+D.length);H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,A),H.write_shift(1,39);for(var J=0;J<H.length;++J){var ue=D.charCodeAt(J);H.write_shift(1,ue>=128?95:ue)}return H.write_shift(1,0),H}function h(A,R,D){var H=u(A,R,D);return H[1].v=A.read_shift(2,"i"),H}function p(A,R,D){var H=se(7);return H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,A),H.write_shift(2,D,"i"),H}function v(A,R,D){var H=u(A,R,D);return H[1].v=A.read_shift(8,"f"),H}function x(A,R,D){var H=se(13);return H.write_shift(1,255),H.write_shift(2,R),H.write_shift(2,A),H.write_shift(8,D,"f"),H}function y(A,R,D){var H=A.l+R,J=u(A,R,D);if(J[1].v=A.read_shift(8,"f"),D.qpro)A.l=H;else{var ue=A.read_shift(2);S(A.slice(A.l,A.l+ue),J),A.l+=ue}return J}function g(A,R,D){var H=R&32768;return R&=-32769,R=(H?A:0)+(R>=8192?R-16384:R),(H?"":"$")+(D?Ct(R):Vt(R))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},m=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(A,R){jr(A,0);for(var D=[],H=0,J="",ue="",le="",Z="";A.l<A.length;){var ee=A[A.l++];switch(ee){case 0:D.push(A.read_shift(8,"f"));break;case 1:ue=g(R[0].c,A.read_shift(2),!0),J=g(R[0].r,A.read_shift(2),!1),D.push(ue+J);break;case 2:{var fe=g(R[0].c,A.read_shift(2),!0),P=g(R[0].r,A.read_shift(2),!1);ue=g(R[0].c,A.read_shift(2),!0),J=g(R[0].r,A.read_shift(2),!1),D.push(fe+P+":"+ue+J)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(A.read_shift(2));break;case 6:{for(var ke="";ee=A[A.l++];)ke+=String.fromCharCode(ee);D.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:Z=D.pop(),le=D.pop(),D.push(["AND","OR"][ee-20]+"("+le+","+Z+")");break;default:if(ee<32&&m[ee])Z=D.pop(),le=D.pop(),D.push(le+m[ee]+Z);else if(b[ee]){if(H=b[ee][1],H==69&&(H=A[A.l++]),H>D.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+D.join("|")+"|");return}var be=D.slice(-H);D.length-=H,D.push(b[ee][0]+"("+be.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}D.length==1?R[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function w(A){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=A.read_shift(2),R[3]=A[A.l++],R[0].c=A[A.l++],R}function _(A,R){var D=w(A);return D[1].t="s",D[1].v=A.read_shift(R-4,"cstr"),D}function k(A,R,D,H){var J=se(6+H.length);J.write_shift(2,A),J.write_shift(1,D),J.write_shift(1,R),J.write_shift(1,39);for(var ue=0;ue<H.length;++ue){var le=H.charCodeAt(ue);J.write_shift(1,le>=128?95:le)}return J.write_shift(1,0),J}function N(A,R){var D=w(A);D[1].v=A.read_shift(2);var H=D[1].v>>1;if(D[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return D[1].v=H,D}function j(A,R){var D=w(A),H=A.read_shift(4),J=A.read_shift(4),ue=A.read_shift(2);if(ue==65535)return H===0&&J===3221225472?(D[1].t="e",D[1].v=15):H===0&&J===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var le=ue&32768;return ue=(ue&32767)-16446,D[1].v=(1-le*2)*(J*Math.pow(2,ue+32)+H*Math.pow(2,ue)),D}function E(A,R,D,H){var J=se(14);if(J.write_shift(2,A),J.write_shift(1,D),J.write_shift(1,R),H==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ue=0,le=0,Z=0,ee=0;return H<0&&(ue=1,H=-H),le=Math.log2(H)|0,H/=Math.pow(2,le-31),ee=H>>>0,ee&2147483648||(H/=2,++le,ee=H>>>0),H-=ee,ee|=2147483648,ee>>>=0,H*=Math.pow(2,32),Z=H>>>0,J.write_shift(4,Z),J.write_shift(4,ee),le+=16383+(ue?32768:0),J.write_shift(2,le),J}function O(A,R){var D=j(A);return A.l+=R-14,D}function T(A,R){var D=w(A),H=A.read_shift(4);return D[1].v=H>>6,D}function L(A,R){var D=w(A),H=A.read_shift(8,"f");return D[1].v=H,D}function X(A,R){var D=L(A);return A.l+=R-10,D}function M(A,R){return A[A.l+R-1]==0?A.read_shift(R,"cstr"):""}function U(A,R){var D=A[A.l++];D>R-1&&(D=R-1);for(var H="";H.length<D;)H+=String.fromCharCode(A[A.l++]);return H}function q(A,R,D){if(!(!D.qpro||R<21)){var H=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var J=A.read_shift(R-21,"cstr");return[H,J]}}function K(A,R){for(var D={},H=A.l+R;A.l<H;){var J=A.read_shift(2);if(J==14e3){for(D[J]=[0,""],D[J][0]=A.read_shift(2);A[A.l];)D[J][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return D}function F(A,R){var D=se(5+A.length);D.write_shift(2,14e3),D.write_shift(2,R);for(var H=0;H<A.length;++H){var J=A.charCodeAt(H);D[D.l++]=J>127?95:J}return D[D.l++]=0,D}var Q={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:M},222:{n:"SHEETNAMELP",f:U},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:M},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function s0e(e){var t={},r=e.match(qr),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=De(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Qb[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var o0e=function(){var e=$f("t"),t=$f("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Ye(s[1])},c=i.match(t);return c&&(o.s=s0e(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),l0e=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),c0e=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,u0e=/<(?:\w+:)?r>/,f0e=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ww(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ye(ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ct(e),r&&(n.h=ow(n.t))):e.match(u0e)&&(n.r=ct(e),n.t=Ye(ct((e.replace(f0e,"").match(c0e)||[]).join("").replace(qr,""))),r&&(n.h=l0e(o0e(n.r)))),n):{t:""}}var d0e=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,h0e=/<(?:\w+:)?(?:si|sstItem)>/g,p0e=/<\/(?:\w+:)?(?:si|sstItem)>/;function m0e(e,t){var r=[],n="";if(!e)return r;var a=e.match(d0e);if(a){n=a[2].replace(h0e,"").split(p0e);for(var i=0;i!=n.length;++i){var s=ww(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=De(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var x0e=/^\s|\s$|[\t\n\r]/;function JP(e,t){if(!t.bookSST)return"";var r=[Gt];r[r.length]=ge("sst",null,{xmlns:Eo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(x0e)&&(i+=' xml:space="preserve"'),i+=">"+at(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function v0e(e){return[e.read_shift(4),e.read_shift(4)]}function g0e(e,t){var r=[],n=!1;return Mi(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function y0e(e,t){return t||(t=se(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var b0e=Oce;function w0e(e){var t=mn();de(t,159,y0e(e));for(var r=0;r<e.length;++r)de(t,19,b0e(e[r]));return de(t,160),t.end()}function e5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function vi(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function _0e(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=vi(e,4),t.U=vi(e,4),t.W=vi(e,4),t}function S0e(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function k0e(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(S0e(e));return t}function N0e(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function j0e(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=vi(e,4),t.U=vi(e,4),t.W=vi(e,4),t}function E0e(e){var t=j0e(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function t5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function r5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function T0e(e){var t=vi(e);switch(t.Minor){case 2:return[t.Minor,A0e(e)];case 3:return[t.Minor,O0e()];case 4:return[t.Minor,C0e(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function A0e(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=t5(e,r),a=r5(e,e.length-e.l);return{t:"Std",h:n,v:a}}function O0e(){throw new Error("File is password-protected: ECMA-376 Extensible")}function C0e(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(qr,function(i){var s=De(i);switch(Ja(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function P0e(e,t){var r={},n=r.EncryptionVersionInfo=vi(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=t5(e,a),t-=a,r.EncryptionVerifier=r5(e,t),r}function M0e(e){var t={},r=t.EncryptionVersionInfo=vi(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function _w(e){var t=0,r,n=e5(e),a=n.length+1,i,s,o,c,u;for(r=is(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var n5=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],c=104,u=s.length-1;u>=0;--u)for(var f=s[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(s){for(var o=e5(s),c=i(o),u=o.length,f=is(16),d=0;d!=16;++d)f[d]=0;var h,p,v;for((u&1)===1&&(h=c>>8,f[u]=a(e[0],h),--u,h=c&255,p=o[o.length-1],f[u]=a(p,h));u>0;)--u,h=c>>8,f[u]=a(o[u],h),--u,h=c&255,f[u]=a(o[u],h);for(u=15,v=15-o.length;v>0;)h=c>>8,f[u]=a(e[v],h),--u,--v,h=c&255,f[u]=a(o[u],h),--u,--v;return f}}(),F0e=function(e,t,r,n,a){a||(a=t),n||(n=n5(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},D0e=function(e){var t=0,r=n5(e);return function(n){var a=F0e("",n,t,r);return t=a[1],a[0]}};function I0e(e,t,r,n){var a={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(a.verifier=_w(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=D0e(r.password)),a}function R0e(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=M0e(e):n.Data=P0e(e,t),n}function $0e(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?R0e(e,t-2,n):I0e(e,r.biff>=8?t:t-2,r,n),n}var a5=function(){function e(a,i){switch(i.type){case"base64":return t(Rn(a),i);case"binary":return t(a,i);case"buffer":return t(Ve&&Buffer.isBuffer(a)?a.toString("binary"):bs(a),i);case"array":return t(mo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,v,x=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var y=f.slice(p,h.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var g={v:y,t:"s"};Array.isArray(o)?o[d][x]=g:o[Fe({r:d,c:x})]=g}break}p=h.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Be(u),o}function r(a,i){return ws(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Qe(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=Fe({r:u,c:f});o=c?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ni(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function L0e(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function zf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function B0e(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,c=0,u=a+i;switch(c=s/(u>1?2-u:u),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,c,u/2]}function U0e(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,s[0]+=a,s[1]+=c;break;case 1:c=a*(2-o),s[0]+=c,s[1]+=a;break;case 2:c=a*(o-2),s[1]+=a,s[2]+=c;break;case 3:c=a*(4-o),s[1]+=c,s[2]+=a;break;case 4:c=a*(o-4),s[2]+=a,s[0]+=c;break;case 5:c=a*(6-o),s[2]+=c,s[0]+=a;break}for(var u=0;u!=3;++u)s[u]=Math.round(s[u]*255);return s}function pp(e,t){if(t===0)return e;var r=B0e(L0e(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),zf(U0e(r))}var i5=6,z0e=15,W0e=1,Ur=i5;function Wf(e){return Math.floor((e+Math.round(128/Ur)/256)*Ur)}function Hf(e){return Math.floor((e-5)/Ur*100+.5)/100}function mp(e){return Math.round((e*Ur+5)/Ur*256)/256}function sv(e){return mp(Hf(Wf(e)))}function Sw(e){var t=Math.abs(e-sv(e)),r=Ur;if(t>.005)for(Ur=W0e;Ur<z0e;++Ur)Math.abs(e-sv(e))<=t&&(t=Math.abs(e-sv(e)),r=Ur);Ur=r}function ss(e){e.width?(e.wpx=Wf(e.width),e.wch=Hf(e.wpx),e.MDW=Ur):e.wpx?(e.wch=Hf(e.wpx),e.width=mp(e.wch),e.MDW=Ur):typeof e.wch=="number"&&(e.width=mp(e.wch),e.wpx=Wf(e.width),e.MDW=Ur),e.customWidth&&delete e.customWidth}var H0e=96,s5=H0e;function Vf(e){return e*96/s5}function ac(e){return e*s5/96}var V0e={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function G0e(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(qr)||[]).forEach(function(s){var o=De(s);switch(Ja(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=bt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=bt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function X0e(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(qr)||[]).forEach(function(s){var o=De(s);switch(Ja(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function K0e(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(qr)||[]).forEach(function(s){var o=De(s);switch(Ja(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=ct(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?bt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?bt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?bt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?bt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?bt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?bt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?bt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Qb[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=bt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Qs[a.color.index];a.color.index==81&&(c=Qs[1]),c||(c=Qs[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=pp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function q0e(e,t,r){t.NumberFmt=[];for(var n=Bt(Me),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Me[n[a]];var i=e[0].match(qr);if(i)for(a=0;a<i.length;++a){var s=De(i[a]);switch(Ja(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ye(ct(s.formatCode)),c=parseInt(s.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}xi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Y0e(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ge("numFmt",null,{numFmtId:n,formatCode:at(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ge("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cd=["numFmtId","fillId","fontId","borderId","xfId"],ud=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Q0e(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(qr)||[]).forEach(function(i){var s=De(i),o=0;switch(Ja(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<cd.length;++o)n[cd[o]]&&(n[cd[o]]=parseInt(n[cd[o]],10));for(o=0;o<ud.length;++o)n[ud[o]]&&(n[ud[o]]=bt(n[ud[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=bt(s.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function Z0e(e){var t=[];return t[t.length]=ge("cellXfs",null),e.forEach(function(r){t[t.length]=ge("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ge("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var J0e=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&q0e(d,f,u),(d=o.match(a))&&K0e(d,f,c,u),(d=o.match(n))&&X0e(d,f,c,u),(d=o.match(i))&&G0e(d,f,c,u),(d=o.match(r))&&Q0e(d,f,u),f}}();function o5(e,t){var r=[Gt,ge("styleSheet",null,{xmlns:Eo[0],"xmlns:vt":or.vt})],n;return e.SSF&&(n=Y0e(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Z0e(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ede(e,t){var r=e.read_shift(2),n=Hr(e);return[r,n]}function tde(e,t,r){r||(r=se(6+4*t.length)),r.write_shift(2,e),yr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Rce(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Ice(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hr(e),n}function nde(e,t){t||(t=se(25+4*32)),t.write_shift(2,e.sz*20),$ce(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),fp(e.color,t);var n=0;return n=2,t.write_shift(1,n),yr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ade=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ov,ide=Kr;function Hj(e,t){t||(t=se(4*3+8*7+16*1)),ov||(ov=zm(ade));var r=ov[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(fp({auto:1},t),fp({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function sde(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function l5(e,t,r){r||(r=se(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function tu(e,t){return t||(t=se(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ode=Kr;function lde(e,t){return t||(t=se(51)),t.write_shift(1,0),tu(null,t),tu(null,t),tu(null,t),tu(null,t),tu(null,t),t.length>t.l?t.slice(0,t.l):t}function cde(e,t){return t||(t=se(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),up(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ude(e,t,r){var n=se(2052);return n.write_shift(4,e),up(t,n),up(r,n),n.length>n.l?n.slice(0,n.l):n}function fde(e,t,r){var n={};n.NumberFmt=[];for(var a in Me)n.NumberFmt[a]=Me[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return Mi(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],xi(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=pp(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(u.T>0)i.push(f);else if(u.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function dde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(de(e,615,Ca(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&de(e,44,tde(a,t[a]))}),de(e,616))}}function hde(e){var t=1;de(e,611,Ca(t)),de(e,43,nde({sz:12,color:{theme:1},name:"Calibri",family:2})),de(e,612)}function pde(e){var t=2;de(e,603,Ca(t)),de(e,45,Hj({patternType:"none"})),de(e,45,Hj({patternType:"gray125"})),de(e,604)}function mde(e){var t=1;de(e,613,Ca(t)),de(e,46,lde()),de(e,614)}function xde(e){var t=1;de(e,626,Ca(t)),de(e,47,l5({numFmtId:0},65535)),de(e,627)}function vde(e,t){de(e,617,Ca(t.length)),t.forEach(function(r){de(e,47,l5(r,0))}),de(e,618)}function gde(e){var t=1;de(e,619,Ca(t)),de(e,48,cde({xfId:0,name:"Normal"})),de(e,620)}function yde(e){var t=0;de(e,505,Ca(t)),de(e,506)}function bde(e){var t=0;de(e,508,ude(t,"TableStyleMedium9","PivotStyleMedium4")),de(e,509)}function wde(e,t){var r=mn();return de(r,278),dde(r,e.SSF),hde(r),pde(r),mde(r),xde(r),vde(r,t.cellXfs),gde(r),yde(r),bde(r),de(r,279),r.end()}var _de=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Sde(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(qr)||[]).forEach(function(a){var i=De(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[_de.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function kde(){}function Nde(){}var jde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ede=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Tde=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ade(e,t,r){t.themeElements={};var n;[["clrScheme",jde,Sde],["fontScheme",Ede,kde],["fmtScheme",Tde,Nde]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Ode=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function c5(e,t){(!e||e.length===0)&&(e=kw());var r,n={};if(!(r=e.match(Ode)))throw new Error("themeElements not found in theme");return Ade(r[0],n,t),n.raw=e,n}function kw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Gt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Cde(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=tP(i,{type:"array"})}catch{return}var o=On(s,"theme/theme/theme1.xml",!0);if(o)return c5(o,r)}}function Pde(e){return e.read_shift(4)}function Mde(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fde(e,4);break;case 2:t.xclrValue=zP(e);break;case 3:t.xclrValue=Pde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fde(e,t){return Kr(e,t)}function Dde(e,t){return Kr(e,t)}function Ide(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Mde(e);break;case 6:n[1]=Dde(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Rde(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(Ide(e,r-e.l));return{ixfe:n,ext:i}}function $de(e,t){t.forEach(function(r){switch(r[0]){}})}function Lde(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hr(e)}}function Bde(e){var t=se(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yr(e.name,t),t.slice(0,t.l)}function Ude(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zde(e){var t=se(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Wde(e,t){var r=se(8+2*t.length);return r.write_shift(4,e),yr(t,r),r.slice(0,r.l)}function Hde(e){return e.l+=4,e.read_shift(4)!=0}function Vde(e,t){var r=se(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Gde(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return Mi(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!u.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Xde(){var e=mn();return de(e,332),de(e,334,Ca(1)),de(e,335,Bde({name:"XLDAPR",version:12e4,flags:3496657072})),de(e,336),de(e,339,Wde(1,"XLDAPR")),de(e,52),de(e,35,Ca(514)),de(e,4096,Ca(0)),de(e,4097,Kn(1)),de(e,36),de(e,53),de(e,340),de(e,337,Vde(1)),de(e,51,zde([[1,0]])),de(e,338),de(e,333),e.end()}function Kde(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(qr,function(o){var c=De(o);switch(Ja(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(s=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):i==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function u5(){var e=[Gt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function qde(e){var t=[];if(!e)return t;var r=1;return(e.match(qr)||[]).forEach(function(n){var a=De(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Yde(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Fe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Qde(e,t,r){var n=[];return Mi(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Zde(e,t,r,n){if(!e)return e;var a=n||{},i=!1;Mi(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function Jde(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var ul=1024;function f5(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ge("xml",null,{"xmlns:v":jn.v,"xmlns:o":jn.o,"xmlns:x":jn.x,"xmlns:mv":jn.mv}).replace(/\/>/,">"),ge("o:shapelayout",ge("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ge("v:shapetype",[ge("v:stroke",null,{joinstyle:"miter"}),ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];ul<e*1e3;)ul+=1e3;return t.forEach(function(i){var s=Pt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ge("v:fill",c,o),f={on:"t",obscured:"t"};++ul,a=a.concat(["<v:shape"+Lf({id:"_x0000_s"+ul,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ge("v:shadow",null,f),ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Er("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Er("x:AutoFill","False"),Er("x:Row",String(s.r)),Er("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Vj(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=Pt(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var c=Qe(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Be(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:r};s.h&&(f.h=s.h);for(var d=i.c.length-1;d>=0;--d){if(!r&&i.c[d].T)return;r&&!i.c[d].T&&i.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}i.c.push(f)})}function ehe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=De(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Pt(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&ww(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function d5(e){var t=[Gt,ge("comments",null,{xmlns:Eo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=at(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(at(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(Er("t",at(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(Er("t",at(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function the(e,t){var r=[],n=!1,a={},i=0;return e.replace(qr,function(o,c){var u=De(o);switch(Ja(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":a.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function rhe(e,t,r){var n=[Gt,ge("ThreadedComments",null,{xmlns:or.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(ge("threadedComment",Er("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function nhe(e,t){var r=[],n=!1;return e.replace(qr,function(i){var s=De(i);switch(Ja(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function ahe(e){var t=[Gt,ge("personList",null,{xmlns:or.TCMNT,"xmlns:x":Eo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ihe(e){var t={};t.iauthor=e.read_shift(4);var r=Co(e);return t.rfx=r.s,t.ref=Fe(r.s),e.l+=16,t}function she(e,t){return t==null&&(t=se(36)),t.write_shift(4,e[1].iauthor),Cc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ohe=Hr;function lhe(e){return yr(e.slice(0,54))}function che(e,t){var r=[],n=[],a={},i=!1;return Mi(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function uhe(e){var t=mn(),r=[];return de(t,628),de(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),de(t,632,lhe(a.a)))})}),de(t,631),de(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Pt(n[0]),e:Pt(n[0])};de(t,635,she([i,a])),a.t&&a.t.length>0&&de(t,637,Pce(a)),de(t,636),delete a.iauthor})}),de(t,634),de(t,629),t.end()}var fhe="application/vnd.ms-office.vbaProject";function dhe(e){var t=Oe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Oe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Oe.write(t)}function hhe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Oe.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var h5=["xlsb","xlsm","xlam","biff8","xla"];function phe(){return{"!type":"dialog"}}function mhe(){return{"!type":"dialog"}}function xhe(){return{"!type":"macro"}}function vhe(){return{"!type":"macro"}}var _l=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,a+(o?"":"$")+Ct(f)+(c?"":"$")+Vt(u)}return function(a,i){return t=i,a.replace(e,r)}}(),Nw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,jw=function(){return function(t,r){return t.replace(Nw,function(n,a,i,s,o,c){var u=dw(s)-(i?0:r.c),f=fw(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":i?u+1:"["+u+"]";return a+"R"+d+"C"+h})}}();function p5(e,t){return e.replace(Nw,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Ct(dw(i)+t.c))+(s=="$"?s+o:Vt(fw(o)+t.r))})}function ghe(e,t,r){var n=yn(t),a=n.s,i=Pt(r),s={r:i.r-a.r,c:i.c-a.c};return p5(e,s)}function yhe(e){return e.length!=1}function Gj(e){return e.replace(/_xlfn\./g,"")}function qt(e){e.l+=1}function os(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m5(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return x5(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=os(e),o=os(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function x5(e){var t=os(e),r=os(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function bhe(e,t,r){if(r.biff<8)return x5(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=os(e),s=os(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function v5(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return whe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=os(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function whe(e){var t=os(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function _he(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function She(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return khe(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function khe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Nhe(e,t,r){var n=(e[e.l++]&96)>>5,a=m5(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function jhe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=m5(e,i,r);return[n,a,s]}function Ehe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function The(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Ahe(e,t,r){var n=(e[e.l++]&96)>>5,a=bhe(e,t-1,r);return[n,a]}function Ohe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Xj(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Che(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Phe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Mhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Fhe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Dhe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function g5(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Ihe(e){return e.read_shift(2),g5(e)}function Rhe(e){return e.read_shift(2),g5(e)}function $he(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=v5(e,0,r);return[n,a]}function Lhe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=She(e,0,r);return[n,a]}function Bhe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=v5(e,0,r);return[n,a,i]}function Uhe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Hpe[a],w5[a],n]}function zhe(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Whe(e);return[a,(i[0]===0?w5:Wpe)[i[1]]]}function Whe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hhe(e,t,r){e.l+=r&&r.biff==2?3:4}function Vhe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Ghe(e){return e.l++,Fi[e.read_shift(1)]}function Xhe(e){return e.l++,e.read_shift(2)}function Khe(e){return e.l++,e.read_shift(1)!==0}function qhe(e){return e.l++,Wr(e)}function Yhe(e,t,r){return e.l++,p0(e,t-1,r)}function Qhe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Fi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Wr(e);break;case 2:r[1]=Po(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Zhe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Co:Vm)(e));return a}function Jhe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Qhe(e,r.biff);return s}function epe(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function tpe(e,t,r){if(r.biff==5)return rpe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function rpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function npe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ape(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function ipe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function spe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var ope=Kr,lpe=Kr,cpe=Kr;function x0(e,t,r){return e.l+=2,[_he(e)]}function Ew(e){return e.l+=6,[]}var upe=x0,fpe=Ew,dpe=Ew,hpe=x0;function y5(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var ppe=x0,mpe=y5,xpe=Ew,vpe=x0,gpe=x0,ype=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bpe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=ype[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function wpe(e){return e.l+=2,[e.read_shift(4)]}function _pe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Spe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function kpe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Npe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jpe(e){return e.l+=4,[0,0]}var Kj={1:{n:"PtgExp",f:Vhe},2:{n:"PtgTbl",f:cpe},3:{n:"PtgAdd",f:qt},4:{n:"PtgSub",f:qt},5:{n:"PtgMul",f:qt},6:{n:"PtgDiv",f:qt},7:{n:"PtgPower",f:qt},8:{n:"PtgConcat",f:qt},9:{n:"PtgLt",f:qt},10:{n:"PtgLe",f:qt},11:{n:"PtgEq",f:qt},12:{n:"PtgGe",f:qt},13:{n:"PtgGt",f:qt},14:{n:"PtgNe",f:qt},15:{n:"PtgIsect",f:qt},16:{n:"PtgUnion",f:qt},17:{n:"PtgRange",f:qt},18:{n:"PtgUplus",f:qt},19:{n:"PtgUminus",f:qt},20:{n:"PtgPercent",f:qt},21:{n:"PtgParen",f:qt},22:{n:"PtgMissArg",f:qt},23:{n:"PtgStr",f:Yhe},26:{n:"PtgSheet",f:_pe},27:{n:"PtgEndSheet",f:Spe},28:{n:"PtgErr",f:Ghe},29:{n:"PtgBool",f:Khe},30:{n:"PtgInt",f:Xhe},31:{n:"PtgNum",f:qhe},32:{n:"PtgArray",f:Ohe},33:{n:"PtgFunc",f:Uhe},34:{n:"PtgFuncVar",f:zhe},35:{n:"PtgName",f:epe},36:{n:"PtgRef",f:$he},37:{n:"PtgArea",f:Nhe},38:{n:"PtgMemArea",f:npe},39:{n:"PtgMemErr",f:ope},40:{n:"PtgMemNoMem",f:lpe},41:{n:"PtgMemFunc",f:ape},42:{n:"PtgRefErr",f:ipe},43:{n:"PtgAreaErr",f:Ehe},44:{n:"PtgRefN",f:Lhe},45:{n:"PtgAreaN",f:Ahe},46:{n:"PtgMemAreaN",f:kpe},47:{n:"PtgMemNoMemN",f:Npe},57:{n:"PtgNameX",f:tpe},58:{n:"PtgRef3d",f:Bhe},59:{n:"PtgArea3d",f:jhe},60:{n:"PtgRefErr3d",f:spe},61:{n:"PtgAreaErr3d",f:The},255:{}},Epe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tpe={1:{n:"PtgElfLel",f:y5},2:{n:"PtgElfRw",f:vpe},3:{n:"PtgElfCol",f:upe},6:{n:"PtgElfRwV",f:gpe},7:{n:"PtgElfColV",f:hpe},10:{n:"PtgElfRadical",f:ppe},11:{n:"PtgElfRadicalS",f:xpe},13:{n:"PtgElfColS",f:fpe},15:{n:"PtgElfColSV",f:dpe},16:{n:"PtgElfRadicalLel",f:mpe},25:{n:"PtgList",f:bpe},29:{n:"PtgSxName",f:wpe},255:{}},Ape={0:{n:"PtgAttrNoop",f:jpe},1:{n:"PtgAttrSemi",f:Dhe},2:{n:"PtgAttrIf",f:Mhe},4:{n:"PtgAttrChoose",f:Che},8:{n:"PtgAttrGoto",f:Phe},16:{n:"PtgAttrSum",f:Hhe},32:{n:"PtgAttrBaxcel",f:Xj},33:{n:"PtgAttrBaxcel",f:Xj},64:{n:"PtgAttrSpace",f:Ihe},65:{n:"PtgAttrSpaceSemi",f:Rhe},128:{n:"PtgAttrIfError",f:Fhe},255:{}};function v0(e,t,r,n){if(n.biff<8)return Kr(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Jhe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Zhe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(Kr(e,t)),i}function g0(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Kj[i]||Kj[Epe[i]],(i===24||i===25)&&(a=(i===24?Tpe:Ape)[e[e.l+1]]),!a||!a.f?Kr(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Ope(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Cpe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Ppe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function b5(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function qj(e,t,r){var n=b5(e,t,r);return n=="#REF"?n:Ppe(n,r)}function $r(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},o=[],c,u,f,d=0,h=0,p,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,y="",g=0,b=e[0].length;g<b;++g){var m=e[0][g];switch(m[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:y=$t(" ",e[0][x][1][1]);break;case 1:y=$t("\r",e[0][x][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+y,x=-1}o.push(u+Cpe[m[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Au(m[1][1],s,a),o.push(Ou(f,i));break;case"PtgRefN":f=r?Au(m[1][1],r,a):m[1][1],o.push(Ou(f,i));break;case"PtgRef3d":d=m[1][1],f=Au(m[1][2],s,a),v=qj(n,d,a),o.push(v+"!"+Ou(f,i));break;case"PtgFunc":case"PtgFuncVar":var S=m[1][0],w=m[1][1];S||(S=0),S&=127;var _=S==0?[]:o.slice(-S);o.length-=S,w==="User"&&(w=_.shift()),o.push(w+"("+_.join(",")+")");break;case"PtgBool":o.push(m[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(m[1]);break;case"PtgNum":o.push(String(m[1]));break;case"PtgStr":o.push('"'+m[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(m[1]);break;case"PtgAreaN":p=kj(m[1][1],r?{s:r}:s,a),o.push(nv(p,a));break;case"PtgArea":p=kj(m[1][1],s,a),o.push(nv(p,a));break;case"PtgArea3d":d=m[1][1],p=m[1][2],v=qj(n,d,a),o.push(v+"!"+nv(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=m[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],N=k?k.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var j=m[1][1];h=m[1][2];var E;if(a.biff<=5)j<0&&(j=-j),n[j]&&(E=n[j][h]);else{var O="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][h]&&n[j][h].itab>0&&(O=n.SheetNames[n[j][h].itab-1]+"!"):O=n.SheetNames[h-1]+"!"),n[j]&&n[j][h])O+=n[j][h].Name;else if(n[0]&&n[0][h])O+=n[0][h].Name;else{var T=(b5(n,j,a)||"").split(";;");T[h-1]?O=T[h-1]:O+="SH33TJSERRX"}o.push(O);break}E||(E={Name:"SH33TJSERRY"}),o.push(E.Name);break;case"PtgParen":var L="(",X=")";if(x>=0){switch(y="",e[0][x][1][0]){case 2:L=$t(" ",e[0][x][1][1])+L;break;case 3:L=$t("\r",e[0][x][1][1])+L;break;case 4:X=$t(" ",e[0][x][1][1])+X;break;case 5:X=$t("\r",e[0][x][1][1])+X;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(L+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:m[1][1],r:m[1][0]};var M={c:r.c,r:r.r};if(n.sharedf[Fe(f)]){var U=n.sharedf[Fe(f)];o.push($r(U,s,M,n,a))}else{var q=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push($r(u[1],s,M,n,a)),q=!0;break}q||o.push(m[1])}break;case"PtgArray":o.push("{"+Ope(m[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+m[1].idx+"[#"+m[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(m));default:throw new Error("Unrecognized Formula Token: "+String(m))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&K.indexOf(e[0][g][0])==-1){m=e[0][x];var F=!0;switch(m[1][0]){case 4:F=!1;case 0:y=$t(" ",m[1][1]);break;case 5:F=!1;case 1:y=$t("\r",m[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+m[1][0])}o.push((F?y:"")+o.pop()+(F?"":y)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Mpe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Kr(e,t-2)];var o=g0(e,s,r);return t!==s+a&&(i=v0(e,t-s-a,o,r)),e.l=n,[o,i]}function Fpe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],Kr(e,t-2)];var o=g0(e,s,r);return t!==s+a&&(i=v0(e,t-s-a,o,r)),e.l=n,[o,i]}function Dpe(e,t,r,n){var a=e.l+t,i=g0(e,n,r),s;return a!==e.l&&(s=v0(e,a-e.l,i,r)),[i,s]}function Ipe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=g0(e,i,r);return i==65535?[[],Kr(e,t-2)]:(t!==i+2&&(a=v0(e,n-i-2,s,r)),[s,a])}function Rpe(e){var t;if(fi(e,e.l+6)!==65535)return[Wr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function $pe(e){if(e==null){var t=se(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return xo(e);return xo(0)}function lv(e,t,r){var n=e.l+t,a=ei(e);r.biff==2&&++e.l;var i=Rpe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Fpe(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Lpe(e,t,r,n,a){var i=go(t,r,a),s=$pe(e.v),o=se(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=se(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=vr([i,s,o,u]);return d}function Gm(e,t,r){var n=e.read_shift(4),a=g0(e,n,r),i=e.read_shift(4),s=i>0?v0(e,i,a,r):null;return[a,s]}var Bpe=Gm,Xm=Gm,Upe=Gm,zpe=Gm,Wpe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},w5={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hpe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Yj(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Vpe(e){var t="of:="+e.replace(Nw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function cv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Gpe(e){return e.replace(/\./,"!")}var Pu={},Sl={},Mu=typeof Map<"u";function Tw(e,t,r){var n=0,a=e.length;if(r){if(Mu?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Mu?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Mu?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Km(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ur=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Hf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=mp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function eo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _s(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){xi(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function _5(e,t,r,n,a,i){try{n.cellNF&&(e.z=Me[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=_t(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Me[t]==null&&xi(Wle[t]||"General",t),e.t==="e")e.w=e.w||Fi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v);else if(e.t==="d"){var s=ur(e.v);(s|0)===s?e.w=s.toString(10):e.w=Rf(s)}else{if(e.v===void 0)return"";e.w=po(e.v,Sl)}else e.t==="d"?e.w=la(t,ur(e.v),Sl):e.w=la(t,e.v,Sl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=pp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=pp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function Xpe(e,t,r){if(e&&e["!ref"]){var n=Qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Kpe(e,t){var r=Qe(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var qpe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ype=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Qpe=/<(?:\w:)?hyperlink [^>]*>/mg,Zpe=/"(\w*:\w*)"/,Jpe=/<(?:\w:)?col\b[^>]*[\/]?>/g,eme=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,tme=/<(?:\w:)?pageMargins[^>]*\/>/g,S5=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,rme=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,nme=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ame(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(Ype);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(S5);h?Aw(h[0],o,a,r):(h=u.match(rme))&&sme(h[0],h[1]||"",o,a,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=u.slice(p,p+50).match(Zpe);v&&Kpe(o,v[1])}var x=u.match(nme);x&&x[1]&&yme(x[1],a);var y=[];if(t.cellStyles){var g=u.match(Jpe);g&&pme(y,g)}d&&_me(d[1],o,t,c,i,s);var b=f.match(eme);b&&(o["!autofilter"]=xme(b[0]));var m=[],S=f.match(qpe);if(S)for(p=0;p!=S.length;++p)m[p]=Qe(S[p].slice(S[p].indexOf('"')+1));var w=f.match(Qpe);w&&fme(o,w,n);var _=f.match(tme);if(_&&(o["!margins"]=dme(De(_[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),t.sheetRows>0&&o["!ref"]){var k=Qe(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(k))}return y.length>0&&(o["!cols"]=y),m.length>0&&(o["!merges"]=m),o}function ime(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Be(e[r])+'"/>';return t+"</mergeCells>"}function Aw(e,t,r,n){var a=De(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ye(ct(a.codeName)))}function sme(e,t,r,n,a){Aw(e.slice(0,e.indexOf(">")),r,n,a)}function ome(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=Ua(at(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ge("outlinePr",null,u)}!i&&!o||(a[a.length]=ge("sheetPr",o,s))}var lme=["objects","scenarios","selectLockedCells","selectUnlockedCells"],cme=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ume(e){var t={sheet:1};return lme.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),cme.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=_w(e.password).toString(16).toUpperCase()),ge("sheetProtection",null,t)}function fme(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=De(ct(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Ye(i.location))):(i.Target="#"+Ye(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Qe(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=Fe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function dme(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function hme(e){return eo(e),ge("pageMargins",null,e)}function pme(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=De(t[n],!0);a.hidden&&(a.hidden=bt(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Sw(a.width)),ss(a);i<=s;)e[i++]=St(a)}}function mme(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ge("col",null,Km(a,n)));return r[r.length]="</cols>",r.join("")}function xme(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function vme(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Be(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=yn(a);s.s.r==s.e.r&&(s.e.r=yn(t["!ref"]).e.r,a=Be(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ge("autoFilter",null,{ref:a})}var gme=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function yme(e,t){t.Views||(t.Views=[{}]),(e.match(gme)||[]).forEach(function(r,n){var a=De(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),bt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function bme(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ge("sheetViews",ge("sheetView",null,a),{})}function wme(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Fi[e.v];break;case"d":n&&n.cellDates?a=_t(e.v,-1).toISOString():(e=St(e),e.t="n",a=""+(e.v=ur(_t(e.v)))),typeof e.z>"u"&&(e.z=Me[14]);break;default:a=e.v;break}var o=Er("v",at(a)),c={r:t},u=_s(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Er("v",""+Tw(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ge("f",at(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ge("c",o,c)}var _me=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=$f("v"),s=$f("f");return function(c,u,f,d,h,p){for(var v=0,x="",y=[],g=[],b=0,m=0,S=0,w="",_,k,N=0,j=0,E,O,T=0,L=0,X=Array.isArray(p.CellXf),M,U=[],q=[],K=Array.isArray(u),F=[],Q={},ie=!1,A=!!f.sheetStubs,R=c.split(t),D=0,H=R.length;D!=H;++D){x=R[D].trim();var J=x.length;if(J!==0){var ue=0;e:for(v=0;v<J;++v)switch(x[v]){case">":if(x[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(k=De(x.slice(ue,v),!0),N=k.r!=null?parseInt(k.r,10):N+1,j=-1,f.sheetRows&&f.sheetRows<N)continue;Q={},ie=!1,k.ht&&(ie=!0,Q.hpt=parseFloat(k.ht),Q.hpx=ac(Q.hpt)),k.hidden=="1"&&(ie=!0,Q.hidden=!0),k.outlineLevel!=null&&(ie=!0,Q.level=+k.outlineLevel),ie&&(F[N-1]=Q)}break;case"<":ue=v;break}if(ue>=v)break;if(k=De(x.slice(ue,v),!0),N=k.r!=null?parseInt(k.r,10):N+1,j=-1,!(f.sheetRows&&f.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),f&&f.cellStyles&&(Q={},ie=!1,k.ht&&(ie=!0,Q.hpt=parseFloat(k.ht),Q.hpx=ac(Q.hpt)),k.hidden=="1"&&(ie=!0,Q.hidden=!0),k.outlineLevel!=null&&(ie=!0,Q.level=+k.outlineLevel),ie&&(F[N-1]=Q)),y=x.slice(v).split(e);for(var le=0;le!=y.length&&y[le].trim().charAt(0)=="<";++le);for(y=y.slice(le),v=0;v!=y.length;++v)if(x=y[v].trim(),x.length!==0){if(g=x.match(r),b=v,m=0,S=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,g!=null&&g.length===2){for(b=0,w=g[1],m=0;m!=w.length&&!((S=w.charCodeAt(m)-64)<1||S>26);++m)b=26*b+S;--b,j=b}else++j;for(m=0;m!=x.length&&x.charCodeAt(m)!==62;++m);if(++m,k=De(x.slice(0,m),!0),k.r||(k.r=Fe({r:N-1,c:j})),w=x.slice(m),_={t:""},(g=w.match(i))!=null&&g[1]!==""&&(_.v=Ye(g[1])),f.cellFormula){if((g=w.match(s))!=null&&g[1]!==""){if(_.f=Ye(ct(g[1])).replace(/\r\n/g,`
`),f.xlfn||(_.f=Gj(_.f)),g[0].indexOf('t="array"')>-1)_.F=(w.match(a)||[])[1],_.F.indexOf(":")>-1&&U.push([Qe(_.F),_.F]);else if(g[0].indexOf('t="shared"')>-1){O=De(g[0]);var Z=Ye(ct(g[1]));f.xlfn||(Z=Gj(Z)),q[parseInt(O.si,10)]=[O,Z,k.r]}}else(g=w.match(/<f[^>]*\/>/))&&(O=De(g[0]),q[O.si]&&(_.f=ghe(q[O.si][1],q[O.si][2],k.r)));var ee=Pt(k.r);for(m=0;m<U.length;++m)ee.r>=U[m][0].s.r&&ee.r<=U[m][0].e.r&&ee.c>=U[m][0].s.c&&ee.c<=U[m][0].e.c&&(_.F=U[m][1])}if(k.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(A)_.t="z";else continue;else _.t=k.t||"n";switch(d.s.c>j&&(d.s.c=j),d.e.c<j&&(d.e.c=j),_.t){case"n":if(_.v==""||_.v==null){if(!A)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!A)continue;_.t="z"}else E=Pu[parseInt(_.v,10)],_.v=E.t,_.r=E.r,f.cellHTML&&(_.h=E.h);break;case"str":_.t="s",_.v=_.v!=null?ct(_.v):"",f.cellHTML&&(_.h=ow(_.v));break;case"inlineStr":g=w.match(n),_.t="s",g!=null&&(E=ww(g[1]))?(_.v=E.t,f.cellHTML&&(_.h=E.h)):_.v="";break;case"b":_.v=bt(_.v);break;case"d":f.cellDates?_.v=_t(_.v,1):(_.v=ur(_t(_.v,1)),_.t="n");break;case"e":(!f||f.cellText!==!1)&&(_.w=_.v),_.v=NP[_.v];break}if(T=L=0,M=null,X&&k.s!==void 0&&(M=p.CellXf[k.s],M!=null&&(M.numFmtId!=null&&(T=M.numFmtId),f.cellStyles&&M.fillId!=null&&(L=M.fillId))),_5(_,T,L,f,h,p),f.cellDates&&X&&_.t=="n"&&Tc(Me[T])&&(_.t="d",_.v=Hm(_.v)),k.cm&&f.xlmeta){var fe=(f.xlmeta.Cell||[])[+k.cm-1];fe&&fe.type=="XLDAPR"&&(_.D=!0)}if(K){var P=Pt(k.r);u[P.r]||(u[P.r]=[]),u[P.r][P.c]=_}else u[k.r]=_}}}}F.length>0&&(u["!rows"]=F)}}();function Sme(e,t,r,n){var a=[],i=[],s=Qe(e["!ref"]),o="",c,u="",f=[],d=0,h=0,p=e["!rows"],v=Array.isArray(e),x={r:u},y,g=-1;for(h=s.s.c;h<=s.e.c;++h)f[h]=Ct(h);for(d=s.s.r;d<=s.e.r;++d){for(i=[],u=Vt(d),h=s.s.c;h<=s.e.c;++h){c=f[h]+u;var b=v?(e[d]||[])[h]:e[c];b!==void 0&&(o=wme(b,c,e,t))!=null&&i.push(o)}(i.length>0||p&&p[d])&&(x={r:u},p&&p[d]&&(y=p[d],y.hidden&&(x.hidden=1),g=-1,y.hpx?g=Vf(y.hpx):y.hpt&&(g=y.hpt),g>-1&&(x.ht=g,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),a[a.length]=ge("row",i.join(""),x))}if(p)for(;d<p.length;++d)p&&p[d]&&(x={r:d+1},y=p[d],y.hidden&&(x.hidden=1),g=-1,y.hpx?g=Vf(y.hpx):y.hpt&&(g=y.hpt),g>-1&&(x.ht=g,x.customHeight=1),y.level&&(x.outlineLevel=y.level),a[a.length]=ge("row","",x));return a.join("")}function k5(e,t,r,n){var a=[Gt,ge("worksheet",null,{xmlns:Eo[0],"xmlns:r":or.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",f=Qe(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=Be(f)}n||(n={}),c["!comments"]=[];var d=[];ome(c,r,e,t,a),a[a.length]=ge("dimension",null,{ref:u}),a[a.length]=bme(c,t,e,r),t.sheetFormat&&(a[a.length]=ge("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=mme(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Sme(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=ume(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=vme(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=ime(c["!merges"]));var h=-1,p,v=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(p={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=nt(n,-1,at(x[1].Target).replace(/#.*$/,""),Ge.HLINK),p["r:id"]="rId"+v),(h=x[1].Target.indexOf("#"))>-1&&(p.location=at(x[1].Target.slice(h+1))),x[1].Tooltip&&(p.tooltip=at(x[1].Tooltip)),a[a.length]=ge("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=hme(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Er("ignoredErrors",ge("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=nt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ge.DRAW),a[a.length]=ge("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=d),c["!comments"].length>0&&(v=nt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ge.VML),a[a.length]=ge("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function kme(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Nme(e,t,r){var n=se(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Vf(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){u.c=p;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Fe(u)];v&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function jme(e,t,r,n){var a=Nme(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&de(e,0,a)}var Eme=Co,Tme=Cc;function Ame(){}function Ome(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Mce(e),r}function Cme(e,t,r){r==null&&(r=se(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return fp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),bP(e,r),r.slice(0,r.l)}function Pme(e){var t=ha(e);return[t]}function Mme(e,t,r){return r==null&&(r=se(8)),To(t,r)}function Fme(e){var t=Ao(e);return[t]}function Dme(e,t,r){return r==null&&(r=se(4)),Oo(t,r)}function Ime(e){var t=ha(e),r=e.read_shift(1);return[t,r,"b"]}function Rme(e,t,r){return r==null&&(r=se(9)),To(t,r),r.write_shift(1,e.v?1:0),r}function $me(e){var t=Ao(e),r=e.read_shift(1);return[t,r,"b"]}function Lme(e,t,r){return r==null&&(r=se(5)),Oo(t,r),r.write_shift(1,e.v?1:0),r}function Bme(e){var t=ha(e),r=e.read_shift(1);return[t,r,"e"]}function Ume(e,t,r){return r==null&&(r=se(9)),To(t,r),r.write_shift(1,e.v),r}function zme(e){var t=Ao(e),r=e.read_shift(1);return[t,r,"e"]}function Wme(e,t,r){return r==null&&(r=se(8)),Oo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Hme(e){var t=ha(e),r=e.read_shift(4);return[t,r,"s"]}function Vme(e,t,r){return r==null&&(r=se(12)),To(t,r),r.write_shift(4,t.v),r}function Gme(e){var t=Ao(e),r=e.read_shift(4);return[t,r,"s"]}function Xme(e,t,r){return r==null&&(r=se(8)),Oo(t,r),r.write_shift(4,t.v),r}function Kme(e){var t=ha(e),r=Wr(e);return[t,r,"n"]}function qme(e,t,r){return r==null&&(r=se(16)),To(t,r),xo(e.v,r),r}function N5(e){var t=Ao(e),r=Wr(e);return[t,r,"n"]}function Yme(e,t,r){return r==null&&(r=se(12)),Oo(t,r),xo(e.v,r),r}function Qme(e){var t=ha(e),r=xw(e);return[t,r,"n"]}function Zme(e,t,r){return r==null&&(r=se(12)),To(t,r),wP(e.v,r),r}function Jme(e){var t=Ao(e),r=xw(e);return[t,r,"n"]}function exe(e,t,r){return r==null&&(r=se(8)),Oo(t,r),wP(e.v,r),r}function txe(e){var t=ha(e),r=hw(e);return[t,r,"is"]}function rxe(e){var t=ha(e),r=Hr(e);return[t,r,"str"]}function nxe(e,t,r){return r==null&&(r=se(12+4*e.v.length)),To(t,r),yr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function axe(e){var t=Ao(e),r=Hr(e);return[t,r,"str"]}function ixe(e,t,r){return r==null&&(r=se(8+4*e.v.length)),Oo(t,r),yr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sxe(e,t,r){var n=e.l+t,a=ha(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Xm(e,n-e.l,r);s[3]=$r(o,null,a,r.supbooks,r)}else e.l=n;return s}function oxe(e,t,r){var n=e.l+t,a=ha(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Xm(e,n-e.l,r);s[3]=$r(o,null,a,r.supbooks,r)}else e.l=n;return s}function lxe(e,t,r){var n=e.l+t,a=ha(e);a.r=r["!row"];var i=Wr(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Xm(e,n-e.l,r);s[3]=$r(o,null,a,r.supbooks,r)}else e.l=n;return s}function cxe(e,t,r){var n=e.l+t,a=ha(e);a.r=r["!row"];var i=Hr(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Xm(e,n-e.l,r);s[3]=$r(o,null,a,r.supbooks,r)}else e.l=n;return s}var uxe=Co,fxe=Cc;function dxe(e,t){return t==null&&(t=se(4)),t.write_shift(4,e),t}function hxe(e,t){var r=e.l+t,n=Co(e),a=pw(e),i=Hr(e),s=Hr(e),o=Hr(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function pxe(e,t){var r=se(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Cc({s:Pt(e[0]),e:Pt(e[0])},r),mw("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return yr(a||"",r),yr(e[1].Tooltip||"",r),yr("",r),r.slice(0,r.l)}function mxe(){}function xxe(e,t,r){var n=e.l+t,a=_P(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=Bpe(e,n-e.l,r);s[1]=o}else e.l=n;return s}function vxe(e,t,r){var n=e.l+t,a=Co(e),i=[a];if(r.cellFormula){var s=zpe(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function gxe(e,t,r){r==null&&(r=se(18));var n=Km(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var j5=["left","right","top","bottom","header","footer"];function yxe(e){var t={};return j5.forEach(function(r){t[r]=Wr(e)}),t}function bxe(e,t){return t==null&&(t=se(6*8)),eo(e),j5.forEach(function(r){xo(e[r],t)}),t}function wxe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function _xe(e,t,r){r==null&&(r=se(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Sxe(e){var t=se(24);return t.write_shift(4,4),t.write_shift(4,1),Cc(e,t),t}function kxe(e,t){return t==null&&(t=se(16*4+2)),t.write_shift(2,e.password?_w(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Nxe(){}function jxe(){}function Exe(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,v,x,y,g,b,m,S,w,_=[];o.biff=12,o["!row"]=0;var k=0,N=!1,j=[],E={},O=o.supbooks||a.supbooks||[[]];if(O.sharedf=E,O.arrayf=j,O.SheetNames=a.SheetNames||a.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=O,a.Names))for(var T=0;T<a.Names.length;++T)O[0][T+1]=a.Names[T];var L=[],X=[],M=!1;Gf[16]={n:"BrtShortReal",f:N5};var U;if(Mi(e,function(F,Q,ie){if(!h)switch(ie){case 148:u=F;break;case 0:p=F,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),S=Vt(y=p.r),o["!row"]=p.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=ac(F.hpt)),X[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:F[2]},F[2]){case"n":v.v=F[1];break;case"s":m=Pu[F[1]],v.v=m.t,v.r=m.r;break;case"b":v.v=!!F[1];break;case"e":v.v=F[1],o.cellText!==!1&&(v.w=Fi[v.v]);break;case"str":v.t="s",v.v=F[1];break;case"is":v.t="s",v.v=F[1].t;break}if((x=s.CellXf[F[0].iStyleRef])&&_5(v,x.numFmtId,null,o,i,s),g=F[0].c==-1?g+1:F[0].c,o.dense?(c[y]||(c[y]=[]),c[y][g]=v):c[Ct(g)+S]=v,o.cellFormula){for(N=!1,k=0;k<j.length;++k){var A=j[k];p.r>=A[0].s.r&&p.r<=A[0].e.r&&g>=A[0].s.c&&g<=A[0].e.c&&(v.F=Be(A[0]),N=!0)}!N&&F.length>3&&(v.f=F[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),o.cellDates&&x&&v.t=="n"&&Tc(Me[x.numFmtId])){var R=Gs(v.v);R&&(v.t="d",v.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}U&&(U.type=="XLDAPR"&&(v.D=!0),U=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;v={t:"z",v:void 0},g=F[0].c==-1?g+1:F[0].c,o.dense?(c[y]||(c[y]=[]),c[y][g]=v):c[Ct(g)+S]=v,f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),U&&(U.type=="XLDAPR"&&(v.D=!0),U=void 0);break;case 176:_.push(F);break;case 49:U=((o.xlmeta||{}).Cell||[])[F-1];break;case 494:var D=n["!id"][F.relId];for(D?(F.Target=D.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=D):F.relId==""&&(F.Target="#"+F.loc),y=F.rfx.s.r;y<=F.rfx.e.r;++y)for(g=F.rfx.s.c;g<=F.rfx.e.c;++g)o.dense?(c[y]||(c[y]=[]),c[y][g]||(c[y][g]={t:"z",v:void 0}),c[y][g].l=F):(b=Fe({c:g,r:y}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=F);break;case 426:if(!o.cellFormula)break;j.push(F),w=o.dense?c[y][g]:c[Ct(g)+S],w.f=$r(F[1],f,{r:p.r,c:g},O,o),w.F=Be(F[0]);break;case 427:if(!o.cellFormula)break;E[Fe(F[0].s)]=F[1],w=o.dense?c[y][g]:c[Ct(g)+S],w.f=$r(F[1],f,{r:p.r,c:g},O,o);break;case 60:if(!o.cellStyles)break;for(;F.e>=F.s;)L[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},M||(M=!0,Sw(F.w/256)),ss(L[F.e+1]);break;case 161:c["!autofilter"]={ref:Be(F)};break;case 476:c["!margins"]=F;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),F.name&&(a.Sheets[r].CodeName=F.name),(F.above||F.left)&&(c["!outline"]={above:F.above,left:F.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),F.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!Q.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Be(u||f)),o.sheetRows&&c["!ref"]){var q=Qe(c["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(q))}return _.length>0&&(c["!merges"]=_),L.length>0&&(c["!cols"]=L),X.length>0&&(c["!rows"]=X),c}function Txe(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=St(t),t.z=t.z||Me[14],t.v=ur(_t(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=_s(a.cellXfs,t,a),t.l&&i["!links"].push([Fe(c),t.l]),t.c&&i["!comments"].push([Fe(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Tw(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?de(e,18,Xme(t,c)):de(e,7,Vme(t,c))):(c.t="str",s?de(e,17,ixe(t,c)):de(e,6,nxe(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?de(e,13,exe(t,c)):de(e,2,Zme(t,c)):s?de(e,16,Yme(t,c)):de(e,5,qme(t,c)),!0;case"b":return c.t="b",s?de(e,15,Lme(t,c)):de(e,4,Rme(t,c)),!0;case"e":return c.t="e",s?de(e,14,Wme(t,c)):de(e,3,Ume(t,c)),!0}return s?de(e,12,Dme(t,c)):de(e,1,Mme(t,c)),!0}function Axe(e,t,r,n){var a=Qe(t["!ref"]||"A1"),i,s="",o=[];de(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){s=Vt(f),jme(e,t,a,f);var d=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(o[h]=Ct(h)),i=o[h]+s;var p=c?(t[f]||[])[h]:t[i];if(!p){d=!1;continue}d=Txe(e,p,f,h,n,t,d)}}de(e,146)}function Oxe(e,t){!t||!t["!merges"]||(de(e,177,dxe(t["!merges"].length)),t["!merges"].forEach(function(r){de(e,176,fxe(r))}),de(e,178))}function Cxe(e,t){!t||!t["!cols"]||(de(e,390),t["!cols"].forEach(function(r,n){r&&de(e,60,gxe(n,r))}),de(e,391))}function Pxe(e,t){!t||!t["!ref"]||(de(e,648),de(e,649,Sxe(Qe(t["!ref"]))),de(e,650))}function Mxe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=nt(r,-1,n[1].Target.replace(/#.*$/,""),Ge.HLINK);de(e,494,pxe(n,a))}}),delete t["!links"]}function Fxe(e,t,r,n){if(t["!comments"].length>0){var a=nt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ge.VML);de(e,551,mw("rId"+a)),t["!legacy"]=a}}function Dxe(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Be(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=yn(i);o.s.r==o.e.r&&(o.e.r=yn(t["!ref"]).e.r,i=Be(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),de(e,161,Cc(Qe(i))),de(e,162)}}function Ixe(e,t,r){de(e,133),de(e,137,_xe(t,r)),de(e,138),de(e,134)}function Rxe(e,t){t["!protect"]&&de(e,535,kxe(t["!protect"]))}function $xe(e,t,r,n){var a=mn(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Qe(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],de(a,129),(r.vbaraw||s["!outline"])&&de(a,147,Cme(o,s["!outline"])),de(a,148,Tme(c)),Ixe(a,s,r.Workbook),Cxe(a,s),Axe(a,s,e,t),Rxe(a,s),Dxe(a,s,r,e),Oxe(a,s),Mxe(a,s,n),s["!margins"]&&de(a,476,bxe(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Pxe(a,s),Fxe(a,s,e,n),de(a,130),a.end()}function Lxe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Ye((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function Bxe(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=Lxe(d);f.s.r=f.s.c=0,f.e.c=o,u=Ct(o),h[0].forEach(function(p,v){s[u+Vt(v)]={t:"n",v:p,z:h[1]},c=v}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(s["!ref"]=Be(f)),s}function Uxe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(S5);return o&&Aw(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function zxe(e,t){e.l+=10;var r=Hr(e);return{name:r}}function Wxe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Mi(e,function(c,u,f){switch(f){case 550:i["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Ow=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Hxe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Vxe=[],Gxe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Qj(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=bt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Zj(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=bt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function E5(e){Zj(e.WBProps,Ow),Zj(e.CalcPr,Gxe),Qj(e.WBView,Hxe),Qj(e.Sheets,Vxe),Sl.date1904=bt(e.WBProps.date1904)}function Xxe(e){return!e.Workbook||!e.Workbook.WBProps?"false":bt(e.Workbook.WBProps.date1904)?"true":"false"}var Kxe="][*?/\\".split("");function T5(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Kxe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function qxe(e,t,r){e.forEach(function(n,a){T5(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Yxe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];qxe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Xpe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Qxe=/<\w+:workbook/;function Zxe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(qr,function(c,u){var f=De(c);switch(Ja(f[0])){case"<?xml":break;case"<workbook":c.match(Qxe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ow.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=bt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=ct(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ye(ct(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ct(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),bt(f.hidden||"0")&&(i.Hidden=!0),s=u+c.length;break;case"</definedName>":i.Ref=Ye(ct(e.slice(s,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Eo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return E5(r),r}function A5(e){var t=[Gt];t[t.length]=ge("workbook",null,{xmlns:Eo[0],"xmlns:r":or.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ow.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ge("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:at(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=ge("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ge("definedName",at(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Jxe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=L1(e),r.name=Hr(e),r}function eve(e,t){return t||(t=se(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),mw(e.strRelID,t),yr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tve(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Hr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rve(e,t){t||(t=se(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),bP(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nve(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function ave(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Fce(e),s=Upe(e,0,r),o=pw(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function ive(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],Gf[16]={n:"BrtFRTArchID$",f:nve},Mi(e,function(c,u,f){switch(f){case 156:s.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=$r(c.Ptg,null,null,s,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,c]):s[0]=[f,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),E5(r),r.Names=i,r.supbooks=s,r}function sve(e,t){de(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};de(e,156,eve(a))}de(e,144)}function ove(e,t){t||(t=se(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return yr("SheetJS",t),yr(ap.version,t),yr(ap.version,t),yr("7262",t),t.length>t.l?t.slice(0,t.l):t}function lve(e,t){t||(t=se(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function cve(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(de(e,135),de(e,158,lve(a)),de(e,136))}}function uve(e,t){var r=mn();return de(r,131),de(r,128,ove()),de(r,153,rve(e.Workbook&&e.Workbook.WBProps||null)),cve(r,e),sve(r,e),de(r,132),r.end()}function fve(e,t,r){return t.slice(-4)===".bin"?ive(e,r):Zxe(e,r)}function dve(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Exe(e,n,r,a,i,s,o):ame(e,n,r,a,i,s,o)}function hve(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?Wxe(e,n,r,a,i):Uxe(e,n,r,a,i)}function pve(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?xhe():vhe()}function mve(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?phe():mhe()}function xve(e,t,r,n){return t.slice(-4)===".bin"?fde(e,r,n):J0e(e,r,n)}function vve(e,t,r){return c5(e,r)}function gve(e,t,r){return t.slice(-4)===".bin"?g0e(e,r):m0e(e,r)}function yve(e,t,r){return t.slice(-4)===".bin"?che(e,r):ehe(e,r)}function bve(e,t,r){return t.slice(-4)===".bin"?Qde(e):qde(e)}function wve(e,t,r,n){return r.slice(-4)===".bin"?Zde(e,t,r,n):void 0}function _ve(e,t,r){return t.slice(-4)===".bin"?Gde(e,t,r):Kde(e,t,r)}function Sve(e,t,r){return(t.slice(-4)===".bin"?uve:A5)(e)}function kve(e,t,r,n,a){return(t.slice(-4)===".bin"?$xe:k5)(e,r,n,a)}function Nve(e,t,r){return(t.slice(-4)===".bin"?wde:o5)(e,r)}function jve(e,t,r){return(t.slice(-4)===".bin"?w0e:JP)(e,r)}function Eve(e,t,r){return(t.slice(-4)===".bin"?uhe:d5)(e)}function Tve(e){return(e.slice(-4)===".bin"?Xde:u5)()}var O5=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,C5=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function va(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(O5),i,s,o,c;if(a)for(c=0;c!=a.length;++c)i=a[c].match(C5),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Ave(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(O5),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(C5),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Fu;function Ove(e,t){var r=Fu[e]||Ye(e);return r==="General"?po(t):la(r,t)}function Cve(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=bt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=_t(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ye(t)]=a}function Pve(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Fi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v):e.w=po(e.v):e.w=Ove(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Fu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Tc(n)){var a=Gs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function Mve(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=V0e[n.Pattern]||n.Pattern)}e[t.ID]=t}function Fve(e,t,r,n,a,i,s,o,c,u){var f="General",d=n.StyleID,h={};u=u||{};var p=[],v=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&s&&(d=s.StyleID);i[d]!==void 0&&(i[d].nf&&(f=i[d].nf),i[d].Interior&&p.push(i[d].Interior),!!i[d].Parent);)d=i[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=bt(e);break;case"String":n.t="s",n.r=mj(Ye(e)),n.v=e.indexOf("<")>-1?Ye(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(_t(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ye(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=NP[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=mj(t||e));break}if(Pve(n,f,u),u.cellFormula!==!1)if(n.Formula){var x=Ye(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=_l(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=_l("RC:RC",a):n.ArrayRange&&(n.F=_l(n.ArrayRange,a),c.push([Qe(n.F),n.F]))}else for(v=0;v<c.length;++v)a.r>=c[v][0].s.r&&a.r<=c[v][0].e.r&&a.c>=c[v][0].s.c&&a.c<=c[v][0].e.c&&(n.F=c[v][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Dve(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function uv(e,t){var r=t||{};Ac();var n=cu(lw(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ct(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=St(r);return s.type="string",nc.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(We){a.indexOf("<"+We)>=0&&(i=!0)}),i)return bge(n,r);Fu={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],h=r.dense?[]:{},p="",v={},x={},y=va('<Data ss:Type="String">'),g=0,b=0,m=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w={},_={},k="",N=0,j=[],E={},O={},T=0,L=[],X=[],M={},U=[],q,K=!1,F=[],Q=[],ie={},A=0,R=0,D={Sheets:[],WBProps:{date1904:!1}},H={};Bf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Bf.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Fve(n.slice(g,o.index),k,y,c[c.length-1][0]=="comment"?M:v,{c:b,r:m},w,U[b],x,F,r):(k="",y=va(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(X.length>0&&(v.c=X),(!r.sheetRows||r.sheetRows>m)&&v.v!==void 0&&(r.dense?(h[m]||(h[m]=[]),h[m][b]=v):h[Ct(b)+Vt(m)]=v),v.HRef&&(v.l={Target:Ye(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(A=b+(parseInt(v.MergeAcross,10)|0),R=m+(parseInt(v.MergeDown,10)|0),j.push({s:{c:b,r:m},e:{c:A,r:R}})),!r.sheetStubs)v.MergeAcross?b=A+1:++b;else if(v.MergeAcross||v.MergeDown){for(var ue=b;ue<=A;++ue)for(var le=m;le<=R;++le)(ue>b||le>m)&&(r.dense?(h[le]||(h[le]=[]),h[le][ue]={t:"z"}):h[Ct(ue)+Vt(le)]={t:"z"});b=A+1}else++b;else v=Ave(o[0]),v.Index&&(b=+v.Index-1),b<S.s.c&&(S.s.c=b),b>S.e.c&&(S.e.c=b),o[0].slice(-2)==="/>"&&++b,X=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(m<S.s.r&&(S.s.r=m),m>S.e.r&&(S.e.r=m),o[0].slice(-2)==="/>"&&(x=va(o[0]),x.Index&&(m=+x.Index-1)),b=0,++m):(x=va(o[0]),x.Index&&(m=+x.Index-1),ie={},(x.AutoFitHeight=="0"||x.Height)&&(ie.hpx=parseInt(x.Height,10),ie.hpt=Vf(ie.hpx),Q[m]=ie),x.Hidden=="1"&&(ie.hidden=!0,Q[m]=ie));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=Be(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=Be(S))),j.length&&(h["!merges"]=j),U.length>0&&(h["!cols"]=U),Q.length>0&&(h["!rows"]=Q),f[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=b=0,c.push([o[3],!1]),u=va(o[0]),p=Ye(u.Name),h=r.dense?[]:{},j=[],F=[],Q=[],H={name:p,Hidden:0},D.Sheets.push(H);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),U=[],K=!1}break;case"style":o[1]==="/"?Mve(w,_,r):_=va(o[0]);break;case"numberformat":_.nf=Ye(va(o[0]).Format||"General"),Fu[_.nf]&&(_.nf=Fu[_.nf]);for(var Z=0;Z!=392&&Me[Z]!=_.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(Me[Z]==null){xi(_.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(q=va(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!K&&q.wpx>10){K=!0,Ur=i5;for(var ee=0;ee<U.length;++ee)U[ee]&&ss(U[ee])}K&&ss(q),U[q.Index-1||U.length]=q;for(var fe=0;fe<+q.Span;++fe)U[U.length]=St(q);break;case"namedrange":if(o[1]==="/")break;D.Names||(D.Names=[]);var P=De(o[0]),ke={Name:P.Name,Ref:_l(P.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(ke.Sheet=D.Sheets.length-1),D.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=va(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?iue(E,J,n.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Dve(M),X.push(M)}else c.push([o[3],!1]),u=va(o[0]),M={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var be=va(o[0]);h["!autofilter"]={ref:_l(be.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return n4(n,r);var Te=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(T,o.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else T=o.index+o[0].length;break;case"header":h["!margins"]||eo(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].header=+De(o[0]).Margin);break;case"footer":h["!margins"]||eo(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var Ae=De(o[0]);h["!margins"]||eo(h["!margins"]={},"xlml"),isNaN(+Ae.Top)||(h["!margins"].top=+Ae.Top),isNaN(+Ae.Left)||(h["!margins"].left=+Ae.Left),isNaN(+Ae.Right)||(h["!margins"].right=+Ae.Right),isNaN(+Ae.Bottom)||(h["!margins"].bottom=+Ae.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Cve(O,J,L,n.slice(T,o.index)):(L=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=f),he.SheetNames=d,he.Workbook=D,he.SSF=St(Me),he.Props=E,he.Custprops=O,he}function G1(e,t){switch(Pw(t=t||{}),t.type||"base64"){case"base64":return uv(Rn(e),t);case"binary":case"buffer":case"file":return uv(e,t);case"array":return uv(bs(e),t)}}function Ive(e,t){var r=[];return e.Props&&r.push(sue(e.Props,t)),e.Custprops&&r.push(oue(e.Props,e.Custprops)),r.join("")}function Rve(){return""}function $ve(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(ge("NumberFormat",null,{"ss:Format":at(Me[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(ge("Style",i.join(""),s))}),ge("Styles",r.join(""))}function P5(e){return ge("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+jw(e.Ref,{r:0,c:0})})}function Lve(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(P5(a)))}return ge("Names",r.join(""))}function Bve(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(P5(o)))}return i.join("")}function Uve(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ge("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ge("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ge("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Er("ProtectContents","True")),e["!protect"].objects&&a.push(Er("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Er("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Er("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Er("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":ge("WorksheetOptions",a.join(""),{xmlns:jn.x})}function zve(e){return e.map(function(t){var r=cce(t.t||""),n=ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ge("Comment",n,{"ss:Author":t.a})}).join("")}function Wve(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+at(jw(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=Pt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=at(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=at(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=s.c||u[f].s.r!=s.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Fi[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Me[14]);break;case"s":d="String",h=lce(e.v||"");break}var p=_s(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=s.c+1;var v=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=zve(e.c)),ge("Cell",x,o)}function Hve(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ac(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Vve(e,t,r,n){if(!e["!ref"])return"";var a=Qe(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,g){ss(y);var b=!!y.width,m=Km(g,y),S={"ss:Index":g+1};b&&(S["ss:Width"]=Wf(m.width)),y.hidden&&(S["ss:Hidden"]="1"),o.push(ge("Column",null,S))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[Hve(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>u)&&!(i[s].e.c<d)&&!(i[s].e.r<u)){(i[s].s.c!=d||i[s].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:d},v=Fe(p),x=c?(e[u]||[])[d]:e[v];f.push(Wve(x,v,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Gve(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?Bve(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Vve(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(Uve(i,t,e,r)),n.join("")}function Xve(e,t){t||(t={}),e.SSF||(e.SSF=St(Me)),e.SSF&&(Ac(),Um(e.SSF),t.revssf=Wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_s(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Ive(e,t)),r.push(Rve()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ge("Worksheet",Gve(n,t,e),{"ss:Name":at(e.SheetNames[n])}));return r[2]=$ve(e,t),r[3]=Lve(e),Gt+ge("Workbook",r.join(""),{xmlns:jn.ss,"xmlns:o":jn.o,"xmlns:x":jn.x,"xmlns:ss":jn.ss,"xmlns:dt":jn.dt,"xmlns:html":jn.html})}function Kve(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Lce(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Bce(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var qve=[60,1084,2066,2165,2175];function Yve(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var c=fi(r,r.l),u=X1[c],f=0;u!=null&&qve.indexOf(c)>-1;)i=fi(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+i),s.push(o),r.l+=4+i,u=X1[c=fi(r,r.l)];var d=vr(s);jr(d,0);var h=0;d.lens=[];for(var p=0;p<s.length;++p)d.lens.push(h),h+=s[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Da(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Me[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Fi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Rf(e.v):e.w=po(e.v):e.w=la(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Tc(Me[n]||String(n))){var a=Gs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function fd(e,t,r){return{v:e,ixfe:t,t:r}}function Qve(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,c=[],u="",f={},d,h="",p,v,x,y,g={},b=[],m,S,w=[],_=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},j=function(Re){return Re<8?Qs[Re]:Re<64&&_[Re-8]||Qs[Re]},E=function(Re,xt,He){var Ke=xt.XF.data;if(!(!Ke||!Ke.patternType||!He||!He.cellStyles)){xt.s={},xt.s.patternType=Ke.patternType;var Et;(Et=zf(j(Ke.icvFore)))&&(xt.s.fgColor={rgb:Et}),(Et=zf(j(Ke.icvBack)))&&(xt.s.bgColor={rgb:Et})}},O=function(Re,xt,He){if(!(ie>1)&&!(He.sheetRows&&Re.r>=He.sheetRows)){if(He.cellStyles&&xt.XF&&xt.XF.data&&E(Re,xt,He),delete xt.ixfe,delete xt.XF,d=Re,h=Fe(Re),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<s.s.r&&(s.s.r=Re.r),Re.c<s.s.c&&(s.s.c=Re.c),Re.r+1>s.e.r&&(s.e.r=Re.r+1),Re.c+1>s.e.c&&(s.e.c=Re.c+1),He.cellFormula&&xt.f){for(var Ke=0;Ke<b.length;++Ke)if(!(b[Ke][0].s.c>Re.c||b[Ke][0].s.r>Re.r)&&!(b[Ke][0].e.c<Re.c||b[Ke][0].e.r<Re.r)){xt.F=Be(b[Ke][0]),(b[Ke][0].s.c!=Re.c||b[Ke][0].s.r!=Re.r)&&delete xt.f,xt.f&&(xt.f=""+$r(b[Ke][1],s,Re,F,T));break}}He.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=xt):a[h]=xt}},T={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var L,X=[],M=[],U=[],q=[],K=!1,F=[];F.SheetNames=T.snames,F.sharedf=T.sharedf,F.arrayf=T.arrayf,F.names=[],F.XTI=[];var Q=0,ie=0,A=0,R=[],D=[],H;T.codepage=1200,ka(1200);for(var J=!1;e.l<e.length-1;){var ue=e.l,le=e.read_shift(2);if(le===0&&Q===10)break;var Z=e.l===e.length?0:e.read_shift(2),ee=X1[le];if(ee&&ee.f){if(t.bookSheets&&Q===133&&le!==133)break;if(Q=le,ee.r===2||ee.r==12){var fe=e.read_shift(2);if(Z-=2,!T.enc&&fe!==le&&((fe&255)<<8|fe>>8)!==le)throw new Error("rt mismatch: "+fe+"!="+le);ee.r==12&&(e.l+=10,Z-=10)}var P={};if(le===10?P=ee.f(e,Z,T):P=Yve(le,ee,e,Z,T),ie==0&&[9,521,1033,2057].indexOf(Q)===-1)continue;switch(le){case 34:r.opts.Date1904=k.WBProps.date1904=P;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=P,!t.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=P;break;case 66:var ke=Number(P);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}ka(T.codepage=ke),J=!0;break;case 317:T.rrtabid=P;break;case 25:T.winlocked=P;break;case 439:r.opts.RefreshAll=P;break;case 12:r.opts.CalcCount=P;break;case 16:r.opts.CalcDelta=P;break;case 17:r.opts.CalcIter=P;break;case 13:r.opts.CalcMode=P;break;case 14:r.opts.CalcPrecision=P;break;case 95:r.opts.CalcSaveRecalc=P;break;case 15:T.CalcRefMode=P;break;case 2211:r.opts.FullCalc=P;break;case 129:P.fDialog&&(a["!type"]="dialog"),P.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),P.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:w.push(P);break;case 430:F.push([P]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(P);break;case 24:case 536:H={Name:P.Name,Ref:$r(P.rgce,s,null,F,T)},P.itab>0&&(H.Sheet=P.itab-1),F.names.push(H),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(D[P.itab-1]={ref:Be(P.rgce[0][0][1][2])});break;case 22:T.ExternCount=P;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(P),F.XTI=F.XTI.concat(P);break;case 2196:if(T.biff<8)break;H!=null&&(H.Comment=P[1]);break;case 18:a["!protect"]=P;break;case 19:P!==0&&T.WTF&&console.error("Password verifier: "+P);break;case 133:i[P.pos]=P,T.snames.push(P.name);break;case 10:{if(--ie)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Be(s),t.sheetRows&&t.sheetRows<=s.e.r){var be=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Be(s),s.e.r=be}s.e.r++,s.e.c++}X.length>0&&(a["!merges"]=X),M.length>0&&(a["!objects"]=M),U.length>0&&(a["!cols"]=U),q.length>0&&(a["!rows"]=q),k.Sheets.push(N)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),T.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(T.biff=5,J=!0,ka(T.codepage=28591)),T.biff==8&&P.BIFFVer==0&&P.dt==16&&(T.biff=2),ie++)break;if(a=t.dense?[]:{},T.biff<8&&!J&&(J=!0,ka(T.codepage=t.codepage||1252)),T.biff<5||P.BIFFVer==0&&P.dt==4096){u===""&&(u="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-Z,name:u};i[Te.pos]=Te,T.snames.push(u)}else u=(i[ue]||{name:""}).name;P.dt==32&&(a["!type"]="chart"),P.dt==64&&(a["!type"]="macro"),X=[],M=[],T.arrayf=b=[],U=[],q=[],K=!1,N={Hidden:(i[ue]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[P.r]||[])[P.c]:a[Fe({c:P.c,r:P.r})])&&++P.c,m={ixfe:P.ixfe,XF:w[P.ixfe]||{},v:P.val,t:"n"},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t);break;case 5:case 517:m={ixfe:P.ixfe,XF:w[P.ixfe],v:P.val,t:P.t},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t);break;case 638:m={ixfe:P.ixfe,XF:w[P.ixfe],v:P.rknum,t:"n"},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t);break;case 189:for(var Ae=P.c;Ae<=P.C;++Ae){var he=P.rkrec[Ae-P.c][0];m={ixfe:he,XF:w[he],v:P.rkrec[Ae-P.c][1],t:"n"},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:Ae,r:P.r},m,t)}break;case 6:case 518:case 1030:{if(P.val=="String"){o=P;break}if(m=fd(P.val,P.cell.ixfe,P.tt),m.XF=w[m.ixfe],t.cellFormula){var We=P.formula;if(We&&We[0]&&We[0][0]&&We[0][0][0]=="PtgExp"){var mt=We[0][0][1][0],rr=We[0][0][1][1],Ut=Fe({r:mt,c:rr});g[Ut]?m.f=""+$r(P.formula,s,P.cell,F,T):m.F=((t.dense?(a[mt]||[])[rr]:a[Ut])||{}).F}else m.f=""+$r(P.formula,s,P.cell,F,T)}A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O(P.cell,m,t),o=P}break;case 7:case 519:if(o)o.val=P,m=fd(P,o.cell.ixfe,"s"),m.XF=w[m.ixfe],t.cellFormula&&(m.f=""+$r(o.formula,s,o.cell,F,T)),A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O(o.cell,m,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(P);var _r=Fe(P[0].s);if(p=t.dense?(a[P[0].s.r]||[])[P[0].s.c]:a[_r],t.cellFormula&&p){if(!o||!_r||!p)break;p.f=""+$r(P[1],s,P[0],F,T),p.F=Be(P[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;g[Fe(o.cell)]=P[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Fe(o.cell)],(p||{}).f=""+$r(P[0],s,d,F,T)}}break;case 253:m=fd(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(m.h=c[P.isst].h),m.XF=w[m.ixfe],A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t);break;case 513:t.sheetStubs&&(m={ixfe:P.ixfe,XF:w[P.ixfe],t:"z"},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t));break;case 190:if(t.sheetStubs)for(var Xt=P.c;Xt<=P.C;++Xt){var Dt=P.ixfe[Xt-P.c];m={ixfe:Dt,XF:w[Dt],t:"z"},A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:Xt,r:P.r},m,t)}break;case 214:case 516:case 4:m=fd(P.val,P.ixfe,"s"),m.XF=w[m.ixfe],A>0&&(m.z=R[m.ixfe>>8&63]),Da(m,t,r.opts.Date1904),O({c:P.c,r:P.r},m,t);break;case 0:case 512:ie===1&&(s=P);break;case 252:c=P;break;case 1054:if(T.biff==4){R[A++]=P[1];for(var Kt=0;Kt<A+163&&Me[Kt]!=P[1];++Kt);Kt>=163&&xi(P[1],A+163)}else xi(P[1],P[0]);break;case 30:{R[A++]=P;for(var Cr=0;Cr<A+163&&Me[Cr]!=P;++Cr);Cr>=163&&xi(P,A+163)}break;case 229:X=X.concat(P);break;case 93:M[P.cmo[0]]=T.lastobj=P;break;case 438:T.lastobj.TxO=P;break;case 127:T.lastobj.ImData=P;break;case 440:for(y=P[0].s.r;y<=P[0].e.r;++y)for(x=P[0].s.c;x<=P[0].e.c;++x)p=t.dense?(a[y]||[])[x]:a[Fe({c:x,r:y})],p&&(p.l=P[1]);break;case 2048:for(y=P[0].s.r;y<=P[0].e.r;++y)for(x=P[0].s.c;x<=P[0].e.c;++x)p=t.dense?(a[y]||[])[x]:a[Fe({c:x,r:y})],p&&p.l&&(p.l.Tooltip=P[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(a[P[0].r]||[])[P[0].c]:a[Fe(P[0])];var pa=M[P[2]];p||(t.dense?(a[P[0].r]||(a[P[0].r]=[]),p=a[P[0].r][P[0].c]={t:"z"}):p=a[Fe(P[0])]={t:"z"},s.e.r=Math.max(s.e.r,P[0].r),s.s.r=Math.min(s.s.r,P[0].r),s.e.c=Math.max(s.e.c,P[0].c),s.s.c=Math.min(s.s.c,P[0].c)),p.c||(p.c=[]),v={a:P[1],t:pa.TxO.t},p.c.push(v)}break;case 2173:$de(w[P.ixfe],P.ext);break;case 125:{if(!T.cellStyles)break;for(;P.e>=P.s;)U[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},K||(K=!0,Sw(P.w/256)),ss(U[P.e+1])}break;case 520:{var jt={};P.level!=null&&(q[P.r]=jt,jt.level=P.level),P.hidden&&(q[P.r]=jt,jt.hidden=!0),P.hpt&&(q[P.r]=jt,jt.hpt=P.hpt,jt.hpx=ac(P.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||eo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=P;break;case 161:a["!margins"]||eo(a["!margins"]={}),a["!margins"].header=P.header,a["!margins"].footer=P.footer;break;case 574:P.RTL&&(k.Views[0].RTL=!0);break;case 146:_=P;break;case 2198:L=P;break;case 140:S=P;break;case 442:u?N.CodeName=P||N.name:k.WBProps.CodeName=P||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=Z}return r.SheetNames=Bt(i).sort(function(dr,Re){return Number(dr)-Number(Re)}).map(function(dr){return i[dr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&D.forEach(function(dr,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=dr}),r.Strings=c,r.SSF=St(Me),T.enc&&(r.Encryption=T.enc),L&&(r.Themes=L),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),F.names.length>0&&(k.Names=F.names),r.Workbook=k,r}var Du={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Zve(e,t,r){var n=Oe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Mj(n,B1,Du.DSI);for(var i in a)t[i]=a[i]}catch(u){if(r.WTF)throw u}var s=Oe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=Mj(s,U1,Du.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(CP(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Jve(e,t){var r=[],n=[],a=[],i=0,s,o=cj(B1,"n"),c=cj(U1,"n");if(e.Props)for(s=Bt(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Bt(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)$P.indexOf(a[i][0])>-1||OP.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&Oe.utils.cfb_add(t,"/SummaryInformation",Fj(n,Du.SI,c,U1)),(r.length||u.length)&&Oe.utils.cfb_add(t,"/DocumentSummaryInformation",Fj(r,Du.DSI,o,B1,u.length?u:null,Du.UDI))}function M5(e,t){t||(t={}),Pw(t),Jb(),t.codepage&&Zb(t.codepage);var r,n;if(e.FullPaths){if(Oe.find(e,"/encryption"))throw new Error("File is password-protected");r=Oe.find(e,"!CompObj"),n=Oe.find(e,"/Workbook")||Oe.find(e,"/Book")}else{switch(t.type){case"base64":e=An(Rn(e));break;case"binary":e=An(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}jr(e,0),n={content:e}}var a,i;if(r&&Kve(r),t.bookProps&&!t.bookSheets)a={};else{var s=Ve?"buffer":"array";if(n&&n.content)a=Qve(n.content,t);else if((i=Oe.find(e,"PerfectOffice_MAIN"))&&i.content)a=Js.to_workbook(i.content,(t.type=s,t));else if((i=Oe.find(e,"NativeContent_MAIN"))&&i.content)a=Js.to_workbook(i.content,(t.type=s,t));else throw(i=Oe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Oe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=dhe(e))}var o={};return e.FullPaths&&Zve(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function ege(e,t){var r=t||{},n=Oe.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Oe.utils.cfb_add(n,a,F5(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Jve(e,n),r.biff==8&&e.vbaraw&&hhe(n,Oe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Gf={0:{f:kme},1:{f:Pme},2:{f:Qme},3:{f:Bme},4:{f:Ime},5:{f:Kme},6:{f:rxe},7:{f:Hme},8:{f:cxe},9:{f:lxe},10:{f:sxe},11:{f:oxe},12:{f:Fme},13:{f:Jme},14:{f:zme},15:{f:$me},16:{f:N5},17:{f:axe},18:{f:Gme},19:{f:hw},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ave},40:{},42:{},43:{f:rde},44:{f:ede},45:{f:ide},46:{f:ode},47:{f:sde},48:{},49:{f:Ece},50:{},51:{f:Ude},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qP},62:{f:txe},63:{f:Yde},64:{f:Nxe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:wxe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ome},148:{f:Eme,p:16},151:{f:mxe},152:{},153:{f:tve},154:{},155:{},156:{f:Jxe},157:{},158:{},159:{T:1,f:v0e},160:{T:-1},161:{T:1,f:Co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uxe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lde},336:{T:-1},337:{f:Hde,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:L1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:KP},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:xxe},427:{f:vxe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:yxe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ame},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hxe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:L1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ohe},633:{T:1},634:{T:-1},635:{T:1,f:ihe},636:{T:-1},637:{f:Cce},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zxe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:jxe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},X1={6:{f:lv},10:{f:Ii},12:{f:Zt},13:{f:Zt},14:{f:zt},15:{f:zt},16:{f:Wr},17:{f:zt},18:{f:zt},19:{f:Zt},20:{f:Bj},21:{f:Bj},23:{f:KP},24:{f:zj},25:{f:zt},26:{},27:{},28:{f:jfe},29:{},34:{f:zt},35:{f:Uj},38:{f:Wr},39:{f:Wr},40:{f:Wr},41:{f:Wr},42:{f:zt},43:{f:zt},47:{f:$0e},49:{f:Jue},51:{f:Zt},60:{},61:{f:Kue},64:{f:zt},65:{f:Zue},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:Rue},93:{f:Afe},94:{},95:{f:zt},96:{},97:{},99:{f:zt},125:{f:qP},128:{f:pfe},129:{f:Lue},130:{f:Zt},131:{f:zt},132:{f:zt},133:{f:Bue},134:{},140:{f:Rfe},141:{f:Zt},144:{},146:{f:Bfe},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:Xfe},161:{f:Wfe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ufe},190:{f:ffe},193:{f:Ii},197:{},198:{},199:{},200:{},201:{},202:{f:zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:zt},222:{},224:{f:hfe},225:{f:Iue},226:{f:Ii},227:{},229:{f:Efe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zue},253:{f:tfe},255:{f:Hue},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LP},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zt},353:{f:Ii},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yfe},431:{f:zt},432:{},433:{},434:{},437:{},438:{f:Pfe},439:{f:zt},440:{f:Mfe},441:{},442:{f:m0},443:{},444:{f:Zt},445:{},446:{},448:{f:Ii},449:{f:Xue,r:2},450:{f:Ii},512:{f:Rj},513:{f:Gfe},515:{f:vfe},516:{f:nfe},517:{f:Lj},519:{f:Kfe},520:{f:Vue},523:{},545:{f:Wj},549:{f:Ij},566:{},574:{f:Yue},638:{f:cfe},659:{},1048:{},1054:{f:ife},1084:{},1212:{f:Sfe},2048:{f:Dfe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ld},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ii},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Ufe,r:12},2173:{f:Rde,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:_fe,r:12},2197:{},2198:{f:Cde,r:12},2199:{},2200:{},2201:{},2202:{f:kfe,r:12},2203:{f:Ii},2204:{},2205:{},2206:{},2207:{},2211:{f:Gue},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Hfe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Lfe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Rj},1:{},2:{f:Jfe},3:{f:Qfe},4:{f:Yfe},5:{f:Lj},7:{f:t0e},8:{},9:{f:ld},11:{},22:{f:Zt},30:{f:ofe},31:{},32:{},33:{f:Wj},36:{},37:{f:Ij},50:{f:r0e},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:qfe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:n0e},223:{},234:{},354:{},421:{},518:{f:lv},521:{f:ld},536:{f:zj},547:{f:Uj},561:{},579:{},1030:{f:lv},1033:{f:ld},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&uw(r)&&e.push(r)}}function tge(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ye(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function y0(e,t,r){return e||(e=se(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function rge(e,t,r,n){var a=se(9);return y0(a,e,t),BP(r,n||"b",a),a}function nge(e,t,r){var n=se(8+2*r.length);return y0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function age(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?ur(_t(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ye(e,2,e0e(r,n,a)):ye(e,3,Zfe(r,n,a));return;case"b":case"e":ye(e,5,rge(r,n,t.v,t.t));return;case"s":case"str":ye(e,4,nge(r,n,(t.v||"").slice(0,255)));return}ye(e,1,y0(null,r,n))}function ige(e,t,r,n){var a=Array.isArray(t),i=Qe(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Be(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Vt(u);for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(c[f]=Ct(f)),s=c[f]+o;var d=a?(t[u]||[])[f]:t[s];d&&age(e,d,u,f)}}}function sge(e,t){for(var r=t||{},n=mn(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,bw(e,16,r)),ige(n,e.Sheets[e.SheetNames[a]],a,r),ye(n,10),n.end()}function oge(e,t,r){ye(e,49,efe({sz:12,name:"Arial"},r))}function lge(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,1054,sfe(a,t[a],r))})}function cge(e,t){var r=se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(e,2151,r),r=se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),VP(Qe(t["!ref"]||"A1"),r),r.write_shift(4,4),ye(e,2152,r)}function uge(e,t){for(var r=0;r<16;++r)ye(e,224,$j({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ye(e,224,$j(n,0,t))})}function fge(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ye(e,440,Ffe(n)),n[1].Tooltip&&ye(e,2048,Ife(n))}delete t["!links"]}function dge(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ye(e,125,zfe(Km(a,n),a))})}}function hge(e,t,r,n,a){var i=16+_s(a.cellXfs,t,a);if(t.v==null&&!t.bf){ye(e,513,go(r,n,i));return}if(t.bf)ye(e,6,Lpe(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?ur(_t(t.v)):t.v;ye(e,515,gfe(r,n,s,i));break;case"b":case"e":ye(e,517,xfe(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Tw(a.Strings,t.v,a.revStrings);ye(e,253,rfe(r,n,o,i))}else ye(e,516,afe(r,n,(t.v||"").slice(0,255),i,a));break;default:ye(e,513,go(r,n,i))}}function pge(e,t,r){var n=mn(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,f,d="",h=[],p=Qe(i["!ref"]||"A1"),v=u?65536:16384;if(p.e.c>255||p.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}ye(n,2057,bw(r,16,t)),ye(n,13,Kn(1)),ye(n,12,Kn(100)),ye(n,15,Zr(!0)),ye(n,17,Zr(!1)),ye(n,16,xo(.001)),ye(n,95,Zr(!0)),ye(n,42,Zr(!1)),ye(n,43,Zr(!1)),ye(n,130,Kn(1)),ye(n,128,mfe()),ye(n,131,Zr(!1)),ye(n,132,Zr(!1)),u&&dge(n,i["!cols"]),ye(n,512,lfe(p,t)),u&&(i["!links"]=[]);for(var x=p.s.r;x<=p.e.r;++x){d=Vt(x);for(var y=p.s.c;y<=p.e.c;++y){x===p.s.r&&(h[y]=Ct(y)),f=h[y]+d;var g=c?(i[x]||[])[y]:i[f];g&&(hge(n,g,x,y,t),u&&g.l&&i["!links"].push([f,g.l]))}}var b=o.CodeName||o.name||a;return u&&ye(n,574,Que((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&ye(n,229,Tfe(i["!merges"])),u&&fge(n,i),ye(n,442,UP(b)),u&&cge(n,i),ye(n,10),n.end()}function mge(e,t,r){var n=mn(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(ye(n,2057,bw(e,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?Kn(1200):null),ye(n,193,xue(2)),c&&ye(n,191),c&&ye(n,192),ye(n,226),ye(n,92,$ue("SheetJS",r)),ye(n,66,Kn(o?1200:1252)),o&&ye(n,353,Kn(0)),o&&ye(n,448),ye(n,317,Vfe(e.SheetNames.length)),o&&e.vbaraw&&ye(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";ye(n,442,UP(u))}ye(n,156,Kn(17)),ye(n,25,Zr(!1)),ye(n,18,Zr(!1)),ye(n,19,Kn(0)),o&&ye(n,431,Zr(!1)),o&&ye(n,444,Kn(0)),ye(n,61,que()),ye(n,64,Zr(!1)),ye(n,141,Kn(0)),ye(n,34,Zr(Xxe(e)=="true")),ye(n,14,Zr(!0)),o&&ye(n,439,Zr(!1)),ye(n,218,Kn(0)),oge(n,e,r),lge(n,e.SSF,r),uge(n,r),o&&ye(n,352,Zr(!1));var f=n.end(),d=mn();o&&ye(d,140,$fe()),o&&r.Strings&&tge(d,252,Wue(r.Strings)),ye(d,10);var h=d.end(),p=mn(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var y=f.length+v+h.length;for(x=0;x<e.SheetNames.length;++x){var g=i[x]||{};ye(p,133,Uue({pos:y,hs:g.Hidden||0,dt:0,name:e.SheetNames[x]},r)),y+=t[x].length}var b=p.end();if(v!=b.length)throw new Error("BS8 "+v+" != "+b.length);var m=[];return f.length&&m.push(f),b.length&&m.push(b),h.length&&m.push(h),vr(m)}function xge(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=St(Me)),e&&e.SSF&&(Ac(),Um(e.SSF),r.revssf=Wm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Mw(r),r.cellXfs=[],_s(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=pge(a,r,e);return n.unshift(mge(e,n,r)),vr(n)}function F5(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=yn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return xge(e,t);case 4:case 3:case 2:return sge(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Jj(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,c=ece(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<c.length;++s){var x=c[s].trim(),y=x.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(y!="<td"&&y!="<th")){var g=x.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var b=g[o].trim();if(b.match(/<t[dh]/i)){for(var m=b,S=0;m.charAt(0)=="<"&&(S=m.indexOf(">"))>-1;)m=m.slice(S+1);for(var w=0;w<v.length;++w){var _=v[w];_.s.c==f&&_.s.r<u&&u<=_.e.r&&(f=_.e.c+1,w=-1)}var k=De(b.slice(0,b.indexOf(">")));h=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||h>1)&&v.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var N=k.t||k["data-t"]||"";if(!m.length){f+=h;continue}if(m=aP(m),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!m.length){f+=h;continue}var j={t:"s",v:m};r.raw||!m.trim().length||N=="s"||(m==="TRUE"?j={t:"b",v:!0}:m==="FALSE"?j={t:"b",v:!1}:isNaN(Oa(m))?isNaN(rc(m).getDate())||(j={t:"d",v:_t(m)},r.cellDates||(j={t:"n",v:ur(j.v)}),j.z=r.dateNF||Me[14]):j={t:"n",v:Oa(m)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=j):n[Fe({r:u,c:f})]=j,f+=h}}}}return n["!ref"]=Be(p),v.length&&(n["!merges"]=v),n}function vge(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Fe({r,c:s}),d=n.dense?(e[r]||[])[s]:e[f],h=d&&d.v!=null&&(d.h||ow(d.w||(Ni(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,i.push(ge("td",h,p))}}var v="<tr>";return v+i.join("")+"</tr>"}var gge='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',yge="</body></html>";function bge(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ws(Jj(r[0],t),t);var n=Iw();return r.forEach(function(a,i){Rw(n,Jj(a,t),"Sheet"+(i+1))}),n}function wge(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function D5(e,t){var r=t||{},n=r.header!=null?r.header:gge,a=r.footer!=null?r.footer:yge,i=[n],s=yn(e["!ref"]);r.dense=Array.isArray(e),i.push(wge(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(vge(e,s,o,r));return i.push("</table>"+a),i.join("")}function I5(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?Pt(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=yn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),v=0,x=0,y=0,g=0,b=0,m=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&x<c;++v){var S=o[v];if(e4(S)){if(n.display)continue;p[x]={hidden:!0}}var w=S.children;for(y=g=0;y<w.length;++y){var _=w[y];if(!(n.display&&e4(_))){var k=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):aP(_.innerHTML),N=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<d.length;++h){var j=d[h];j.s.c==g+i&&j.s.r<x+a&&x+a<=j.e.r&&(g=j.e.c+1-i,h=-1)}m=+_.getAttribute("colspan")||1,((b=+_.getAttribute("rowspan")||1)>1||m>1)&&d.push({s:{r:x+a,c:g+i},e:{r:x+a+(b||1)-1,c:g+i+(m||1)-1}});var E={t:"s",v:k},O=_.getAttribute("data-t")||_.getAttribute("t")||"";k!=null&&(k.length==0?E.t=O||"z":n.raw||k.trim().length==0||O=="s"||(k==="TRUE"?E={t:"b",v:!0}:k==="FALSE"?E={t:"b",v:!1}:isNaN(Oa(k))?isNaN(rc(k).getDate())||(E={t:"d",v:_t(k)},n.cellDates||(E={t:"n",v:ur(E.v)}),E.z=n.dateNF||Me[14]):E={t:"n",v:Oa(k)})),E.z===void 0&&N!=null&&(E.z=N);var T="",L=_.getElementsByTagName("A");if(L&&L.length)for(var X=0;X<L.length&&!(L[X].hasAttribute("href")&&(T=L[X].getAttribute("href"),T.charAt(0)!="#"));++X);T&&T.charAt(0)!="#"&&(E.l={Target:T}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][g+i]=E):e[Fe({c:g+i,r:x+a})]=E,u.e.c<g+i&&(u.e.c=g+i),g+=m}}++x}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,x-1+a),e["!ref"]=Be(u),x>=c&&(e["!fullref"]=Be((u.e.r=o.length-v+x-1+a,u))),e}function R5(e,t){var r=t||{},n=r.dense?[]:{};return I5(n,e,t)}function _ge(e,t){return ws(R5(e,t),t)}function e4(e){var t="",r=Sge(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Sge(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kge(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ye(t.replace(/<[^>]*>/g,""));return[r]}var t4={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function $5(e,t){var r=t||{},n=lw(e),a=[],i,s,o={name:""},c="",u=0,f,d,h={},p=[],v=r.dense?[]:{},x,y,g={value:""},b="",m=0,S=[],w=-1,_=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,j={},E=[],O={},T=0,L=0,X=[],M=1,U=1,q=[],K={Names:[]},F={},Q=["",""],ie=[],A={},R="",D=0,H=!1,J=!1,ue=0;for(Bf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=Bf.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?v["!ref"]=Be(k):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=Be(k)),E.length&&(v["!merges"]=E),X.length&&(v["!rows"]=X),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=v,J=!1):x[0].charAt(x[0].length-2)!=="/"&&(f=De(x[0],!1),w=_=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,v=r.dense?[]:{},E=[],X=[],J=!0);break;case"table-row-group":x[1]==="/"?--N:++N;break;case"table-row":case"":if(x[1]==="/"){w+=M,M=1;break}if(d=De(x[0],!1),d.?w=d.-1:w==-1&&(w=0),M=+d["number-rows-repeated"]||1,M<10)for(ue=0;ue<M;++ue)N>0&&(X[w+ue]={level:N});_=-1;break;case"covered-table-cell":x[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(v[w]||(v[w]=[]),v[w][_]={t:"z"}):v[Fe({r:w,c:_})]={t:"z"}),b="",S=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++_,g=De(x[0],!1),U=parseInt(g["number-columns-repeated"]||"1",10),y={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(y.f=Yj(Ye(g.formula))),(g.||g["value-type"])=="string"&&(y.t="s",y.v=Ye(g["string-value"]||""),r.dense?(v[w]||(v[w]=[]),v[w][_]=y):v[Fe({r:w,c:_})]=y),_+=U-1;else if(x[1]!=="/"){++_,b="",m=0,S=[],U=1;var le=M?w+M-1:w;if(_>k.e.c&&(k.e.c=_),_<k.s.c&&(k.s.c=_),w<k.s.r&&(k.s.r=w),le>k.e.r&&(k.e.r=le),g=De(x[0],!1),ie=[],A={},y={t:g.||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=Ye(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(T=parseInt(g["number-matrix-rows-spanned"],10)||0,L=parseInt(g["number-matrix-columns-spanned"],10)||0,O={s:{r:w,c:_},e:{r:w+T-1,c:_+L-1}},y.F=Be(O),q.push([O,y.F])),g.formula)y.f=Yj(g.formula);else for(ue=0;ue<q.length;++ue)w>=q[ue][0].s.r&&w<=q[ue][0].e.r&&_>=q[ue][0].s.c&&_<=q[ue][0].e.c&&(y.F=q[ue][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(T=parseInt(g["number-rows-spanned"],10)||0,L=parseInt(g["number-columns-spanned"],10)||0,O={s:{r:w,c:_},e:{r:w+T-1,c:_+L-1}},E.push(O)),g["number-columns-repeated"]&&(U=parseInt(g["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=bt(g["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(g.value);break;case"percentage":y.t="n",y.v=parseFloat(g.value);break;case"currency":y.t="n",y.v=parseFloat(g.value);break;case"date":y.t="d",y.v=_t(g["date-value"]),r.cellDates||(y.t="n",y.v=ur(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Qle(g["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Hm(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(g.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",g["string-value"]!=null&&(b=Ye(g["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(H=!1,y.t==="s"&&(y.v=b||"",S.length&&(y.R=S),H=m==0),F.Target&&(y.l=F),ie.length>0&&(y.c=ie,ie=[]),b&&r.cellText!==!1&&(y.w=b),H&&(y.t="z",delete y.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=w))for(var Z=0;Z<M;++Z){if(U=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(v[w+Z]||(v[w+Z]=[]),v[w+Z][_]=Z==0?y:St(y);--U>0;)v[w+Z][_+U]=St(y);else for(v[Fe({r:w+Z,c:_})]=y;--U>0;)v[Fe({r:w+Z,c:_+U})]=St(y);k.e.c<=_&&(k.e.c=_)}U=parseInt(g["number-columns-repeated"]||"1",10),_+=U-1,U=0,y={},b="",S=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i;A.t=b,S.length&&(A.R=S),A.a=R,ie.push(A)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);R="",D=0,b="",m=0,S=[];break;case"creator":x[1]==="/"?R=n.slice(D,x.index):D=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);b="",m=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(j[o.name]=c,(i=a.pop())[0]!==x[3])throw"Bad state: "+i}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=De(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(x[0],!1),c+=t4[x[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=De(x[0],!1),c+=t4[x[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":s=De(x[0],!1),Q=cv(s["cell-range-address"]);var ee={Name:s.name,Ref:Q[0]+"!"+Q[1]};J&&(ee.Sheet=p.length),K.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!g||!g["string-value"])){var fe=kge(n.slice(m,x.index));b=(b.length>0?b+`
`:"")+fe[0]}else De(x[0],!1),m=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{Q=cv(De(x[0])["target-range-address"]),h[Q[0]]["!autofilter"]={ref:Q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(F=De(x[0],!1),!F.href)break;F.Target=Ye(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(Q=cv(F.Target.slice(1)),F.Target="#"+Q[0]+"!"+Q[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var P={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete P.Sheets,P}function r4(e,t){t=t||{},Xn(e,"META-INF/manifest.xml")&&Qce(Qt(e,"META-INF/manifest.xml"),t);var r=On(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=$5(ct(r),t);return Xn(e,"meta.xml")&&(n.Props=TP(Qt(e,"meta.xml"))),n}function n4(e,t){return $5(e,t)}var Nge=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Gt+t}}(),a4=function(){var e=function(i){return at(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+at(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=yn(i["!ref"]||"A1"),h=i["!merges"]||[],p=0,v=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var x="",y=i["!rows"]||[];for(u=0;u<d.s.r;++u)x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=d.e.r;++u){for(x=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var g=!1,b={},m="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>u)&&!(h[p].e.c<f)&&!(h[p].e.r<u)){(h[p].s.c!=f||h[p].s.r!=u)&&(g=!0),b["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,b["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(g){c.push(r);continue}var S=Fe({r:u,c:f}),w=v?(i[u]||[])[f]:i[S];if(w&&w.f&&(b["table:formula"]=at(Vpe(w.f)),w.F&&w.F.slice(0,S.length)==S)){var _=yn(w.F);b["table:number-matrix-columns-spanned"]=_.e.c-_.s.c+1,b["table:number-matrix-rows-spanned"]=_.e.r-_.s.r+1}if(!w){c.push(t);continue}switch(w.t){case"b":m=w.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=w.v?"true":"false";break;case"n":m=w.w||String(w.v||0),b["office:value-type"]="float",b["office:value"]=w.v||0;break;case"s":case"str":m=w.v==null?"":w.v,b["office:value-type"]="string";break;case"d":m=w.w||_t(w.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=_t(w.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(m);if(w.l&&w.l.Target){var N=w.l.Target;N=N.charAt(0)=="#"?"#"+Gpe(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),k=ge("text:a",k,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+ge("table:table-cell",ge("text:p",k,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;ss(d),d.ods=o;var h=u["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[Gt],u=Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(EP().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(n(s.Sheets[s.SheetNames[d]],s,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function L5(e,t){if(t.bookType=="fods")return a4(e,t);var r=aw(),n="",a=[],i=[];return n="mimetype",Ue(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ue(r,n,a4(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ue(r,n,Nge(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ue(r,n,Gt+EP()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ue(r,n,eue(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ue(r,n,Zce(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function yo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function K1(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ct(bs(e))}function jge(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):An(Ua(e))}function Ege(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ls(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function i4(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Tge(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Age(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Xf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function rt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Lt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ze(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Xf(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Xf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Sr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(rt(n*8+a.type)),a.type==2&&t.push(rt(a.data.length)),t.push(a.data))})}),ls(t)}function Cw(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Vn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Xf(e,n),i=Ze(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Lt(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=Ze(o.data),u=Lt(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Lt(i[3][0].data)>>>0>0),r.push(s)}return r}function Bo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:rt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:rt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:rt(s.data.length)}],n[2].push({data:Sr(s.meta),type:2})});var i=Sr(n);t.push(rt(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),ls(t)}function Oge(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Xf(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ls(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var f=ls(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Gn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Oge(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ls(t)}function Uo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=rt(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return ls(t)}function Cge(e,t,r,n){var a=yo(e),i=a.getUint32(4,!0),s=(n>1?12:8)+i4(i&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=i4(i&(n>1?12288:4096))*4,i&16&&(c=a.getUint32(s,!0),s+=4),i&32&&(u=a.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function Pge(e,t,r){var n=yo(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(c=Tge(e,i),i+=16),a&2&&(u=n.getFloat64(i,!0),i+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function fv(e,t){var r=new Uint8Array(32),n=yo(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Age(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function dv(e,t){var r=new Uint8Array(32),n=yo(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Mge(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Cge(e,t,r,e[0]);case 5:return Pge(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rr(e){var t=Ze(e);return Xf(t[1][0].data)}function s4(e,t){var r=Ze(t.data),n=Lt(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=Ze(s.data),c=Lt(o[1][0].data)>>>0;switch(n){case 1:i[c]=K1(o[3][0].data);break;case 8:{var u=e[Rr(o[9][0].data)][0],f=Ze(u.data),d=e[Rr(f[1][0].data)][0],h=Lt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Ze(d.data);i[c]=p[3].map(function(v){return K1(v.data)}).join("")}break}}),i}function Fge(e,t){var r,n,a,i,s,o,c,u,f,d,h,p,v,x,y=Ze(e),g=Lt(y[1][0].data)>>>0,b=Lt(y[2][0].data)>>>0,m=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Lt(y[8][0].data)>0||!1,S,w;if((i=(a=y[7])==null?void 0:a[0])!=null&&i.data&&t!=0)S=(o=(s=y[7])==null?void 0:s[0])==null?void 0:o.data,w=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=y[4])==null?void 0:f[0])!=null&&d.data&&t!=1)S=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,w=(x=(v=y[3])==null?void 0:v[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=m?4:1,k=yo(S),N=[],j=0;j<S.length/2;++j){var E=k.getUint16(j*2,!0);E<65535&&N.push([j,E])}if(N.length!=b)throw"Expected ".concat(b," cells, found ").concat(N.length);var O=[];for(j=0;j<N.length-1;++j)O[N[j][0]]=w.subarray(N[j][1]*_,N[j+1][1]*_);return N.length>=1&&(O[N[N.length-1][0]]=w.subarray(N[N.length-1][1]*_)),{R:g,cells:O}}function Dge(e,t){var r,n=Ze(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Lt(n[7][0].data)>>>0>0?1:0:-1,i=Cw(n[5],function(s){return Fge(s,a)});return{nrows:Lt(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(c,u){if(s[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));s[o.R][u]=c}),s},[])}}function Ige(e,t,r){var n,a=Ze(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Lt(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Lt(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Be(i);var s=Ze(a[4][0].data),o=s4(e,e[Rr(s[4][0].data)][0]),c=(n=s[17])!=null&&n[0]?s4(e,e[Rr(s[17][0].data)][0]):[],u=Ze(s[3][0].data),f=0;u[1].forEach(function(d){var h=Ze(d.data),p=e[Rr(h[2][0].data)][0],v=Lt(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var x=Dge(e,p);x.data.forEach(function(y,g){y.forEach(function(b,m){var S=Fe({r:f+g,c:m}),w=Mge(b,o,c);w&&(r[S]=w)})}),f+=x.nrows})}function Rge(e,t){var r=Ze(t.data),n={"!ref":"A1"},a=e[Rr(r[2][0].data)],i=Lt(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Ige(e,a[0],n),n}function $ge(e,t){var r,n=Ze(t.data),a={name:(r=n[1])!=null&&r[0]?K1(n[1][0].data):"",sheets:[]},i=Cw(n[2],Rr);return i.forEach(function(s){e[s].forEach(function(o){var c=Lt(o.meta[1][0].data);c==6e3&&a.sheets.push(Rge(e,o))})}),a}function Lge(e,t){var r=Iw(),n=Ze(t.data),a=Cw(n[1],Rr);if(a.forEach(function(i){e[i].forEach(function(s){var o=Lt(s.meta[1][0].data);if(o==2){var c=$ge(e,s);c.sheets.forEach(function(u,f){Rw(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function hv(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Gn(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=Vn(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){i[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Lt(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(c){i[c].forEach(function(u){var f=Lt(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Lge(i,o)}function Bge(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Lt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=yo(e[7][0].data),f=0,d=[],h=yo(e[4][0].data),p=0,v=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,f,!0),h.setUint16(x*2,p,!0);var y,g;switch(typeof t[x]){case"string":y=fv({t:"s",v:t[x]},r),g=dv({t:"s",v:t[x]},r);break;case"number":y=fv({t:"n",v:t[x]},r),g=dv({t:"n",v:t[x]},r);break;case"boolean":y=fv({t:"b",v:t[x]},r),g=dv({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}d.push(y),f+=y.length,v.push(g),p+=g.length,++c}for(e[2][0].data=rt(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=ls(d),e[3][0].data=ls(v),c}function Uge(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=yn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Be(n)));var i=vp(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(R){return R.forEach(function(D){typeof D=="string"&&s.push(D)})});var o={},c=[],u=Oe.read(t.numbers,{type:"base64"});u.FileIndex.map(function(R,D){return[R,u.FullPaths[D]]}).forEach(function(R){var D=R[0],H=R[1];if(D.type==2&&D.name.match(/\.iwa/)){var J=D.content,ue=Gn(J),le=Vn(ue);le.forEach(function(Z){c.push(Z.id),o[Z.id]={deps:[],location:H,type:Lt(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(R,D){return R-D});var f=c.filter(function(R){return R>1}).map(function(R){return[R,rt(R)]});u.FileIndex.map(function(R,D){return[R,u.FullPaths[D]]}).forEach(function(R){var D=R[0];if(R[1],!!D.name.match(/\.iwa/)){var H=Vn(Gn(D.content));H.forEach(function(J){J.messages.forEach(function(ue){f.forEach(function(le){J.messages.some(function(Z){return Lt(Z.meta[1][0].data)!=11006&&Ege(Z.data,le[1])})&&o[le[0]].deps.push(J.id)})})})}});for(var d=Oe.find(u,o[1].location),h=Vn(Gn(d.content)),p,v=0;v<h.length;++v){var x=h[v];x.id==1&&(p=x)}var y=Rr(Ze(p.messages[0].data)[1][0].data);for(d=Oe.find(u,o[y].location),h=Vn(Gn(d.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(p=x);for(y=Rr(Ze(p.messages[0].data)[2][0].data),d=Oe.find(u,o[y].location),h=Vn(Gn(d.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(p=x);for(y=Rr(Ze(p.messages[0].data)[2][0].data),d=Oe.find(u,o[y].location),h=Vn(Gn(d.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(p=x);var g=Ze(p.messages[0].data);{g[6][0].data=rt(n.e.r+1),g[7][0].data=rt(n.e.c+1);var b=Rr(g[46][0].data),m=Oe.find(u,o[b].location),S=Vn(Gn(m.content));{for(var w=0;w<S.length&&S[w].id!=b;++w);if(S[w].id!=b)throw"Bad ColumnRowUIDMapArchive";var _=Ze(S[w].messages[0].data);_[1]=[],_[2]=[],_[3]=[];for(var k=0;k<=n.e.c;++k){var N=[];N[1]=N[2]=[{type:0,data:rt(k+420690)}],_[1].push({type:2,data:Sr(N)}),_[2].push({type:0,data:rt(k)}),_[3].push({type:0,data:rt(k)})}_[4]=[],_[5]=[],_[6]=[];for(var j=0;j<=n.e.r;++j)N=[],N[1]=N[2]=[{type:0,data:rt(j+726270)}],_[4].push({type:2,data:Sr(N)}),_[5].push({type:0,data:rt(j)}),_[6].push({type:0,data:rt(j)});S[w].messages[0].data=Sr(_)}m.content=Uo(Bo(S)),m.size=m.content.length,delete g[46];var E=Ze(g[4][0].data);{E[7][0].data=rt(n.e.r+1);var O=Ze(E[1][0].data),T=Rr(O[2][0].data);m=Oe.find(u,o[T].location),S=Vn(Gn(m.content));{if(S[0].id!=T)throw"Bad HeaderStorageBucket";var L=Ze(S[0].messages[0].data);for(j=0;j<i.length;++j){var X=Ze(L[2][0].data);X[1][0].data=rt(j),X[4][0].data=rt(i[j].length),L[2][j]={type:L[2][0].type,data:Sr(X)}}S[0].messages[0].data=Sr(L)}m.content=Uo(Bo(S)),m.size=m.content.length;var M=Rr(E[2][0].data);m=Oe.find(u,o[M].location),S=Vn(Gn(m.content));{if(S[0].id!=M)throw"Bad HeaderStorageBucket";for(L=Ze(S[0].messages[0].data),k=0;k<=n.e.c;++k)X=Ze(L[2][0].data),X[1][0].data=rt(k),X[4][0].data=rt(n.e.r+1),L[2][k]={type:L[2][0].type,data:Sr(X)};S[0].messages[0].data=Sr(L)}m.content=Uo(Bo(S)),m.size=m.content.length;var U=Rr(E[4][0].data);(function(){for(var R=Oe.find(u,o[U].location),D=Vn(Gn(R.content)),H,J=0;J<D.length;++J){var ue=D[J];ue.id==U&&(H=ue)}var le=Ze(H.messages[0].data);{le[3]=[];var Z=[];s.forEach(function(P,ke){Z[1]=[{type:0,data:rt(ke)}],Z[2]=[{type:0,data:rt(1)}],Z[3]=[{type:2,data:jge(P)}],le[3].push({type:2,data:Sr(Z)})})}H.messages[0].data=Sr(le);var ee=Bo(D),fe=Uo(ee);R.content=fe,R.size=R.content.length})();var q=Ze(E[3][0].data);{var K=q[1][0];delete q[2];var F=Ze(K.data);{var Q=Rr(F[2][0].data);(function(){for(var R=Oe.find(u,o[Q].location),D=Vn(Gn(R.content)),H,J=0;J<D.length;++J){var ue=D[J];ue.id==Q&&(H=ue)}var le=Ze(H.messages[0].data);{delete le[6],delete q[7];var Z=new Uint8Array(le[5][0].data);le[5]=[];for(var ee=0,fe=0;fe<=n.e.r;++fe){var P=Ze(Z);ee+=Bge(P,i[fe],s),P[1][0].data=rt(fe),le[5].push({data:Sr(P),type:2})}le[1]=[{type:0,data:rt(n.e.c+1)}],le[2]=[{type:0,data:rt(n.e.r+1)}],le[3]=[{type:0,data:rt(ee)}],le[4]=[{type:0,data:rt(n.e.r+1)}]}H.messages[0].data=Sr(le);var ke=Bo(D),be=Uo(ke);R.content=be,R.size=R.content.length})()}K.data=Sr(F)}E[3][0].data=Sr(q)}g[4][0].data=Sr(E)}p.messages[0].data=Sr(g);var ie=Bo(h),A=Uo(ie);return d.content=A,d.size=d.content.length,u}function B5(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Pw(e){B5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Mw(e){B5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zge(e){return Ge.WS.indexOf(e)>-1?"sheet":e==Ge.CS?"chart":e==Ge.DS?"dialog":e==Ge.MS?"macro":e&&e.length?e:"sheet"}function Wge(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zge(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Hge(e,t,r,n,a,i,s,o,c,u,f,d){try{i[n]=Cu(On(e,r,!0),t);var h=Qt(e,t),p;switch(o){case"sheet":p=dve(h,t,a,c,i[n],u,f,d);break;case"chart":if(p=hve(h,t,a,c,i[n],u,f,d),!p||!p["!drawel"])break;var v=fu(p["!drawel"].Target,t),x=Uf(v),y=Jde(On(e,v,!0),Cu(On(e,x,!0),v)),g=fu(y,v),b=Uf(g);p=Bxe(On(e,g,!0),g,c,Cu(On(e,b,!0),g),u,p);break;case"macro":p=pve(h,t,a,c,i[n],u,f,d);break;case"dialog":p=mve(h,t,a,c,i[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=p;var m=[];i&&i[n]&&Bt(i[n]).forEach(function(S){var w="";if(i[n][S].Type==Ge.CMNT){w=fu(i[n][S].Target,t);var _=yve(Qt(e,w,!0),w,c);if(!_||!_.length)return;Vj(p,_,!1)}i[n][S].Type==Ge.TCMNT&&(w=fu(i[n][S].Target,t),m=m.concat(the(Qt(e,w,!0),c)))}),m&&m.length&&Vj(p,m,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function Wn(e){return e.charAt(0)=="/"?e.slice(1):e}function Vge(e,t){if(Ac(),t=t||{},Pw(t),Xn(e,"META-INF/manifest.xml")||Xn(e,"objectdata.xml"))return r4(e,t);if(Xn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof hv<"u"){if(e.FileIndex)return hv(e);var r=Oe.utils.cfb_new();return dj(e).forEach(function(X){Ue(r,X,rce(e,X))}),hv(r)}throw new Error("Unsupported NUMBERS file")}if(!Xn(e,"[Content_Types].xml"))throw Xn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Xn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=dj(e),a=qce(On(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Qt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Qt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Pu=[],a.sst)try{Pu=gve(Qt(e,Wn(a.sst)),a.sst,t)}catch(X){if(t.WTF)throw X}t.cellStyles&&a.themes.length&&(c=vve(On(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=xve(Qt(e,Wn(a.style)),a.style,c,t))}a.links.map(function(X){try{var M=Cu(On(e,Uf(Wn(X))),X);return wve(Qt(e,Wn(X)),M,X,t)}catch{}});var f=fve(Qt(e,Wn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Qt(e,Wn(a.coreprops[0]),!0),h&&(d=TP(h)),a.extprops.length!==0&&(h=Qt(e,Wn(a.extprops[0]),!0),h&&rue(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=On(e,Wn(a.custprops[0]),!0),h&&(p=aue(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?s=f.Sheets.map(function(M){return M.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),t.bookProps&&(v.Props=d,v.Custprops=p),t.bookSheets&&typeof s<"u"&&(v.SheetNames=s),t.bookSheets?v.SheetNames:t.bookProps))return v;s={};var x={};t.bookDeps&&a.calcchain&&(x=bve(Qt(e,Wn(a.calcchain)),a.calcchain));var y=0,g={},b,m;{var S=f.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var w=0;w!=S.length;++w)d.SheetNames[w]=S[w].name}var _=i?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Xn(e,N)||(N="xl/_rels/workbook."+_+".rels");var j=Cu(On(e,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=_ve(Qt(e,Wn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=nhe(Qt(e,Wn(a.people[0])),t)),j&&(j=Wge(j,f.Sheets));var E=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=d.Worksheets;++y){var O="sheet";if(j&&j[y]?(b="xl/"+j[y][1].replace(/[\/]?xl\//,""),Xn(e,b)||(b=j[y][1]),Xn(e,b)||(b=N.replace(/_rels\/.*$/,"")+j[y][1]),O=j[y][2]):(b="xl/worksheets/sheet"+(y+1-E)+"."+_,b=b.replace(/sheet0\./,"sheet.")),m=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(d.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,L=0;L!=t.sheets.length;++L)typeof t.sheets[L]=="number"&&t.sheets[L]==y&&(T=1),typeof t.sheets[L]=="string"&&t.sheets[L].toLowerCase()==d.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}Hge(e,b,m,d.SheetNames[y],y,g,s,O,t,f,c,u)}return v={Directory:a,Workbook:f,Props:d,Custprops:p,Deps:x,Sheets:s,SheetNames:d.SheetNames,Strings:Pu,Styles:u,Themes:c,SSF:St(Me)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(X,M){X=X.replace(/^Root Entry[\/]/,""),v.keys.push(X),v.files[X]=e.FileIndex[M]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Qt(e,Wn(a.vba[0]),!0):a.defaults&&a.defaults.bin===fhe&&(v.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),v}function Gge(e,t){var r=t||{},n="Workbook",a=Oe.find(e,n);try{if(n="/!DataSpaces/Version",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(_0e(a.content),n="/!DataSpaces/DataSpaceMap",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=k0e(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=N0e(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);E0e(a.content)}catch{}if(n="/EncryptionInfo",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=T0e(a.content);if(n="/EncryptedPackage",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Xge(e,t){return t.bookType=="ods"?L5(e,t):t.bookType=="numbers"?Uge(e,t):t.bookType=="xlsb"?Kge(e,t):qge(e,t)}function Kge(e,t){ul=1024,e&&!e.SSF&&(e.SSF=St(Me)),e&&e.SSF&&(Ac(),Um(e.SSF),t.revssf=Wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=h5.indexOf(t.bookType)>-1,a=gw();Mw(t=t||{});var i=aw(),s="",o=0;if(t.cellXfs=[],_s(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ue(i,s,AP(e.Props,t)),a.coreprops.push(s),nt(t.rels,2,s,Ge.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ue(i,s,PP(e.Props)),a.extprops.push(s),nt(t.rels,3,s,Ge.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ue(i,s,MP(e.Custprops)),a.custprops.push(s),nt(t.rels,4,s,Ge.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ue(i,s,kve(o-1,s,t,e,f)),a.sheets.push(s),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(d){var p=d["!comments"],v=!1,x="";p&&p.length>0&&(x="xl/comments"+o+"."+r,Ue(i,x,Eve(p,x)),a.comments.push(x),nt(f,-1,"../comments"+o+"."+r,Ge.CMNT),v=!0),d["!legacy"]&&v&&Ue(i,"xl/drawings/vmlDrawing"+o+".vml",f5(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ue(i,Uf(s),wl(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ue(i,s,jve(t.Strings,s,t)),a.strs.push(s),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),s="xl/workbook."+r,Ue(i,s,Sve(e,s)),a.workbooks.push(s),nt(t.rels,1,s,Ge.WB),s="xl/theme/theme1.xml",Ue(i,s,kw(e.Themes,t)),a.themes.push(s),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),s="xl/styles."+r,Ue(i,s,Nve(e,s,t)),a.styles.push(s),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ue(i,s,e.vbaraw),a.vba.push(s),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),s="xl/metadata."+r,Ue(i,s,Tve(s)),a.metadata.push(s),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),Ue(i,"[Content_Types].xml",jP(a,t)),Ue(i,"_rels/.rels",wl(t.rels)),Ue(i,"xl/_rels/workbook."+r+".rels",wl(t.wbrels)),delete t.revssf,delete t.ssf,i}function qge(e,t){ul=1024,e&&!e.SSF&&(e.SSF=St(Me)),e&&e.SSF&&(Ac(),Um(e.SSF),t.revssf=Wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mu?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=h5.indexOf(t.bookType)>-1,a=gw();Mw(t=t||{});var i=aw(),s="",o=0;if(t.cellXfs=[],_s(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Ue(i,s,AP(e.Props,t)),a.coreprops.push(s),nt(t.rels,2,s,Ge.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ue(i,s,PP(e.Props)),a.extprops.push(s),nt(t.rels,3,s,Ge.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Ue(i,s,MP(e.Custprops)),a.custprops.push(s),nt(t.rels,4,s,Ge.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Ue(i,s,k5(o-1,t,e,d)),a.sheets.push(s),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ge.WS[0])}if(h){var v=h["!comments"],x=!1,y="";if(v&&v.length>0){var g=!1;v.forEach(function(b){b[1].forEach(function(m){m.T==!0&&(g=!0)})}),g&&(y="xl/threadedComments/threadedComment"+o+"."+r,Ue(i,y,rhe(v,f,t)),a.threadedcomments.push(y),nt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ge.TCMNT)),y="xl/comments"+o+"."+r,Ue(i,y,d5(v)),a.comments.push(y),nt(d,-1,"../comments"+o+"."+r,Ge.CMNT),x=!0}h["!legacy"]&&x&&Ue(i,"xl/drawings/vmlDrawing"+o+".vml",f5(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ue(i,Uf(s),wl(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Ue(i,s,JP(t.Strings,t)),a.strs.push(s),nt(t.wbrels,-1,"sharedStrings."+r,Ge.SST)),s="xl/workbook."+r,Ue(i,s,A5(e)),a.workbooks.push(s),nt(t.rels,1,s,Ge.WB),s="xl/theme/theme1.xml",Ue(i,s,kw(e.Themes,t)),a.themes.push(s),nt(t.wbrels,-1,"theme/theme1.xml",Ge.THEME),s="xl/styles."+r,Ue(i,s,o5(e,t)),a.styles.push(s),nt(t.wbrels,-1,"styles."+r,Ge.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Ue(i,s,e.vbaraw),a.vba.push(s),nt(t.wbrels,-1,"vbaProject.bin",Ge.VBA)),s="xl/metadata."+r,Ue(i,s,u5()),a.metadata.push(s),nt(t.wbrels,-1,"metadata."+r,Ge.XLMETA),f.length>1&&(s="xl/persons/person.xml",Ue(i,s,ahe(f)),a.people.push(s),nt(t.wbrels,-1,"persons/person.xml",Ge.PEOPLE)),Ue(i,"[Content_Types].xml",jP(a,t)),Ue(i,"_rels/.rels",wl(t.rels)),Ue(i,"xl/_rels/workbook."+r+".rels",wl(t.wbrels)),delete t.revssf,delete t.ssf,i}function Fw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Rn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Yge(e,t){return Oe.find(e,"EncryptedPackage")?Gge(e,t):M5(e,t)}function Qge(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r=tP(n,a),Vge(r,a)}function U5(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return G1(e.slice(r),t);default:break e}return nc.to_workbook(e,t)}function Zge(e,t){var r="",n=Fw(e,t);switch(t.type){case"base64":r=Rn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=mo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ct(r)),t.type="binary",U5(r,t)}function Jge(e,t){var r=e;return t.type=="base64"&&(r=Rn(r)),r=Df.utils.decode(1200,r.slice(2),"str"),t.type="binary",U5(r,t)}function e1e(e){return e.match(/[^\x00-\x7F]/)?Ua(e):e}function pv(e,t,r,n){return n?(r.type="string",nc.to_workbook(e,r)):nc.to_workbook(t,r)}function xp(e,t){Jb();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xp(new Uint8Array(e),(r=St(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Sl={},r.dateNF&&(Sl.dateNF=r.dateNF),r.type||(r.type=Ve&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ve?"buffer":"binary",n=Kle(e),typeof Uint8Array<"u"&&!Ve&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=e1e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=St(r),r.type="array",xp(ew(n),r)}switch((a=Fw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Yge(Oe.read(n,r),r);break;case 9:if(a[1]<=8)return M5(n,r);break;case 60:return G1(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return i0e(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return QP.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Qge(n,r):pv(e,n,r,i);case 239:return a[3]===60?G1(n,r):pv(e,n,r,i);case 255:if(a[1]===254)return Jge(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Js.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Js.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return V1.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return a5.to_workbook(n,r);break;case 10:case 13:case 32:return Zge(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return a0e.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?V1.to_workbook(n,r):pv(e,n,r,i)}function z5(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return d0(t.file,Oe.write(e,{type:Ve?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Oe.write(e,t)}function t1e(e,t){var r=St(t||{}),n=Xge(e,r);return r1e(n,r)}function r1e(e,t){var r={},n=Ve?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Oe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Bm(a))}return t.password&&typeof encrypt_agile<"u"?z5(encrypt_agile(a,t.password),t):t.type==="file"?d0(t.file,a):t.type=="string"?ct(a):a}function n1e(e,t){var r=t||{},n=ege(e,r);return z5(n,r)}function Ra(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return If(Ua(n));case"binary":return Ua(n);case"string":return e;case"file":return d0(t.file,n,"utf8");case"buffer":return Ve?Pi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ra(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function a1e(e,t){switch(t.type){case"base64":return If(e);case"binary":return e;case"string":return e;case"file":return d0(t.file,e,"binary");case"buffer":return Ve?Pi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?If(r):t.type=="string"?ct(r):r;case"file":return d0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function W5(e,t){Jb(),Yxe(e);var r=St(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=W5(e,r);return r.type="array",Bm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ra(Xve(e,r),r);case"slk":case"sylk":return Ra(YP.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ra(D5(e.Sheets[e.SheetNames[a]],r),r);case"txt":return a1e(H5(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ra(Dw(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ra(QP.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return dd(V1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ra(nc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ra(a5.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ra(ZP.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ra(L5(e,r),r);case"wk1":return dd(Js.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return dd(Js.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),dd(F5(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),n1e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return t1e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function i1e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function qm(e,t,r){var n={};return n.type="file",n.file=t,i1e(n),W5(e,n)}function s1e(e,t,r,n,a,i,s,o){var c=Vt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!s||e[r])for(var p=t.s.c;p<=t.e.c;++p){var v=s?e[r][p]:e[n[p]+c];if(v===void 0||v.t===void 0){if(u===void 0)continue;i[p]!=null&&(h[i[p]]=u);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[p]!=null){if(x==null)if(v.t=="e"&&x===null)h[i[p]]=null;else if(u!==void 0)h[i[p]]=u;else if(f&&x===null)h[i[p]]=null;else continue;else h[i[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:Ni(v,x,o);x!=null&&(d=!1)}}return{row:h,isempty:d}}function vp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=Qe(f);break;case"number":c=Qe(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=Vt(c.s.r),h=[],p=[],v=0,x=0,y=Array.isArray(e),g=c.s.r,b=0,m={};y&&!e[g]&&(e[g]=[]);var S=u.skipHidden&&e["!cols"]||[],w=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(S[b]||{}).hidden)switch(h[b]=Ct(b),r=y?e[g][b]:e[h[b]+d],n){case 1:i[b]=b-c.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Ni(r,null,u),x=m[s]||0,!x)m[s]=1;else{do o=s+"_"+x++;while(m[o]);m[s]=x,m[o]=1}i[b]=o}for(g=c.s.r+a;g<=c.e.r;++g)if(!(w[g]||{}).hidden){var _=s1e(e,c,g,h,n,i,y,u);(_.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[v++]=_.row)}return p.length=v,p}var o4=/"/g;function o1e(e,t,r,n,a,i,s,o){for(var c=!0,u=[],f="",d=Vt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Ni(p,null,o));for(var v=0,x=0;v!==f.length;++v)if((x=f.charCodeAt(v))===a||x===i||x===34||o.forceQuotes){f='"'+f.replace(o4,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(o4,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(s)}function Dw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Qe(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(d[v]=Ct(v));for(var x=0,y=a.s.r;y<=a.e.r;++y)(p[y]||{}).hidden||(f=o1e(e,a,y,d,s,c,i,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((x++?o:"")+f)));return delete n.dense,r.join("")}function H5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dw(e,t);return r}function l1e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Qe(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Ct(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=Vt(f),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function V5(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;s=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var d=Qe(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+t.length-1+a)}else s==-1&&(s=0,f.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(x,y){Bt(x).forEach(function(g){(p=h.indexOf(g))==-1&&(h[p=h.length]=g);var b=x[g],m="z",S="",w=Fe({c:o+p,r:s+y+a});u=Kf(i,w),b&&typeof b=="object"&&!(b instanceof Date)?i[w]=b:(typeof b=="number"?m="n":typeof b=="boolean"?m="b":typeof b=="string"?m="s":b instanceof Date?(m="d",n.cellDates||(m="n",b=ur(b)),S=n.dateNF||Me[14]):b===null&&n.nullError&&(m="e",b=0),u?(u.t=m,u.v=b,delete u.w,delete u.R,S&&(u.z=S)):i[w]=u={t:m,v:b},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var v=Vt(s);if(a)for(p=0;p<h.length;++p)i[Ct(p+o)+v]={t:"s",v:h[p]};return i["!ref"]=Be(f),i}function c1e(e,t){return V5(null,e,t)}function Kf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Kf(e,Fe(t)):Kf(e,Fe({r:t,c:r||0}))}function u1e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Iw(){return{SheetNames:[],Sheets:{}}}function Rw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(T5(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function f1e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=u1e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function d1e(e,t){return e.z=t,e}function G5(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function h1e(e,t,r){return G5(e,"#"+t,r)}function p1e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function m1e(e,t,r,n){for(var a=typeof t!="string"?t:Qe(t),i=typeof t=="string"?t:Be(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Kf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var gr={encode_col:Ct,encode_row:Vt,encode_cell:Fe,encode_range:Be,decode_col:dw,decode_row:fw,split_cell:jce,decode_cell:Pt,decode_range:yn,format_cell:Ni,sheet_add_aoa:yP,sheet_add_json:V5,sheet_add_dom:I5,aoa_to_sheet:Oc,json_to_sheet:c1e,table_to_sheet:R5,table_to_book:_ge,sheet_to_csv:Dw,sheet_to_txt:H5,sheet_to_json:vp,sheet_to_html:D5,sheet_to_formulae:l1e,sheet_to_row_object_array:vp,sheet_get_cell:Kf,book_new:Iw,book_append_sheet:Rw,book_set_sheet_visibility:f1e,cell_set_number_format:d1e,cell_set_hyperlink:G5,cell_set_internal_link:h1e,cell_add_comment:p1e,sheet_set_array_formula:m1e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const X5=[{key:"floor",label:"Level / Floor",required:!0},{key:"department",label:"Department (Team)",required:!1},{key:"date",label:"Date",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status (Occupied?)",required:!0}],K5=[{key:"floor",label:"Level / Floor",required:!0},{key:"roomName",label:"Room Name",required:!0},{key:"roomType",label:"Space Type",required:!0},{key:"capacity",label:"Capacity (Marker)",required:!1},{key:"week",label:"Week",required:!1},{key:"day",label:"Day",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status",required:!0},{key:"attendeeCount",label:"Occupancy (Count)",required:!1}],x1e=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var i;try{const s=(i=a.target)==null?void 0:i.result,o=xp(s,{type:"binary"}),c=o.SheetNames[0],u=o.Sheets[c],f=gr.sheet_to_json(u,{header:1});t(f)}catch(s){r(s)}},n.onerror=a=>r(a),n.readAsBinaryString(e)}),v1e=(e,t)=>{const r=e.map(i=>String(i).toLowerCase().trim()),n={},a=i=>r.findIndex(s=>i.some(o=>s.includes(o)));return n.date=a(["date","timestamp"]),n.timeSlot=a(["time","slot","hour","start","period"]),n.floor=a(["floor","level","zone","lvl"]),n.week=a(["week","wk"]),n.day=a(["day"]),t==="workstation"?(n.isOccupied=a(["occup","status","state","vacan","activity"]),n.department=a(["dept","department","team","group","cost center"])):(n.roomName=a(["room","name","id","department","dept"]),n.roomType=a(["type","category","kind"]),n.capacity=a(["cap","seat","pax"]),n.isOccupied=a(["status","state"]),n.attendeeCount=a(["occupancy","actual","pax","people","count"])),Object.keys(n).forEach(i=>{n[i]===-1&&delete n[i]}),n},g1e=(e,t,r)=>{const a=(r==="workstation"?X5:K5).filter(o=>o.required&&t[o.key]===void 0),i=[],s=e.slice(1,11);if(s.length>0&&t.isOccupied!==void 0){const o=t.isOccupied;s.some(u=>{const f=String(u[o]).toLowerCase();return f.includes("occ")||f==="1"||f==="0"||f==="yes"||f==="no"||f==="true"||f==="false"})||i.push("Status column values don't look standard (e.g. 'Occupied', '1', 'Yes').")}if(s.length>0&&t.timeSlot!==void 0){const o=t.timeSlot;s.some(u=>{const f=String(u[o]);return f.includes(":")||!isNaN(parseFloat(f))})||i.push("Time column doesn't appear to contain time formats.")}return{isValid:a.length===0,missingFields:a.map(o=>o.label),warnings:i}},l4=e=>{if(e===1||e==="1")return!0;if(typeof e=="string"){const t=e.toLowerCase().trim();if(t.includes("unoccupied"))return!1;if(t.includes("occupied")||t==="yes"||t==="y"||t==="occ")return!0}return!1},c4=(e,t,r)=>{const n=[],a=i=>{const s=String(i).toLowerCase().trim();return["level","floor","department","room","type","capacity","status","occupancy","week","day","time"].includes(s)};for(let i=1;i<e.length;i++){const s=e[i];if(!s||s.length===0)continue;const o=x=>{const y=t[x];return y!==void 0?s[y]:void 0},c=String(o("date")||""),u=String(o("timeSlot")||""),f=String(o("floor")||"Unknown").trim(),d=o("week"),h=o("day"),p=parseInt(d)||void 0,v=parseInt(h)||void 0;if(!a(f)&&!(f==="Unknown"&&!u&&!c))if(r==="workstation")(c||u||f!=="Unknown")&&n.push({id:`obs-${i}`,date:c||"Unknown Date",timeSlot:u||"Unknown Time",floor:f,department:String(o("department")||"Unassigned"),isOccupied:l4(o("isOccupied")),week:p,day:v});else{const x=l4(o("isOccupied")),y=o("attendeeCount");let g=0;if(x){const b=parseInt(y);!isNaN(b)&&b>0?g=b:g=1}(u||v||p||f!=="Unknown")&&n.push({id:`mtg-${i}`,date:c,timeSlot:u||"Unknown Time",floor:f,roomName:String(o("roomName")||`Room ${i}`),roomType:String(o("roomType")||"Meeting Room"),capacity:1,attendeeCount:g,isOccupied:x,week:p,day:v})}}return n},y1e=e=>{const t=e.length,r=e.filter(u=>u.isOccupied).length,n=t>0?r/t*100:0,a={};e.forEach(u=>{a[u.timeSlot]||(a[u.timeSlot]={t:0,o:0}),a[u.timeSlot].t++,u.isOccupied&&a[u.timeSlot].o++});let i=0;const s=Object.keys(a).map(u=>{const f=a[u].o/a[u].t*100;return f>i&&(i=f),{time:u,rate:f}}).sort((u,f)=>u.time.localeCompare(f.time)),o={};e.forEach(u=>{o[u.floor]||(o[u.floor]={t:0,o:0}),o[u.floor].t++,u.isOccupied&&o[u.floor].o++});const c=Object.keys(o).map(u=>({floor:u,rate:o[u].o/o[u].t*100}));return{avgOccupancy:n,peakOccupancy:i,occupancyByTime:s,occupancyByFloor:c,roomMetrics:[],totalObservations:t,totalRooms:0,overallUtilization:n,overallAvgAttendees:0,globalSizeBins:[],globalInsights:[]}},b1e=e=>e===1?"1p":e===2?"2p":e>=3&&e<=4?"3-4p":e>=5&&e<=7?"5-7p":e>=8&&e<=11?"8-11p":e>=12?"12p+":"0p",q5=e=>{const t=new Map,r=new Set;e.forEach(s=>{if(s.roomName&&r.add(s.roomName),!s.timeSlot)return;const o=s.week||1,c=s.day||1,u=s.timeSlot.trim(),f=`W${o}-D${c}-${u}`;t.has(f)||t.set(f,{week:o,day:c,timeStr:u,allRooms:new Set,occupiedRooms:new Set});const d=t.get(f),h=s.roomName||"Unknown";d.allRooms.add(h),s.isOccupied&&d.occupiedRooms.add(h)});const n=Array.from(t.values()).map(s=>{const o=s.allRooms.size,c=s.occupiedRooms.size,u=o>0?c/o*100:0;let f=0;if(s.timeStr.includes(":")){const h=s.timeStr.split(":");f=(parseInt(h[0])||0)*60+(parseInt(h[1])||0)}else{const h=parseFloat(s.timeStr);isNaN(h)||(h<1?f=h*1440:f=h)}const d=s.week*1e5+s.day*2e3+f;return{time:`W${s.week} D${s.day} ${s.timeStr}`,sortKey:d,occupied:c,total:o,pct:u}}).sort((s,o)=>s.sortKey-o.sortKey).map(({time:s,occupied:o,total:c,pct:u})=>({time:s,occupied:o,total:c,pct:u})),a=n.length>0?n.reduce((s,o)=>s+o.pct,0)/n.length:0,i=n.length>0?Math.max(...n.map(s=>s.pct)):0;return{avgPct:a,maxPct:i,timeline:n,uniqueRoomsCount:r.size}},w1e=(e,t={})=>{const r=new Map;e.forEach(g=>{const b=`${g.floor}::${g.roomName}::${g.week}::${g.day}::${g.timeSlot}`;r.has(b)||r.set(b,{eventId:b,floor:g.floor,roomName:g.roomName||"Unknown",roomType:g.roomType||"General",week:g.week||0,day:g.day||0,time:g.timeSlot,attendees:0,occupied:!1,rawRowIds:[]});const m=r.get(b);m.rawRowIds.push(g.id),g.isOccupied&&(m.occupied=!0,m.attendees+=g.attendeeCount||1)});const n=new Map,a={},i=["1p","2p","3-4p","5-7p","8-11p","12p+"];i.forEach(g=>a[g]=0);let s=0,o=0;r.forEach(g=>{const b=`${g.floor}::${g.roomName}`;n.has(b)||n.set(b,{floor:g.floor,name:g.roomName,type:g.roomType,totalMeetings:0,occupiedMeetings:0,totalAttendees:0,sizeCounts:{},binCounts:{},eventsBySize:{},fitBuckets:{low:[],mid:[],fit:[],over:[]}});const m=n.get(b);if(m.totalMeetings++,g.occupied&&g.attendees>0){m.occupiedMeetings++,m.totalAttendees+=g.attendees,s++,o+=g.attendees;const S=g.attendees;m.sizeCounts[S]=(m.sizeCounts[S]||0)+1;const w={week:g.week,day:g.day,time:g.time,attendees:g.attendees,eventId:g.eventId,floor:g.floor,roomName:g.roomName,roomType:g.roomType,rawRowIds:g.rawRowIds};m.eventsBySize[S]||(m.eventsBySize[S]=[]),m.eventsBySize[S].push(w);const _=b1e(S);m.binCounts[_]=(m.binCounts[_]||0)+1,a[_]=(a[_]||0)+1;const k=t[b]||0;if(k>0){const N=g.attendees/k;N<.4?m.fitBuckets.low.push(w):N<.7?m.fitBuckets.mid.push(w):N<=1?m.fitBuckets.fit.push(w):m.fitBuckets.over.push(w)}}});const c=[];n.forEach((g,b)=>{const m=Object.keys(g.sizeCounts).map(H=>{const J=parseInt(H),ue=g.sizeCounts[J],le=g.occupiedMeetings>0?ue/g.occupiedMeetings*100:0,Z=(g.eventsBySize[J]||[]).sort((ee,fe)=>ee.day!==fe.day?ee.day-fe.day:ee.time.localeCompare(fe.time));return{floor:g.floor,roomName:g.name,size:J,count:ue,occupancyPct:le,events:Z}}).sort((H,J)=>H.size-J.size),S=t[b]||0,w=g.occupiedMeetings>0?g.totalAttendees/g.occupiedMeetings:0,_=Math.round(w);let k=0,N="";Object.entries(g.binCounts).forEach(([H,J])=>{J>k&&(k=J,N=H)});let j=0;switch(N){case"1p":j=1;break;case"2p":j=2;break;case"3-4p":j=3.5;break;case"5-7p":j=6;break;case"8-11p":j=9.5;break;case"12p+":j=12;break;default:j=0}const E=Math.round(j),O=g.occupiedMeetings>0?k/g.occupiedMeetings*100:0,T=j>0?`${N} (${O.toFixed(0)}%)`:"-";let L="Mixed Pattern / Review Required",X="Mixed",M=0,U=0;S<=0?(L="Unclassified",X="Missing Capacity"):g.occupiedMeetings===0?(L="Underutilized / Size Mismatch",X="No Usage"):(M=_/S,U=E/S,M>1||U>1?(L="Over Capacity Risk",X="Avg or Typical > 100%"):M<.5&&U<.5?(L="Underutilized / Size Mismatch",X="Both Metrics < 50%"):M>=.5&&M<=.79&&U>=.5&&U<=.79?(L="Reasonably Utilized",X="Both Metrics 50-79%"):M>=.8&&M<=1&&U>=.8&&U<=1?(L="Over Utilized",X="Both Metrics 80-100%"):(L="Mixed Pattern / Review Required",X="Metrics in different bands"));const q=g.fitBuckets.low.length,K=g.fitBuckets.mid.length,F=g.fitBuckets.fit.length,Q=g.fitBuckets.over.length,ie=g.occupiedMeetings>0?q/g.occupiedMeetings:0,A=g.occupiedMeetings>0?K/g.occupiedMeetings:0,R=g.occupiedMeetings>0?F/g.occupiedMeetings:0,D=g.occupiedMeetings>0?Q/g.occupiedMeetings:0;c.push({floor:g.floor,roomName:g.name,roomType:g.type,capacity:S,observedSlots:g.totalMeetings,occupiedSlots:g.occupiedMeetings,utilizationPct:g.totalMeetings>0?g.occupiedMeetings/g.totalMeetings*100:0,avgOccupancy:w,meetingSizeDistribution:g.binCounts,sizeBreakdown:m,topMeetingSize:T,avgCapRatio:M,classification:L,analysis:{avgOccRaw:w,avgOccRounded:_,avgRatio:M,typicalBin:N,typicalTypeVal:j,typicalRounded:E,typicalRatio:U,statusRule:X},capacityFit:{low:{count:q,pct:ie*100,events:g.fitBuckets.low},mid:{count:K,pct:A*100,events:g.fitBuckets.mid},fit:{count:F,pct:R*100,events:g.fitBuckets.fit},over:{count:Q,pct:D*100,events:g.fitBuckets.over}}})});const u=c.reduce((g,b)=>g+b.observedSlots,0),f=i.map(g=>({label:g,count:a[g],occupancyPct:s>0?a[g]/s*100:0})),d=[],h=a["1p"]||0,p=a["2p"]||0,v=a["8-11p"]||0,x=a["12p+"]||0;if(s>0){const g=(h+p)/s*100,b=(v+x)/s*100;g>60&&d.push("Most interactions are small-format (1-2p), suggesting high demand for focus or dyad rooms."),b>15&&d.push("Notable volume of mid-to-large meetings indicates valid need for formal conference spaces."),b<5&&d.push("Large meetings (8p+) are infrequent; consider repurposing large boardrooms."),a["3-4p"]>a["1p"]&&d.push("Small group collaboration (3-4p) is a dominant behavior.")}else d.push("Insufficient data to generate behavioral insights.");const y=q5(e);return{avgOccupancy:0,peakOccupancy:0,occupancyByTime:[],occupancyByFloor:[],roomMetrics:c,totalObservations:u,totalRooms:n.size,overallUtilization:u>0?s/u*100:0,overallAvgAttendees:s>0?o/s:0,globalSizeBins:f,globalInsights:d,concurrencyStats:y}},_1e=e=>{const t=[],r=["L10","L11","L12"],n=["09:00","10:00","11:00","13:00","14:00","15:00","16:00"];if(e==="workstation"){const a=["Sales","IT","HR","Finance","Product"];for(let i=0;i<800;i++){const s=Math.random()>.4;t.push({id:`sim-${i}`,date:"2024-01-01",timeSlot:n[Math.floor(Math.random()*n.length)],floor:r[Math.floor(Math.random()*r.length)],department:a[Math.floor(Math.random()*a.length)],isOccupied:s})}}else{const a=[{name:"Focus 01",type:"Focus Room"},{name:"Meet 01",type:"Meeting Room"},{name:"Meet 02",type:"Meeting Room"},{name:"Boardroom",type:"Boardroom"}];for(let i=0;i<500;i++){const s=a[Math.floor(Math.random()*a.length)],o=n[Math.floor(Math.random()*n.length)],c=r[Math.floor(Math.random()*r.length)],u=Math.floor(Math.random()*5)+1;if(!(Math.random()>.3))t.push({id:`sim-empty-${i}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!1,date:""});else{const d=Math.floor(Math.random()*8)+1;for(let h=0;h<d;h++)t.push({id:`sim-occ-${i}-${h}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!0,attendeeCount:1,date:""})}}}return t},S1e=()=>{const[e,t]=G.useState("import"),[r,n]=G.useState("workstation"),[a,i]=G.useState([]),[s,o]=G.useState([]),[c,u]=G.useState({}),[f,d]=G.useState([]),[h,p]=G.useState(null),[v,x]=G.useState(!1),[y,g]=G.useState(1),[b,m]=G.useState(""),[S,w]=G.useState(null),[_,k]=G.useState(!1),N=(O,T)=>{k(!0),i(O),m(T);const L=O[0];o(L);const X=v1e(L,r==="workstation"?"workstation":"meeting");u(X);const M=c4(O,X,r==="workstation"?"workstation":"meeting");d(M);const U=g1e(O,X,r==="workstation"?"workstation":"meeting");!U.isValid||U.warnings.length>0?(p({missing:U.missingFields,warnings:U.warnings}),x(!0)):(p(null),x(!1)),setTimeout(()=>{k(!1),t("results")},800)},j=async O=>{var L;const T=(L=O.target.files)==null?void 0:L[0];if(T)try{const X=await x1e(T);X&&X.length>0?(N(X,T.name),w(null)):w("File appears empty.")}catch{w("Failed to parse Excel.")}},E=()=>{const O=_1e(r==="workstation"?"workstation":"meeting");d(O),m("Sample_Data.xlsx"),x(!1),t("results")};return e==="results"?l.jsx(k1e,{records:f,type:r,onBack:()=>{t("import"),g(1)},headers:s,rawData:a,currentMappings:c,initialShowMapping:v,onUpdateMappings:O=>{u(O);const T=c4(a,O,r==="workstation"?"workstation":"meeting");d(T)}}):l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 overflow-hidden",children:[l.jsx("div",{className:"p-6 border-b border-slate-200 bg-white flex justify-between items-center",children:l.jsxs("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(cc,{className:"w-6 h-6 text-orange-500"})," Utilization Study"]})}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[500px] flex flex-col justify-center",children:[y===1&&l.jsxs("div",{className:"p-10 text-center animate-in fade-in",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Study Type"}),l.jsx("p",{className:"text-slate-500 mb-8",children:"Choose the analytical lens for your observation data."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto",children:[l.jsxs("button",{onClick:()=>{n("workstation"),g(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(In,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(In,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Workstation Occupancy"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Analyze desk usage, peak loads, and department patterns."})]}),l.jsxs("button",{onClick:()=>{n("meeting"),g(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(Xr,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(Xr,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Meeting Utilization"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Evaluate room capacity sizing and frequency of use."})]})]})]}),y===2&&l.jsx("div",{className:"p-10 text-center animate-in fade-in",children:_?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-600 rounded-full animate-spin mb-6"}),l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Processing Data..."}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Auto-detecting columns and calculating metrics."})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:l.jsx(KT,{className:"w-10 h-10 text-slate-400"})}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Upload Data Source"}),l.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:"Upload your Excel observation log. The system will automatically detect fields like Date, Time, Floor, and Occupancy."}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("label",{className:"cursor-pointer bg-slate-900 hover:bg-slate-800 text-white px-8 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3",children:[l.jsx(PT,{className:"w-5 h-5"}),"Select Excel File",l.jsx("input",{type:"file",className:"hidden",accept:".xlsx, .xls",onChange:j})]}),l.jsx("button",{onClick:E,className:"text-sm font-bold text-slate-400 hover:text-orange-600 transition-colors py-2",children:"Use Sample Dataset"})]}),S&&l.jsxs("div",{className:"mt-6 bg-rose-50 text-rose-600 px-4 py-3 rounded-lg inline-flex items-center gap-2 text-sm font-medium",children:[l.jsx(Or,{className:"w-4 h-4"})," ",S]}),l.jsx("button",{onClick:()=>g(1),className:"mt-12 text-xs font-bold text-slate-400 hover:text-slate-600",children:" Back to Study Type"})]})})]})})]})},k1e=({records:e,type:t,onBack:r,headers:n,rawData:a,currentMappings:i,initialShowMapping:s,onUpdateMappings:o})=>{const[c,u]=G.useState(!1),[f,d]=G.useState(null),[h,p]=G.useState(null),[v,x]=G.useState({});G.useEffect(()=>{c&&x({...i})},[c,i]),G.useEffect(()=>{s&&u(!0)},[s]);const y=()=>{o(v),u(!1)},[g,b]=G.useState({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),[m,S]=G.useState({}),w=G.useMemo(()=>{const M=new Set,U=new Set,q=new Set,K=new Set,F=new Set,Q=new Set,ie=new Set,A=new Set,R=D=>["level","floor","department","room","type","capacity","week","day","time"].includes(String(D).toLowerCase().trim());return e.forEach(D=>{D.floor&&!R(D.floor)&&M.add(D.floor),D.roomName&&!R(D.roomName)&&U.add(D.roomName),D.roomType&&!R(D.roomType)&&q.add(D.roomType),D.week!==void 0&&K.add(D.week.toString()),D.day!==void 0&&F.add(D.day),D.timeSlot&&!R(D.timeSlot)&&Q.add(D.timeSlot),D.department&&!R(D.department)&&ie.add(D.department),D.date&&A.add(D.date)}),{floors:Array.from(M).sort(),rooms:Array.from(U).sort(),types:Array.from(q).sort(),weeks:Array.from(K).sort((D,H)=>parseInt(D)-parseInt(H)),days:Array.from(F).sort((D,H)=>D-H).map(String),timeSlots:Array.from(Q).sort(),depts:Array.from(ie).sort(),dates:Array.from(A).sort()}},[e]),_=G.useMemo(()=>e.filter(M=>{if(g.floors.length&&!g.floors.includes(M.floor)||g.timeSlots.length&&!g.timeSlots.includes(M.timeSlot))return!1;if(t==="meeting"){if(g.rooms.length&&M.roomName&&!g.rooms.includes(M.roomName)||g.types.length&&M.roomType&&!g.types.includes(M.roomType)||g.weeks.length&&M.week!==void 0&&!g.weeks.includes(M.week.toString())||g.days.length&&M.day!==void 0&&!g.days.includes(M.day.toString()))return!1}else if(g.depts.length&&M.department&&!g.depts.includes(M.department)||g.dates.length&&M.date&&!g.dates.includes(M.date))return!1;return!0}),[e,g,t]),k=G.useMemo(()=>t==="workstation"?y1e(_):w1e(_,m),[_,t,m]),N=t==="workstation"?X5:K5,j=N.filter(M=>M.required&&i[M.key]===void 0),E=j.length>0,O=(M,U)=>{b(q=>{const K=q[M];return{...q,[M]:K.includes(U)?K.filter(F=>F!==U):[...K,U]}})},T=(M,U,q)=>{const K=`${M}::${U}`;S(F=>({...F,[K]:q}))},L=({label:M,items:U,active:q,field:K})=>l.jsxs("div",{className:"relative group",children:[l.jsxs("button",{className:`flex items-center gap-1.5 px-3 py-1.5 text-xs font-bold rounded-lg border transition-colors ${q.length>0?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-600 hover:border-slate-300"}`,children:[M," ",q.length>0&&l.jsx("span",{className:"bg-indigo-600 text-white px-1.5 rounded-full text-[9px]",children:q.length}),l.jsx(Gr,{className:"w-3 h-3 rotate-90 text-slate-400"})]}),l.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 hidden group-hover:block z-50 p-2 max-h-64 overflow-y-auto",children:U.length===0?l.jsx("div",{className:"p-2 text-xs text-slate-400 italic",children:"No options found"}):U.map(F=>l.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"rounded text-indigo-600 focus:ring-indigo-500",checked:q.includes(F),onChange:()=>O(K,F)}),l.jsx("span",{className:"text-xs text-slate-700 truncate",children:F})]},F))})]}),X=()=>{const M=gr.book_new(),U=gr.json_to_sheet(_);if(gr.book_append_sheet(M,U,"Raw Data"),t==="meeting"&&k.roomMetrics){const q=k.roomMetrics.map(F=>({Floor:F.floor,"Room Name":F.roomName,Type:F.roomType,"Room Capacity (User)":F.capacity,"Observed Slots":F.observedSlots,"Occupied Slots":F.occupiedSlots,"Utilization %":(F.utilizationPct/100).toFixed(2),"Avg Occupancy":F.avgOccupancy.toFixed(1),"Top Meeting Size":F.topMeetingSize,Classification:F.classification})),K=gr.json_to_sheet(q);gr.book_append_sheet(M,K,"Room Performance")}qm(M,"Utilization_Analysis.xlsx")};return l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 relative",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm z-20",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 transition-colors",children:l.jsx(Gr,{className:"w-5 h-5 rotate-180"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[t==="workstation"?"Workstation Occupancy":"Meeting Utilization",E&&l.jsxs("span",{title:"Mapping Incomplete",className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-200",children:[l.jsx(Or,{className:"w-3 h-3"})," Fix Mapping"]})]}),l.jsxs("p",{className:"text-xs text-slate-500",children:[_.length," Observations Analyzed"]})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white border border-transparent rounded-lg text-xs font-bold shadow-sm",children:[l.jsx(Ei,{className:"w-4 h-4"})," Export"]})})]}),t==="workstation"&&l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-2 flex items-center gap-4 z-10 overflow-x-auto",children:[l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase mr-2",children:[l.jsx(Jd,{className:"w-3 h-3"})," Filters:"]}),l.jsx(L,{label:"Floor",items:w.floors,active:g.floors,field:"floors"}),l.jsx(L,{label:"Time Slot",items:w.timeSlots,active:g.timeSlots,field:"timeSlots"}),l.jsx(L,{label:"Department",items:w.depts,active:g.depts,field:"depts"}),l.jsx(L,{label:"Date",items:w.dates,active:g.dates,field:"dates"}),l.jsxs("button",{onClick:()=>b({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),className:"ml-auto text-xs font-bold text-rose-500 hover:text-rose-700 flex items-center gap-1",children:[l.jsx(xn,{className:"w-3 h-3"})," Clear"]})]}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto custom-scrollbar",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:_.length===0?l.jsxs("div",{className:"text-center py-20 text-slate-400",children:[l.jsx(Jd,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),l.jsx("p",{children:"No records match the current filters."})]}):t==="workstation"?l.jsx(E1e,{metrics:k}):l.jsx(P1e,{metrics:k,records:_,onUpdateCapacity:T,onDrillDown:(M,U,q)=>d({title:M,events:U,context:q})})})}),c&&l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[450px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800",children:"Auto Field Detection"}),l.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Map Excel columns to required system fields."})]}),l.jsx("button",{onClick:()=>u(!1),children:l.jsx(xn,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[E&&l.jsxs("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[l.jsx(Or,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block mb-1",children:"Missing Required Fields"}),l.jsx("ul",{className:"list-disc list-inside space-y-0.5",children:j.map(M=>l.jsx("li",{children:M.label},M.key))})]})]}),l.jsx("div",{className:"space-y-6",children:N.map(M=>{const U=v[M.key],q=U!==void 0&&a.length>1?a.slice(1,4).map(K=>K[U]).filter(K=>K!==void 0&&K!==""):[];return l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm",children:[l.jsxs("label",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[M.label,M.required&&l.jsx("span",{className:"text-rose-500",title:"Required",children:"*"})]}),U===void 0&&M.required&&l.jsx("span",{className:"text-[9px] text-rose-500 font-bold uppercase bg-rose-50 px-1.5 py-0.5 rounded",children:"Unmapped"})]}),l.jsxs("select",{className:`w-full p-2 text-sm border rounded outline-none transition-all ${U===void 0&&M.required?"border-rose-300 bg-rose-50 focus:border-rose-500":"border-slate-300 bg-white focus:border-indigo-500"}`,value:U??"",onChange:K=>{const F=K.target.value,Q={...v};F===""?delete Q[M.key]:Q[M.key]=parseInt(F),x(Q)},children:[l.jsx("option",{value:"",children:"(Select Excel Column)"}),n.map((K,F)=>l.jsx("option",{value:F,children:K},F))]}),l.jsx("div",{className:"mt-2 min-h-[1.5em]",children:U!==void 0?l.jsxs("div",{className:"text-[10px] text-slate-500 flex items-start gap-1.5 bg-slate-50 p-1.5 rounded",children:[l.jsx("span",{className:"font-bold text-slate-400 uppercase text-[9px] mt-0.5",children:"Preview:"}),l.jsx("span",{className:"font-mono text-slate-700 break-all leading-tight",children:q.length>0?q.join(", "):l.jsx("span",{className:"italic text-slate-400",children:"Empty column"})})]}):l.jsx("div",{className:"text-[10px] text-slate-300 italic pl-1",children:"Map a column to see preview"})})]},M.key)})})]}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:y,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(uc,{className:"w-4 h-4"})," Apply Mapping"]})})]})}),f&&l.jsx(N1e,{title:f.title,events:f.events,context:f.context,onClose:()=>d(null),onJumpToRaw:M=>p(M)}),h&&l.jsx(j1e,{ids:h,allRecords:e,onClose:()=>p(null)})]})},N1e=({title:e,events:t,context:r,onClose:n,onJumpToRaw:a})=>{const i=()=>{const s=t.map(u=>({Week:u.week,Day:u.day,Time:u.time,Floor:u.floor,Room:u.roomName,Type:u.roomType,Attendees:u.attendees})),o=gr.book_new(),c=gr.json_to_sheet(s);gr.book_append_sheet(o,c,"Events"),qm(o,"Drilldown_Events.xlsx")};return l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[600px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-6 border-b border-slate-200 bg-slate-50 flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e,l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-sm px-2 py-0.5 rounded-full",children:t.length})]}),r&&l.jsxs("div",{className:"mt-2 p-2 bg-indigo-50 border border-indigo-100 rounded text-xs text-indigo-700 font-medium",children:["These events contribute to the room being classified as ",l.jsx("span",{className:"font-bold uppercase",children:r}),"."]})]}),l.jsx("button",{onClick:n,children:l.jsx(xn,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-0",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-white border-b border-slate-200 text-xs text-slate-500 uppercase font-semibold sticky top-0 z-10 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Wk-Day"}),l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Time"}),l.jsx("th",{className:"px-6 py-3 bg-white",children:"Room"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Attendees"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t.map((s,o)=>l.jsxs("tr",{className:"hover:bg-slate-50 group",children:[l.jsxs("td",{className:"px-6 py-3 font-medium text-slate-500",children:["W",s.week,"-D",s.day]}),l.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.time}),l.jsxs("td",{className:"px-6 py-3 text-slate-700",children:[l.jsx("div",{className:"truncate w-32",title:s.roomName,children:s.roomName}),l.jsx("div",{className:"text-[10px] text-slate-400",children:s.roomType})]}),l.jsx("td",{className:"px-6 py-3 text-right font-bold text-indigo-600",children:s.attendees}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("button",{onClick:()=>a(s.rawRowIds),className:"text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx(Gp,{className:"w-3 h-3"})," Raw Data"]})})]},o))})]})}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:i,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(Ei,{className:"w-4 h-4"})," Export Events CSV"]})})]})})},j1e=({ids:e,allRecords:t,onClose:r})=>{const n=t.filter(a=>e.includes(a.id));return l.jsx("div",{className:"absolute inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[80vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2",children:[l.jsx(Gp,{className:"w-5 h-5 text-indigo-600"})," Source Data Inspection"]}),l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Showing ",n.length," raw Excel row(s) corresponding to selected event."]})]}),l.jsx("button",{onClick:r,children:l.jsx(xn,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-auto p-6 bg-slate-50/50",children:l.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"ID"}),l.jsx("th",{className:"px-4 py-3",children:"Floor"}),l.jsx("th",{className:"px-4 py-3",children:"Room / Dept"}),l.jsx("th",{className:"px-4 py-3",children:"Day"}),l.jsx("th",{className:"px-4 py-3",children:"Time"}),l.jsx("th",{className:"px-4 py-3",children:"Occupancy"}),l.jsx("th",{className:"px-4 py-3",children:"Status"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(a=>l.jsxs("tr",{className:"hover:bg-indigo-50/30",children:[l.jsx("td",{className:"px-4 py-2 font-mono text-slate-400",children:a.id}),l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:a.floor}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.roomName||a.department}),l.jsxs("td",{className:"px-4 py-2 text-slate-600",children:["Day ",a.day]}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.timeSlot}),l.jsx("td",{className:"px-4 py-2 font-bold text-indigo-600",children:a.attendeeCount||1}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${a.isOccupied?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:a.isOccupied?"Occupied":"Vacant"})})]},a.id))})]})})}),l.jsx("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end",children:l.jsx("button",{onClick:r,className:"px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-bold transition-colors",children:"Close"})})]})})},E1e=({metrics:e})=>l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"col-span-1 lg:col-span-2 grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Avg Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-indigo-600 mt-2",children:[e.avgOccupancy.toFixed(0),"%"]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Peak Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-rose-500 mt-2",children:[e.peakOccupancy.toFixed(0),"%"]})]}),l.jsx("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:l.jsxs("div",{className:"flex gap-2 items-start text-xs text-slate-600",children:[l.jsx(dc,{className:"w-4 h-4 text-indigo-500 flex-shrink-0"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Insight:"})," ",e.avgOccupancy<50?"Low utilization suggests opportunity for desk sharing or consolidation.":"High utilization indicates steady demand."]})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy Profile (Time)"}),l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(IC,{data:e.occupancyByTime,children:[l.jsx(ho,{strokeDasharray:"3 3",vertical:!1}),l.jsx(vn,{dataKey:"time",tick:{fontSize:10}}),l.jsx(gn,{unit:"%",tick:{fontSize:10}}),l.jsx(Wt,{}),l.jsx(jc,{type:"monotone",dataKey:"rate",stroke:zr.primary,strokeWidth:3,dot:{r:4}})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy by Floor"}),l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Ec,{data:e.occupancyByFloor,layout:"vertical",children:[l.jsx(ho,{strokeDasharray:"3 3",horizontal:!1}),l.jsx(vn,{type:"number",unit:"%",hide:!0}),l.jsx(gn,{type:"category",dataKey:"floor",tick:{fontSize:11},width:50}),l.jsx(Wt,{}),l.jsx(da,{dataKey:"rate",fill:zr.program[0],radius:[0,4,4,0],barSize:20,label:{position:"right",fontSize:10,fill:"#64748b",formatter:t=>`${t.toFixed(0)}%`}})]})})]})]}),T1e=({room:e,onUpdateCapacity:t,onDrillDown:r})=>{var v;const[n,a]=G.useState(!1),[i,s]=G.useState(!1),[o,c]=G.useState(((v=e.capacity)==null?void 0:v.toString())||"");G.useEffect(()=>{i||c(e.capacity>0?e.capacity.toString():"")},[e.capacity,i]);const u=()=>{c(e.capacity>0?e.capacity.toString():""),s(!0)},f=()=>{const x=parseInt(o);!isNaN(x)&&x>0?t(e.floor,e.roomName,x):o===""&&t(e.floor,e.roomName,0),s(!1)},d=x=>{x.key==="Enter"&&f()},h=x=>x.includes("Under")?"bg-blue-50 text-blue-700 border-blue-200":x.includes("Over")?"bg-rose-50 text-rose-700 border-rose-200":x.includes("Reasonable")||x.includes("Well")?"bg-emerald-50 text-emerald-700 border-emerald-200":"bg-slate-100 text-slate-600 border-slate-200";e.sizeBreakdown.map(x=>({label:`${x.size}p`,pct:x.occupancyPct,count:x.count,size:x.size})).filter(x=>x.pct>0);const p=e.analysis||{avgOccRaw:e.avgOccupancy,avgOccRounded:Math.round(e.avgOccupancy),avgRatio:e.capacity>0?e.avgOccupancy/e.capacity:0,typicalBin:"N/A",typicalRounded:0,typicalRatio:0,statusRule:"Legacy Calculation"};return l.jsxs(l.Fragment,{children:[l.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${n?"bg-slate-50":"bg-white"}`,children:[l.jsx("td",{className:"px-6 py-4 text-slate-600 text-xs border-b border-slate-50",children:e.floor}),l.jsxs("td",{className:"px-4 py-4 border-b border-slate-50",children:[l.jsx("div",{className:"font-bold text-slate-700 text-sm",children:e.roomName}),l.jsx("div",{className:"text-[10px] text-slate-400",children:e.roomType})]}),l.jsx("td",{className:"px-4 py-4 text-center border-b border-slate-50",children:i?l.jsx("input",{type:"number",autoFocus:!0,className:"w-16 p-1 text-center border border-indigo-300 rounded text-xs bg-white focus:ring-2 focus:ring-indigo-500 outline-none shadow-sm",value:o,onChange:x=>c(x.target.value),onBlur:f,onKeyDown:d}):l.jsx("div",{onClick:u,className:"cursor-pointer group flex justify-center",children:e.capacity>0?l.jsxs("span",{className:"text-sm font-mono text-slate-600 border-b border-transparent group-hover:border-indigo-300 group-hover:text-indigo-600 transition-all px-1",children:[e.capacity," pax"]}):l.jsx("button",{className:"text-[10px] bg-slate-100 hover:bg-indigo-50 text-slate-500 hover:text-indigo-600 font-bold px-2 py-1 rounded border border-slate-200 hover:border-indigo-200 transition-colors",children:"Set"})})}),l.jsxs("td",{className:"px-4 py-4 text-center font-bold text-slate-700 border-b border-slate-50",children:[e.utilizationPct.toFixed(0),"%"]}),l.jsx("td",{className:"px-4 py-4 text-center font-mono text-slate-600 border-b border-slate-50",children:e.avgOccupancy.toFixed(1)}),l.jsx("td",{className:"px-4 py-4 border-b border-slate-50",children:l.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase border ${h(e.classification)}`,children:e.classification.split("/")[0].trim()})}),l.jsx("td",{className:"px-4 py-4 text-center border-b border-slate-50",children:l.jsx("button",{onClick:()=>a(!n),className:"p-1 hover:bg-slate-200 rounded-full text-slate-400 transition-colors",children:n?l.jsx(h8,{className:"w-4 h-4"}):l.jsx(pn,{className:"w-4 h-4"})})})]}),n&&l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"px-6 py-4 bg-slate-50 border-b border-slate-200 shadow-inner",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-in slide-in-from-top-1",children:[l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-center gap-4",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase",children:"Room Snapshot"}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-slate-700",children:e.occupiedSlots}),l.jsx("div",{className:"text-[9px] text-slate-400",children:"Total Meetings"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-bold text-indigo-600",children:[e.utilizationPct.toFixed(0),"%"]}),l.jsx("div",{className:"text-[9px] text-slate-400",children:"Utilization"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-bold text-slate-700",children:e.avgOccupancy.toFixed(1)}),l.jsx("div",{className:"text-[9px] text-slate-400",children:"Avg Occ"})]})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col gap-3",children:[l.jsxs("div",{className:"flex justify-between items-start border-b border-slate-50 pb-2 mb-1",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase",children:"Fit Analysis"}),l.jsxs("div",{className:"text-[10px] text-slate-500",children:["Capacity: ",l.jsxs("strong",{children:[e.capacity||"?"," pax"]})]})]}),e.capacity>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs mb-2",children:[l.jsx("div",{className:"text-slate-400 font-medium",children:"Metric"}),l.jsx("div",{className:"text-right text-slate-400 font-medium",children:"Value"}),l.jsx("div",{className:"text-right text-slate-400 font-medium",children:"% Cap"}),l.jsx("div",{className:"text-slate-700 font-bold",children:"Average"}),l.jsxs("div",{className:"text-right font-mono text-slate-600",children:[p.avgOccRaw.toFixed(1)," ",l.jsxs("span",{className:"text-slate-400",children:[" ",p.avgOccRounded]})]}),l.jsxs("div",{className:"text-right font-bold text-indigo-600",children:[(p.avgRatio*100).toFixed(0),"%"]}),l.jsx("div",{className:"text-slate-700 font-bold",children:"Typical"}),l.jsxs("div",{className:"text-right font-mono text-slate-600",children:[p.typicalBin," ",l.jsxs("span",{className:"text-slate-400",children:[" ",p.typicalRounded]})]}),l.jsxs("div",{className:"text-right font-bold text-indigo-600",children:[(p.typicalRatio*100).toFixed(0),"%"]})]}),l.jsxs("div",{className:"mt-auto bg-slate-50 p-2 rounded border border-slate-100 text-[10px] flex items-start gap-2",children:[l.jsx(dc,{className:"w-3 h-3 text-slate-400 mt-0.5 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold text-slate-500 uppercase",children:"Logic:"}),l.jsx("span",{className:"text-slate-600 ml-1",children:p.statusRule})]})]})]}):l.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-center p-4 bg-amber-50 rounded border border-amber-100 border-dashed",children:[l.jsx(Or,{className:"w-5 h-5 text-amber-400 mb-2"}),l.jsx("p",{className:"text-xs text-amber-700 font-medium",children:"Set capacity above to evaluate fit."})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[l.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase mb-3 flex justify-between items-center",children:[l.jsx("span",{children:"Size Breakdown"}),l.jsxs("button",{onClick:()=>r(`Events in ${e.roomName}`,e.sizeBreakdown.flatMap(x=>x.events),e.classification),className:"text-[9px] bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1 rounded flex items-center gap-1",children:[l.jsx(S8,{className:"w-3 h-3"})," View All Events"]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto max-h-24 pr-1 custom-scrollbar",children:l.jsxs("table",{className:"w-full text-xs text-left",children:[l.jsx("thead",{className:"text-slate-400 border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"font-normal pb-1",children:"Size"}),l.jsx("th",{className:"font-normal pb-1 text-right",children:"Count"}),l.jsx("th",{className:"font-normal pb-1 text-right",children:"%"})]})}),l.jsx("tbody",{className:"text-slate-600",children:e.sizeBreakdown.map((x,y)=>l.jsxs("tr",{className:"border-b border-slate-50 last:border-0",children:[l.jsxs("td",{className:"py-1",children:[x.size," pax"]}),l.jsx("td",{className:"py-1 text-right",children:x.count}),l.jsxs("td",{className:"py-1 text-right font-medium",children:[x.occupancyPct.toFixed(0),"%"]})]},y))})]})})]})]})})})]})},A1e=({stats:e,roomTypes:t,selectedType:r,onSelectType:n,activeTotalRooms:a})=>{const[i,s]=G.useState({bar:"#cbd5e1",highlight:"#f43f5e",line:"#6366f1"}),[o,c]=G.useState(!1),[u,f]=G.useState(!1),d=G.useRef(null);if(G.useEffect(()=>{const m=localStorage.getItem("mm_chart_colors");if(m)try{s(JSON.parse(m))}catch{}},[]),!e||!e.timeline)return null;const h=Math.round(e.avgPct/100*a),p=Math.round(e.maxPct/100*a),v=r==="All Rooms"?"OVERALL ROOM OCCUPANCY (CONCURRENCY)":`${r.toUpperCase()} OCCUPANCY (CONCURRENCY)`,x=m=>{s(m),localStorage.setItem("mm_chart_colors",JSON.stringify(m))},y=()=>{x({bar:"#cbd5e1",highlight:"#f43f5e",line:"#6366f1"})},g=()=>{const m=["Time","Occupied Rooms","Total Rooms","Concurrency %"],S=e.timeline.map(k=>[k.time,k.occupied,k.total,k.pct.toFixed(2)]),w="data:text/csv;charset=utf-8,"+[m.join(","),...S.map(k=>k.join(","))].join(`
`),_=document.createElement("a");_.setAttribute("href",encodeURI(w)),_.setAttribute("download","concurrency_data.csv"),document.body.appendChild(_),_.click(),document.body.removeChild(_),f(!1)},b=()=>{if(!d.current)return;const m=d.current.querySelector("svg");if(!m)return;const w=new XMLSerializer().serializeToString(m),_=new Blob([w],{type:"image/svg+xml;charset=utf-8"}),k=URL.createObjectURL(_),N=document.createElement("canvas");N.width=1200,N.height=600;const j=N.getContext("2d");if(!j)return;j.fillStyle="#ffffff",j.fillRect(0,0,N.width,N.height);const E=new Image;E.onload=()=>{j.drawImage(E,40,40,1120,520);const O=N.toDataURL("image/png"),T=document.createElement("a");T.download="concurrency_chart.png",T.href=O,T.click(),URL.revokeObjectURL(k),f(!1)},E.src=k};return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 flex flex-col md:flex-row gap-8 relative",children:[l.jsxs("div",{className:"md:w-1/3 flex flex-col justify-center space-y-6",children:[l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-between items-start mb-2",children:l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase",children:v})}),l.jsxs("div",{className:"relative group w-full mb-4",children:[l.jsx("select",{className:"w-full appearance-none bg-slate-50 border border-slate-200 text-sm font-bold text-slate-700 py-2 pl-3 pr-8 rounded-lg hover:border-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 cursor-pointer",value:r,onChange:m=>n(m.target.value),children:t.map(m=>l.jsx("option",{value:m,children:m},m))}),l.jsx(pn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]}),l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>f(!u),className:"p-2 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 text-slate-500 hover:text-indigo-600 transition-colors",title:"Download",children:l.jsx(Ei,{className:"w-4 h-4"})}),u&&l.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-40 bg-white border border-slate-200 rounded-lg shadow-xl z-20 overflow-hidden",children:[l.jsxs("button",{onClick:b,className:"w-full text-left px-4 py-2 text-xs font-bold text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[l.jsx(IT,{className:"w-3 h-3"})," Download PNG"]}),l.jsxs("button",{onClick:g,className:"w-full text-left px-4 py-2 text-xs font-bold text-slate-600 hover:bg-slate-50 flex items-center gap-2",children:[l.jsx(fc,{className:"w-3 h-3"})," Download CSV"]})]})]}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>c(!o),className:`p-2 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors ${o?"text-indigo-600 border-indigo-200":"text-slate-500"}`,title:"Chart Colors",children:l.jsx(Wp,{className:"w-4 h-4"})}),o&&l.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-56 bg-white border border-slate-200 rounded-xl shadow-xl z-20 p-4 animate-in fade-in slide-in-from-bottom-2",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-800 mb-3 border-b border-slate-100 pb-2",children:"Chart Theme"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Standard Bar"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.bar,onChange:m=>x({...i,bar:m.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.bar})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Max Peak (Highlight)"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.highlight,onChange:m=>x({...i,highlight:m.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.highlight})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] text-slate-500 font-bold block mb-1",children:"Average Line"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"color",value:i.line,onChange:m=>x({...i,line:m.target.value}),className:"w-6 h-6 rounded cursor-pointer border-0 p-0"}),l.jsx("span",{className:"text-[10px] font-mono text-slate-400",children:i.line})]})]}),l.jsxs("button",{onClick:y,className:"w-full mt-2 py-1.5 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded text-[10px] font-bold flex items-center justify-center gap-1",children:[l.jsx(Z8,{className:"w-3 h-3"})," Reset Defaults"]})]})]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[l.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-100 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Total Rooms"}),l.jsx("span",{className:"text-xl font-bold text-slate-800",children:a})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Avg Occupied"}),l.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[e.avgPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-[10px] font-medium text-slate-400 mt-1 leading-tight",children:[" ",h," in use"]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Max Occupied"}),l.jsxs("div",{className:"text-2xl font-bold text-rose-500",children:[e.maxPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-[10px] font-medium text-slate-400 mt-1 leading-tight",children:[" ",p," in use"]})]})]})]})]}),l.jsxs("div",{className:"md:w-2/3 flex flex-col",ref:d,children:[l.jsx("div",{className:"h-64 relative",children:e.timeline.length>0?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"absolute top-0 right-4 z-10 px-3 py-1 rounded-full text-xs font-bold shadow-sm border bg-white flex items-center gap-2",style:{borderColor:i.line,color:i.line},children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:i.line}}),"Avg ",e.avgPct.toFixed(1),"%"]}),l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Ec,{data:e.timeline,margin:{top:20,right:20,left:0,bottom:0},children:[l.jsx(ho,{strokeDasharray:"3 3",vertical:!1}),l.jsx(vn,{dataKey:"time",tick:{fontSize:10},interval:"preserveStartEnd",minTickGap:30}),l.jsx(gn,{unit:"%",tick:{fontSize:10},domain:[0,100]}),l.jsx(Wt,{content:({active:m,payload:S,label:w})=>{if(m&&S&&S.length){const _=S[0].payload;return l.jsxs("div",{className:"bg-white p-2 border border-slate-200 rounded shadow-lg text-xs",children:[l.jsx("div",{className:"font-bold text-slate-800 mb-1",children:w}),l.jsxs("div",{className:"text-indigo-600 font-bold",children:[_.pct.toFixed(1),"% Occupied"]}),l.jsxs("div",{className:"text-slate-500",children:[_.occupied," / ",_.total," Rooms Observed"]})]})}return null}}),l.jsx(f0,{y:e.avgPct,stroke:i.line,strokeDasharray:"3 3"}),l.jsx(da,{dataKey:"pct",fill:i.bar,radius:[2,2,0,0],children:e.timeline.map((m,S)=>l.jsx(Oi,{fill:m.pct===e.maxPct?i.highlight:i.bar},`cell-${S}`))})]})})]}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-100 rounded-xl",children:[l.jsx(cc,{className:"w-8 h-8 mb-2"}),l.jsx("p",{className:"text-xs",children:"No occupied observations for selected room type."})]})}),e.timeline.length>0&&l.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-[10px] text-slate-500 font-medium",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:i.bar}}),l.jsx("span",{children:"Occupied"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:i.highlight}}),l.jsx("span",{children:"Peak"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-4 h-0.5 border-t-2 border-dashed",style:{borderColor:i.line}}),l.jsx("span",{children:"Average"})]})]})]})]})},O1e=({metrics:e})=>{const[t,r]=G.useState(zr.program),[n,a]=G.useState(!1),i=G.useRef(null),s=()=>{const f=["Size Group","Count","Occupancy %"],d=e.globalSizeBins.map(v=>[v.label,v.count,v.occupancyPct.toFixed(1)]),h="data:text/csv;charset=utf-8,"+[f.join(","),...d.map(v=>v.join(","))].join(`
`),p=document.createElement("a");p.setAttribute("href",encodeURI(h)),p.setAttribute("download","meeting_size_dist.csv"),document.body.appendChild(p),p.click(),document.body.removeChild(p)},o=()=>{if(!i.current)return;const f=i.current.querySelector("svg");if(!f)return;const h=new XMLSerializer().serializeToString(f),p=new Blob([h],{type:"image/svg+xml;charset=utf-8"}),v=URL.createObjectURL(p),x=document.createElement("canvas");x.width=800,x.height=600;const y=x.getContext("2d");if(!y)return;y.fillStyle="#ffffff",y.fillRect(0,0,x.width,x.height);const g=new Image;g.onload=()=>{y.drawImage(g,50,50,700,500);const b=x.toDataURL("image/png"),m=document.createElement("a");m.download="meeting_size_dist.png",m.href=b,m.click(),URL.revokeObjectURL(v)},g.src=v},c=e.globalSizeBins.reduce((f,d)=>f.count>d.count?f:d,e.globalSizeBins[0]),u=({cx:f,cy:d,midAngle:h,innerRadius:p,outerRadius:v,percent:x,index:y,name:g,value:b})=>{if(x<.05)return null;const m=Math.PI/180,S=v+20,w=f+S*Math.cos(-h*m),_=d+S*Math.sin(-h*m);return l.jsx("text",{x:w,y:_,fill:"#64748b",textAnchor:w>f?"start":"end",dominantBaseline:"central",fontSize:10,fontWeight:"bold",children:`${g}  ${b}  ${(x*100).toFixed(0)}%`})};return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 h-full flex flex-col relative group",children:[l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase",children:"Meeting Size Distribution"}),l.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Occupancy % by bucket (Attendees > 0)"})]}),l.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:s,className:"p-1.5 bg-slate-50 hover:bg-slate-100 rounded text-slate-400 hover:text-slate-600",title:"CSV",children:l.jsx(fc,{className:"w-3 h-3"})}),l.jsx("button",{onClick:o,className:"p-1.5 bg-slate-50 hover:bg-slate-100 rounded text-slate-400 hover:text-slate-600",title:"PNG",children:l.jsx(IT,{className:"w-3 h-3"})}),l.jsx("button",{onClick:()=>a(!n),className:"p-1.5 bg-slate-50 hover:bg-slate-100 rounded text-slate-400 hover:text-slate-600",title:"Colors",children:l.jsx(Wp,{className:"w-3 h-3"})})]})]}),n&&l.jsx("div",{className:"absolute top-14 right-6 bg-white border border-slate-200 shadow-xl rounded-lg p-3 z-20 grid grid-cols-3 gap-2",children:t.map((f,d)=>l.jsx("input",{type:"color",value:f,onChange:h=>{const p=[...t];p[d]=h.target.value,r(p)},className:"w-6 h-6 rounded cursor-pointer border-0 p-0"},d))}),l.jsxs("div",{className:"flex-grow flex flex-col md:flex-row items-center gap-8",children:[l.jsxs("div",{className:"w-full md:w-3/5 h-64 relative",ref:i,children:[l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Lm,{children:[l.jsx(fa,{data:e.globalSizeBins,dataKey:"count",nameKey:"label",cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:2,label:u,children:e.globalSizeBins.map((f,d)=>l.jsx(Oi,{fill:t[d%t.length],stroke:"none"},`cell-${d}`))}),l.jsx(Wt,{})]})}),l.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none text-slate-700",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Total Meetings"}),l.jsx("span",{className:"text-2xl font-bold",children:e.roomMetrics.reduce((f,d)=>f+d.occupiedSlots,0)}),c&&l.jsxs("span",{className:"text-[9px] text-slate-400 mt-1",children:["Typical: ",l.jsx("span",{className:"font-bold text-slate-600",children:c.label})]})]})]}),l.jsx("div",{className:"w-full md:w-2/5 overflow-hidden",children:l.jsxs("table",{className:"w-full text-xs text-left",children:[l.jsx("thead",{className:"text-slate-400 border-b border-slate-100 font-semibold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pb-2 pl-2",children:"Size"}),l.jsx("th",{className:"pb-2 text-right",children:"Count"}),l.jsx("th",{className:"pb-2 pr-2 text-right",children:"Occ %"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50 text-slate-600",children:e.globalSizeBins.map((f,d)=>l.jsxs("tr",{className:"hover:bg-slate-50",children:[l.jsxs("td",{className:"py-2 pl-2 flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t[d%t.length]}}),f.label]}),l.jsx("td",{className:"py-2 text-right font-mono",children:f.count}),l.jsxs("td",{className:"py-2 pr-2 text-right font-bold text-slate-700",children:[f.occupancyPct.toFixed(1),"%"]})]},d))})]})})]})]})},C1e=({insights:e})=>l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-full flex flex-col",children:[l.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4 flex items-center gap-2",children:[l.jsx($T,{className:"w-4 h-4 text-amber-500"})," Work Behaviors"]}),l.jsx("div",{className:"flex-grow",children:e.length>0?l.jsx("ul",{className:"space-y-4",children:e.map((t,r)=>l.jsxs("li",{className:"flex gap-3 text-xs text-slate-600 bg-slate-50 p-3 rounded-lg border border-slate-100 items-start",children:[l.jsx(Dp,{className:"w-3 h-3 text-slate-400 flex-shrink-0 mt-0.5"}),l.jsx("span",{className:"leading-snug",children:t})]},r))}):l.jsx("div",{className:"text-xs text-slate-400 italic text-center py-10",children:"No specific behavioral patterns detected."})})]}),P1e=({metrics:e,records:t,onUpdateCapacity:r,onDrillDown:n})=>{var u;const a=G.useMemo(()=>{const f=new Set(["All Rooms"]);return t.forEach(d=>{d.roomType&&f.add(d.roomType)}),Array.from(f).sort()},[t]),[i,s]=G.useState("All Rooms"),o=G.useMemo(()=>{const f=i==="All Rooms"?t:t.filter(d=>d.roomType===i);return q5(f)},[t,i]),c=G.useMemo(()=>{if(i==="All Rooms")return e.totalRooms;const f=new Set;return t.forEach(d=>{d.roomType===i&&d.roomName&&f.add(d.roomName)}),f.size},[t,i,e.totalRooms]);return l.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Avg Utilization"}),l.jsxs("div",{className:"text-3xl font-bold text-indigo-600 mt-2",children:[e.overallUtilization.toFixed(0),"%"]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Of observed time slots"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Avg Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-slate-800 mt-2",children:[e.overallAvgAttendees.toFixed(1)," ",l.jsx("span",{className:"text-sm font-medium text-slate-400",children:"ppl"})]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"When room is in use"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Peak Concurrency"}),l.jsxs("div",{className:"text-3xl font-bold text-rose-500 mt-2",children:[(u=e.concurrencyStats)==null?void 0:u.maxPct.toFixed(0),"%"]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Max % of rooms used at once"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Underutilized"}),l.jsxs("div",{className:"text-3xl font-bold text-amber-500 mt-2",children:[e.roomMetrics.filter(f=>f.classification.includes("Under")).length," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:["/ ",e.roomMetrics.length," rms"]})]}),l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:"Rooms flagged for size mismatch"})]})]}),l.jsx(A1e,{stats:o,roomTypes:a,selectedType:i,onSelectType:s,activeTotalRooms:c}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx("div",{className:"lg:col-span-2",children:l.jsx(O1e,{metrics:e})}),l.jsx("div",{children:l.jsx(C1e,{insights:e.globalInsights})})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[l.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:l.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[l.jsx(In,{className:"w-4 h-4 text-slate-400"})," Room Performance"]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-white border-b border-slate-100 text-xs font-bold text-slate-500 uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3",children:"Location"}),l.jsx("th",{className:"px-4 py-3",children:"Room"}),l.jsx("th",{className:"px-4 py-3 text-center",children:"Capacity"}),l.jsx("th",{className:"px-4 py-3 text-center",children:"Util %"}),l.jsx("th",{className:"px-4 py-3 text-center",children:"Avg Occ"}),l.jsx("th",{className:"px-4 py-3",children:"Status"}),l.jsx("th",{className:"px-4 py-3 w-10"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:e.roomMetrics.map(f=>l.jsx(T1e,{room:f,onUpdateCapacity:r,onDrillDown:n},`${f.floor}-${f.roomName}`))})]})})]})]})},As=[{title:"Project Context",desc:"Define the strategic identity, scale, and physical constraints of your project. These inputs drive all subsequent capacity calculations.",icon:Up},{title:"Strategy & Budget",desc:"Model scenarios by adjusting policy ratios (Sharing, Meeting, Support). See real-time impact on area demand vs supply.",icon:ds},{title:"Decision Framework",desc:"Compare scenarios side-by-side using strategic indicators like Density, Utilization Index, and Meeting Ratios.",icon:ps},{title:"Stacking & Mix",desc:"Visualize program distribution across floors. Ensure the 'Program Mix' aligns with organizational goals.",icon:In},{title:"Deep Analysis",desc:"Use Team Adjacency and Utilization Studies to validate your strategy with data-driven evidence.",icon:hs}],M1e=({onClose:e})=>{const[t,r]=G.useState(0),n=()=>{t<As.length-1?r(t+1):e()},a=As[t].icon;return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"h-32 bg-gradient-to-r from-orange-500 to-rose-500 relative flex items-center justify-center",children:[l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-md",children:l.jsx(a,{className:"w-8 h-8 text-white"})}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white/70 hover:text-white",children:l.jsx(xn,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsxs("div",{className:"text-xs font-bold text-orange-600 uppercase tracking-widest mb-2",children:["Step ",t+1," of ",As.length]}),l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:As[t].title}),l.jsx("p",{className:"text-slate-500 leading-relaxed mb-8 h-16",children:As[t].desc}),l.jsx("div",{className:"flex gap-2 justify-center mb-8",children:As.map((i,s)=>l.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${s===t?"w-8 bg-orange-500":"w-2 bg-slate-200"}`},s))}),l.jsxs("button",{onClick:n,className:"w-full py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg",children:[t===As.length-1?"Get Started":"Next Step"," ",l.jsx(Gr,{className:"w-4 h-4"})]})]})]})})},F1e=()=>{const[e,t]=G.useState(X6),[r,n]=G.useState("home"),[a,i]=G.useState(!0),[s,o]=G.useState([{...Q2,id:"s1",name:"Scenario A"}]),[c,u]=G.useState("s1"),[f,d]=G.useState(null),h=s.find(_=>_.id===c)||s[0],p=G.useMemo(()=>R1(e,h),[e,h]),v=s.find(_=>_.id===f),x=v?R1(e,v):null,y=_=>{o(k=>k.map(N=>N.id===_.id?_:N))},g=()=>{const _=`s${Date.now()}`,k={...Q2,id:_,name:`Option ${s.length+1}`};o([...s,k]),u(_)},b=()=>{const _=`s${Date.now()}`,k={...h,id:_,name:`${h.name} (Copy)`};o([...s,k]),u(_)},m=_=>{if(s.length>1){const k=s.filter(N=>N.id!==_);o(k),c===_&&u(k[0].id),f===_&&d(null)}},S=(_,k)=>{o(N=>N.map(j=>j.id===_?{...j,name:k}:j))};G.useEffect(()=>{const _=K6(e.industry,e.projectType);Object.keys(_).length>0&&o(k=>k.map(N=>N.id===c?{...N,..._}:N))},[e.industry,e.projectType]);const w=({page:_,label:k,icon:N})=>l.jsxs("button",{onClick:()=>n(_),className:`w-full flex items-center gap-3 px-5 py-3 text-sm font-medium transition-all duration-200 border-l-2 ${r===_?"border-orange-500 bg-slate-50 text-slate-900":"border-transparent text-slate-500 hover:bg-slate-50 hover:text-slate-700"}`,children:[l.jsx(N,{className:`w-4 h-4 ${r===_?"text-orange-500":"text-slate-400"}`}),k]});return l.jsxs("div",{className:"h-screen w-screen bg-slate-100 flex overflow-hidden font-sans text-slate-900",children:[a&&l.jsx(M1e,{onClose:()=>i(!1)}),l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0 z-30 shadow-sm",children:[l.jsx("div",{className:"p-6 border-b border-slate-100",children:l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-8 bg-orange-500 rounded-sm"}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]",children:"M MOSER ASSOCIATES"})]}),l.jsxs("h1",{className:"text-base font-bold text-slate-800 leading-tight pl-4",children:["Workplace Strategy",l.jsx("br",{}),"Toolkit"]})]})}),l.jsxs("div",{className:"flex-grow py-8 space-y-8 overflow-y-auto",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Context"}),l.jsx(w,{page:"home",label:"Project Information",icon:Up})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Strategy & Planning"}),l.jsx(w,{page:"budget",label:"Space Budget",icon:ds}),l.jsx(w,{page:"stacking",label:"Stacking Plan",icon:ia})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deep Analysis"}),l.jsx(w,{page:"adjacency",label:"Team Adjacency",icon:hs}),l.jsx(w,{page:"utilization",label:"Utilization Study",icon:cc}),l.jsx(w,{page:"test-fit",label:"Test Fit Scoring",icon:Fp})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deliverables"}),l.jsx(w,{page:"exports",label:"Exports",icon:Ei})]})]}),l.jsx("div",{className:"p-5 border-t border-slate-100 bg-slate-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-white border border-slate-200 rounded-full flex items-center justify-center shadow-sm",children:l.jsx(DT,{className:"w-4 h-4 text-slate-400"})}),l.jsxs("div",{className:"flex-grow overflow-hidden",children:[l.jsx("div",{className:"text-xs font-bold text-slate-800 truncate",title:e.projectName,children:e.projectName||"New Project"}),l.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:e.location||"Location N/A"})]})]})})]}),l.jsx("div",{className:"flex-grow flex flex-col overflow-hidden bg-[#F8FAFC] relative",children:l.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[r==="home"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(pD,{data:e,onChange:t})}),r==="budget"&&l.jsx(cle,{project:e,setProject:t,activeStrategy:h,handleStrategyChange:y,activeMetrics:p,scenarios:s,activeScenarioId:c,setActiveScenarioId:u,addScenario:g,duplicateScenario:b,deleteScenario:m,renameScenario:S,compareScenarioId:f,setCompareScenarioId:d,compareMetrics:x,onNavigate:_=>n(_)}),r==="stacking"&&l.jsxs("div",{className:"h-full p-6 flex flex-col",children:[l.jsxs("div",{className:"mb-6 flex justify-between items-end px-2",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Stacking Plan"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Translate strategy into floor-by-floor allocation."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Active Strategy:"}),l.jsx("span",{className:"text-xs font-bold bg-white border border-slate-200 text-orange-600 px-3 py-1 rounded-full shadow-sm",children:h.name})]})]}),l.jsx("div",{className:"flex-grow overflow-hidden bg-white rounded-xl shadow-sm border border-slate-200",children:l.jsx(RC,{metrics:p,project:e,strategy:h,mode:"default",onUpdateProject:t})})]}),r==="adjacency"&&l.jsx("div",{className:"h-full p-6",children:l.jsx(hle,{project:e,onChange:t,metrics:p,onNavigateToStacking:()=>n("stacking")})}),r==="utilization"&&l.jsx("div",{className:"h-full",children:l.jsx(S1e,{})}),r==="test-fit"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(ple,{metrics:p,project:e})}),r==="exports"&&l.jsx("div",{className:"h-full",children:l.jsx(mle,{project:e,scenarios:s,activeScenarioId:c})})]})})]})},Y5=document.getElementById("root");if(!Y5)throw new Error("Could not find root element to mount to");const D1e=Ed.createRoot(Y5);D1e.render(l.jsx(Y.StrictMode,{children:l.jsx(F1e,{})}));const I1e=["Technology","Finance","Professional Services","Legal","Real Estate","Retail/FMCG","Media & Creative","Healthcare","Education","Manufacturing","Logistics","Public Sector","Other (Custom)"],R1e=["Global HQ","Regional HQ","Corporate Office","Client-facing Office","R&D / Innovation Hub","Trading Floor","Back Office","Flex / Hybrid Workplace","Other (Custom)"],er={primary:"#F97316",program:["#64748B","#F97316","#8B5CF6","#0EA5E9","#94A3B8","#F43F5E"],departments:["#3B82F6","#8B5CF6","#EC4899","#F43F5E","#F97316","#EAB308","#84CC16","#10B981","#06B6D4","#6366F1"]},$1e={deskOpen:4.5,deskAlt:3,deskEnclosed:12,meetingAvg:18,phoneBooth:1.5},L1e={deskOpen:48,deskAlt:32,deskEnclosed:130,meetingAvg:195,phoneBooth:16},b0=e=>e==="sqm"?$1e:L1e,Vo={small:25,medium:60,large:150,board:300,townhall:1e3},B1e=[{id:"sup-1",name:"Tea Point / Pantry",category:"pantry",logic:"ratio",value:50,areaPerUnit:15},{id:"sup-2",name:"Open Collaboration",category:"collab",logic:"pct_nia",value:15},{id:"sup-3",name:"Storage",category:"storage",logic:"pct_nia",value:2},{id:"sup-4",name:"IT / Server Room",category:"server",logic:"fixed_area",value:10},{id:"sup-5",name:"Wellness / Mothers",category:"wellness",logic:"fixed_count",value:1,areaPerUnit:10},{id:"sup-6",name:"Print / Utilities",category:"utilities",logic:"ratio",value:75,areaPerUnit:4}],w0=e=>[{id:"pg-work",name:"Workstations",color:er.program[0],items:["work_open","work_alt","work_enclosed"]},{id:"pg-collab",name:"Collaboration",color:er.program[1],items:["sup-2"]},{id:"pg-meet",name:"Meeting Rooms",color:er.program[2],items:["meet","phone"]},{id:"pg-supp",name:"Support",color:er.program[3],items:["sup-1","sup-3","sup-4","sup-5","sup-6"]},{id:"pg-circ",name:"Circulation",color:er.program[4],items:["circ"]}],U1e={projectName:"New Strategic Hub",location:"Singapore",industry:"Technology",projectType:"Regional HQ",areaInput:2500,areaDefinition:"NIA",targetEfficiency:80,calculatedNia:2500,unit:"sqm",headcount:300,floors:[{id:"f1",name:"Floor 1",headcount:300}],departments:[{id:"d1",name:"Sales",headcount:80,futureHeadcount:90,occupancy:80,color:er.departments[0],collaborators:[{deptId:"d2",strength:80}]},{id:"d2",name:"Marketing",headcount:40,futureHeadcount:45,occupancy:70,color:er.departments[1],collaborators:[{deptId:"d1",strength:80},{deptId:"d4",strength:50}]},{id:"d3",name:"Engineering",headcount:120,futureHeadcount:140,occupancy:60,color:er.departments[2],collaborators:[{deptId:"d4",strength:80}]},{id:"d4",name:"Product",headcount:30,futureHeadcount:35,occupancy:90,color:er.departments[3],collaborators:[{deptId:"d3",strength:80},{deptId:"d2",strength:50}]},{id:"d5",name:"G&A",headcount:30,futureHeadcount:30,occupancy:95,color:er.departments[4],collaborators:[]}],programStructure:w0()},u4={id:"default",name:"Base Case",workpoints:{fixed:240,alternative:60},circulationPct:25,growthBuffer:5,enclosedOfficeCount:10,meetingRatios:{...Vo},phoneBoothRatio:15,supportSpaces:[...B1e]},z1e=(e,t)=>{let r={};switch(e){case"Legal":r={enclosedOfficeCount:50};break;case"Technology":r={enclosedOfficeCount:5};break}return r},hd=({number:e,title:t,icon:r})=>l.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-2 border-b border-slate-100",children:[l.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center text-xs font-bold font-mono",children:e}),l.jsxs("h3",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(r,{className:"w-4 h-4 text-orange-500"}),t]})]}),W1e=({data:e,onChange:t})=>{const[r,n]=G.useState(!1),[a,i]=G.useState(!1);G.useEffect(()=>{let h=e.areaInput;e.areaDefinition==="Gross"&&(h=e.areaInput*(e.targetEfficiency/100)),h!==e.calculatedNia&&t({...e,calculatedNia:h})},[e.areaInput,e.areaDefinition,e.targetEfficiency,e.calculatedNia]);const s=(h,p)=>{let v={...e,[h]:p};if(h==="projectType"){const x=w0();v={...v,programStructure:x}}t(v)},o=h=>{t({...e,unit:h})},c=h=>{const p=[...e.floors];if(h>p.length)for(let v=p.length;v<h;v++)p.push({id:`f${v+1}`,name:`Floor ${v+1}`,headcount:0});else h<p.length&&(p.length=h);t({...e,floors:p})},u=(h,p)=>{const v=[...e.floors];v[h]={...v[h],headcount:p},t({...e,floors:v})},f=e.floors.reduce((h,p)=>h+p.headcount,0),d=f!==e.headcount;return l.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto",children:[l.jsxs("div",{className:"mb-10",children:[l.jsxs("h2",{className:"text-2xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Zd,{className:"w-6 h-6 text-orange-500"}),"Project Information"]}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Defining the strategic context and constraints for the portfolio analysis."})]}),l.jsxs("div",{className:"space-y-12",children:[l.jsxs("section",{children:[l.jsx(hd,{number:"1",title:"Strategic Context",icon:lc}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"col-span-1 md:col-span-2",children:[l.jsxs("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2",children:["Project Name ",l.jsx("span",{className:"text-rose-500",children:"*"})]}),l.jsxs("div",{className:"flex items-center bg-slate-50 px-4 py-3 rounded-lg border border-slate-200 focus-within:border-orange-400 transition-all",children:[l.jsx(fc,{className:"w-5 h-5 text-slate-400 mr-3"}),l.jsx("input",{type:"text",className:"bg-transparent w-full text-lg font-bold text-slate-800 focus:outline-none placeholder-slate-300",value:e.projectName||"",onChange:h=>s("projectName",h.target.value),placeholder:"e.g. Project Zenith - Global HQ"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Industry Sector"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Bp,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.industry,onChange:h=>s("industry",h.target.value),children:I1e.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(pn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Location"}),l.jsxs("div",{className:"relative group",children:[l.jsx(BT,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"text",className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.location,onChange:h=>s("location",h.target.value),placeholder:"City, Country"})]})]})]})]}),l.jsxs("section",{children:[l.jsx(hd,{number:"2",title:"Scale & Typology",icon:VT}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Project Typology"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Zd,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("select",{className:"w-full bg-slate-50 border border-slate-200 text-sm font-medium text-slate-700 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400 appearance-none",value:e.projectType,onChange:h=>s("projectType",h.target.value),children:R1e.map(h=>l.jsx("option",{value:h,children:h},h))}),l.jsx(pn,{className:"w-4 h-4 text-slate-400 absolute right-3 top-2.5 pointer-events-none"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Total Base Headcount"}),l.jsxs("div",{className:"relative group",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400 absolute left-3 top-2.5"}),l.jsx("input",{type:"number",min:"1",className:"w-full bg-slate-50 border border-slate-200 text-sm font-bold text-slate-800 pl-10 pr-3 py-2.5 rounded-lg focus:outline-none focus:border-orange-400",value:e.headcount,onChange:h=>s("headcount",parseInt(h.target.value)||0)})]})]})]})]}),l.jsxs("section",{children:[l.jsx(hd,{number:"3",title:"Physical Constraints",icon:ia}),l.jsxs("div",{className:"flex flex-wrap items-end gap-6 bg-slate-50 p-6 rounded-xl border border-slate-100 mb-6",children:[l.jsxs("div",{className:"flex-grow min-w-[240px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Input Area"}),l.jsxs("div",{className:"flex items-center gap-6 mb-3",children:[l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="NIA",onChange:()=>t({...e,areaDefinition:"NIA",targetEfficiency:100})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"NIA (Net Internal)"})]}),l.jsxs("label",{className:"inline-flex items-center cursor-pointer group",children:[l.jsx("input",{type:"radio",className:"form-radio text-orange-600 w-4 h-4 focus:ring-orange-500 border-slate-300",checked:e.areaDefinition==="Gross",onChange:()=>t({...e,areaDefinition:"Gross",targetEfficiency:80})}),l.jsx("span",{className:"ml-2 text-sm text-slate-700 font-medium",children:"Gross Area"})]})]}),l.jsxs("div",{className:"relative group max-w-xs",children:[l.jsx("input",{type:"number",className:"w-full bg-white border border-slate-300 text-lg font-bold text-slate-800 pl-4 pr-12 py-2 rounded-lg focus:outline-none focus:border-orange-400 shadow-sm",value:e.areaInput,onChange:h=>s("areaInput",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-4 top-3 text-xs font-bold text-slate-400 uppercase",children:e.unit})]})]}),e.areaDefinition==="Gross"&&l.jsxs("div",{className:"w-40 space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Efficiency"}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:"number",min:"50",max:"100",className:"w-full bg-white border border-slate-300 text-lg font-medium text-slate-700 px-3 py-2 rounded-lg focus:outline-none focus:border-orange-400 text-right pr-8 shadow-sm",value:e.targetEfficiency,onChange:h=>s("targetEfficiency",parseFloat(h.target.value))}),l.jsx("span",{className:"absolute right-3 top-3 text-sm text-slate-400 font-bold",children:"%"})]})]}),l.jsx("div",{className:"flex items-center pb-4 text-slate-300",children:l.jsx(Ga,{className:"w-6 h-6"})}),l.jsxs("div",{className:"flex-grow min-w-[200px] space-y-3",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Effective NIA (Usable)"}),l.jsxs("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("span",{className:"text-xl font-bold text-slate-800 w-full font-mono",children:Math.round(e.calculatedNia).toLocaleString()}),l.jsx("span",{className:"text-xs text-slate-400 font-bold ml-2 uppercase",children:e.unit})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase tracking-wide",children:"Number of Floors"}),l.jsx("input",{type:"number",min:"1",max:"50",className:"w-24 bg-white border border-slate-200 text-sm font-medium text-slate-700 px-3 py-1.5 rounded-lg focus:outline-none focus:border-orange-400 text-right",value:e.floors.length,onChange:h=>c(parseInt(h.target.value)||1)})]}),l.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 text-xs font-bold text-slate-600 uppercase hover:text-orange-600 transition-colors group",children:[r?l.jsx(pn,{className:"w-4 h-4 text-orange-500"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400 group-hover:text-orange-500"}),"Floor-by-Floor Allocation ",r?"":"(Optional)"]}),r&&l.jsxs("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200 animate-in fade-in slide-in-from-top-2",children:[l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:e.floors.map((h,p)=>l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm focus-within:border-orange-400 transition-colors",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wide",children:h.name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Xr,{className:"w-3 h-3 text-slate-300"}),l.jsx("input",{type:"number",className:"w-full text-sm font-bold text-slate-700 focus:outline-none",value:h.headcount,onChange:v=>u(p,parseInt(v.target.value)||0)})]})]},h.id))}),d&&l.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs font-medium text-amber-700 bg-amber-50 p-3 rounded-lg border border-amber-100",children:[l.jsx(Or,{className:"w-4 h-4 text-amber-500"}),l.jsxs("span",{children:["Warning: Floor headcount sum (",f,") does not match Total Headcount (",e.headcount,"). Stacking calculations generally prioritize floor data."]})]})]})]})]}),l.jsxs("section",{children:[l.jsx(hd,{number:"4",title:"System Preferences",icon:Vp}),l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-xl border border-slate-100",children:[l.jsx("div",{className:"flex items-center gap-6",children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Unit System"}),l.jsxs("div",{className:"flex bg-white p-1 rounded-lg border border-slate-200 shadow-sm",children:[l.jsx("button",{onClick:()=>o("sqm"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqm"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQM"}),l.jsx("button",{onClick:()=>o("sqft"),className:`px-4 py-1.5 text-xs font-bold rounded-md transition ${e.unit==="sqft"?"bg-slate-800 text-white shadow":"text-slate-500 hover:text-slate-700"}`,children:"SQFT"})]})]})}),l.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2.5 text-sm font-bold text-slate-700 bg-white border border-slate-300 rounded-lg hover:border-orange-400 hover:text-orange-600 transition-all shadow-sm",children:[l.jsx(Wp,{className:"w-4 h-4"})," Customize Visualization"]})]})]})]}),a&&l.jsxs("div",{className:"mt-6 p-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-900 text-sm",children:[l.jsx("div",{className:"font-bold mb-1",children:"Visualization settings placeholder (temporary)"}),l.jsxs("div",{children:["This prototype references ",l.jsx("span",{className:"font-mono",children:"VisualizationSettings"}),", but the component file isnt present, so its disabled for build/deploy."]}),l.jsx("button",{className:"mt-3 px-3 py-2 rounded-md border border-amber-300 bg-white hover:bg-amber-100 font-bold",onClick:()=>i(!1),children:"Close"})]})]})},f4=({title:e,icon:t,isOpen:r,toggle:n})=>l.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-3 bg-white border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(t,{className:"w-4 h-4 text-indigo-600"}),l.jsx("span",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:e})]}),r?l.jsx(pn,{className:"w-4 h-4 text-slate-400"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400"})]}),Go=({label:e,value:t,unit:r,min:n,max:a,onChange:i,disabled:s,step:o=1,note:c})=>l.jsxs("div",{className:`mb-3 ${s?"opacity-60 grayscale":""}`,children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:e}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",min:n,max:a,step:o,value:t,disabled:s,onChange:u=>i(parseFloat(u.target.value)||0),className:"w-full p-2 text-sm border border-slate-200 rounded-l-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none bg-white font-medium"}),r&&l.jsx("div",{className:"px-3 py-2 bg-slate-100 border border-l-0 border-slate-200 rounded-r-md text-xs font-bold text-slate-500 whitespace-nowrap",children:r})]}),c&&l.jsx("div",{className:"text-[10px] text-slate-400 mt-1",children:c})]}),H1e=({pct:e,baseHc:t,onChange:r,disabled:n})=>{const[a,i]=G.useState("%"),s=Math.round(t*(e/100)),o=c=>{if(t>0){const u=c/t*100;r(parseFloat(u.toFixed(1)))}};return l.jsxs("div",{className:`mb-4 p-3 bg-indigo-50 rounded-lg border border-indigo-100 ${n?"opacity-60 grayscale":""}`,children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-xs font-bold text-indigo-800 uppercase tracking-wide",children:"Growth Buffer"}),l.jsxs("div",{className:"flex bg-white rounded border border-indigo-200 p-0.5",children:[l.jsx("button",{onClick:()=>i("%"),className:`text-[10px] px-2 py-0.5 rounded ${a==="%"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"%"}),l.jsx("button",{onClick:()=>i("Abs"),className:`text-[10px] px-2 py-0.5 rounded ${a==="Abs"?"bg-indigo-100 text-indigo-700 font-bold":"text-slate-400"}`,children:"HC"})]})]}),a==="%"?l.jsx(Go,{label:"",value:e,unit:"% add-on",min:0,max:100,step:1,onChange:r,disabled:n}):l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"number",className:"w-full p-2 text-sm border border-indigo-200 rounded-l-md focus:outline-none focus:ring-1 focus:ring-indigo-500",value:s,onChange:c=>o(parseInt(c.target.value)||0),disabled:n}),l.jsx("div",{className:"px-3 py-2 bg-white border border-l-0 border-indigo-200 rounded-r-md text-xs font-bold text-indigo-500 whitespace-nowrap",children:"People"})]}),l.jsxs("div",{className:"text-[10px] text-indigo-400 mt-1 flex justify-between",children:[l.jsx("span",{children:"Reserve capacity"}),l.jsx("span",{children:a==="%"?`+${s} people`:`+${e}% add-on`})]})]})},V1e=({ratios:e,onChange:t,disabled:r})=>{const n=(s,o)=>{t({...e,[s]:o})},a=(s,o)=>{if(s===0)return{label:"None",color:"bg-slate-100 text-slate-400"};const c=(s-o)/o;return c>.1?{label:"Conservative",color:"bg-orange-100 text-orange-700"}:c<-.1?{label:"Generous",color:"bg-emerald-100 text-emerald-700"}:{label:"Typical",color:"bg-blue-100 text-blue-700"}},i=({type:s,label:o,val:c,bench:u})=>{const f=a(c,u);return l.jsxs("tr",{className:"border-b border-slate-50 last:border-0 hover:bg-slate-50 group",children:[l.jsxs("td",{className:"py-2 pl-2 text-xs font-medium text-slate-700 flex items-center gap-1",children:[o,l.jsxs("div",{className:"group relative",children:[l.jsx(OT,{className:"w-3 h-3 text-slate-300 cursor-help"}),l.jsxs("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-2 w-32 bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg opacity-0 group-hover:opacity-100 pointer-events-none z-50 whitespace-normal",children:["Benchmark: 1 per ",u," ppl"]})]})]}),l.jsx("td",{className:"py-2 px-1",children:l.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border border-slate-200 rounded focus:ring-1 focus:ring-indigo-500 font-medium",value:c,onChange:d=>n(s,parseInt(d.target.value)||0),disabled:r})}),l.jsx("td",{className:"py-2 pr-2 text-right",children:l.jsx("span",{className:`text-[9px] uppercase font-bold px-1.5 py-0.5 rounded ${f.color}`,children:f.label})})]})};return l.jsxs("div",{className:"mb-4 bg-white border border-slate-200 rounded-lg overflow-hidden",children:[l.jsxs("div",{className:"bg-slate-50 px-3 py-2 border-b border-slate-200 flex justify-between items-center",children:[l.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Meeting Strategy"}),l.jsx("span",{className:"text-[10px] text-slate-400 italic",children:"People per Room"})]}),l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 text-[10px] text-slate-400 uppercase font-semibold text-left",children:l.jsxs("tr",{children:[l.jsx("th",{className:"pl-2 py-1 font-normal w-1/3",children:"Room Type"}),l.jsx("th",{className:"py-1 text-right font-normal pr-2",children:"Input"}),l.jsx("th",{className:"pr-2 py-1 text-right font-normal",children:"Status"})]})}),l.jsxs("tbody",{children:[l.jsx(i,{type:"small",label:"Small (4p)",val:e.small,bench:Vo.small}),l.jsx(i,{type:"medium",label:"Medium (8p)",val:e.medium,bench:Vo.medium}),l.jsx(i,{type:"large",label:"Large (14p)",val:e.large,bench:Vo.large}),l.jsx(i,{type:"board",label:"Board (20p)",val:e.board,bench:Vo.board}),l.jsx(i,{type:"townhall",label:"Townhall",val:e.townhall,bench:Vo.townhall})]})]})]})},G1e=({spaces:e,onChange:t})=>{const r=()=>{t([...e,{id:`sup-${Date.now()}`,name:"New Amenity",category:"other",logic:"pct_nia",value:1}])},n=(i,s,o)=>{t(e.map(c=>c.id===i?{...c,[s]:o}:c))},a=i=>{t(e.filter(s=>s.id!==i))};return l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-600 uppercase flex items-center gap-1",children:[l.jsx(Rp,{className:"w-3 h-3"})," Support & Amenity"]}),l.jsxs("button",{onClick:r,className:"text-xs font-bold text-indigo-600 hover:text-indigo-800 flex items-center gap-1",children:[l.jsx(Ya,{className:"w-3 h-3"})," Add"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(i=>l.jsxs("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 text-xs hover:border-indigo-200 transition-colors",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2 gap-2",children:[l.jsx("input",{className:"bg-transparent font-bold text-slate-700 w-full focus:outline-none border-b border-transparent focus:border-indigo-200 text-xs",value:i.name,onChange:s=>n(i.id,"name",s.target.value),placeholder:"Space Name"}),l.jsx("button",{onClick:()=>a(i.id),className:"text-slate-400 hover:text-rose-500",children:l.jsx(ms,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("select",{className:"w-full p-1 border rounded bg-white text-[10px]",value:i.logic,onChange:s=>n(i.id,"logic",s.target.value),children:[l.jsx("option",{value:"ratio",children:"Ratio (1:X)"}),l.jsx("option",{value:"pct_nia",children:"% of NIA"}),l.jsx("option",{value:"fixed_area",children:"Fixed Area"}),l.jsx("option",{value:"fixed_count",children:"Fixed Count"}),l.jsx("option",{value:"area_per_person",children:"Area / Person"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right",value:i.value,onChange:s=>n(i.id,"value",parseFloat(s.target.value))}),l.jsx("span",{className:"text-[9px] text-slate-400 w-8 text-right",children:i.logic==="pct_nia"?"%":i.logic==="ratio"?"ppl":"val"})]})]}),(i.logic==="ratio"||i.logic==="fixed_count")&&l.jsxs("div",{className:"mt-2 flex items-center justify-between pt-1 border-t border-slate-200",children:[l.jsx("span",{className:"text-[9px] text-slate-400",children:"Size per room:"}),l.jsx("div",{className:"flex items-center gap-1 w-20",children:l.jsx("input",{type:"number",className:"w-full p-1 border rounded bg-white text-right text-[10px]",value:i.areaPerUnit||0,onChange:s=>n(i.id,"areaPerUnit",parseFloat(s.target.value))})})]})]},i.id))})]})},X1e=({strategy:e,onChange:t,title:r="Active Strategy",isReadOnly:n=!1,baseHeadcount:a=100})=>{var x,y;const[i,s]=G.useState({planning:!0,workplace:!0}),o=Math.ceil(a*(1+e.growthBuffer/100)),c=((x=e.workpoints)==null?void 0:x.fixed)||0,u=((y=e.workpoints)==null?void 0:y.alternative)||0,f=c+u,d=f-o,h=(g,b)=>{n||t({...e,[g]:b})},p=(g,b)=>{n||t({...e,workpoints:{...e.workpoints,[g]:Math.max(0,b)}})},v=g=>s(b=>({...b,[g]:!b[g]}));return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 h-full flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-4 bg-slate-50 border-b border-slate-200",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(Vp,{className:"w-4 h-4 text-indigo-600"}),"Strategy Inputs"]}),l.jsx("div",{className:"text-xs text-slate-500 mt-1 truncate font-medium",children:r})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx(f4,{title:"Planning Factors",icon:RT,isOpen:i.planning,toggle:()=>v("planning")}),i.planning&&l.jsxs("div",{className:"p-4 space-y-4 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(H1e,{pct:e.growthBuffer,baseHc:a,onChange:g=>h("growthBuffer",g),disabled:n}),l.jsx(Go,{label:"Circulation",value:e.circulationPct,unit:"% add-on",min:10,max:60,onChange:g=>h("circulationPct",g),disabled:n})]}),l.jsx(f4,{title:"Workplace Strategy",icon:lc,isOpen:i.workplace,toggle:()=>v("workplace")}),i.workplace&&l.jsxs("div",{className:"p-4 space-y-6 animate-in slide-in-from-top-2 duration-200",children:[l.jsx(Go,{label:"Enclosed Offices",value:e.enclosedOfficeCount,unit:"people",min:0,onChange:g=>h("enclosedOfficeCount",g),disabled:n,note:"Included within Fixed Workstations count"}),l.jsxs("div",{className:"pt-2 border-t border-slate-100",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase",children:"Workpoints Target"})}),l.jsx(Go,{label:"Fixed Workstations",value:c,unit:"seats",min:0,onChange:g=>p("fixed",g),disabled:n,note:"Total assigned desks (includes Enclosed Offices)"}),l.jsx(Go,{label:"Alternative Workpoints",value:u,unit:"points",min:0,onChange:g=>p("alternative",g),disabled:n,note:"Agile, flex, or touchdown points"}),l.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-lg p-3 text-xs space-y-2 shadow-sm mb-3 mt-2",children:[l.jsxs("div",{className:"flex items-center gap-1.5 border-b border-indigo-200 pb-1.5 mb-1",children:[l.jsx(ds,{className:"w-3 h-3 text-indigo-500"}),l.jsx("span",{className:"font-bold text-indigo-800",children:"Supply vs Demand"})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Headcount:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:o})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-indigo-600",children:"Total Workpoints:"}),l.jsx("span",{className:"font-bold text-indigo-900",children:f})]}),l.jsxs("div",{className:`flex justify-between font-bold pt-1 border-t border-indigo-100 ${d<0?"text-amber-600":d>0?"text-blue-600":"text-emerald-600"}`,children:[l.jsxs("span",{className:"flex items-center gap-1",children:[d<0?l.jsx(Or,{className:"w-3 h-3"}):l.jsx(qa,{className:"w-3 h-3"})," Status:"]}),l.jsx("span",{children:d===0?"Matched":d>0?`Over by ${d}`:`Under by ${Math.abs(d)}`})]})]})]}),l.jsx(V1e,{ratios:e.meetingRatios,onChange:g=>h("meetingRatios",g),disabled:n}),l.jsx(Go,{label:"Phone Booth Ratio",value:e.phoneBoothRatio,unit:"ppl : 1 booth",min:1,max:100,onChange:g=>h("phoneBoothRatio",g),disabled:n}),l.jsx("div",{className:"border-t border-slate-100 pt-4",children:l.jsx(G1e,{spaces:e.supportSpaces||[],onChange:g=>h("supportSpaces",g)})})]})]})]})},$w=({data:e,groups:t,unit:r,height:n="100%",showLegend:a=!0,layout:i="vertical",barSize:s=40,maxCategories:o=6,showLabels:c=!0})=>{const{chartData:u,activeGroups:f}=G.useMemo(()=>{let h=t;if(t.length>o){const v=t.slice(0,o-1),x={id:"_other",name:"Other",color:"#94a3b8",items:[]};h=[...v,x]}return{chartData:e.map(v=>{const x={...v,_total:0};let y=0;if(t.forEach(g=>{v[g.id]&&(y+=v[g.id])}),t.length>o){t.slice(0,o-1);const g=t.slice(o-1);let b=0;g.forEach(m=>{x[m.id]!==void 0&&(b+=x[m.id],delete x[m.id])}),x._other=b}return x._total=y,x}),activeGroups:h}},[e,t,o]),d=h=>{const{x:p,y:v,width:x,height:y,value:g,payload:b}=h,m=b&&typeof b._total=="number"?b._total:0,S=m>0?g/m:0;if(S<.05)return null;const w=i==="vertical",_=20;return w&&x<_||!w&&y<_?null:l.jsx("text",{x:p+x/2,y:v+y/2,fill:"#fff",textAnchor:"middle",dominantBaseline:"middle",fontSize:10,fontWeight:"bold",style:{pointerEvents:"none",textShadow:"0px 0px 3px rgba(0,0,0,0.6)"},children:`${(S*100).toFixed(0)}%`})};return l.jsx(sa,{width:"100%",height:n,children:l.jsxs(Ec,{data:u,layout:i,barSize:s,margin:{top:20,right:30,left:20,bottom:5},children:[i==="vertical"?l.jsxs(l.Fragment,{children:[l.jsx(vn,{type:"number",hide:!0}),l.jsx(gn,{type:"category",dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"},width:100})]}):l.jsxs(l.Fragment,{children:[l.jsx(vn,{dataKey:"name",tick:{fontSize:11,fill:"#64748b",fontWeight:"bold"}}),l.jsx(gn,{type:"number",hide:!0})]}),l.jsx(Wt,{cursor:{fill:"transparent"},content:({active:h,payload:p})=>{if(h&&p&&p.length&&p[0].payload){const v=p[0].payload._total||0;return l.jsxs("div",{className:"bg-white p-3 border border-slate-200 rounded-lg shadow-xl text-xs z-50",children:[l.jsxs("div",{className:"font-bold text-slate-800 mb-2 border-b border-slate-100 pb-1",children:[p[0].payload.name," Total: ",Math.round(v).toLocaleString()," ",r]}),p.map((x,y)=>l.jsxs("div",{className:"flex justify-between items-center gap-4 mb-1",children:[l.jsxs("span",{style:{color:x.color},className:"font-semibold",children:[x.name,":"]}),l.jsxs("span",{className:"text-slate-600 font-mono",children:[Math.round(x.value).toLocaleString()," (",v>0?(x.value/v*100).toFixed(1):0,"%)"]})]},y))]})}return null}}),a&&l.jsx(Aa,{verticalAlign:"top",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}}),f.map(h=>l.jsx(da,{dataKey:h.id,name:h.name,stackId:"a",fill:h.color,radius:[0,0,0,0],children:c&&l.jsx(ta,{dataKey:h.id,content:d})},h.id))]})})},K1e=[{id:"work_open",label:"Fixed Workstations"},{id:"work_enclosed",label:"Enclosed Offices (Private)"},{id:"work_alt",label:"Alternative Workpoints"},{id:"meet",label:"Meeting Rooms (Enclosed)"},{id:"phone",label:"Phone Booths"},{id:"circ",label:"Circulation"}],d4=["#6366f1","#ec4899","#8b5cf6","#10b981","#f59e0b","#ef4444","#06b6d4","#64748b"],q1e=({groups:e,supportSpaces:t,onSave:r,onClose:n})=>{const[a,i]=G.useState(JSON.parse(JSON.stringify(e))),s=[...K1e,...t.map(p=>({id:p.id,label:p.name}))],o=()=>{const p=`g-${Date.now()}`,v=d4[a.length%d4.length];i([...a,{id:p,name:"New Category",color:v,items:[]}])},c=p=>{if(a.length<=1)return;const v=a.find(g=>g.id===p),x=a.find(g=>g.id!==p);if(!x)return;const y=a.filter(g=>g.id!==p).map(g=>g.id===x.id?{...g,items:[...g.items,...(v==null?void 0:v.items)||[]]}:g);i(y)},u=(p,v)=>{const x=a.map(y=>({...y,items:y.id===v?[...y.items,p]:y.items.filter(g=>g!==p)}));i(x)},f=(p,v)=>{i(a.map(x=>x.id===p?{...x,color:v}:x))},d=(p,v)=>{i(a.map(x=>x.id===p?{...x,name:v}:x))},h=a.length>6;return l.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/30 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[85vh]",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800 text-lg",children:"Configure Program Structure"}),l.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Define how space types are categorized for visual analysis and reporting."})]}),l.jsx("button",{onClick:n,children:l.jsx(xn,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[h&&l.jsxs("div",{className:"mb-6 flex items-start gap-3 bg-amber-50 border border-amber-200 p-3 rounded-lg text-sm text-amber-800",children:[l.jsx(Or,{className:"w-5 h-5 text-amber-600 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold",children:"Recommendation:"})," You have defined ",a.length,' categories. For optimal clarity in client presentations, we recommend sticking to 4-6 distinct program categories. Excess categories will be automatically collapsed into "Other" in some summary charts.']})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.map(p=>l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b border-slate-100 pb-3",children:[l.jsx("input",{type:"color",value:p.color,onChange:v=>f(p.id,v.target.value),className:"w-6 h-6 rounded cursor-pointer border-0 p-0 overflow-hidden"}),l.jsx("input",{type:"text",value:p.name,onChange:v=>d(p.id,v.target.value),className:"font-bold text-sm bg-transparent border-b border-transparent focus:border-indigo-500 outline-none text-slate-800 flex-grow",placeholder:"Category Name"}),a.length>1&&l.jsx("button",{onClick:()=>c(p.id),className:"text-slate-300 hover:text-rose-500 transition-colors",title:"Delete Category (Items will be moved)",children:l.jsx(ms,{className:"w-4 h-4"})})]}),l.jsx("div",{className:"space-y-2",children:p.items.length===0?l.jsx("div",{className:"text-xs text-slate-400 italic py-4 text-center border-2 border-dashed border-slate-100 rounded",children:"No items assigned"}):p.items.map(v=>{const x=s.find(y=>y.id===v);return l.jsxs("div",{className:"relative group flex items-center bg-slate-50 border border-slate-200 rounded px-3 py-2 text-xs hover:border-indigo-300 transition-colors",children:[l.jsx("span",{className:"mr-2 text-slate-700 font-medium truncate flex-grow",title:x==null?void 0:x.label,children:(x==null?void 0:x.label)||v}),l.jsxs("div",{className:"relative",children:[l.jsx(Ga,{className:"w-3 h-3 text-slate-300 group-hover:text-indigo-600"}),l.jsx("select",{className:"absolute right-0 top-0 w-6 h-6 opacity-0 cursor-pointer",value:p.id,onChange:y=>u(v,y.target.value),children:a.map(y=>l.jsxs("option",{value:y.id,children:["Move to ",y.name]},y.id))})]})]},v)})})]},p.id)),l.jsxs("button",{onClick:o,className:"flex flex-col items-center justify-center gap-2 p-6 rounded-xl border-2 border-dashed border-slate-300 text-slate-400 hover:border-indigo-400 hover:text-indigo-600 hover:bg-indigo-50 transition-all min-h-[200px]",children:[l.jsx("div",{className:"p-3 bg-white rounded-full shadow-sm",children:l.jsx(Ya,{className:"w-6 h-6"})}),l.jsx("span",{className:"text-sm font-bold",children:"Add Category"})]})]})]}),l.jsxs("div",{className:"p-5 border-t border-slate-200 flex justify-between items-center bg-white",children:[l.jsxs("div",{className:"text-xs text-slate-500",children:[l.jsx("strong",{children:"Integrity Check:"})," All space types must belong to exactly one category."]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:n,className:"px-5 py-2.5 text-sm font-bold text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),l.jsx("button",{onClick:()=>r(a),className:"px-6 py-2.5 bg-indigo-600 text-white text-sm font-bold rounded-lg hover:bg-indigo-700 shadow-md transition-all transform hover:scale-105",children:"Apply Configuration"})]})]})]})})},Q5=({metrics:e,project:t,strategy:r,mode:n="default",onUpdateProject:a})=>{const[i,s]=G.useState(n==="review"?"visual":"summary"),[o,c]=G.useState("qty"),[u,f]=G.useState(!1),[d,h]=G.useState(!1),[p,v]=G.useState(!1),[x,y]=G.useState(t.programStructure||w0(t.projectType));G.useEffect(()=>{t.programStructure&&y(t.programStructure)},[t.programStructure]);const g=E=>{y(E),a&&a({...t,programStructure:E}),v(!1)},b=t.unit.toUpperCase(),m=t.floors,S=()=>{const E=["Space Type",...m.map(L=>L.name),"Total"].join("	"),O=[["Headcount",...e.floorMetrics.map(L=>L.headcount),e.totalHeadcountWithGrowth],["Total Seats",...e.floorMetrics.map(L=>L.totalDesks),e.requiredDesks],["Used Area",...e.floorMetrics.map(L=>Math.round(L.areaUsed)),Math.round(e.totalUsedArea)]],T=[E,...O.map(L=>L.join("	"))].join(`
`);navigator.clipboard.writeText(T),f(!0),setTimeout(()=>f(!1),2e3)},w=()=>h(!d),_=G.useMemo(()=>{const E=b0(t.unit);return m.map(O=>{const T=e.floorMetrics.find(X=>X.floorId===O.id);if(!T)return{name:O.name};const L={name:O.name};return x.forEach(X=>{let M=0;X.items.forEach(U=>{if(U==="work_open")M+=T.openDesks*E.deskOpen;else if(U==="work_enclosed")M+=T.enclosedOffices*E.deskEnclosed;else if(U==="work_alt")M+=T.altDesks*E.deskAlt;else if(U==="meet")M+=T.areaMeeting;else if(U==="phone")M+=T.areaPhone;else if(U==="circ")M+=T.areaCirculation;else{const q=r.supportSpaces.find(K=>K.id===U);if(q){const K=T.supportSummary.find(F=>F.name===q.name);K&&(M+=K.area)}}}),L[X.id]=M}),L})},[e,t,x,r]),k=d?"fixed inset-0 z-50 bg-white flex flex-col":"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-full",N=({val:E,isTotal:O=!1,type:T="number"})=>l.jsx("td",{className:`px-4 py-3 text-right text-xs whitespace-nowrap ${O?"font-bold bg-indigo-50 text-indigo-900 border-l border-slate-200 sticky right-0 z-10":"text-slate-600 border-b border-slate-50"}`,children:T==="area"?Math.round(E).toLocaleString():T==="percent"?`${E.toFixed(0)}%`:E.toLocaleString()}),j=({label:E,isGroup:O=!1})=>l.jsx("td",{className:`sticky left-0 bg-white z-10 px-4 py-3 text-xs border-r border-slate-100 ${O?"font-bold text-slate-800 bg-slate-50 uppercase tracking-wide":"font-medium text-slate-600"}`,children:E});return l.jsxs("div",{className:k,children:[l.jsxs("div",{className:"p-3 border-b border-slate-200 bg-slate-50 flex justify-between items-center flex-shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("h3",{className:"text-sm font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(ia,{className:"w-4 h-4 text-indigo-600"}),d?"Stacking Plan (Full Screen)":"Stacking Plan"]}),l.jsxs("div",{className:"flex items-center gap-1 ml-4 bg-white border border-slate-200 rounded-lg p-0.5",children:[l.jsxs("button",{onClick:()=>s("summary"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="summary"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(LT,{className:"w-3 h-3"})," Summary"]}),l.jsxs("button",{onClick:()=>s("matrix"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="matrix"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx($p,{className:"w-3 h-3"})," Matrix"]}),l.jsxs("button",{onClick:()=>s("visual"),className:`flex items-center gap-1 px-3 py-1.5 text-xs font-bold rounded-md transition ${i==="visual"?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(Ip,{className:"w-3 h-3"})," Program Mix"]})]}),i==="visual"&&l.jsx(l.Fragment,{children:l.jsxs("button",{onClick:()=>v(!0),className:"ml-2 flex items-center gap-1 px-3 py-1.5 text-xs font-bold text-slate-600 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition border border-transparent hover:border-slate-200",children:[l.jsx(Hp,{className:"w-3 h-3"})," Structure"]})}),i==="matrix"&&l.jsxs("div",{className:"flex bg-white border border-slate-200 rounded-lg p-0.5 ml-2",children:[l.jsx("button",{onClick:()=>c("qty"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="qty"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Qty"}),l.jsx("button",{onClick:()=>c("area"),className:`px-3 py-1.5 text-xs font-bold rounded-md transition ${o==="area"?"bg-indigo-50 text-indigo-700":"text-slate-500"}`,children:"Area"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:S,className:"flex items-center gap-1.5 px-3 py-1.5 bg-white border border-slate-300 rounded-lg text-xs font-bold text-slate-700 hover:bg-slate-50 transition",children:[u?l.jsx(uc,{className:"w-3 h-3 text-emerald-600"}):l.jsx(Lp,{className:"w-3 h-3"}),u?"Copied":"Export"]}),l.jsx("button",{onClick:w,className:"p-1.5 text-slate-500 hover:text-indigo-600 hover:bg-slate-100 rounded-lg transition",title:d?"Exit Full Screen":"Expand to Full Screen",children:d?l.jsx(WT,{className:"w-4 h-4"}):l.jsx(UT,{className:"w-4 h-4"})}),d&&l.jsx("button",{onClick:w,className:"ml-2 p-1 text-slate-400 hover:text-slate-700",children:l.jsx(xn,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:`flex-grow overflow-auto relative custom-scrollbar ${d?"p-6 bg-slate-100":""}`,children:i==="visual"?l.jsx("div",{className:`h-full flex flex-col ${d?"bg-white shadow-sm rounded-lg p-6":"p-4"}`,children:l.jsx("div",{className:"flex-grow w-full min-h-[300px]",children:l.jsx($w,{data:_,groups:x,unit:b,layout:"vertical",showLabels:!0})})}):l.jsx("div",{className:d?"bg-white shadow-sm rounded-lg overflow-hidden":"",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{className:"sticky top-0 bg-white z-20 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"sticky left-0 z-30 bg-white border-b border-slate-200 px-4 py-3 text-xs font-bold text-slate-500 uppercase tracking-wider min-w-[160px] border-r border-slate-100",children:"Space Type"}),m.map(E=>l.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-500 uppercase tracking-wider border-b border-slate-200 bg-slate-50 min-w-[100px]",children:E.name},E.id)),l.jsx("th",{className:"sticky right-0 z-30 bg-indigo-50 border-b border-l border-slate-200 px-4 py-3 text-right text-xs font-bold text-indigo-800 uppercase tracking-wider min-w-[100px]",children:"Total"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:i==="summary"?l.jsxs(l.Fragment,{children:[l.jsxs("tr",{children:[l.jsx(j,{label:"Headcount (Capacity)",isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.headcount},E.floorId)),l.jsx(N,{val:e.totalHeadcountWithGrowth,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Workpoints (Seats)"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.totalDesks},E.floorId)),l.jsx(N,{val:e.requiredDesks,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting Rooms"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.meetingRoomsTotal},E.floorId)),l.jsx(N,{val:e.totalMeetingRooms,isTotal:!0})]}),l.jsxs("tr",{children:[l.jsx(j,{label:`Total Area (${b})`,isGroup:!0}),e.floorMetrics.map(E=>l.jsx(N,{val:E.areaUsed,type:"area"},E.floorId)),l.jsx(N,{val:e.totalUsedArea,isTotal:!0,type:"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Space Utilization Index"}),e.floorMetrics.map(E=>l.jsx(N,{val:E.utilization,type:"percent"},E.floorId)),l.jsx(N,{val:e.fitFactor,isTotal:!0,type:"percent"})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"WORKSTATIONS",isGroup:!0}),l.jsx("td",{colSpan:m.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Enclosed Offices"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.enclosedOffices:E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.enclosedOffices:e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Fixed Workstations"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.openDesks:E.areaWorkstations-E.enclosedOffices*12,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.openDesks:e.areaWorkstations-e.enclosedOffices*12,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Alternative Workpoints"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.altDesks:E.altDesks*3,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.altDesks:e.altDesks*3,isTotal:!0,type:o==="qty"?"number":"area"})]}),l.jsxs("tr",{className:"bg-slate-50/50",children:[l.jsx(j,{label:"MEETING ROOMS",isGroup:!0}),l.jsx("td",{colSpan:m.length+1})]}),l.jsxs("tr",{children:[l.jsx(j,{label:"Total Meeting"}),e.floorMetrics.map(E=>l.jsx(N,{val:o==="qty"?E.meetingRoomsTotal:E.areaMeeting,type:o==="qty"?"number":"area"},E.floorId)),l.jsx(N,{val:o==="qty"?e.totalMeetingRooms:e.areaMeeting,isTotal:!0,type:o==="qty"?"number":"area"})]})]})})]})})}),p&&l.jsx(q1e,{groups:x,supportSpaces:r.supportSpaces,onSave:g,onClose:()=>v(!1)})]})},Y1e=({metrics:e,strategy:t,project:r})=>{var f;const n=r.programStructure||w0(r.projectType),a=b0(r.unit),i=G.useMemo(()=>n.map(d=>{let h=0;return e.floorMetrics.forEach(p=>{d.items.forEach(v=>{if(v==="work_open")h+=p.openDesks*a.deskOpen;else if(v==="work_enclosed")h+=p.enclosedOffices*a.deskEnclosed;else if(v==="work_alt")h+=p.altDesks*a.deskAlt;else if(v==="meet")h+=p.areaMeeting;else if(v==="phone")h+=p.areaPhone;else if(v==="circ")h+=p.areaCirculation;else{const x=t.supportSpaces.find(y=>y.id===v);if(x){const y=p.supportSummary.find(g=>g.name===x.name);y&&(h+=y.area)}}})}),{name:d.name,value:h,color:d.color}}).filter(d=>d.value>0),[e,n,t,a]),s=r.unit.toUpperCase(),o=e.fitFactor>100?"text-rose-600":"text-emerald-600",c=({cx:d,cy:h,midAngle:p,innerRadius:v,outerRadius:x,percent:y})=>{if(y<.05)return null;const g=Math.PI/180,b=v+(x-v)*.5,m=d+b*Math.cos(-p*g),S=h+b*Math.sin(-p*g);return l.jsx("text",{x:m,y:S,fill:"white",textAnchor:"middle",dominantBaseline:"central",fontSize:10,fontWeight:"bold",style:{textShadow:"0px 0px 3px rgba(0,0,0,0.5)",pointerEvents:"none"},children:`${(y*100).toFixed(0)}%`})},u=d=>{const h=i.find(p=>p.name===d);return h?Math.round(h.value).toLocaleString():"0"};return l.jsxs("div",{className:"h-full flex flex-col gap-6",children:[l.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-shrink-0",children:[l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Capacity"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.totalHeadcountWithGrowth}),l.jsx("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:"Total People (w/ Growth)"})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(In,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Workpoints"})]}),l.jsx("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:e.requiredDesks}),l.jsxs("div",{className:"text-xs text-slate-400 flex gap-2 mt-1 font-medium",children:[l.jsxs("span",{children:[e.openDesks," Open"]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:[e.enclosedOffices," Enc"]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:border-orange-200 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Xr,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Meeting Rms"})]}),l.jsxs("div",{className:"text-3xl font-bold text-slate-800 tracking-tight",children:[e.totalMeetingRooms," ",l.jsx("span",{className:"text-lg font-normal text-slate-400",children:"rms"})]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:["Ratio 1 : ",e.derivedMeetingRatio.toFixed(1)]})]}),l.jsxs("div",{className:`bg-white p-5 rounded-xl shadow-sm border border-slate-200 hover:shadow-md transition-shadow ${e.fitFactor>100?"border-l-4 border-l-rose-500":"border-l-4 border-l-emerald-500"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(zp,{className:"w-4 h-4 text-slate-400"}),l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Space Utilization Index"})]}),l.jsxs("div",{className:`text-3xl font-bold tracking-tight ${o}`,children:[e.fitFactor.toFixed(0),"%"]}),l.jsxs("div",{className:"text-xs text-slate-400 mt-1 font-medium",children:[Math.round(e.totalUsedArea).toLocaleString()," / ",Math.round(r.calculatedNia).toLocaleString()," ",s]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 flex-grow min-h-0",children:[l.jsxs("div",{className:"flex flex-col gap-6 min-h-0",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-64 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-white flex justify-between items-center rounded-t-xl",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Strategic Metrics Overview"}),l.jsxs("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-0.5 rounded",children:[e.density.toFixed(1)," ",s,"/p"]})]}),l.jsx("div",{className:"flex-grow p-2",children:l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Lm,{children:[l.jsx(fa,{data:i,innerRadius:60,outerRadius:80,paddingAngle:2,dataKey:"value",label:c,labelLine:!1,children:i.map((d,h)=>l.jsx(Oi,{fill:d.color,stroke:"none"},`cell-${h}`))}),l.jsx(Wt,{formatter:d=>[`${Math.round(d).toLocaleString()} ${s}`,"Area"],contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"}}),l.jsx(Aa,{iconType:"circle",layout:"vertical",verticalAlign:"middle",align:"right",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col flex-grow overflow-hidden",children:[l.jsx("div",{className:"p-4 border-b border-slate-100 bg-white rounded-t-xl",children:l.jsx("h3",{className:"text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Program Budget"})}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-5 space-y-6 custom-scrollbar",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Workstations"}),l.jsx("span",{children:u("Workstations")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Open (",e.openDesks,")"]})," ",l.jsx("span",{children:"Fixed Points"})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsxs("span",{children:["Enclosed (",e.enclosedOffices,")"]})," ",l.jsx("span",{children:"Fixed Points"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Meeting Rooms"}),l.jsx("span",{children:u("Meeting Rooms")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Rooms"})," ",l.jsx("span",{children:e.totalMeetingRooms})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Ratio"})," ",l.jsxs("span",{children:["1:",e.derivedMeetingRatio.toFixed(0)]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Collaboration"}),l.jsx("span",{children:u("Collaboration")})]}),l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:"Open Zones"})," ",l.jsx("span",{className:"text-[10px] text-slate-400",children:"Calculated"})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex justify-between text-xs text-slate-800 font-bold border-b border-slate-100 pb-2 mb-2",children:[l.jsx("span",{children:"Support"}),l.jsx("span",{children:u("Support")})]}),(f=e.floorMetrics[0])==null?void 0:f.supportSummary.filter(d=>d.name!=="Open Collaboration").map((d,h)=>l.jsxs("div",{className:"flex justify-between text-xs text-slate-500",children:[l.jsx("span",{children:d.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"Included"})]},h))]})]})]})]}),l.jsx("div",{className:"min-h-0 h-full",children:l.jsx(Q5,{metrics:e,project:r,strategy:t})})]})]})},Q1e=({scenarios:e,activeId:t,project:r,metrics:n,onActivate:a,onAdd:i,onDuplicate:s,onDelete:o,onRename:c,compareId:u,onCompare:f,compareMetrics:d,onGoToDecision:h})=>{const p=e.find(b=>b.id===t),v=e.find(b=>b.id===u),x=({label:b,v1:m,v2:S,unit:w="",inverse:_=!1})=>{const k=m-S,N=k===0,j=k>0,E=N?"text-slate-300":j?"text-blue-600":"text-orange-600",O=j?"+":"";return l.jsxs("div",{className:"flex justify-between items-center text-xs py-1 border-b border-slate-50 last:border-0",children:[l.jsx("span",{className:"text-slate-500",children:b}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"font-bold text-slate-800",children:m.toLocaleString()}),!N&&l.jsxs("span",{className:`font-mono text-[10px] ${E}`,children:[O,k.toLocaleString()]})]})]})},g=d?((b,m)=>{const S=b.requiredDesks-m.requiredDesks,w=b.totalUsedArea-m.totalUsedArea,_=b.density-m.density;let k="";S>0?k=`Increases capacity by ${S} workpoints (+${(S/m.requiredDesks*100).toFixed(0)}%).`:S<0?k=`Reduces capacity by ${Math.abs(S)} workpoints.`:k="Maintains equivalent workpoint capacity.";let N="";w>0?N=`Requires ${Math.round(w)} ${r.unit} additional area, putting pressure on the spatial budget.`:w<0?N=`Recovers ${Math.round(Math.abs(w))} ${r.unit} of area, improving spatial efficiency.`:N="Neutral impact on overall area consumption.";let j="";return _<-1?j="Consider: Does the higher density impact acoustic comfort?":_>1?j="Consider: Is the generous density essential for experience targets?":j="Consider: Trade-off lies primarily in operational style rather than space.",{varianceText:k,impactText:N,decisionText:j}})(n,d):null;return l.jsxs("div",{className:"bg-white border-l border-slate-200 h-full flex flex-col w-80",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide",children:"Scenarios"}),l.jsxs("button",{onClick:i,className:"text-xs flex items-center gap-1 text-indigo-600 hover:text-indigo-800 font-bold",children:[l.jsx(Ya,{className:"w-3 h-3"})," New"]})]}),l.jsx("div",{className:"space-y-2",children:e.map(b=>l.jsx("div",{onClick:()=>a(b.id),className:`group p-2 rounded-lg border cursor-pointer transition-all ${t===b.id?"bg-white border-indigo-500 shadow-sm ring-1 ring-indigo-500":"bg-white border-slate-200 hover:border-indigo-300"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[t===b.id?l.jsx("input",{value:b.name,onChange:m=>c(b.id,m.target.value),className:"text-sm font-bold text-indigo-700 bg-transparent outline-none w-full",onClick:m=>m.stopPropagation()}):l.jsx("span",{className:"text-sm font-medium text-slate-600 group-hover:text-indigo-600",children:b.name}),t===b.id&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:m=>{m.stopPropagation(),s()},className:"p-1 text-slate-400 hover:text-indigo-600",title:"Duplicate",children:l.jsx(Lp,{className:"w-3 h-3"})}),e.length>1&&l.jsx("button",{onClick:m=>{m.stopPropagation(),o(b.id)},className:"p-1 text-slate-400 hover:text-rose-500",title:"Delete",children:l.jsx(ms,{className:"w-3 h-3"})})]})]})},b.id))}),l.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:l.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 rounded-lg text-xs font-bold transition-colors border border-indigo-200",children:[l.jsx(ps,{className:"w-4 h-4"})," Compare & Decide"]})})]}),l.jsxs("div",{className:"p-4 border-b border-slate-200",children:[l.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase mb-2 block flex items-center gap-2",children:[l.jsx(Ga,{className:"w-3 h-3"})," Quick Comparison"]}),l.jsxs("select",{className:"w-full text-sm p-2 border border-slate-200 rounded-md bg-slate-50 focus:outline-none",value:u||"",onChange:b=>f(b.target.value||null),children:[l.jsx("option",{value:"",children:"None (Single View)"}),e.filter(b=>b.id!==t).map(b=>l.jsx("option",{value:b.id,children:b.name},b.id))]})]}),d&&v&&g?l.jsxs("div",{className:"flex-grow overflow-y-auto p-4 bg-slate-50",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between border-b border-slate-100 pb-2",children:[l.jsx("span",{className:"text-xs font-bold text-indigo-600 truncate max-w-[100px]",children:p==null?void 0:p.name}),l.jsx("span",{className:"text-[10px] text-slate-400",children:"vs"}),l.jsx("span",{className:"text-xs font-bold text-slate-600 truncate max-w-[100px]",children:v.name})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Seating"}),l.jsx(x,{label:"Open Seats",v1:n.openDesks,v2:d.openDesks}),l.jsx(x,{label:"Alt Seats",v1:n.altDesks,v2:d.altDesks}),l.jsx(x,{label:"Total",v1:n.requiredDesks,v2:d.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Spaces"}),l.jsx(x,{label:"Meeting Rms",v1:n.totalMeetingRooms,v2:d.totalMeetingRooms}),l.jsx(x,{label:"Phone Booths",v1:n.totalPhoneBooths,v2:d.totalPhoneBooths})]}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:["Area (",r.unit,")"]}),l.jsx(x,{label:"Used Area",v1:Math.round(n.totalUsedArea),v2:Math.round(d.totalUsedArea)}),l.jsxs("div",{className:"flex justify-between items-center text-xs py-1",children:[l.jsx("span",{className:"text-slate-500",children:"Utilization Index"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:`font-bold ${n.fitFactor>100?"text-rose-600":"text-emerald-600"}`,children:[n.fitFactor.toFixed(0),"%"]}),l.jsx("span",{className:"text-slate-300",children:"/"}),l.jsxs("span",{className:"text-slate-400",children:[d.fitFactor.toFixed(0),"%"]})]})]})]})]}),l.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-100 rounded-lg text-xs text-blue-800",children:[l.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[l.jsx(fc,{className:"w-4 h-4 mt-0.5 text-blue-600"}),l.jsx("span",{className:"font-bold uppercase text-[10px] text-blue-500 mt-0.5",children:"Analysis"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Variance"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:g.varianceText})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block text-blue-900 mb-0.5",children:"Strategic Impact"}),l.jsx("span",{className:"leading-tight block text-blue-800",children:g.impactText})]}),l.jsx("div",{className:"pt-2 border-t border-blue-100 mt-1",children:l.jsx("span",{className:"leading-tight block text-blue-700 italic",children:g.decisionText})})]})]})]}):l.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center text-slate-400 p-8 text-center",children:[l.jsx(Ga,{className:"w-8 h-8 mb-2 opacity-20"}),l.jsx("p",{className:"text-xs",children:"Select a scenario above to compare metrics."})]})]})},ru={s:4,m:8,l:14,b:20,t:40},nu={s:10,m:18,l:25,b:40,t:80},q1=(e,t)=>{var K,F,Q,ie;const r=b0(e.unit),n=e.calculatedNia;let a=0,i=0,s=0,o=0,c=0,u=0,f=0,d=0,h=0,p=0,v=0,x=0,y=0,g=0;const b={small:0,medium:0,large:0,board:0,townhall:0},m=[],S=e.floors.reduce((A,R)=>A+R.headcount,0)||e.headcount,w=((K=t.workpoints)==null?void 0:K.fixed)||0,_=((F=t.workpoints)==null?void 0:F.alternative)||0,k=t.enclosedOfficeCount||0,N=Math.max(0,w-k);e.floors.forEach(A=>{const R=Math.ceil(A.headcount*(1+t.growthBuffer/100));a+=R;const D=S>0?A.headcount/S:0,H=Math.round(k*D),J=Math.round(N*D),ue=Math.round(_*D),le=H+J+ue;c+=H,s+=J,o+=ue,i+=le;const Z=t.meetingRatios.small>0?Math.ceil(R/t.meetingRatios.small):0,ee=t.meetingRatios.medium>0?Math.ceil(R/t.meetingRatios.medium):0,fe=t.meetingRatios.large>0?Math.ceil(R/t.meetingRatios.large):0,P=t.meetingRatios.board>0?Math.ceil(R/t.meetingRatios.board):0,ke=t.meetingRatios.townhall>0?Math.ceil(R/t.meetingRatios.townhall):0,be=Z+ee+fe+P+ke,Te=Z*ru.s+ee*ru.m+fe*ru.l+P*ru.b+ke*ru.t;u+=be,f+=Te,b.small+=Z,b.medium+=ee,b.large+=fe,b.board+=P,b.townhall+=ke;const Ae=Math.max(1,t.phoneBoothRatio),he=Math.ceil(R/Ae);d+=he;let We=0;const mt=[];t.supportSpaces.forEach(He=>{let Ke=0,Et=0;if(He.logic==="ratio")Ke=Math.ceil(R/Math.max(1,He.value)),Et=Ke*(He.areaPerUnit||0);else if(He.logic==="fixed_count"){const Ss=He.value*D;Et=Ss*(He.areaPerUnit||0),Ke=Ss}else He.logic==="area_per_person"?(Et=R*He.value,Ke=0):He.logic==="pct_nia"?(Et=n*D*(He.value/100),Ke=0):He.logic==="fixed_area"&&(Et=He.value*D,Ke=0);We+=Et,mt.push({name:He.name,count:Ke,area:Et})});const rr=H*r.deskEnclosed,Ut=J*r.deskOpen,_r=ue*r.deskAlt,Xt=rr+Ut+_r;let Dt=Z*nu.s+ee*nu.m+fe*nu.l+P*nu.b+ke*nu.t;const Kt=e.unit==="sqft"?Dt*10.76:Dt,Cr=he*r.phoneBooth,pa=Xt+Kt+Cr+We,jt=pa*(t.circulationPct/100),dr=pa+jt,Re=n*D,xt=Re>0?dr/Re*100:0;h+=Xt,p+=Kt,v+=Cr,x+=We,y+=jt,g+=dr,m.push({floorId:A.id,name:A.name,headcount:R,enclosedOffices:H,openDesks:J,altDesks:ue,totalDesks:le,meetingRoomsTotal:be,roomsSmall:Z,roomsMedium:ee,roomsLarge:fe,roomsBoard:P,roomsTownhall:ke,phoneBooths:he,supportSummary:mt,areaUsed:dr,areaWorkstations:Xt,areaMeeting:Kt,areaPhone:Cr,areaSupport:We,areaCirculation:jt,utilization:xt})});const j=e.departments,E=j.length,O=[],T={};j.forEach(A=>{T[A.id]={},A.collaborators.forEach(R=>{R.deptId&&(T[A.id][R.deptId]=R.strength)})});let L=0,X=0;for(let A=0;A<E;A++)for(let R=A+1;R<E;R++){const D=j[A],H=j[R],J=((Q=T[D.id])==null?void 0:Q[H.id])||0,ue=((ie=T[H.id])==null?void 0:ie[D.id])||0,le=J+ue;if(le>0){const Z=D.pinnedFloor,ee=H.pinnedFloor;let fe=0;!Z&&!ee||Z===ee?fe=1:fe=0;const P=1-fe,ke=le/2,be=ke*P;L+=ke,X+=be;let Te="Low";le>=160?Te="Critical":le>=100?Te="High":le>=50&&(Te="Medium"),O.push({dept1:D,dept2:H,score:le,strengthLabel:Te,isCrossFloor:P===1,asymmetry:Math.abs(J-ue),friction:be,overlap:fe})}}const M=L>0?X/L*100:0,U=u>0?a/u:0,q=i>0?a/i:0;return{totalHeadcountWithGrowth:a,totalOpenPlanPeople:a-c,requiredDesks:i,openDesks:s,altDesks:o,enclosedOffices:c,totalMeetingRooms:u,totalMeetingSeats:f,totalPhoneBooths:d,derivedMeetingRatio:U,effectiveDeskRatio:q,areaWorkstations:h,areaMeeting:p,areaPhone:v,areaSupport:x,areaCirculation:y,totalUsedArea:g,remainingArea:n-g,density:a>0?n/a:0,occupancyRatio:i>0?n/i:0,fitFactor:g/n*100,roomMix:b,floorMetrics:m,adjacencyStats:{stressScore:M,topFrictionPairs:O.filter(A=>A.friction>0).sort((A,R)=>R.friction-A.friction),allPairs:O.sort((A,R)=>R.score-A.score),matrix:T}}},Z1e=(e,t=!1)=>{const r=Math.min(...e),n=Math.max(...e);if(r===0&&n===0)return null;if(r===n)return l.jsx("span",{className:"text-[10px] text-slate-400 font-medium px-2",children:"No Variance"});const a=n-r,i=r===0?100:a/r*100;return l.jsxs("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded border ${i>15?"text-amber-600 bg-amber-50 border-amber-100":"text-slate-600 bg-slate-100 border-slate-200"}`,children:[i>100?">100%":`${i.toFixed(0)}%`," "]})},J1e=e=>{const t={};return e.floorMetrics.forEach(r=>{r.supportSummary.forEach(n=>{t[n.name]||(t[n.name]={count:0,area:0}),t[n.name].count+=n.count,t[n.name].area+=n.area})}),t},Os=({title:e,icon:t,isOpen:r,onToggle:n,children:a,deltaValues:i})=>l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden transition-all duration-300",children:[l.jsxs("button",{onClick:n,className:`w-full flex items-center justify-between p-4 ${r?"bg-slate-50 border-b border-slate-100":"bg-white hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:`p-1.5 rounded-lg ${r?"bg-indigo-100 text-indigo-600":"bg-slate-100 text-slate-500"}`,children:l.jsx(t,{className:"w-4 h-4"})}),l.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase tracking-wide",children:e})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[!r&&i&&Z1e(i),r?l.jsx(pn,{className:"w-4 h-4 text-slate-400"}):l.jsx(Gr,{className:"w-4 h-4 text-slate-400"})]})]}),r&&l.jsx("div",{className:"p-5 animate-in slide-in-from-top-2 duration-200",children:a})]}),mv=({scenarios:e,rows:t})=>l.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"text-left py-3 pl-4 text-xs font-bold text-slate-400 uppercase w-1/3",children:"Metric / Driver"}),e.map(r=>l.jsx("th",{className:"text-right py-3 px-4 text-xs font-bold text-indigo-800 uppercase w-32",children:r.name},r.id))]})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:t.map((r,n)=>l.jsxs("tr",{className:`hover:bg-slate-50/80 ${r.highlight?"bg-indigo-50/30":""}`,children:[l.jsxs("td",{className:"py-3 pl-4",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700",children:r.label}),r.subLabel&&l.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:r.subLabel})]}),r.values.map((a,i)=>l.jsx("td",{className:"py-3 px-4 text-right text-sm font-medium text-slate-700",children:a},i))]},n))})]})}),eye=({scenario:e,metrics:t,project:r,isActive:n,onSelect:a,onDeepDive:i})=>{const s=t.fitFactor<=100,o=r.unit.toUpperCase();return l.jsxs("div",{className:`relative flex flex-col p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-md h-full ${n?"bg-white border-indigo-600 shadow-lg z-10":"bg-white border-slate-200 hover:border-indigo-300"}`,onClick:a,children:[n&&l.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 bg-indigo-600 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:"Selected Direction"}),l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsx("h3",{className:`text-base font-bold truncate ${n?"text-indigo-800":"text-slate-700"}`,title:e.name,children:e.name}),l.jsx("div",{className:`flex-shrink-0 flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${s?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:s?l.jsx(qa,{className:"w-3 h-3"}):l.jsx(AT,{className:"w-3 h-3"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-y-3 gap-x-2 mb-3",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Total Headcount"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.totalHeadcountWithGrowth})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Workpoints"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:t.requiredDesks})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Density"}),l.jsxs("div",{className:"text-sm font-bold text-slate-800",children:[t.density.toFixed(1)," ",l.jsxs("span",{className:"text-[10px] font-normal text-slate-400",children:[o,"/p"]})]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[9px] text-slate-400 uppercase font-bold",children:"Space Utilization Index"}),l.jsxs("div",{className:`text-sm font-bold ${t.fitFactor>100?"text-rose-600":"text-slate-800"}`,children:[t.fitFactor.toFixed(0),"%"]})]})]}),l.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-100 flex justify-between items-center",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Meeting Ratio"}),l.jsxs("span",{className:"text-xs font-bold text-indigo-600",children:["1 : ",t.derivedMeetingRatio.toFixed(0)]})]}),l.jsxs("button",{onClick:c=>{c.stopPropagation(),i()},className:"text-[10px] flex items-center gap-1 bg-slate-100 hover:bg-slate-200 text-slate-600 px-2 py-1.5 rounded-md font-bold transition-colors border border-slate-200",children:[l.jsx(GT,{className:"w-3 h-3"})," Details"]})]})]})},tye=({project:e,scenarios:t,metricsMap:r,programGroups:n})=>{const a=b0(e.unit);return l.jsx("div",{className:"space-y-6",children:e.floors.map(i=>{const s=t.map(o=>{const c=r[o.id].floorMetrics.find(f=>f.floorId===i.id),u={name:o.name};return c&&n.forEach(f=>{let d=0;f.items.forEach(h=>{if(h==="work_open")d+=c.openDesks*a.deskOpen;else if(h==="work_enclosed")d+=c.enclosedOffices*a.deskEnclosed;else if(h==="work_alt")d+=c.altDesks*a.deskAlt;else if(h==="meet")d+=c.areaMeeting;else if(h==="phone")d+=c.areaPhone;else if(h==="circ")d+=c.areaCirculation;else{const p=o.supportSpaces.find(v=>v.id===h);if(p){const v=c.supportSummary.find(x=>x.name===p.name);v&&(d+=v.area)}}}),u[f.id]=d}),u});return l.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("h4",{className:"text-sm font-bold text-slate-700 mb-3 flex justify-between",children:[l.jsx("span",{children:i.name}),l.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:[i.headcount," HC"]})]}),l.jsx("div",{className:"h-24",children:l.jsx($w,{data:s,groups:n,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:30,showLegend:!1,showLabels:!0})})]},i.id)})})},rye=({scenario:e,metrics:t,project:r,programGroups:n})=>{const a=()=>t.effectiveDeskRatio<=1?"Assignments: Traditional 1:1 model ensures dedicated seating for all, minimizing change management but maximizing area consumption.":t.effectiveDeskRatio<1.4?"Assignments: Hybrid approach introduces sharing while maintaining team anchors. Requires team-level zoning.":"Assignments: High-agility model assumes mostly mobile workforce. Relies heavily on alternative settings to absorb overflow.",i=()=>t.derivedMeetingRatio>25?"Collaboration: Lean meeting ratio may cause room scarcity during peak hours. Focus on bookable open collab zones.":t.derivedMeetingRatio<15?"Collaboration: High provision of enclosed meeting spaces supports intensive privacy needs but impacts open plan capacity.":"Collaboration: Balanced meeting supply aligns with standard benchmarks.",s=()=>t.areaSupport/t.totalUsedArea*100>15?"Experience: Amenity-rich environment emphasizes social connection and wellness over density.":"Experience: Functional approach to amenities prioritizes operational efficiency.";return l.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border border-slate-200 h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3 border-b border-slate-200 pb-2",children:[l.jsx("div",{className:"text-xs font-bold text-slate-700 truncate pr-2",children:e.name}),l.jsx("div",{className:"text-[9px] px-1.5 py-0.5 rounded font-bold uppercase bg-slate-200 text-slate-600",children:"Strategy Profile"})]}),l.jsx("ul",{className:"space-y-3 flex-grow",children:[{label:"Workstations",text:a()},{label:"Meeting & Collab",text:i()},{label:"Support",text:s()}].map((o,c)=>l.jsxs("li",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wide",children:o.label}),l.jsx("span",{className:"text-xs text-slate-600 leading-snug",children:o.text})]},c))})]})},nye=({project:e,scenarios:t,activeScenarioId:r,onActivateScenario:n,onProceed:a})=>{const[i,s]=G.useState(null),[o,c]=G.useState([]),[u,f]=G.useState(["metrics","implications"]);G.useEffect(()=>{const m=[r];t.filter(w=>w.id!==r).slice(0,2).forEach(w=>m.push(w.id)),c(m)},[t,r]);const d=m=>{f(S=>S.includes(m)?S.filter(w=>w!==m):[...S,m])},h=G.useMemo(()=>t.reduce((m,S)=>(m[S.id]=q1(e,S),m),{}),[e,t]),p=t.filter(m=>o.includes(m.id)),v=t.find(m=>m.id===r),x=v?h[r]:null,y=e.programStructure||w0(e.projectType),g=G.useMemo(()=>{const m=b0(e.unit);return p.map(S=>{const w=h[S.id],_={name:S.name};return y.forEach(k=>{let N=0;w.floorMetrics.forEach(j=>{k.items.forEach(E=>{if(E==="work_open")N+=j.openDesks*m.deskOpen;else if(E==="work_enclosed")N+=j.enclosedOffices*m.deskEnclosed;else if(E==="work_alt")N+=j.altDesks*m.deskAlt;else if(E==="meet")N+=j.areaMeeting;else if(E==="phone")N+=j.areaPhone;else if(E==="circ")N+=j.areaCirculation;else{const O=S.supportSpaces.find(T=>T.id===E);if(O){const T=j.supportSummary.find(L=>L.name===O.name);T&&(N+=T.area)}}})}),_[k.id]=N}),_})},[p,h,e,y]),b=m=>{o.includes(m)?o.length>1&&c(o.filter(S=>S!==m)):o.length<3&&c([...o,m])};return i?l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"max-w-3xl mx-auto bg-amber-50 border border-amber-200 rounded-xl p-5 text-amber-900",children:[l.jsx("div",{className:"font-bold mb-2",children:"Deep Dive (temporary placeholder)"}),l.jsxs("div",{className:"text-sm",children:["This prototype references ",l.jsx("span",{className:"font-mono",children:"ScenarioDeepDive"}),", but the component isnt present in the codebase, so Deep Dive is disabled for build/deploy."]}),l.jsx("button",{className:"mt-4 px-3 py-2 rounded-lg border border-amber-300 bg-white hover:bg-amber-100 font-bold text-sm",onClick:()=>s(null),children:"Back"})]})}):l.jsxs("div",{className:"flex h-full bg-slate-50 overflow-hidden",children:[l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col z-10 flex-shrink-0",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50",children:[l.jsxs("h2",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide flex items-center gap-2",children:[l.jsx(Ga,{className:"w-4 h-4 text-indigo-600"})," Compare"]}),l.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Select up to 3 scenarios."})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:t.map(m=>{const S=o.includes(m.id),w=r===m.id;return l.jsxs("div",{className:`p-3 rounded-lg border transition-all cursor-pointer ${S?"bg-indigo-50 border-indigo-200":"bg-white border-slate-200 hover:border-indigo-200"}`,onClick:()=>b(m.id),children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${S?"bg-indigo-600 border-indigo-600":"border-slate-300"}`,children:S&&l.jsx(qa,{className:"w-3 h-3 text-white"})}),l.jsx("span",{className:`text-sm font-bold ${S?"text-indigo-900":"text-slate-600"}`,children:m.name})]}),w&&l.jsx("div",{className:"ml-6 text-[10px] font-bold text-indigo-600 uppercase tracking-wider",children:"Current Selection"})]},m.id)})})]}),l.jsxs("div",{className:"flex-grow flex flex-col overflow-hidden relative",children:[l.jsx("div",{className:"flex-grow overflow-y-auto p-8 custom-scrollbar bg-slate-50/50",children:l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 pb-32",children:[l.jsx("div",{className:"mb-8",children:l.jsx("div",{className:"flex justify-between items-end",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Strategic Decision Framework"}),l.jsxs("p",{className:"text-slate-500",children:["Evaluating strategies for ",e.projectName,"."]})]})})}),l.jsx(Os,{title:"Strategic Metrics Overview",icon:In,isOpen:u.includes("metrics"),onToggle:()=>d("metrics"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(m=>l.jsx(eye,{scenario:m,metrics:h[m.id],project:e,isActive:r===m.id,onSelect:()=>n(m.id),onDeepDive:()=>s(m.id)},m.id))})}),l.jsx(Os,{title:"Workstation Strategy",icon:HT,isOpen:u.includes("workpoints"),onToggle:()=>d("workpoints"),deltaValues:p.map(m=>h[m.id].requiredDesks),children:l.jsx(mv,{scenarios:p,rows:[{label:"Total Workpoints (Seats)",values:p.map(m=>h[m.id].requiredDesks.toLocaleString()),highlight:!0},{label:"Open Workstations",values:p.map(m=>h[m.id].openDesks)},{label:"Enclosed Offices (Private)",values:p.map(m=>h[m.id].enclosedOffices)},{label:"Alternative Workpoints",values:p.map(m=>h[m.id].altDesks)},{label:"Effective Sharing Ratio",subLabel:"Total HC / Total Seats",values:p.map(m=>`1 : ${h[m.id].effectiveDeskRatio.toFixed(2)}`)}]})}),l.jsx(Os,{title:"Meeting Rooms",icon:Xr,isOpen:u.includes("meeting"),onToggle:()=>d("meeting"),deltaValues:p.map(m=>h[m.id].totalMeetingRooms),children:l.jsx(mv,{scenarios:p,rows:[{label:"Total Enclosed Meeting Rooms",values:p.map(m=>h[m.id].totalMeetingRooms),highlight:!0},{label:"Total Meeting Capacity (Seats)",values:p.map(m=>h[m.id].totalMeetingSeats)},{label:"Effective Meeting Ratio",subLabel:"Headcount per Room",values:p.map(m=>`1 : ${h[m.id].derivedMeetingRatio.toFixed(1)}`)},{label:"Small Meeting Rooms (4p)",values:p.map(m=>h[m.id].roomMix.small)},{label:"Medium Meeting Rooms (8p)",values:p.map(m=>h[m.id].roomMix.medium)},{label:"Large Meeting Rooms (14p)",values:p.map(m=>h[m.id].roomMix.large)},{label:"Boardrooms (20p)",values:p.map(m=>h[m.id].roomMix.board)},{label:"Phone Booths (1p)",values:p.map(m=>h[m.id].totalPhoneBooths)}]})}),l.jsx(Os,{title:"Support & Amenity Allocation",icon:Rp,isOpen:u.includes("support"),onToggle:()=>d("support"),deltaValues:p.map(m=>Math.round(h[m.id].areaSupport)),children:l.jsx(mv,{scenarios:p,rows:[{label:"Total Support Area",values:p.map(m=>`${Math.round(h[m.id].areaSupport).toLocaleString()} ${e.unit.toUpperCase()}`),highlight:!0},{label:"% of NIA",values:p.map(m=>`${(h[m.id].areaSupport/e.calculatedNia*100).toFixed(1)}%`)},...(()=>{const m=new Set;return p.forEach(S=>S.supportSpaces.forEach(w=>m.add(w.name))),Array.from(m).map(S=>({label:S,values:p.map(w=>{const _=w.supportSpaces.find(E=>E.name===S),N=J1e(h[w.id])[S];if(!_||!N)return"-";const j=_.logic==="ratio"?`1:${_.value}`:_.logic==="pct_nia"?`${_.value}%`:"Fixed";return N.count>0?`${N.count} (${j})`:`${Math.round(N.area)} ${e.unit==="sqm"?"m":"ft"} (${j})`})}))})()]})}),l.jsx(Os,{title:"Program Mix (Space Distribution)",icon:Ip,isOpen:u.includes("space_mix"),onToggle:()=>d("space_mix"),children:l.jsx("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-72",children:l.jsx($w,{data:g,groups:y,unit:e.unit.toUpperCase(),layout:"horizontal",barSize:60,showLabels:!0})})}),l.jsx(Os,{title:"Floor-by-Floor Breakdown",icon:ia,isOpen:u.includes("floors"),onToggle:()=>d("floors"),children:l.jsx(tye,{project:e,scenarios:p,metricsMap:h,programGroups:y})}),l.jsx(Os,{title:"Strategic Implications & Recommendations",icon:XT,isOpen:u.includes("implications"),onToggle:()=>d("implications"),children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:p.map(m=>l.jsx(rye,{scenario:m,metrics:h[m.id],project:e,programGroups:y},m.id))})})]})}),l.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-2xl flex justify-between items-center z-20 px-8",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:l.jsx(ps,{className:"w-5 h-5 text-indigo-700"})}),l.jsxs("div",{children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Selected Strategy"}),l.jsx("div",{className:"text-lg font-bold text-slate-800",children:v==null?void 0:v.name})]}),x&&l.jsxs("div",{className:`ml-4 px-3 py-1 rounded text-xs font-bold ${x.fitFactor<=100?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:[x.fitFactor.toFixed(0),"% Utilization"]})]}),l.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg font-bold shadow-md transition-all hover:translate-x-1",children:["Proceed to Stacking Plan ",l.jsx(ia,{className:"w-4 h-4"})]})]})]})]})},aye=({project:e,activeStrategy:t,handleStrategyChange:r,activeMetrics:n,scenarios:a,activeScenarioId:i,setActiveScenarioId:s,addScenario:o,duplicateScenario:c,deleteScenario:u,renameScenario:f,compareScenarioId:d,setCompareScenarioId:h,compareMetrics:p,onNavigate:v})=>{const[x,y]=G.useState("planning");return l.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[l.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-6 py-2 flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center bg-slate-100 p-1 rounded-lg",children:[l.jsxs("button",{onClick:()=>y("planning"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${x==="planning"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ds,{className:"w-3 h-3"})," Detailed Planning"]}),l.jsxs("button",{onClick:()=>y("decision"),className:`flex items-center gap-2 px-4 py-1.5 rounded-md text-xs font-bold transition-all ${x==="decision"?"bg-white text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[l.jsx(ps,{className:"w-3 h-3"})," Decision Framework"]})]})}),l.jsx("div",{className:"flex-grow overflow-hidden relative",children:x==="decision"?l.jsx(nye,{project:e,scenarios:a,activeScenarioId:i,onActivateScenario:s,onProceed:()=>v("stacking")}):l.jsxs("div",{className:"flex h-full",children:[l.jsx("div",{className:"w-[340px] flex-shrink-0 flex flex-col border-r border-slate-200 bg-white z-10",children:l.jsx("div",{className:"flex-grow overflow-hidden",children:l.jsx(X1e,{strategy:t,onChange:r,title:t.name,baseHeadcount:e.headcount})})}),l.jsx("div",{className:"flex-grow overflow-y-auto bg-slate-50/50 p-6",children:l.jsx(Y1e,{metrics:n,strategy:t,project:e})}),l.jsx("div",{className:"w-80 flex-shrink-0 bg-white border-l border-slate-200 z-10",children:l.jsx(Q1e,{scenarios:a,activeId:i,project:e,metrics:n,onActivate:s,onAdd:o,onDuplicate:c,onDelete:u,onRename:f,compareId:d,onCompare:h,compareMetrics:p,onGoToDecision:()=>y("decision")})})]})})]})},iye=({project:e,onChange:t,selectedDeptId:r,onSelectDept:n})=>{const a=(c,u)=>{const f=e.departments.map(d=>d.id===c?{...d,...u}:d);t({...e,departments:f})},i=()=>{const c=`d-${Date.now()}`,u={id:c,name:"New Dept",headcount:10,color:er.departments[e.departments.length%er.departments.length],collaborators:[]};t({...e,departments:[...e.departments,u]}),n(c)},s=c=>{const f=e.departments.filter(d=>d.id!==c).map(d=>({...d,collaborators:d.collaborators.filter(h=>h.deptId!==c)}));t({...e,departments:f}),r===c&&n(null)},o=(c,u,f)=>{const d=e.departments.find(v=>v.id===c);if(!d)return;let h=[...d.collaborators];const p=h.findIndex(v=>v.deptId===u);p>=0?f===0?h.splice(p,1):h[p]={...h[p],strength:f}:f>0&&h.push({deptId:u,strength:f}),a(c,{collaborators:h})};return e.departments.find(c=>c.id===r),l.jsxs("div",{className:"flex flex-col h-full bg-white border-r border-slate-200 w-full",children:[l.jsxs("div",{className:"p-4 border-b border-slate-200 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(hs,{className:"w-4 h-4 text-orange-600"}),"Departments & Flows"]}),l.jsx("button",{onClick:i,className:"p-1.5 bg-white border border-slate-200 rounded hover:bg-orange-50 hover:text-orange-600 transition-colors",children:l.jsx(Ya,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:[l.jsx("div",{className:"divide-y divide-slate-100",children:e.departments.map(c=>{var f;const u=c.id===r;return l.jsxs("div",{className:`group transition-colors ${u?"bg-orange-50/50":"hover:bg-slate-50"}`,children:[l.jsxs("div",{className:"p-3 flex items-center gap-3 cursor-pointer",onClick:()=>n(u?null:c.id),children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:c.color}}),l.jsx("input",{type:"color",className:"absolute inset-0 opacity-0 cursor-pointer",value:c.color,onChange:d=>a(c.id,{color:d.target.value}),onClick:d=>d.stopPropagation()})]}),l.jsxs("div",{className:"flex-grow min-w-0",children:[l.jsx("input",{className:`text-sm font-bold bg-transparent w-full outline-none truncate ${u?"text-orange-900":"text-slate-700"}`,value:c.name,onChange:d=>a(c.id,{name:d.target.value}),onClick:d=>d.stopPropagation()}),l.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400 mt-0.5",children:[l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(qT,{className:"w-3 h-3"})," ",c.headcount]}),l.jsxs("span",{className:"flex items-center gap-0.5",children:[l.jsx(ia,{className:"w-3 h-3"})," ",((f=e.floors.find(d=>d.id===c.pinnedFloor))==null?void 0:f.name)||"Unassigned"]})]})]}),l.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx("button",{onClick:d=>{d.stopPropagation(),s(c.id)},className:"p-1.5 text-slate-300 hover:text-rose-500",children:l.jsx(ms,{className:"w-3 h-3"})}),l.jsx(Gr,{className:`w-4 h-4 text-slate-300 transition-transform ${u?"rotate-90":""}`})]})]}),u&&l.jsxs("div",{className:"px-4 pb-4 pt-0 animate-in slide-in-from-top-1",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Headcount"}),l.jsx("input",{type:"number",className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.headcount,onChange:d=>a(c.id,{headcount:parseInt(d.target.value)||0})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Floor"}),l.jsxs("select",{className:"w-full text-xs p-1.5 border border-slate-200 rounded bg-white",value:c.pinnedFloor||"",onChange:d=>a(c.id,{pinnedFloor:d.target.value||void 0}),children:[l.jsx("option",{value:"",children:"Unassigned"}),e.floors.map(d=>l.jsx("option",{value:d.id,children:d.name},d.id))]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-2 flex justify-between",children:[l.jsx("span",{children:"Interaction Strength (0-100)"}),l.jsx("span",{className:"text-orange-600",children:"With..."})]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-1",children:e.departments.filter(d=>d.id!==c.id).map(d=>{const h=c.collaborators.find(v=>v.deptId===d.id),p=(h==null?void 0:h.strength)||0;return l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"w-20 truncate text-slate-600",title:d.name,children:d.name}),l.jsx("input",{type:"range",min:"0",max:"100",step:"10",className:"flex-grow h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-orange-500",value:p,onChange:v=>o(c.id,d.id,parseInt(v.target.value))}),l.jsx("span",{className:`w-8 text-right font-mono ${p>0?"text-slate-800 font-bold":"text-slate-300"}`,children:p})]},d.id)})})]})]})]},c.id)})}),e.departments.length===0&&l.jsxs("div",{className:"p-8 text-center text-slate-400 text-xs",children:["No departments defined.",l.jsx("br",{}),"Click + to add one."]})]})]})},sye=({matrix:e,onCellClick:t,hoveredLink:r,onHoverLink:n,sortedDepts:a})=>{const o=100+a.length*28;return l.jsx("div",{className:"w-full h-full overflow-auto flex justify-center items-center p-4 bg-slate-50/50",children:l.jsxs("div",{className:"relative bg-white shadow-sm border border-slate-200 p-2 rounded-lg",style:{width:o+20,height:o+20},children:[l.jsx("div",{className:"absolute left-[100px] top-0 flex pointer-events-none",children:a.map((c,u)=>l.jsx("div",{className:"relative h-[100px]",style:{width:28},children:l.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 origin-bottom-left -rotate-45 text-[10px] font-bold text-slate-600 whitespace-nowrap overflow-visible",style:{width:120},children:c.name})},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-0 flex flex-col pointer-events-none",children:a.map((c,u)=>l.jsxs("div",{className:"h-[28px] w-[100px] flex items-center justify-end pr-2 gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-600 truncate max-w-[70px]",title:c.name,children:c.name}),l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:c.color}})]},c.id))}),l.jsx("div",{className:"absolute top-[100px] left-[100px] flex flex-col border-t border-l border-slate-200",children:a.map(c=>l.jsx("div",{className:"flex",children:a.map(u=>{var p;if(c.id===u.id)return l.jsx("div",{className:"bg-slate-100 border-r border-b border-slate-200",style:{width:28,height:28}},u.id);const f=((p=e[c.id])==null?void 0:p[u.id])||0,d=f/100,h=r&&(r.d1===c.id&&r.d2===u.id||r.d1===u.id&&r.d2===c.id);return l.jsx("div",{className:`border-r border-b border-slate-200 flex items-center justify-center text-[9px] font-bold cursor-pointer transition-all duration-150 ${h?"ring-2 ring-indigo-500 z-10 scale-110":"hover:bg-slate-50"}`,style:{width:28,height:28,backgroundColor:f>0?`rgba(249, 115, 22, ${d})`:"transparent",color:f>50?"white":"#94a3b8"},onClick:()=>t(c,u),onMouseEnter:()=>n({d1:c.id,d2:u.id}),onMouseLeave:()=>n(null),title:`${c.name}  ${u.name}: ${f}`,children:f>0?f:""},u.id)})},c.id))})]})})},oye=({sortedDepts:e,pairs:t,onHoverLink:r,hoveredLink:n,project:a})=>{const f=m=>{var S;return((S=a.floors.find(w=>w.id===m))==null?void 0:S.name)||"Unassigned"},d=e.reduce((m,S)=>m+Math.max(S.headcount||0,5),0),h=.05,v=(2*Math.PI-h*e.length)/(d||1);let x=-Math.PI/2;const y=e.map(m=>{const w=Math.max(m.headcount||0,5)*v,_=x,k=x+w,N=(_+k)/2;x=k+h;const j=300+200*Math.cos(N),E=300+200*Math.sin(N);return{...m,start:_,end:k,mid:N,x:j,y:E}}),g=[];if(y.length>0){let m=y[0].pinnedFloor,S=0;y.forEach((w,_)=>{const k=_===y.length-1,N=k?null:y[_+1].pinnedFloor;if(N!==m||k){const j=y[S],E=w;g.push({name:f(m),start:j.start-.02,end:E.end+.02}),m=N,S=_+1}})}const b=(m,S,w,_=0)=>{const k=300+m*Math.cos(S),N=300+m*Math.sin(S),j=300+m*Math.cos(w),E=300+m*Math.sin(w),O=w-S<=Math.PI?0:1;return`M ${k} ${N} A ${m} ${m} 0 ${O} 1 ${j} ${E}`};return l.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:l.jsxs("svg",{viewBox:"0 0 600 600",className:"w-full h-full max-w-[600px] select-none",children:[g.map((m,S)=>{const w=(m.start+m.end)/2,_=300+275*Math.cos(w),k=300+275*Math.sin(w);return l.jsxs("g",{children:[l.jsx("path",{d:b(250,m.start,m.end),fill:"none",stroke:"#f1f5f9",strokeWidth:"20",strokeLinecap:"butt"}),l.jsx("text",{x:_,y:k,textAnchor:"middle",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-400 uppercase tracking-wide",style:{fontSize:"10px"},children:m.name})]},`floor-${S}`)}),t.map((m,S)=>{const w=y.find(j=>j.id===m.dept1.id),_=y.find(j=>j.id===m.dept2.id);if(!w||!_)return null;const k=n&&(n.d1===w.id&&n.d2===_.id||n.d1===_.id&&n.d2===w.id),N=n&&!k;return l.jsx("path",{d:`M ${w.x} ${w.y} Q 300 300 ${_.x} ${_.y}`,fill:"none",stroke:k?er.primary:`url(#grad-${S})`,strokeWidth:k?4:Math.max(1,m.score/200*12),opacity:k?1:N?.05:.4,onMouseEnter:()=>r({d1:w.id,d2:_.id}),onMouseLeave:()=>r(null),className:"transition-all duration-300 cursor-pointer"},`link-${S}`)}),l.jsx("defs",{children:t.map((m,S)=>{const w=y.find(k=>k.id===m.dept1.id),_=y.find(k=>k.id===m.dept2.id);return!w||!_?null:l.jsxs("linearGradient",{id:`grad-${S}`,gradientUnits:"userSpaceOnUse",x1:w.x,y1:w.y,x2:_.x,y2:_.y,children:[l.jsx("stop",{offset:"0%",stopColor:w.color}),l.jsx("stop",{offset:"100%",stopColor:_.color})]},`grad-${S}`)})}),y.map(m=>{const S=n&&(n.d1===m.id||n.d2===m.id),w=n&&!S,_=m.mid,k=300+235*Math.cos(_),N=300+235*Math.sin(_),j=_*180/Math.PI+(k<300?180:0);return l.jsxs("g",{className:"transition-opacity duration-300",style:{opacity:w?.2:1},children:[l.jsx("path",{d:b(200,m.start,m.end),fill:"none",stroke:m.color,strokeWidth:"16",className:"cursor-pointer hover:brightness-110",onMouseEnter:()=>r({d1:m.id,d2:m.id}),onMouseLeave:()=>r(null)}),l.jsx("text",{x:k,y:N,textAnchor:k>300?"start":"end",dominantBaseline:"middle",className:"text-[10px] font-bold fill-slate-700 pointer-events-none",transform:`rotate(${j-(k<300?180:0)}, ${k}, ${N})`,children:m.name})]},m.id)})]})})},lye=({project:e,onChange:t,metrics:r,onNavigateToStacking:n})=>{const[a,i]=G.useState(null),[s,o]=G.useState(null),[c,u]=G.useState(!0),{adjacencyStats:f}=r,d=G.useMemo(()=>{const p=v=>e.floors.findIndex(x=>x.id===v);return[...e.departments].sort((v,x)=>{const y=p(v.pinnedFloor),g=p(x.pinnedFloor);return y!==g?(y===-1?99:y)-(g===-1?99:g):x.headcount-v.headcount})},[e]),h=(p,v)=>{o(p.id),u(!0)};return l.jsxs("div",{className:"flex h-full bg-slate-100 overflow-hidden relative",children:[l.jsxs("div",{className:`transition-all duration-300 ease-in-out bg-white border-r border-slate-200 z-20 flex-shrink-0 flex flex-col absolute md:relative h-full ${c?"w-80 translate-x-0":"w-0 -translate-x-full md:translate-x-0 md:w-0"}`,children:[l.jsx("div",{className:"flex-grow overflow-hidden w-80",children:l.jsx(iye,{project:e,onChange:t,selectedDeptId:s,onSelectDept:o})}),l.jsx("button",{onClick:()=>u(!c),className:"absolute top-1/2 -right-8 bg-white border border-l-0 border-slate-200 p-1.5 rounded-r-lg shadow-sm text-slate-500 hover:text-indigo-600 z-30",title:c?"Collapse Panel":"Expand Panel",children:c?l.jsx(zT,{className:"w-4 h-4"}):l.jsx(Gr,{className:"w-4 h-4"})})]}),!c&&l.jsx("button",{onClick:()=>u(!0),className:"absolute top-4 left-4 bg-white p-2 rounded-lg shadow border border-slate-200 z-10 text-slate-600 hover:text-indigo-600",children:l.jsx($p,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-grow flex flex-col h-full overflow-hidden",children:[l.jsxs("div",{className:"bg-white p-4 border-b border-slate-200 shadow-sm flex justify-between items-center flex-shrink-0 z-10",children:[l.jsxs("div",{className:"ml-10 md:ml-0",children:[" ",l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(eh,{className:"w-5 h-5 text-orange-500"})," Team Adjacency Model"]}),l.jsx("p",{className:"text-xs text-slate-500",children:"Define departmental flows to optimize stacking."})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"hidden sm:flex items-center gap-2 bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-100 text-xs text-slate-500",children:[l.jsx(dc,{className:"w-3 h-3 text-slate-400"}),l.jsx("span",{children:"Hover diagram to trace flows"})]}),l.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-xs font-bold shadow-sm transition-colors",children:["Go to Stacking ",l.jsx(Dp,{className:"w-3 h-3"})]})]})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-4 md:p-8 bg-slate-50/50",children:l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 h-full min-h-[600px]",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(FT,{className:"w-4 h-4 text-slate-400"})," Interaction Matrix"]}),l.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"Click cell to edit flow"})]}),l.jsx("div",{className:"flex-grow relative",children:l.jsx(sye,{matrix:f.matrix,onCellClick:h,hoveredLink:a,onHoverLink:i,sortedDepts:d})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col overflow-hidden h-full min-h-[500px]",children:[l.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center",children:[l.jsxs("h3",{className:"font-bold text-slate-700 text-sm flex items-center gap-2",children:[l.jsx(eh,{className:"w-4 h-4 text-slate-400"})," Flow Network"]}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-slate-500",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-300"})," Floor Ring"]})})]}),l.jsx("div",{className:"flex-grow relative flex items-center justify-center bg-white",children:l.jsx(oye,{sortedDepts:d,pairs:f.allPairs,onHoverLink:i,hoveredLink:a,project:e})})]})]})})]})]})},xv=({label:e,score:t,max:r,unit:n,inverse:a=!1,warning:i})=>{const s=Math.min(t/r*100,100),o=a?s<95:s>80,c=i?"text-amber-500":o?"text-emerald-600":"text-rose-600",u=i?"bg-amber-500":o?"bg-emerald-500":"bg-rose-500";return l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:e}),i?l.jsx(Or,{className:"w-4 h-4 text-amber-500"}):l.jsx(Fp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:`text-2xl font-bold ${c}`,children:[t.toLocaleString()," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:["/ ",r.toLocaleString()," ",n]})]}),l.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full mt-2 overflow-hidden",children:l.jsx("div",{className:`h-full ${u} transition-all duration-500`,style:{width:`${s}%`}})})]})]})},cye=({metrics:e,project:t})=>{const r=e.totalUsedArea/t.calculatedNia*100,n=e.adjacencyStats.stressScore;let a=100;r>100&&(a-=(r-100)*2),e.effectiveDeskRatio>1.8&&(a-=10),e.derivedMeetingRatio>25&&(a-=10),n>20&&(a-=(n-20)*.5),a=Math.max(0,Math.min(100,a));const i=a>85?"Excellent Fit":a>70?"Manageable with Compromise":"High Risk / Not Feasible",s=a>85?"bg-emerald-100 text-emerald-700":a>70?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700";return l.jsxs("div",{className:"flex flex-col h-full gap-6 max-w-5xl mx-auto w-full",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Spatial Stress Analysis"}),l.jsx("p",{className:"text-slate-500",children:"Automated assessment of project constraints vs strategic demand."})]}),l.jsxs("div",{className:`px-6 py-4 rounded-xl text-center ${s}`,children:[l.jsxs("div",{className:"text-3xl font-bold",children:[a.toFixed(0),"/100"]}),l.jsx("div",{className:"text-xs font-bold uppercase tracking-wide mt-1",children:i})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx(xv,{label:"Space Utilization Index",score:Math.round(e.totalUsedArea),max:Math.round(t.calculatedNia),unit:t.unit.toUpperCase(),inverse:!0,warning:r>95&&r<=100}),l.jsx(xv,{label:"Operational Stress Index",score:Math.round(n),max:100,unit:"Score",inverse:!0}),l.jsx(xv,{label:"Headcount",score:e.totalHeadcountWithGrowth,max:t.headcount,unit:"ppl",inverse:!0}),l.jsxs("div",{className:"bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col justify-between h-32",children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:"Density"}),l.jsx(zp,{className:"w-4 h-4 text-slate-300"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-slate-800",children:[e.density.toFixed(1)," ",l.jsxs("span",{className:"text-sm font-medium text-slate-400",children:[t.unit.toUpperCase(),"/p"]})]}),l.jsx("div",{className:"text-xs text-slate-400 mt-1",children:"Target: 8.0 - 12.0"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex-grow",children:[l.jsx("h3",{className:"text-sm font-bold text-slate-800 uppercase mb-4",children:"Strategic Stress Factors"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[l.jsx("div",{className:"space-y-4",children:[{label:"Circulation & Flow",val:e.areaCirculation,max:e.totalUsedArea*.35,desc:"Circulation ratio check."},{label:"Meeting Capacity",val:20,max:e.derivedMeetingRatio,desc:"Meeting capacity verification.",inverse:!0},{label:"Sharing Strategy Alignment",val:e.effectiveDeskRatio,max:1.5,desc:"Evaluates cultural readiness for shared desks."}].map((o,c)=>{const u=c===0?"Good":c===1?"Tight":"Aggressive",f=u==="Good"?"text-emerald-600":"text-amber-600";return l.jsxs("div",{className:"flex items-center p-3 bg-slate-50 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"p-2 bg-white rounded-md shadow-sm mr-4",children:c===0?l.jsx(MT,{className:"w-5 h-5 text-indigo-500"}):l.jsx(Xr,{className:"w-5 h-5 text-indigo-500"})}),l.jsxs("div",{className:"flex-grow",children:[l.jsx("div",{className:"text-sm font-bold text-slate-700",children:o.label}),l.jsx("div",{className:"text-xs text-slate-500",children:o.desc})]}),l.jsx("div",{className:`text-right font-bold text-sm ${f}`,children:u})]},c)})}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[l.jsx(hs,{className:"w-4 h-4 text-indigo-500"}),l.jsx("h4",{className:"text-sm font-bold text-slate-800",children:"Top Friction Drivers"}),l.jsx("span",{className:"text-xs text-slate-400 ml-auto",children:"Impact Score (0-100)"})]}),l.jsx("div",{className:"space-y-2",children:e.adjacencyStats.topFrictionPairs.length>0?e.adjacencyStats.topFrictionPairs.slice(0,5).map((o,c)=>l.jsxs("div",{className:"flex justify-between items-center p-2 rounded hover:bg-slate-50 border border-transparent hover:border-slate-100 transition-colors",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("div",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:o.dept1.color}}),o.dept1.name," + ",o.dept2.name]}),l.jsx("div",{className:"text-[10px] text-amber-600 font-medium",children:"Split across floors"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-400",children:["Str: ",(o.score/2).toFixed(0)]}),l.jsx("div",{className:"bg-amber-100 text-amber-700 px-2 py-0.5 rounded text-xs font-bold w-12 text-center",children:o.friction.toFixed(0)})]})]},c)):l.jsxs("div",{className:"text-xs text-slate-500 italic flex items-center gap-2 p-4 bg-emerald-50 rounded border border-emerald-100",children:[l.jsx(qa,{className:"w-4 h-4 text-emerald-500"}),"No significant adjacency friction detected."]})})]})]})]})]})},uye=({project:e,scenarios:t,activeScenarioId:r})=>{const n=t.find(f=>f.id===r),[a,i]=G.useState(!1),[s,o]=G.useState("custom"),c=f=>{o(f),i(!0)},u=({preset:f,title:d,desc:h,icon:p,color:v,items:x,isCustom:y=!1})=>l.jsxs("div",{className:`relative bg-white p-6 rounded-xl border transition-all flex flex-col h-full group ${y?"border-dashed border-slate-300 hover:border-indigo-400":"border-slate-200 shadow-sm hover:shadow-md"}`,children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110 ${v}`,children:l.jsx(p,{className:`w-6 h-6 ${y?"text-indigo-600":"text-white"}`})}),l.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:d}),l.jsx("p",{className:"text-sm text-slate-500 mb-6 flex-grow",children:h}),l.jsx("ul",{className:"space-y-2 mb-6",children:x.map((g,b)=>l.jsxs("li",{className:"flex items-center gap-2 text-xs text-slate-600",children:[l.jsx(uc,{className:`w-3 h-3 ${y?"text-slate-400":"text-emerald-500"}`})," ",g]},b))}),l.jsxs("button",{onClick:()=>c(f),className:`w-full py-2.5 rounded-lg border font-bold text-sm flex items-center justify-center gap-2 transition-colors ${y?"border-indigo-200 text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,children:[y?l.jsx(Hp,{className:"w-4 h-4"}):l.jsx(Ei,{className:"w-4 h-4"}),y?"Open Builder":"Download Package"]})]});return l.jsxs("div",{className:"max-w-6xl mx-auto w-full h-full flex flex-col p-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Project Exports"}),l.jsx("p",{className:"text-slate-500 mt-1",children:"Generate documentation packages for different stakeholders."}),l.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-3 py-1 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-full border border-indigo-100",children:["Active Scenario: ",n==null?void 0:n.name]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx(u,{preset:"client",title:"Client Presentation",desc:"Executive summary with transparent charts, strategic metrics, and comparisons.",icon:lc,color:"bg-indigo-600",items:["PDF Report","High-level KPIs","Strategic Insights"]}),l.jsx(u,{preset:"designer",title:"Designer Handoff",desc:"Technical data package for architectural teams to begin test fitting.",icon:In,color:"bg-pink-600",items:["Excel / CSV","Stacking Matrices","Room Quantities"]}),l.jsx(u,{preset:"internal",title:"Internal Record",desc:"Complete project dump containing all assumptions and metadata.",icon:Bp,color:"bg-emerald-600",items:["Excel Workbook","All Scenarios","Full Audit Log"]}),l.jsx(u,{preset:"custom",title:"Custom Builder",desc:"Build a specific export package by selecting content and formats manually.",icon:Ya,color:"bg-indigo-50",items:["Select Content","Choose Formats","Multi-Scenario"],isCustom:!0})]}),a&&l.jsxs("div",{className:"mt-6 p-4 rounded-lg border border-amber-200 bg-amber-50 text-amber-900 text-sm",children:[l.jsx("div",{className:"font-bold mb-1",children:"Export modal placeholder (temporary)"}),l.jsxs("div",{children:["Preset: ",l.jsx("span",{className:"font-mono",children:s})]}),l.jsxs("div",{className:"mt-2",children:["Your project currently references an ",l.jsx("span",{className:"font-mono",children:"ExportModal"})," component that isnt present in the codebase, so its disabled for build/deploy. Once you add ",l.jsx("span",{className:"font-mono",children:"src/components/ExportModal.tsx"}),", we can restore the real modal UI without changing this pages logic."]}),l.jsx("button",{className:"mt-3 px-3 py-2 rounded-md border border-amber-300 bg-white hover:bg-amber-100 font-bold",onClick:()=>i(!1),children:"Close"})]})]})},Z5=[{key:"floor",label:"Level / Floor",required:!0},{key:"department",label:"Department (Team)",required:!1},{key:"date",label:"Date",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status (Occupied?)",required:!0}],J5=[{key:"floor",label:"Level / Floor",required:!0},{key:"roomName",label:"Room Name",required:!0},{key:"roomType",label:"Space Type",required:!0},{key:"capacity",label:"Capacity (Marker)",required:!1},{key:"week",label:"Week",required:!1},{key:"day",label:"Day",required:!0},{key:"timeSlot",label:"Time Slot",required:!0},{key:"isOccupied",label:"Status",required:!0},{key:"attendeeCount",label:"Occupancy (Count)",required:!1}],fye=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var i;try{const s=(i=a.target)==null?void 0:i.result,o=xp(s,{type:"binary"}),c=o.SheetNames[0],u=o.Sheets[c],f=gr.sheet_to_json(u,{header:1});t(f)}catch(s){r(s)}},n.onerror=a=>r(a),n.readAsBinaryString(e)}),dye=(e,t)=>{const r=e.map(i=>String(i).toLowerCase().trim()),n={},a=i=>r.findIndex(s=>i.some(o=>s.includes(o)));return n.date=a(["date","timestamp"]),n.timeSlot=a(["time","slot","hour","start","period"]),n.floor=a(["floor","level","zone","lvl"]),n.week=a(["week","wk"]),n.day=a(["day"]),t==="workstation"?(n.isOccupied=a(["occup","status","state","vacan","activity"]),n.department=a(["dept","department","team","group","cost center"])):(n.roomName=a(["room","name","id","department","dept"]),n.roomType=a(["type","category","kind"]),n.capacity=a(["cap","seat","pax"]),n.isOccupied=a(["status","state"]),n.attendeeCount=a(["occupancy","actual","pax","people","count"])),Object.keys(n).forEach(i=>{n[i]===-1&&delete n[i]}),n},hye=(e,t,r)=>{const a=(r==="workstation"?Z5:J5).filter(o=>o.required&&t[o.key]===void 0),i=[],s=e.slice(1,11);if(s.length>0&&t.isOccupied!==void 0){const o=t.isOccupied;s.some(u=>{const f=String(u[o]).toLowerCase();return f.includes("occ")||f==="1"||f==="0"||f==="yes"||f==="no"||f==="true"||f==="false"})||i.push("Status column values don't look standard (e.g. 'Occupied', '1', 'Yes').")}if(s.length>0&&t.timeSlot!==void 0){const o=t.timeSlot;s.some(u=>{const f=String(u[o]);return f.includes(":")||!isNaN(parseFloat(f))})||i.push("Time column doesn't appear to contain time formats.")}return{isValid:a.length===0,missingFields:a.map(o=>o.label),warnings:i}},h4=e=>{if(e===1||e==="1")return!0;if(typeof e=="string"){const t=e.toLowerCase().trim();if(t.includes("unoccupied"))return!1;if(t.includes("occupied")||t==="yes"||t==="y"||t==="occ")return!0}return!1},p4=(e,t,r)=>{const n=[],a=i=>{const s=String(i).toLowerCase().trim();return["level","floor","department","room","type","capacity","status","occupancy","week","day","time"].includes(s)};for(let i=1;i<e.length;i++){const s=e[i];if(!s||s.length===0)continue;const o=x=>{const y=t[x];return y!==void 0?s[y]:void 0},c=String(o("date")||""),u=String(o("timeSlot")||""),f=String(o("floor")||"Unknown").trim(),d=o("week"),h=o("day"),p=parseInt(d)||void 0,v=parseInt(h)||void 0;if(!a(f)&&!(f==="Unknown"&&!u&&!c))if(r==="workstation")(c||u||f!=="Unknown")&&n.push({id:`obs-${i}`,date:c||"Unknown Date",timeSlot:u||"Unknown Time",floor:f,department:String(o("department")||"Unassigned"),isOccupied:h4(o("isOccupied")),week:p,day:v});else{const x=h4(o("isOccupied")),y=o("attendeeCount");let g=0;if(x){const b=parseInt(y);!isNaN(b)&&b>0?g=b:g=1}(u||v||p||f!=="Unknown")&&n.push({id:`mtg-${i}`,date:c,timeSlot:u||"Unknown Time",floor:f,roomName:String(o("roomName")||`Room ${i}`),roomType:String(o("roomType")||"Meeting Room"),capacity:1,attendeeCount:g,isOccupied:x,week:p,day:v})}}return n},pye=e=>{const t=e.length,r=e.filter(u=>u.isOccupied).length,n=t>0?r/t*100:0,a={};e.forEach(u=>{a[u.timeSlot]||(a[u.timeSlot]={t:0,o:0}),a[u.timeSlot].t++,u.isOccupied&&a[u.timeSlot].o++});let i=0;const s=Object.keys(a).map(u=>{const f=a[u].o/a[u].t*100;return f>i&&(i=f),{time:u,rate:f}}).sort((u,f)=>u.time.localeCompare(f.time)),o={};e.forEach(u=>{o[u.floor]||(o[u.floor]={t:0,o:0}),o[u.floor].t++,u.isOccupied&&o[u.floor].o++});const c=Object.keys(o).map(u=>({floor:u,rate:o[u].o/o[u].t*100}));return{avgOccupancy:n,peakOccupancy:i,occupancyByTime:s,occupancyByFloor:c,roomMetrics:[],totalObservations:t,totalRooms:0,overallUtilization:n,overallAvgAttendees:0,globalSizeBins:[],globalInsights:[]}},mye=e=>e===1?"1p":e===2?"2p":e>=3&&e<=4?"3-4p":e>=5&&e<=7?"5-7p":e>=8&&e<=11?"8-11p":e>=12?"12p+":"0p",eM=e=>{const t=new Map,r=new Set;e.forEach(s=>{if(s.roomName&&r.add(s.roomName),!s.timeSlot)return;const o=s.week||1,c=s.day||1,u=s.timeSlot.trim(),f=`W${o}-D${c}-${u}`;t.has(f)||t.set(f,{week:o,day:c,timeStr:u,allRooms:new Set,occupiedRooms:new Set});const d=t.get(f),h=s.roomName||"Unknown";d.allRooms.add(h),s.isOccupied&&d.occupiedRooms.add(h)});const n=Array.from(t.values()).map(s=>{const o=s.allRooms.size,c=s.occupiedRooms.size,u=o>0?c/o*100:0;let f=0;if(s.timeStr.includes(":")){const h=s.timeStr.split(":");f=(parseInt(h[0])||0)*60+(parseInt(h[1])||0)}else{const h=parseFloat(s.timeStr);isNaN(h)||(h<1?f=h*1440:f=h)}const d=s.week*1e5+s.day*2e3+f;return{time:`W${s.week} D${s.day} ${s.timeStr}`,sortKey:d,occupied:c,total:o,pct:u}}).sort((s,o)=>s.sortKey-o.sortKey).map(({time:s,occupied:o,total:c,pct:u})=>({time:s,occupied:o,total:c,pct:u})),a=n.length>0?n.reduce((s,o)=>s+o.pct,0)/n.length:0,i=n.length>0?Math.max(...n.map(s=>s.pct)):0;return{avgPct:a,maxPct:i,timeline:n,uniqueRoomsCount:r.size}},xye=(e,t={})=>{const r=new Map;e.forEach(g=>{const b=`${g.floor}::${g.roomName}::${g.week}::${g.day}::${g.timeSlot}`;r.has(b)||r.set(b,{eventId:b,floor:g.floor,roomName:g.roomName||"Unknown",roomType:g.roomType||"General",week:g.week||0,day:g.day||0,time:g.timeSlot,attendees:0,occupied:!1,rawRowIds:[]});const m=r.get(b);m.rawRowIds.push(g.id),g.isOccupied&&(m.occupied=!0,m.attendees+=g.attendeeCount||1)});const n=new Map,a={},i=["1p","2p","3-4p","5-7p","8-11p","12p+"];i.forEach(g=>a[g]=0);let s=0,o=0;r.forEach(g=>{const b=`${g.floor}::${g.roomName}`;n.has(b)||n.set(b,{floor:g.floor,name:g.roomName,type:g.roomType,totalMeetings:0,occupiedMeetings:0,totalAttendees:0,sizeCounts:{},binCounts:{},eventsBySize:{},fitBuckets:{low:[],mid:[],fit:[],over:[]}});const m=n.get(b);if(m.totalMeetings++,g.occupied&&g.attendees>0){m.occupiedMeetings++,m.totalAttendees+=g.attendees,s++,o+=g.attendees;const S=g.attendees;m.sizeCounts[S]=(m.sizeCounts[S]||0)+1;const w={week:g.week,day:g.day,time:g.time,attendees:g.attendees,eventId:g.eventId,floor:g.floor,roomName:g.roomName,roomType:g.roomType,rawRowIds:g.rawRowIds};m.eventsBySize[S]||(m.eventsBySize[S]=[]),m.eventsBySize[S].push(w);const _=mye(S);m.binCounts[_]=(m.binCounts[_]||0)+1,a[_]=(a[_]||0)+1;const k=t[b]||0;if(k>0){const N=g.attendees/k;N<.4?m.fitBuckets.low.push(w):N<.7?m.fitBuckets.mid.push(w):N<=1?m.fitBuckets.fit.push(w):m.fitBuckets.over.push(w)}}});const c=[];n.forEach((g,b)=>{const m=Object.keys(g.sizeCounts).map(Q=>{const ie=parseInt(Q),A=g.sizeCounts[ie],R=g.occupiedMeetings>0?A/g.occupiedMeetings*100:0,D=(g.eventsBySize[ie]||[]).sort((H,J)=>H.day!==J.day?H.day-J.day:H.time.localeCompare(J.time));return{floor:g.floor,roomName:g.name,size:ie,count:A,occupancyPct:R,events:D}}).sort((Q,ie)=>Q.size-ie.size);let S=0,w=0;m.forEach(Q=>{Q.count>w&&(w=Q.count,S=Q.size)});const _=g.occupiedMeetings>0?w/g.occupiedMeetings*100:0,k=S>0?`${S}p (${_.toFixed(0)}%)`:"-",N=t[b]||0,j=g.occupiedMeetings>0?g.totalAttendees/g.occupiedMeetings:0,E=N>0?j/N:0;let O="Mixed Pattern / Review Required";if(N===0||g.occupiedMeetings===0)O="Unclassified";else{const Q=Math.round(N),ie=Math.round(S),A=Math.round(j),R=Math.round(.5*Q),D=Math.round(.7*Q),H=Math.round(.8*Q);ie<R&&A<R?O="Underutilized / Size Mismatch":ie>=R&&ie<=D||A>=R&&A<=D?O="Reasonably Utilized":ie>=H&&A>=H?O="Over Utilized":O="Mixed Pattern / Review Required"}const T=g.fitBuckets.low.length,L=g.fitBuckets.mid.length,X=g.fitBuckets.fit.length,M=g.fitBuckets.over.length,U=g.occupiedMeetings>0?T/g.occupiedMeetings:0,q=g.occupiedMeetings>0?L/g.occupiedMeetings:0,K=g.occupiedMeetings>0?X/g.occupiedMeetings:0,F=g.occupiedMeetings>0?M/g.occupiedMeetings:0;c.push({floor:g.floor,roomName:g.name,roomType:g.type,capacity:N,observedSlots:g.totalMeetings,occupiedSlots:g.occupiedMeetings,utilizationPct:g.totalMeetings>0?g.occupiedMeetings/g.totalMeetings*100:0,avgOccupancy:j,meetingSizeDistribution:g.binCounts,sizeBreakdown:m,topMeetingSize:k,avgCapRatio:E,classification:O,capacityFit:{low:{count:T,pct:U*100,events:g.fitBuckets.low},mid:{count:L,pct:q*100,events:g.fitBuckets.mid},fit:{count:X,pct:K*100,events:g.fitBuckets.fit},over:{count:M,pct:F*100,events:g.fitBuckets.over}}})});const u=c.reduce((g,b)=>g+b.observedSlots,0),f=i.map(g=>({label:g,count:a[g],occupancyPct:s>0?a[g]/s*100:0})),d=[],h=a["1p"]||0,p=a["2p"]||0,v=a["8-11p"]||0,x=a["12p+"]||0;if(s>0){const g=(h+p)/s*100,b=(v+x)/s*100;g>60&&d.push("Most interactions are small-format (1-2p), suggesting high demand for focus or dyad rooms."),b>15&&d.push("Notable volume of mid-to-large meetings indicates valid need for formal conference spaces."),b<5&&d.push("Large meetings (8p+) are infrequent; consider repurposing large boardrooms."),a["3-4p"]>a["1p"]&&d.push("Small group collaboration (3-4p) is a dominant behavior.")}else d.push("Insufficient data to generate behavioral insights.");const y=eM(e);return{avgOccupancy:0,peakOccupancy:0,occupancyByTime:[],occupancyByFloor:[],roomMetrics:c,totalObservations:u,totalRooms:n.size,overallUtilization:u>0?s/u*100:0,overallAvgAttendees:s>0?o/s:0,globalSizeBins:f,globalInsights:d,concurrencyStats:y}},vye=e=>{const t=[],r=["L10","L11","L12"],n=["09:00","10:00","11:00","13:00","14:00","15:00","16:00"];if(e==="workstation"){const a=["Sales","IT","HR","Finance","Product"];for(let i=0;i<800;i++){const s=Math.random()>.4;t.push({id:`sim-${i}`,date:"2024-01-01",timeSlot:n[Math.floor(Math.random()*n.length)],floor:r[Math.floor(Math.random()*r.length)],department:a[Math.floor(Math.random()*a.length)],isOccupied:s})}}else{const a=[{name:"Focus 01",type:"Focus Room"},{name:"Meet 01",type:"Meeting Room"},{name:"Meet 02",type:"Meeting Room"},{name:"Boardroom",type:"Boardroom"}];for(let i=0;i<500;i++){const s=a[Math.floor(Math.random()*a.length)],o=n[Math.floor(Math.random()*n.length)],c=r[Math.floor(Math.random()*r.length)],u=Math.floor(Math.random()*5)+1;if(!(Math.random()>.3))t.push({id:`sim-empty-${i}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!1,date:""});else{const d=Math.floor(Math.random()*8)+1;for(let h=0;h<d;h++)t.push({id:`sim-occ-${i}-${h}`,floor:c,roomName:s.name,roomType:s.type,day:u,timeSlot:o,isOccupied:!0,attendeeCount:1,date:""})}}}return t},gye=()=>{const[e,t]=G.useState("import"),[r,n]=G.useState("workstation"),[a,i]=G.useState([]),[s,o]=G.useState([]),[c,u]=G.useState({}),[f,d]=G.useState([]),[h,p]=G.useState(null),[v,x]=G.useState(!1),[y,g]=G.useState(1),[b,m]=G.useState(""),[S,w]=G.useState(null),[_,k]=G.useState(!1),N=(O,T)=>{k(!0),i(O),m(T);const L=O[0];o(L);const X=dye(L,r==="workstation"?"workstation":"meeting");u(X);const M=p4(O,X,r==="workstation"?"workstation":"meeting");d(M);const U=hye(O,X,r==="workstation"?"workstation":"meeting");!U.isValid||U.warnings.length>0?(p({missing:U.missingFields,warnings:U.warnings}),x(!0)):(p(null),x(!1)),setTimeout(()=>{k(!1),t("results")},800)},j=async O=>{var L;const T=(L=O.target.files)==null?void 0:L[0];if(T)try{const X=await fye(T);X&&X.length>0?(N(X,T.name),w(null)):w("File appears empty.")}catch{w("Failed to parse Excel.")}},E=()=>{const O=vye(r==="workstation"?"workstation":"meeting");d(O),m("Sample_Data.xlsx"),x(!1),t("results")};return e==="results"?l.jsx(yye,{records:f,type:r,onBack:()=>{t("import"),g(1)},headers:s,rawData:a,currentMappings:c,initialShowMapping:v,onUpdateMappings:O=>{u(O);const T=p4(a,O,r==="workstation"?"workstation":"meeting");d(T)}}):l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 overflow-hidden",children:[l.jsx("div",{className:"p-6 border-b border-slate-200 bg-white flex justify-between items-center",children:l.jsxs("h1",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[l.jsx(cc,{className:"w-6 h-6 text-orange-500"})," Utilization Study"]})}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden min-h-[500px] flex flex-col justify-center",children:[y===1&&l.jsxs("div",{className:"p-10 text-center animate-in fade-in",children:[l.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Select Study Type"}),l.jsx("p",{className:"text-slate-500 mb-8",children:"Choose the analytical lens for your observation data."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto",children:[l.jsxs("button",{onClick:()=>{n("workstation"),g(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(In,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(In,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Workstation Occupancy"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Analyze desk usage, peak loads, and department patterns."})]}),l.jsxs("button",{onClick:()=>{n("meeting"),g(2)},className:"group p-8 border-2 border-slate-100 hover:border-orange-500 rounded-2xl hover:bg-orange-50/50 transition-all text-left relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:l.jsx(Xr,{className:"w-24 h-24 text-orange-600"})}),l.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:l.jsx(Xr,{className:"w-6 h-6 text-orange-600"})}),l.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-1",children:"Meeting Utilization"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Evaluate room capacity sizing and frequency of use."})]})]})]}),y===2&&l.jsx("div",{className:"p-10 text-center animate-in fade-in",children:_?l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-orange-200 border-t-orange-600 rounded-full animate-spin mb-6"}),l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"Processing Data..."}),l.jsx("p",{className:"text-slate-500 mt-2",children:"Auto-detecting columns and calculating metrics."})]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-20 h-20 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:l.jsx(KT,{className:"w-10 h-10 text-slate-400"})}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Upload Data Source"}),l.jsx("p",{className:"text-slate-500 max-w-md mx-auto mb-8",children:"Upload your Excel observation log. The system will automatically detect fields like Date, Time, Floor, and Occupancy."}),l.jsxs("div",{className:"flex flex-col items-center gap-4",children:[l.jsxs("label",{className:"cursor-pointer bg-slate-900 hover:bg-slate-800 text-white px-8 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-3",children:[l.jsx(PT,{className:"w-5 h-5"}),"Select Excel File",l.jsx("input",{type:"file",className:"hidden",accept:".xlsx, .xls",onChange:j})]}),l.jsx("button",{onClick:E,className:"text-sm font-bold text-slate-400 hover:text-orange-600 transition-colors py-2",children:"Use Sample Dataset"})]}),S&&l.jsxs("div",{className:"mt-6 bg-rose-50 text-rose-600 px-4 py-3 rounded-lg inline-flex items-center gap-2 text-sm font-medium",children:[l.jsx(Or,{className:"w-4 h-4"})," ",S]}),l.jsx("button",{onClick:()=>g(1),className:"mt-12 text-xs font-bold text-slate-400 hover:text-slate-600",children:" Back to Study Type"})]})})]})})]})},yye=({records:e,type:t,onBack:r,headers:n,rawData:a,currentMappings:i,initialShowMapping:s,onUpdateMappings:o})=>{const[c,u]=G.useState(!1),[f,d]=G.useState(null),[h,p]=G.useState(null),[v,x]=G.useState({});G.useEffect(()=>{c&&x({...i})},[c,i]),G.useEffect(()=>{s&&u(!0)},[s]);const y=()=>{o(v),u(!1)},[g,b]=G.useState({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),[m,S]=G.useState({}),w=G.useMemo(()=>{const M=new Set,U=new Set,q=new Set,K=new Set,F=new Set,Q=new Set,ie=new Set,A=new Set,R=D=>["level","floor","department","room","type","capacity","week","day","time"].includes(String(D).toLowerCase().trim());return e.forEach(D=>{D.floor&&!R(D.floor)&&M.add(D.floor),D.roomName&&!R(D.roomName)&&U.add(D.roomName),D.roomType&&!R(D.roomType)&&q.add(D.roomType),D.week!==void 0&&K.add(D.week.toString()),D.day!==void 0&&F.add(D.day),D.timeSlot&&!R(D.timeSlot)&&Q.add(D.timeSlot),D.department&&!R(D.department)&&ie.add(D.department),D.date&&A.add(D.date)}),{floors:Array.from(M).sort(),rooms:Array.from(U).sort(),types:Array.from(q).sort(),weeks:Array.from(K).sort((D,H)=>parseInt(D)-parseInt(H)),days:Array.from(F).sort((D,H)=>D-H).map(String),timeSlots:Array.from(Q).sort(),depts:Array.from(ie).sort(),dates:Array.from(A).sort()}},[e]),_=G.useMemo(()=>e.filter(M=>{if(g.floors.length&&!g.floors.includes(M.floor)||g.timeSlots.length&&!g.timeSlots.includes(M.timeSlot))return!1;if(t==="meeting"){if(g.rooms.length&&M.roomName&&!g.rooms.includes(M.roomName)||g.types.length&&M.roomType&&!g.types.includes(M.roomType)||g.weeks.length&&M.week!==void 0&&!g.weeks.includes(M.week.toString())||g.days.length&&M.day!==void 0&&!g.days.includes(M.day.toString()))return!1}else if(g.depts.length&&M.department&&!g.depts.includes(M.department)||g.dates.length&&M.date&&!g.dates.includes(M.date))return!1;return!0}),[e,g,t]),k=G.useMemo(()=>t==="workstation"?pye(_):xye(_,m),[_,t,m]),N=t==="workstation"?Z5:J5,j=N.filter(M=>M.required&&i[M.key]===void 0),E=j.length>0,O=(M,U)=>{b(q=>{const K=q[M];return{...q,[M]:K.includes(U)?K.filter(F=>F!==U):[...K,U]}})},T=(M,U,q)=>{const K=`${M}::${U}`;S(F=>({...F,[K]:q}))},L=({label:M,items:U,active:q,field:K})=>l.jsxs("div",{className:"relative group",children:[l.jsxs("button",{className:`flex items-center gap-1.5 px-3 py-1.5 text-xs font-bold rounded-lg border transition-colors ${q.length>0?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-slate-200 text-slate-600 hover:border-slate-300"}`,children:[M," ",q.length>0&&l.jsx("span",{className:"bg-indigo-600 text-white px-1.5 rounded-full text-[9px]",children:q.length}),l.jsx(Gr,{className:"w-3 h-3 rotate-90 text-slate-400"})]}),l.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 hidden group-hover:block z-50 p-2 max-h-64 overflow-y-auto",children:U.length===0?l.jsx("div",{className:"p-2 text-xs text-slate-400 italic",children:"No options found"}):U.map(F=>l.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"rounded text-indigo-600 focus:ring-indigo-500",checked:q.includes(F),onChange:()=>O(K,F)}),l.jsx("span",{className:"text-xs text-slate-700 truncate",children:F})]},F))})]}),X=()=>{const M=gr.book_new(),U=gr.json_to_sheet(_);if(gr.book_append_sheet(M,U,"Raw Data"),t==="meeting"&&k.roomMetrics){const q=k.roomMetrics.map(F=>({Floor:F.floor,"Room Name":F.roomName,Type:F.roomType,"Room Capacity (User)":F.capacity,"Observed Slots":F.observedSlots,"Occupied Slots":F.occupiedSlots,"Utilization %":(F.utilizationPct/100).toFixed(2),"Avg Occupancy":F.avgOccupancy.toFixed(1),"Top Meeting Size":F.topMeetingSize,Classification:F.classification})),K=gr.json_to_sheet(q);gr.book_append_sheet(M,K,"Room Performance")}qm(M,"Utilization_Analysis.xlsx")};return l.jsxs("div",{className:"flex flex-col h-full bg-slate-50 relative",children:[l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center shadow-sm z-20",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:r,className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 transition-colors",children:l.jsx(Gr,{className:"w-5 h-5 rotate-180"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[t==="workstation"?"Workstation Occupancy":"Meeting Utilization",E&&l.jsxs("span",{title:"Mapping Incomplete",className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-200",children:[l.jsx(Or,{className:"w-3 h-3"})," Fix Mapping"]})]}),l.jsxs("p",{className:"text-xs text-slate-500",children:[_.length," Observations Analyzed"]})]})]}),l.jsx("div",{className:"flex items-center gap-3",children:l.jsxs("button",{onClick:X,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white border border-transparent rounded-lg text-xs font-bold shadow-sm",children:[l.jsx(Ei,{className:"w-4 h-4"})," Export"]})})]}),t==="workstation"&&l.jsxs("div",{className:"bg-white border-b border-slate-200 px-6 py-2 flex items-center gap-4 z-10 overflow-x-auto",children:[l.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase mr-2",children:[l.jsx(Jd,{className:"w-3 h-3"})," Filters:"]}),l.jsx(L,{label:"Floor",items:w.floors,active:g.floors,field:"floors"}),l.jsx(L,{label:"Time Slot",items:w.timeSlots,active:g.timeSlots,field:"timeSlots"}),l.jsx(L,{label:"Department",items:w.depts,active:g.depts,field:"depts"}),l.jsx(L,{label:"Date",items:w.dates,active:g.dates,field:"dates"}),l.jsxs("button",{onClick:()=>b({floors:[],rooms:[],types:[],weeks:[],days:[],timeSlots:[],depts:[],dates:[]}),className:"ml-auto text-xs font-bold text-rose-500 hover:text-rose-700 flex items-center gap-1",children:[l.jsx(xn,{className:"w-3 h-3"})," Clear"]})]}),l.jsx("div",{className:"flex-grow p-8 overflow-y-auto custom-scrollbar",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:_.length===0?l.jsxs("div",{className:"text-center py-20 text-slate-400",children:[l.jsx(Jd,{className:"w-12 h-12 mx-auto mb-4 opacity-20"}),l.jsx("p",{children:"No records match the current filters."})]}):t==="workstation"?l.jsx(_ye,{metrics:k}):l.jsx(jye,{metrics:k,records:_,onUpdateCapacity:T,onDrillDown:(M,U,q)=>d({title:M,events:U,context:q})})})}),c&&l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[450px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-slate-800",children:"Auto Field Detection"}),l.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:"Map Excel columns to required system fields."})]}),l.jsx("button",{onClick:()=>u(!1),children:l.jsx(xn,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsxs("div",{className:"flex-grow overflow-y-auto p-6 bg-slate-50/50",children:[E&&l.jsxs("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-800 flex items-start gap-2",children:[l.jsx(Or,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold block mb-1",children:"Missing Required Fields"}),l.jsx("ul",{className:"list-disc list-inside space-y-0.5",children:j.map(M=>l.jsx("li",{children:M.label},M.key))})]})]}),l.jsx("div",{className:"space-y-6",children:N.map(M=>{const U=v[M.key],q=U!==void 0&&a.length>1?a.slice(1,4).map(K=>K[U]).filter(K=>K!==void 0&&K!==""):[];return l.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 shadow-sm",children:[l.jsxs("label",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-slate-700 flex items-center gap-1",children:[M.label,M.required&&l.jsx("span",{className:"text-rose-500",title:"Required",children:"*"})]}),U===void 0&&M.required&&l.jsx("span",{className:"text-[9px] text-rose-500 font-bold uppercase bg-rose-50 px-1.5 py-0.5 rounded",children:"Unmapped"})]}),l.jsxs("select",{className:`w-full p-2 text-sm border rounded outline-none transition-all ${U===void 0&&M.required?"border-rose-300 bg-rose-50 focus:border-rose-500":"border-slate-300 bg-white focus:border-indigo-500"}`,value:U??"",onChange:K=>{const F=K.target.value,Q={...v};F===""?delete Q[M.key]:Q[M.key]=parseInt(F),x(Q)},children:[l.jsx("option",{value:"",children:"(Select Excel Column)"}),n.map((K,F)=>l.jsx("option",{value:F,children:K},F))]}),l.jsx("div",{className:"mt-2 min-h-[1.5em]",children:U!==void 0?l.jsxs("div",{className:"text-[10px] text-slate-500 flex items-start gap-1.5 bg-slate-50 p-1.5 rounded",children:[l.jsx("span",{className:"font-bold text-slate-400 uppercase text-[9px] mt-0.5",children:"Preview:"}),l.jsx("span",{className:"font-mono text-slate-700 break-all leading-tight",children:q.length>0?q.join(", "):l.jsx("span",{className:"italic text-slate-400",children:"Empty column"})})]}):l.jsx("div",{className:"text-[10px] text-slate-300 italic pl-1",children:"Map a column to see preview"})})]},M.key)})})]}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:y,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(uc,{className:"w-4 h-4"})," Apply Mapping"]})})]})}),f&&l.jsx(bye,{title:f.title,events:f.events,context:f.context,onClose:()=>d(null),onJumpToRaw:M=>p(M)}),h&&l.jsx(wye,{ids:h,allRecords:e,onClose:()=>p(null)})]})},bye=({title:e,events:t,context:r,onClose:n,onJumpToRaw:a})=>{const i=()=>{const s=t.map(u=>({Week:u.week,Day:u.day,Time:u.time,Floor:u.floor,Room:u.roomName,Type:u.roomType,Attendees:u.attendees})),o=gr.book_new(),c=gr.json_to_sheet(s);gr.book_append_sheet(o,c,"Events"),qm(o,"Drilldown_Events.xlsx")};return l.jsx("div",{className:"absolute inset-0 z-50 bg-slate-900/50 backdrop-blur-sm flex justify-end animate-in fade-in duration-200",children:l.jsxs("div",{className:"w-[600px] bg-white h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[l.jsxs("div",{className:"p-6 border-b border-slate-200 bg-slate-50 flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[e,l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-sm px-2 py-0.5 rounded-full",children:t.length})]}),r&&l.jsxs("div",{className:"mt-2 p-2 bg-indigo-50 border border-indigo-100 rounded text-xs text-indigo-700 font-medium",children:["These events contribute to the room being classified as ",l.jsx("span",{className:"font-bold uppercase",children:r}),"."]})]}),l.jsx("button",{onClick:n,children:l.jsx(xn,{className:"w-5 h-5 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-y-auto p-0",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-white border-b border-slate-200 text-xs text-slate-500 uppercase font-semibold sticky top-0 z-10 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Wk-Day"}),l.jsx("th",{className:"px-6 py-3 bg-white w-20",children:"Time"}),l.jsx("th",{className:"px-6 py-3 bg-white",children:"Room"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Attendees"}),l.jsx("th",{className:"px-6 py-3 bg-white text-right",children:"Action"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:t.map((s,o)=>l.jsxs("tr",{className:"hover:bg-slate-50 group",children:[l.jsxs("td",{className:"px-6 py-3 font-medium text-slate-500",children:["W",s.week,"-D",s.day]}),l.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.time}),l.jsxs("td",{className:"px-6 py-3 text-slate-700",children:[l.jsx("div",{className:"truncate w-32",title:s.roomName,children:s.roomName}),l.jsx("div",{className:"text-[10px] text-slate-400",children:s.roomType})]}),l.jsx("td",{className:"px-6 py-3 text-right font-bold text-indigo-600",children:s.attendees}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("button",{onClick:()=>a(s.rawRowIds),className:"text-xs font-bold text-slate-400 hover:text-indigo-600 flex items-center gap-1 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",children:[l.jsx(Gp,{className:"w-3 h-3"})," Raw Data"]})})]},o))})]})}),l.jsx("div",{className:"p-5 border-t border-slate-200 bg-white",children:l.jsxs("button",{onClick:i,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm hover:bg-slate-800 transition-all shadow-lg flex items-center justify-center gap-2",children:[l.jsx(Ei,{className:"w-4 h-4"})," Export Events CSV"]})})]})})},wye=({ids:e,allRecords:t,onClose:r})=>{const n=t.filter(a=>e.includes(a.id));return l.jsx("div",{className:"absolute inset-0 z-[60] bg-slate-900/60 backdrop-blur-sm flex items-center justify-center p-8 animate-in fade-in duration-200",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[80vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-5 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-lg flex items-center gap-2",children:[l.jsx(Gp,{className:"w-5 h-5 text-indigo-600"})," Source Data Inspection"]}),l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Showing ",n.length," raw Excel row(s) corresponding to selected event."]})]}),l.jsx("button",{onClick:r,children:l.jsx(xn,{className:"w-6 h-6 text-slate-400 hover:text-slate-700"})})]}),l.jsx("div",{className:"flex-grow overflow-auto p-6 bg-slate-50/50",children:l.jsx("div",{className:"bg-white border border-slate-200 rounded-lg overflow-hidden shadow-sm",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3",children:"ID"}),l.jsx("th",{className:"px-4 py-3",children:"Floor"}),l.jsx("th",{className:"px-4 py-3",children:"Room / Dept"}),l.jsx("th",{className:"px-4 py-3",children:"Day"}),l.jsx("th",{className:"px-4 py-3",children:"Time"}),l.jsx("th",{className:"px-4 py-3",children:"Occupancy"}),l.jsx("th",{className:"px-4 py-3",children:"Status"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:n.map(a=>l.jsxs("tr",{className:"hover:bg-indigo-50/30",children:[l.jsx("td",{className:"px-4 py-2 font-mono text-slate-400",children:a.id}),l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:a.floor}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.roomName||a.department}),l.jsxs("td",{className:"px-4 py-2 text-slate-600",children:["Day ",a.day]}),l.jsx("td",{className:"px-4 py-2 text-slate-600",children:a.timeSlot}),l.jsx("td",{className:"px-4 py-2 font-bold text-indigo-600",children:a.attendeeCount||1}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${a.isOccupied?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:a.isOccupied?"Occupied":"Vacant"})})]},a.id))})]})})}),l.jsx("div",{className:"p-4 border-t border-slate-200 bg-white flex justify-end",children:l.jsx("button",{onClick:r,className:"px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg text-sm font-bold transition-colors",children:"Close"})})]})})},_ye=({metrics:e})=>l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsxs("div",{className:"col-span-1 lg:col-span-2 grid grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Avg Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-indigo-600 mt-2",children:[e.avgOccupancy.toFixed(0),"%"]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Peak Occupancy"}),l.jsxs("div",{className:"text-3xl font-bold text-rose-500 mt-2",children:[e.peakOccupancy.toFixed(0),"%"]})]}),l.jsx("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:l.jsxs("div",{className:"flex gap-2 items-start text-xs text-slate-600",children:[l.jsx(dc,{className:"w-4 h-4 text-indigo-500 flex-shrink-0"}),l.jsxs("p",{children:[l.jsx("strong",{children:"Insight:"})," ",e.avgOccupancy<50?"Low utilization suggests opportunity for desk sharing or consolidation.":"High utilization indicates steady demand."]})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy Profile (Time)"}),l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(IC,{data:e.occupancyByTime,children:[l.jsx(ho,{strokeDasharray:"3 3",vertical:!1}),l.jsx(vn,{dataKey:"time",tick:{fontSize:10}}),l.jsx(gn,{unit:"%",tick:{fontSize:10}}),l.jsx(Wt,{}),l.jsx(jc,{type:"monotone",dataKey:"rate",stroke:er.primary,strokeWidth:3,dot:{r:4}})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm h-80",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Occupancy by Floor"}),l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Ec,{data:e.occupancyByFloor,layout:"vertical",children:[l.jsx(ho,{strokeDasharray:"3 3",horizontal:!1}),l.jsx(vn,{type:"number",unit:"%",hide:!0}),l.jsx(gn,{type:"category",dataKey:"floor",tick:{fontSize:11},width:50}),l.jsx(Wt,{}),l.jsx(da,{dataKey:"rate",fill:er.program[0],radius:[0,4,4,0],barSize:20,label:{position:"right",fontSize:10,fill:"#64748b",formatter:t=>`${t.toFixed(0)}%`}})]})})]})]}),Sye=({row:e})=>{const[t,r]=G.useState(!1);if(!e.capacity||e.capacity===0)return l.jsx("div",{className:"text-xs text-slate-400 italic",children:"Set capacity to evaluate fit."});const n=e.sizeBreakdown.map(v=>({label:`${v.size}p`,pct:v.occupancyPct,count:v.count,size:v.size})).filter(v=>v.pct>0),a=v=>v<=1?"bg-slate-200":v<=2?"bg-slate-300":v<=4?"bg-indigo-200":v<=6?"bg-indigo-300":v<=10?"bg-indigo-400":"bg-indigo-500",s=(v=>v.includes("Under")?{class:"bg-blue-50 text-blue-700 border-blue-200",icon:TT}:v.includes("Reasonably")||v.includes("Well")?{class:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:qa}:v.includes("Over")?{class:"bg-rose-50 text-rose-700 border-rose-200",icon:Or}:{class:"bg-amber-50 text-amber-700 border-amber-200",icon:CT})(e.classification),o=s.icon;let c="";e.classification.includes("Underutilized")?c="Most meetings occur well below room capacity.":e.classification.includes("Over")?c="Meetings frequently approach or exceed room capacity.":e.classification.includes("Reasonably")?c="Room usage generally aligns with its designed capacity.":c="Meeting size patterns vary significantly and require review.";const u=Math.round(e.capacity),f=Math.round(.5*u),d=Math.round(.7*u),h=Math.round(.8*u),p=parseInt(e.topMeetingSize.split("p")[0])||0;return l.jsxs("div",{className:"flex flex-col gap-4 w-full relative",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border flex items-center gap-1.5 ${s.class}`,children:[l.jsx(o,{className:"w-3 h-3"}),e.classification]}),l.jsx("button",{onClick:()=>r(!t),className:`p-1 rounded hover:bg-slate-100 ${t?"text-indigo-600 bg-indigo-50":"text-slate-400"}`,title:"Explain Logic",children:l.jsx(dc,{className:"w-3 h-3"})})]}),t&&l.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded p-3 text-[10px] space-y-2 animate-in fade-in slide-in-from-top-1 mt-1",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2 border-b border-slate-200 pb-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Capacity"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[u," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Primary"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[p," pax"]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Avg Occ"}),l.jsxs("span",{className:"font-mono font-bold text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("span",{className:"block text-slate-400 uppercase font-bold",children:"Logic Applied"}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["< ",f," pax"]}),l.jsx("span",{children:"Underutilized"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:[f,"",d," pax"]}),l.jsx("span",{children:"Reasonable"})]}),l.jsxs("div",{className:"flex justify-between items-center bg-white px-2 py-1 rounded border border-slate-100 text-slate-500",children:[l.jsxs("span",{children:["> ",h," pax"]}),l.jsx("span",{children:"Over Utilized"})]})]}),l.jsx("div",{className:"pt-1 text-slate-500 italic",children:"Values are rounded before comparison. Primary size or Avg Occ must trigger threshold."})]}),!t&&l.jsx("div",{className:"text-[10px] text-slate-500 italic",children:c})]}),l.jsx("div",{className:"relative h-8 w-full mt-1",children:l.jsx("div",{className:"absolute inset-0 flex rounded-md overflow-hidden h-full border border-white bg-slate-50",children:n.map((v,x)=>l.jsx("div",{style:{width:`${v.pct}%`},className:`${a(v.size)} h-full border-r border-white last:border-0 relative group flex items-center justify-center transition-colors hover:brightness-95`,title:`${v.label}: ${v.pct.toFixed(1)}%`,children:v.pct>8&&l.jsx("span",{className:"text-[9px] font-bold text-slate-700 opacity-80 whitespace-nowrap px-1",children:v.label})},x))})}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"text-[10px] text-slate-500 font-medium flex gap-3 border-b border-slate-100 pb-2",children:[l.jsxs("span",{children:["Room Capacity: ",l.jsxs("strong",{className:"text-slate-700",children:[e.capacity," pax"]})]}),l.jsx("span",{className:"text-slate-300",children:"|"}),l.jsxs("span",{children:["Avg Occupancy: ",l.jsxs("strong",{className:"text-slate-700",children:[e.avgOccupancy.toFixed(1)," pax"]})]})]}),l.jsx("div",{className:"flex flex-wrap gap-x-3 gap-y-1",children:n.map((v,x)=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${a(v.size)}`}),l.jsxs("span",{className:"text-[9px] text-slate-400 font-medium",children:[v.label," (",v.pct.toFixed(0),"%)"]})]},x))})]})]})},kye=({stats:e,totalRooms:t,roomTypes:r,selectedType:n,onSelectType:a})=>{if(!e||!e.timeline)return null;const i=Math.round(e.avgPct/100*e.uniqueRoomsCount),s=Math.round(e.maxPct/100*e.uniqueRoomsCount),o=n==="All Rooms"?"OVERALL ROOM OCCUPANCY (CONCURRENCY)":`${n.toUpperCase()} OCCUPANCY (CONCURRENCY)`;return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"md:w-1/3 flex flex-col justify-center space-y-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase",children:o}),l.jsxs("div",{className:"relative group",children:[l.jsx("select",{className:"appearance-none bg-slate-50 border border-slate-200 text-xs font-bold text-slate-700 py-1 pl-2 pr-6 rounded-md hover:border-indigo-300 focus:outline-none focus:ring-1 focus:ring-indigo-500 cursor-pointer max-w-[140px] truncate",value:n,onChange:c=>a(c.target.value),children:r.map(c=>l.jsx("option",{value:c,children:c},c))}),l.jsx(pn,{className:"w-3 h-3 text-slate-400 absolute right-2 top-1.5 pointer-events-none"})]})]}),l.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Based on concurrent usage across all observed time slots."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Average Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:[e.avgPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",i," rooms in use"]})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-100",children:[l.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Max Occupied %"}),l.jsxs("div",{className:"text-2xl font-bold text-rose-500",children:[e.maxPct.toFixed(1),"%"]}),l.jsxs("div",{className:"text-xs font-medium text-slate-500 mt-1",children:[" ",s," rooms in use"]})]})]})]}),l.jsx("div",{className:"md:w-2/3 h-64",children:e.timeline.length>0?l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Ec,{data:e.timeline,margin:{top:20,right:20,left:0,bottom:0},children:[l.jsx(ho,{strokeDasharray:"3 3",vertical:!1}),l.jsx(vn,{dataKey:"time",tick:{fontSize:10},interval:"preserveStartEnd",minTickGap:30}),l.jsx(gn,{unit:"%",tick:{fontSize:10},domain:[0,100]}),l.jsx(Wt,{content:({active:c,payload:u,label:f})=>{if(c&&u&&u.length){const d=u[0].payload;return l.jsxs("div",{className:"bg-white p-2 border border-slate-200 rounded shadow-lg text-xs",children:[l.jsx("div",{className:"font-bold text-slate-800 mb-1",children:f}),l.jsxs("div",{className:"text-indigo-600 font-bold",children:[d.pct.toFixed(1),"% Occupied"]}),l.jsxs("div",{className:"text-slate-500",children:[d.occupied," / ",d.total," Rooms Observed"]})]})}return null}}),l.jsx(f0,{y:e.avgPct,stroke:"#6366f1",strokeDasharray:"3 3",label:{value:"Avg",position:"insideTopRight",fill:"#6366f1",fontSize:10}}),l.jsx(da,{dataKey:"pct",fill:"#cbd5e1",radius:[2,2,0,0],children:e.timeline.map((c,u)=>l.jsx(Oi,{fill:c.pct===e.maxPct?"#f43f5e":"#cbd5e1"},`cell-${u}`))})]})}):l.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-slate-300 border-2 border-dashed border-slate-100 rounded-xl",children:[l.jsx(cc,{className:"w-8 h-8 mb-2"}),l.jsx("p",{className:"text-xs",children:"No occupied observations for selected room type."})]})})]})},Nye=({metrics:e})=>{const t=e.globalSizeBins,r=t.map(n=>({name:n.label,value:n.count,pct:n.occupancyPct,fill:n.label.includes("12p")?er.program[5]:n.label.includes("8-11")?er.program[2]:n.label.includes("5-7")?er.program[1]:n.label.includes("3-4")?er.program[3]:er.program[0]}));return l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6 mb-8 flex flex-col md:flex-row gap-8",children:[l.jsxs("div",{className:"flex-1 min-w-[300px]",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Meeting Size Distribution (Occupancy %)"}),l.jsx("div",{className:"h-64",children:l.jsx(sa,{width:"100%",height:"100%",children:l.jsxs(Lm,{children:[l.jsxs(fa,{data:r,dataKey:"pct",nameKey:"name",innerRadius:60,outerRadius:80,paddingAngle:2,children:[r.map((n,a)=>l.jsx(Oi,{fill:n.fill,stroke:"none"},`cell-${a}`)),l.jsx(ta,{dataKey:"name",position:"outside",style:{fontSize:10,fill:"#64748b",fontWeight:"bold"}})]}),l.jsx(Wt,{formatter:(n,a,i)=>[`${n.toFixed(1)}% (${i.payload.value} mtgs)`,a],contentStyle:{borderRadius:"8px",fontSize:"12px"}}),l.jsx(Aa,{verticalAlign:"bottom",height:36,iconType:"circle",wrapperStyle:{fontSize:"11px",fontWeight:600,color:"#475569"}})]})})})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Global Distribution"}),l.jsx("div",{className:"bg-slate-50 rounded-lg border border-slate-200 overflow-hidden",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-slate-100 border-b border-slate-200 text-slate-500 font-bold uppercase",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occupancy %"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-200",children:t.map(n=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2 font-medium text-slate-700",children:n.label}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-500",children:n.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-bold text-indigo-600",children:[n.occupancyPct.toFixed(1),"%"]})]},n.label))})]})})]}),l.jsxs("div",{className:"flex-1 bg-indigo-50 rounded-xl border border-indigo-100 p-5",children:[l.jsxs("h3",{className:"text-xs font-bold text-indigo-800 uppercase mb-3 flex items-center gap-2",children:[l.jsx($T,{className:"w-4 h-4 text-indigo-600"})," Work Behaviors"]}),l.jsx("ul",{className:"space-y-3",children:e.globalInsights.map((n,a)=>l.jsxs("li",{className:"flex gap-2 text-xs text-indigo-900 leading-relaxed",children:[l.jsx(Dp,{className:"w-3 h-3 text-indigo-400 mt-0.5 flex-shrink-0"}),n]},a))})]})]})},jye=({metrics:e,records:t,onUpdateCapacity:r,onDrillDown:n})=>{const[a,i]=G.useState("utilizationPct"),[s,o]=G.useState(!1),[c,u]=G.useState(null),[f,d]=G.useState("All"),[h,p]=G.useState("All Rooms"),v=G.useMemo(()=>{let m=[...e.roomMetrics];return f!=="All"&&(m=m.filter(S=>f==="Under"?S.classification.includes("Under"):f==="Fit"?S.classification.includes("Reasonably")||S.classification.includes("Well"):f==="Over"?S.classification.includes("Over"):f==="Mixed"?S.classification.includes("Mixed")||S.classification.includes("Unclassified"):!0)),m.sort((S,w)=>{const _=S[a],k=w[a];return s?_-k:k-_})},[e.roomMetrics,a,s,f]),x=G.useMemo(()=>{const m=new Set;return t.forEach(S=>{S.roomType&&m.add(S.roomType.trim())}),["All Rooms",...Array.from(m).sort()]},[t]),y=G.useMemo(()=>{const m=h==="All Rooms"?t:t.filter(S=>(S.roomType||"").trim()===h);return eM(m)},[t,h]),g=m=>{if(!m.sizeBreakdown||m.sizeBreakdown.length===0)return"No data available.";const w=[...m.sizeBreakdown].sort((E,O)=>O.count-E.count)[0],k=m.sizeBreakdown.filter(E=>E.size<=2).reduce((E,O)=>E+O.occupancyPct,0);if(w.size<=2&&k>w.occupancyPct+5)return`Small meetings (12p) account for ${k.toFixed(0)}% of usage.`;const j=m.sizeBreakdown.filter(E=>E.size>=3&&E.size<=4).reduce((E,O)=>E+O.occupancyPct,0);return(w.size===3||w.size===4)&&j>w.occupancyPct+5?`34 pax meetings account for ${j.toFixed(0)}% of usage.`:"Most frequent occupancy observed."},b=m=>m.includes("Under")?l.jsxs("span",{title:m,className:"inline-flex items-center gap-1 text-[10px] font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded border border-blue-100",children:[l.jsx(TT,{className:"w-3 h-3"})," Under"]}):m.includes("Reasonably")||m.includes("Well")?l.jsxs("span",{title:m,className:"inline-flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded border border-emerald-100",children:[l.jsx(qa,{className:"w-3 h-3"})," Fit"]}):m.includes("Over")?l.jsxs("span",{title:m,className:"inline-flex items-center gap-1 text-[10px] font-bold text-rose-600 bg-rose-50 px-2 py-0.5 rounded border border-rose-100",children:[l.jsx(Or,{className:"w-3 h-3"})," Over"]}):l.jsxs("span",{title:m,className:"inline-flex items-center gap-1 text-[10px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded border border-amber-100",children:[l.jsx(CT,{className:"w-3 h-3"})," Mixed"]});return l.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-4 duration-500",children:[l.jsx(kye,{stats:y,totalRooms:e.totalRooms,roomTypes:x,selectedType:h,onSelectType:p}),l.jsx(Nye,{metrics:e}),l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 flex justify-between items-center bg-slate-50",children:[l.jsxs("h3",{className:"font-bold text-slate-800 text-sm flex items-center gap-2",children:[l.jsx(sD,{className:"w-4 h-4 text-slate-500"})," Room Performance"]}),l.jsx("div",{className:"flex items-center gap-1 bg-white border border-slate-200 p-0.5 rounded-lg",children:["All","Under","Fit","Over","Mixed"].map(m=>l.jsx("button",{onClick:()=>d(m),className:`px-3 py-1 text-[10px] font-bold rounded-md transition-colors ${f===m?"bg-indigo-50 text-indigo-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:m},m))}),l.jsxs("div",{className:"text-xs text-slate-400 hidden sm:block",children:[e.totalRooms," Rooms | ",e.totalObservations," Observations"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left text-sm",children:[l.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-xs uppercase text-slate-500 font-semibold",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("floor"),children:"Floor"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomName"),children:"Room Name"}),l.jsx("th",{className:"px-6 py-3 cursor-pointer hover:text-slate-700",onClick:()=>i("roomType"),children:"Type"}),l.jsx("th",{className:"px-6 py-3 text-center w-24",children:"Capacity (Pax)"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("utilizationPct"),children:"Util %"}),l.jsx("th",{className:"px-6 py-3 text-right cursor-pointer hover:text-slate-700",onClick:()=>i("avgOccupancy"),children:"Avg Occ."}),l.jsx("th",{className:"px-6 py-3 text-center",children:"Status"}),l.jsx("th",{className:"px-4 py-3 text-center w-10"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:v.map((m,S)=>{const w=c===`${m.floor}-${m.roomName}`;return l.jsxs(Y.Fragment,{children:[l.jsxs("tr",{className:`hover:bg-slate-50 transition-colors cursor-pointer ${w?"bg-slate-50":""}`,onClick:()=>u(w?null:`${m.floor}-${m.roomName}`),children:[l.jsx("td",{className:"px-6 py-3 text-slate-600",children:m.floor}),l.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:m.roomName}),l.jsx("td",{className:"px-6 py-3 text-slate-500 text-xs",children:m.roomType}),l.jsx("td",{className:"px-6 py-3 text-center",onClick:_=>_.stopPropagation(),children:l.jsxs("div",{className:"relative group/edit w-20 mx-auto",children:[l.jsx("input",{type:"number",className:"w-full text-center border-b border-transparent hover:border-slate-300 focus:border-indigo-500 focus:outline-none bg-transparent",placeholder:"-",value:m.capacity||"",onChange:_=>r(m.floor,m.roomName,parseInt(_.target.value)||0)}),l.jsx(q8,{className:"w-3 h-3 text-slate-300 absolute right-0 top-1 opacity-0 group-hover/edit:opacity-100 pointer-events-none"})]})}),l.jsx("td",{className:"px-6 py-3 text-right",children:l.jsxs("span",{className:`px-2 py-1 rounded text-xs font-bold ${m.utilizationPct>50?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-600"}`,children:[m.utilizationPct.toFixed(0),"%"]})}),l.jsx("td",{className:"px-6 py-3 text-right font-mono text-slate-600",children:m.avgOccupancy.toFixed(1)}),l.jsx("td",{className:"px-6 py-3 text-center",children:b(m.classification)}),l.jsx("td",{className:"px-4 py-3 text-center text-slate-400",children:l.jsx(pn,{className:`w-4 h-4 transition-transform ${w?"rotate-180":""}`})})]}),w&&l.jsx("tr",{children:l.jsx("td",{colSpan:8,className:"p-0 bg-slate-50 border-b border-slate-200",children:l.jsxs("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in slide-in-from-top-2",children:[l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col justify-between",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Room Snapshot"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Total Meetings (Occupied)"}),l.jsx("span",{className:"text-lg font-bold text-slate-800",children:m.occupiedSlots})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-slate-600",children:"Room Utilization"}),l.jsxs("span",{className:`text-lg font-bold ${m.utilizationPct>50?"text-emerald-600":"text-slate-800"}`,children:[m.utilizationPct.toFixed(1),"%"]})]}),l.jsxs("div",{className:"pt-2 border-t border-slate-100 mt-2",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Primary Meeting Size"}),l.jsx("div",{className:"text-xl font-bold text-indigo-700",children:m.topMeetingSize}),l.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:g(m)})]})]})]}),l.jsxs("div",{className:"bg-white p-5 rounded-lg border border-slate-200 shadow-sm h-full flex flex-col",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-4",children:"Capacity Fit Analysis"}),l.jsx("div",{className:"flex-grow flex items-center",children:l.jsx(Sye,{row:m})})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden flex flex-col max-h-64",children:[l.jsx("div",{className:"bg-slate-50 px-4 py-2 border-b border-slate-200",children:l.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:"Size Breakdown"})}),l.jsx("div",{className:"flex-grow overflow-y-auto",children:l.jsxs("table",{className:"w-full text-left text-xs",children:[l.jsx("thead",{className:"bg-white sticky top-0 text-slate-400 font-bold border-b border-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:"Size"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Count"}),l.jsx("th",{className:"px-4 py-2 text-right",children:"Occ %"}),l.jsx("th",{className:"px-4 py-2"})]})}),l.jsxs("tbody",{className:"divide-y divide-slate-100",children:[m.sizeBreakdown.map((_,k)=>l.jsxs("tr",{className:"hover:bg-slate-50",children:[l.jsxs("td",{className:"px-4 py-2 font-bold text-slate-700",children:[_.size," pax"]}),l.jsx("td",{className:"px-4 py-2 text-right text-slate-600",children:_.count}),l.jsxs("td",{className:"px-4 py-2 text-right font-mono font-bold text-indigo-700",children:[_.occupancyPct.toFixed(0),"%"]}),l.jsx("td",{className:"px-4 py-2 text-right",children:l.jsxs("button",{onClick:()=>n(`${m.roomName} - ${_.size} Pax Meetings`,_.events,m.classification),className:"text-[9px] font-bold text-slate-400 hover:text-indigo-600 border border-slate-200 hover:border-indigo-200 px-2 py-1 rounded transition-colors",children:["View (",_.count,")"]})})]},k)),m.sizeBreakdown.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:4,className:"p-4 text-center text-slate-400",children:"No data"})})]})]})})]})]})})})]},S)})})]})})]})]})},Cs=[{title:"Project Context",desc:"Define the strategic identity, scale, and physical constraints of your project. These inputs drive all subsequent capacity calculations.",icon:Up},{title:"Strategy & Budget",desc:"Model scenarios by adjusting policy ratios (Sharing, Meeting, Support). See real-time impact on area demand vs supply.",icon:ds},{title:"Decision Framework",desc:"Compare scenarios side-by-side using strategic indicators like Density, Utilization Index, and Meeting Ratios.",icon:ps},{title:"Stacking & Mix",desc:"Visualize program distribution across floors. Ensure the 'Program Mix' aligns with organizational goals.",icon:In},{title:"Deep Analysis",desc:"Use Team Adjacency and Utilization Studies to validate your strategy with data-driven evidence.",icon:hs}],Eye=({onClose:e})=>{const[t,r]=G.useState(0),n=()=>{t<Cs.length-1?r(t+1):e()},a=Cs[t].icon;return l.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"h-32 bg-gradient-to-r from-orange-500 to-rose-500 relative flex items-center justify-center",children:[l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-md",children:l.jsx(a,{className:"w-8 h-8 text-white"})}),l.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-white/70 hover:text-white",children:l.jsx(xn,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"p-8 text-center",children:[l.jsxs("div",{className:"text-xs font-bold text-orange-600 uppercase tracking-widest mb-2",children:["Step ",t+1," of ",Cs.length]}),l.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-4",children:Cs[t].title}),l.jsx("p",{className:"text-slate-500 leading-relaxed mb-8 h-16",children:Cs[t].desc}),l.jsx("div",{className:"flex gap-2 justify-center mb-8",children:Cs.map((i,s)=>l.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${s===t?"w-8 bg-orange-500":"w-2 bg-slate-200"}`},s))}),l.jsxs("button",{onClick:n,className:"w-full py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg",children:[t===Cs.length-1?"Get Started":"Next Step"," ",l.jsx(Gr,{className:"w-4 h-4"})]})]})]})})},Tye=()=>{const[e,t]=G.useState(U1e),[r,n]=G.useState("home"),[a,i]=G.useState(!0),[s,o]=G.useState([{...u4,id:"s1",name:"Scenario A"}]),[c,u]=G.useState("s1"),[f,d]=G.useState(null),h=s.find(_=>_.id===c)||s[0],p=G.useMemo(()=>q1(e,h),[e,h]),v=s.find(_=>_.id===f),x=v?q1(e,v):null,y=_=>{o(k=>k.map(N=>N.id===_.id?_:N))},g=()=>{const _=`s${Date.now()}`,k={...u4,id:_,name:`Option ${s.length+1}`};o([...s,k]),u(_)},b=()=>{const _=`s${Date.now()}`,k={...h,id:_,name:`${h.name} (Copy)`};o([...s,k]),u(_)},m=_=>{if(s.length>1){const k=s.filter(N=>N.id!==_);o(k),c===_&&u(k[0].id),f===_&&d(null)}},S=(_,k)=>{o(N=>N.map(j=>j.id===_?{...j,name:k}:j))};G.useEffect(()=>{const _=z1e(e.industry,e.projectType);Object.keys(_).length>0&&o(k=>k.map(N=>N.id===c?{...N,..._}:N))},[e.industry,e.projectType]);const w=({page:_,label:k,icon:N})=>l.jsxs("button",{onClick:()=>n(_),className:`w-full flex items-center gap-3 px-5 py-3 text-sm font-medium transition-all duration-200 border-l-2 ${r===_?"border-orange-500 bg-slate-50 text-slate-900":"border-transparent text-slate-500 hover:bg-slate-50 hover:text-slate-700"}`,children:[l.jsx(N,{className:`w-4 h-4 ${r===_?"text-orange-500":"text-slate-400"}`}),k]});return l.jsxs("div",{className:"h-screen w-screen bg-slate-100 flex overflow-hidden font-sans text-slate-900",children:[a&&l.jsx(Eye,{onClose:()=>i(!1)}),l.jsxs("div",{className:"w-64 bg-white border-r border-slate-200 flex flex-col flex-shrink-0 z-30 shadow-sm",children:[l.jsx("div",{className:"p-6 border-b border-slate-100",children:l.jsxs("div",{className:"flex flex-col gap-1.5",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-8 bg-orange-500 rounded-sm"}),l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-[0.2em]",children:"M MOSER ASSOCIATES"})]}),l.jsxs("h1",{className:"text-base font-bold text-slate-800 leading-tight pl-4",children:["Workplace Strategy",l.jsx("br",{}),"Toolkit"]})]})}),l.jsxs("div",{className:"flex-grow py-8 space-y-8 overflow-y-auto",children:[l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Context"}),l.jsx(w,{page:"home",label:"Project Information",icon:Up})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Strategy & Planning"}),l.jsx(w,{page:"budget",label:"Space Budget",icon:ds}),l.jsx(w,{page:"stacking",label:"Stacking Plan",icon:ia})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deep Analysis"}),l.jsx(w,{page:"adjacency",label:"Team Adjacency",icon:hs}),l.jsx(w,{page:"utilization",label:"Utilization Study",icon:cc}),l.jsx(w,{page:"test-fit",label:"Test Fit Scoring",icon:Fp})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("div",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider px-6 mb-3",children:"Deliverables"}),l.jsx(w,{page:"exports",label:"Exports",icon:Ei})]})]}),l.jsx("div",{className:"p-5 border-t border-slate-100 bg-slate-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 bg-white border border-slate-200 rounded-full flex items-center justify-center shadow-sm",children:l.jsx(DT,{className:"w-4 h-4 text-slate-400"})}),l.jsxs("div",{className:"flex-grow overflow-hidden",children:[l.jsx("div",{className:"text-xs font-bold text-slate-800 truncate",title:e.projectName,children:e.projectName||"New Project"}),l.jsx("div",{className:"text-[10px] text-slate-500 truncate",children:e.location||"Location N/A"})]})]})})]}),l.jsx("div",{className:"flex-grow flex flex-col overflow-hidden bg-[#F8FAFC] relative",children:l.jsxs("div",{className:"flex-grow overflow-hidden relative",children:[r==="home"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(W1e,{data:e,onChange:t})}),r==="budget"&&l.jsx(aye,{project:e,setProject:t,activeStrategy:h,handleStrategyChange:y,activeMetrics:p,scenarios:s,activeScenarioId:c,setActiveScenarioId:u,addScenario:g,duplicateScenario:b,deleteScenario:m,renameScenario:S,compareScenarioId:f,setCompareScenarioId:d,compareMetrics:x,onNavigate:_=>n(_)}),r==="stacking"&&l.jsxs("div",{className:"h-full p-6 flex flex-col",children:[l.jsxs("div",{className:"mb-6 flex justify-between items-end px-2",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Stacking Plan"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Translate strategy into floor-by-floor allocation."})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Active Strategy:"}),l.jsx("span",{className:"text-xs font-bold bg-white border border-slate-200 text-orange-600 px-3 py-1 rounded-full shadow-sm",children:h.name})]})]}),l.jsx("div",{className:"flex-grow overflow-hidden bg-white rounded-xl shadow-sm border border-slate-200",children:l.jsx(Q5,{metrics:p,project:e,strategy:h,mode:"default",onUpdateProject:t})})]}),r==="adjacency"&&l.jsx("div",{className:"h-full p-6",children:l.jsx(lye,{project:e,onChange:t,metrics:p,onNavigateToStacking:()=>n("stacking")})}),r==="utilization"&&l.jsx("div",{className:"h-full",children:l.jsx(gye,{})}),r==="test-fit"&&l.jsx("div",{className:"h-full p-8 overflow-y-auto",children:l.jsx(cye,{metrics:p,project:e})}),r==="exports"&&l.jsx("div",{className:"h-full",children:l.jsx(uye,{project:e,scenarios:s,activeScenarioId:c})})]})})]})},tM=document.getElementById("root");if(!tM)throw new Error("Could not find root element to mount to");const Aye=Ed.createRoot(tM);Aye.render(l.jsx(Y.StrictMode,{children:l.jsx(Tye,{})}));
